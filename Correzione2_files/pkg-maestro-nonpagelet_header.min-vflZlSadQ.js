define("modules/clean/accessibility/tabbable",["jquery"],function(e){return(function(){function t(){t.initialized||this.listen()}return t.initialized=!1,t.prototype.listen=function(){return t.initialized=!0,e(document).on("keydown",(function(t){return function(t){if(9===t.keyCode)return e(document.body).addClass("tabbing")}})(this)),e(document).on("mousedown",(function(t){return function(t){return e(document.body).removeClass("tabbing")}})(this))},t.initialize_module=function(){return new t},t})()}),define("modules/clean/api_v2/client",["require","exports","tslib","jquery","external/underscore","modules/clean/api_v2/error","modules/clean/devtools/perf_hub_actions","modules/constants/debug","modules/constants/request","modules/core/i18n","modules/core/cookies","modules/core/notify","modules/core/uri"],function(e,t,n,r,i,o,s,a,l,c,u,d,p){"use strict";var _=(function(){function e(e,t){if(void 0===e&&(e="async"),"async"===e){if(void 0!==t)throw new Error("syncMode is 'async'; do not specify a syncTimeout")}else{if("syncOrServiceWorker"===e)throw new Error("syncOrServiceWorker mode not yet supported");if(void 0===t)throw new Error("syncMode is "+e+", but syncTimeout was not specified");if(t<=0)throw new Error("syncMode is "+e+", and you passed syncTimeout="+t+". syncTimeout must be a positive number")}this.syncMode=e,this.syncTimeout=t}return e.prototype.rpc=function(e,t,n,r){null==n&&(n=null);var o=u.read(l.JS_CSRF_COOKIE)||"",s={"X-Dropbox-Uid":e,"X-CSRF-Token":o};i.extend(s,r);var c=new p({scheme:"https",authority:"www.dropbox.com",path:"/2/"+t});a.CPROFILE_ENABLED&&c.setQuery({cProfile:a.CPROFILE_PARAMETER,parent_request_id:l.REQUEST_ID});var d=c.toString(),_=c.getPath(),m=JSON.stringify(n);switch(this.syncMode){case"async":return this.executeAsyncRpc(d,_,s,m);case"sync":return this.executeSyncRpc(d,_,s,m);case"syncOrServiceWorker":throw new Error("syncOrServiceWorker mode not yet supported")}},e.prototype.executeAsyncRpc=function(t,n,i,o){return new Promise(function(s,a){return r.ajax({type:"POST",url:t,contentType:"application/json",headers:i,data:o}).done(function(t,r,i){return s(e.processXHRSuccess(n,t,r,i))}).fail(function(t){return a(e.processXHRError(t))})})},e.prototype.executeSyncRpc=function(t,n,i,o){var s=Promise.resolve(null),a=function(t,r,i){s=Promise.resolve(e.processXHRSuccess(n,t,r,i))},l=function(t){s=Promise.reject(e.processXHRError(t))};return r.ajax({type:"POST",url:t,contentType:"application/json",headers:i,data:o,async:!1,timeout:this.syncTimeout,success:a,error:l}),s},e.processXHRSuccess=function(e,t,n,r){return a.CPROFILE_ENABLED&&s.add_ajax_profile({xhr:r,url:e}),null!=r.responseText?JSON.parse(r.responseText):null},e.processXHRError=function(e){return o.ApiError.parseResponse(e.status,e.getAllResponseHeaders(),e.responseText)},e})();t.ApiV2Client=_;var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.rpc=function(t,n,r,i,o){return void 0===o&&(o=!1),e.prototype.rpc.call(this,t,n,r,i).catch(function(e){var t;return t=null!=e.error?e.error.console_error:e.message?e.message:c._("There was a problem completing this request."),o&&d.error(t),Promise.reject(e)})},t})(_);t.TeamActionsClient=m});var hasProp={}.hasOwnProperty,extend=function(e,t){function n(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};define("modules/clean/api_v2/error",["modules/core/html","modules/core/i18n"],function(e,t){var n,r,i,o,s,a,l,c;return l=t._,n=(function(){function t(){}return t.parseResponse=function(n,c,u,d){var p,_,m,h,f,y,g,v,b,w,I,S,T,A;null==d&&(d=null),null==d&&(d=(function(){switch(n){case 400:return o;case 401:return i;case 409:return r;case 429:return s;default:return n>=500?a:t}})()),b={raw:{status:n,headerString:c,responseBody:u}};try{h=JSON.parse(u)||{},b.error=h.error,b.summary=h.error_summary,v=(null!=(w=h.user_message)?w.text:void 0)||""}catch(e){e,b.error=null,b.summary=null,v=""}if(429===n&&(v=v||l('Folder updates in progress â€” please try again later. <a href="/help/9259">Learn more</a>')),v&&(v=new e(v)),b.headers={},null!=c)for(I=c.split("\n"),m=0,g=I.length;m<g;m++)p=I[m],p.length>0&&(S=p.split(": "),y=S[0],A=S[1],b.headers[y]=A);_=new d(v);for(f in b)hasProp.call(b,f)&&(T=b[f],_[f]=T);return _},t})(),o=(function(e){function t(e){this.message=e}return extend(t,e),t})(n),i=(function(e){function t(e){this.message=e}return extend(t,e),t})(n),r=(function(e){function t(e){this.message=e}return extend(t,e),t})(n),s=(function(e){function t(e){this.message=e}return extend(t,e),t.prototype.getRetryAfter=function(){var e;return null!=(e=this.headers)?e["retry-after"]:void 0},t})(n),a=(function(e){function t(e){this.message=e}return extend(t,e),t})(n),c=function(e){return function(t){if(t instanceof n)return e(t);throw t}},{catchApiError:c,ApiError:n,AppError:r,AuthError:i,BadRequestError:o,RateLimitError:s,ServerError:a}}),define("modules/clean/api_v2/root_aware_client",["require","exports","tslib","external/underscore","modules/clean/api_v2/client","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,n,r,i,o,s,a){"use strict";var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.rpc=function(t,n,i,s){var a={},l=o.get_viewer().get_user_by_id(t);if(l){var c=l.root_ns_id;c&&(a["X-Dropbox-Path-Root"]=c)}return r.extend(a,s),e.prototype.rpc.call(this,t,n,i,a)},t})(i.ApiV2Client);t.ApiV2RootAwareClient=l;var c=(function(){function e(){this.client=new l}return e.prototype.rpc=function(e,t,n,r,i){return void 0===r&&(r=!1),this.client.rpc(e,t,n,i).catch(function(e){return r&&a.error(e.message||s._("There was a problem completing this request.")),Promise.reject(e)})},e})();t.UserActionsRootAwareClient=c}),define("modules/clean/api_v2/types",["require","exports","tslib","modules/clean/datetime"],function(e,t,n,r){"use strict";function i(e){return r.format_date_utc(e,"yyyy-MM-ddTHH:mm:ssZ")}var o=(function(){function e(e,t,n){this.type=e,this.value=t,this.isScalar=n}return e.parse=function(e){var t=e[".tag"];return 2===Object.keys(e).length&&null!=e[t]?new s(t,e[t]):new a(t,e)},e})();t.Union=o;var s=(function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n,!0)||this}return n.__extends(t,e),t.prototype.toJSON=function(){var e={".tag":this.type};return null!=this.value&&(e[this.type]=this.value),e},t})(o);t.UnionScalar=s;var a=(function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n,!1)||this}return n.__extends(t,e),t.prototype.toJSON=function(){return n.__assign({".tag":this.type},this.value)},t})(o);t.UnionStruct=a;t.formatTimestamp=i}),define("modules/clean/avatar/faceholder",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/clean/react/image","modules/clean/static_urls"],function(e,t,n,r,i,o){var s,a,l,c,u;return a=t.VALID_AVATAR_DIMENSIONS,c=n.getClassName,u=o.static_url,l=e.DOM,s=e.createClass({displayName:"Faceholder",propTypes:{alt:e.PropTypes.string,dimension:e.PropTypes.oneOf(a).isRequired,onClick:e.PropTypes.func,optionalClass:e.PropTypes.string},statics:{SRC_MAP:{16:u("/static/images/avatar/faceholder-16-vflzvFMED.png"),24:u("/static/images/avatar/faceholder-24-vflpqFBTK.png"),32:u("/static/images/avatar/faceholder-32-vflKWtuU5.png"),48:u("/static/images/avatar/faceholder-48-vfll8Voom.png"),64:u("/static/images/avatar/faceholder-64-vflHTEplh.png")},SRC_HI_RES_MAP:{16:u("/static/images/avatar/faceholder-16@2x-vflBZ7FgU.png"),24:u("/static/images/avatar/faceholder-24@2x-vflVegRLu.png"),32:u("/static/images/avatar/faceholder-32@2x-vflYmh947.png"),48:u("/static/images/avatar/faceholder-48@2x-vflUglZDR.png"),64:u("/static/images/avatar/faceholder-64@2x-vfl8eFSM8.png")}},componentDidMount:function(){return r.require_css("/static/css/scooter/scooter-scoped-vfl0UVTY2.css")},render:function(){var t,n;return t=["c-avatar--circle"],this.props.optionalClass&&t.push(this.props.optionalClass),n=e.createElement(i,{alt:this.props.alt||"",src:s.SRC_MAP[this.props.dimension],srcHiRes:s.SRC_HI_RES_MAP[this.props.dimension]}),null!=this.props.onClick&&this.props.alt?(t.push("u-unbutton"),l.button({className:c(this.props.dimension,t),onClick:this.props.onClick},n)):l.div({className:c(this.props.dimension,t),onClick:this.props.onClick},n)}})}),define("modules/clean/avatar/initials_avatar_with_color",["jquery","external/react","modules/clean/avatar/initials_avatar","modules/clean/avatar/style"],function(e,t,n,r){var i,o;return o=r.colorValueForAvatarName,i=t.createElement,t.createClass({displayName:"InitialsAvatarWithColorDerivedFromName",propTypes:{name:t.PropTypes.string.isRequired},render:function(){var t;return t=e.extend({color:o(this.props.name)},this.props),delete t.name,i(n,t)}})}),define("modules/clean/components/scooter/badge",["external/classnames","external/react","external/underscore","modules/core/i18n"],function(e,t,n,r){var i,o,s,a,l,c;return l=r._,c=t.DOM,s={TOP_RIGHT:"TOP_RIGHT"},a=Object.freeze(["normal","loud"]),i=t.createClass({statics:{POSITIONS:s,VARIANTS:a},displayName:"Badge",mixins:[t.addons.PureRenderMixin],propTypes:{position:t.PropTypes.oneOf(n.values(s)),variant:t.PropTypes.oneOf(a),isMaestroDesign:t.PropTypes.bool},getDefaultProps:function(){return{variant:"normal",isMaestroDesign:!1}},_getClassNames:function(){return this.props.isMaestroDesign?"maestro-badge":e({"c-badge":!0,"c-badge--top-right":this.props.position===s.TOP_RIGHT,"c-badge--loud":"loud"===this.props.variant})},render:function(){return c.div({className:this._getClassNames(),"aria-hidden":!0},this.props.children)}}),o=t.createClass({statics:{POSITIONS:s,VARIANTS:a},displayName:"CounterBadge",mixins:[t.addons.PureRenderMixin],propTypes:{count:t.PropTypes.number,position:t.PropTypes.oneOf(n.values(s)),variant:t.PropTypes.oneOf(a),maxCount:t.PropTypes.number,isMaestroDesign:t.PropTypes.bool},render:function(){var e,n,r,o,s,a,u;return a=this.props,e=a.count,u=a.variant,s=a.position,o=a.maxCount,n=a.isMaestroDesign,e?(r=null!=o&&e>o?l("%(count)s+",{comment:"label text for a counter badge, for example: 99+"}).format({count:o}):String(e),t.createElement(i,{position:s,variant:u,isMaestroDesign:n},r)):c.div()}}),{Badge:i,CounterBadge:o}}),define("modules/clean/contacts/types",["require","exports"],function(e,t){"use strict";var n;return(function(e){e[e.EMAIL=0]="EMAIL",e[e.FB=1]="FB",e[e.INVALID_ID=2]="INVALID_ID",e[e.NEW_STYLE_GROUP=4]="NEW_STYLE_GROUP",e[e.DBX_ID=5]="DBX_ID"})(n||(n={})),n});var bind=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/loggers/folder_invite_impression_logger",["modules/clean/analytics","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/models"],function(e,t,n){var r,i,o,s,a,l,c,u;return a=e.ProEventsLogger,r=t.EventTypes,s=n.NotificationTypes,c=n.SharedFolderInviteOverQuotaStatuses,u={},o=3,l={},l[c.ALREADY_OVER]="view_shared_folder_notification_already_oq",l[c.WILL_BE_OVER]="view_shared_folder_notification_near_oq",i=(function(){function e(){this._handleRenderedNotifications=bind(this._handleRenderedNotifications,this)}return e.prototype.listenTo=function(e){return e.addListener(r.RENDERED_NOTIFICATIONS,this._handleRenderedNotifications)},e.prototype.unlistenTo=function(e){return e.removeListener(r.RENDERED_NOTIFICATIONS,this._handleRenderedNotifications)},e.prototype._handleRenderedNotifications=function(e){var t;if(t=e.notifications,!this._hasLoggedOverQuotaImpressions)return this._hasLoggedOverQuotaImpressions=!0,this._logOverQuotaImpressions(t)},e.prototype._logOverQuotaImpressions=function(e){var t,n,r,i,c,u,d;for(u=e.slice(0,o),d=[],n=0,r=u.length;n<r;n++)if(i=u[n],i.type===s.SharedFolderInvite){if(c=i.typeData.overQuotaStatus,t=l[c]){a.log(t);break}d.push(void 0)}else d.push(void 0);return d},e})(),u.FolderInviteImpressionLogger=i,u}),define("modules/clean/loggers/notification_logger",["modules/clean/ajax","modules/clean/react/user_notifications/models"],function(e,t){var n,r;return r=t.NotificationStatusStrings,n={logReceive:function(e){var t,r;return r=(function(){var r,i,o;for(o=[],r=0,i=e.length;r<i;r++)t=e[r],o.push(n._getCommonEventData("receive",t));return o})(),n._log(r)},logRender:function(e,t){var r,i,o,s,a,l;for(l=[],i=r=0,o=e.length;r<o;i=++r)s=e[i],a=n._getCommonEventData("render",s),a.location="home",a.location_index=t+i,l.push(a);return n._log(l)},logAction:function(e,t){var r;return r=n._getCommonEventData("action",e),r.action_taken=t,n._log([r])},_log:function(t){if(0!==t.length)return e.SilentBackgroundRequest({url:"/log/notif_events",data:{event_list:JSON.stringify(t)}})},_getCommonEventData:function(e,t){return{event_name:e,type_id:t.typeId,campaign_id:t.campaignId,campaign_version:t.campaignVersion,instance_id:parseInt(t.id),status:r[t.status],target_object_key:t.targetObjectKey}}},{NotificationLogger:n}}),define("modules/clean/loggers/notification_tray_logger",["require","exports","modules/clean/ajax"],function(e,t,n){"use strict";function r(e){i({event_name:"tray_popup_shown",badge_count:e})}function i(e){n.SilentBackgroundRequest({url:"/log/notif_tray_events",data:{event_dict:JSON.stringify(e)}})}t.logTrayOpen=r}),define("modules/clean/photos/batch_thumb_loader",["jquery","modules/clean/ajax","modules/core/uri","modules/constants/env"],function(e,t,n,r){return(function(){function i(e){var t,n;t=e.batch_size,n=e.max_parallel_requests,this.on_batch=e.on_batch,this.batch_logger=e.batch_logger,this.on_batch_success=e.on_batch_success,this.batch_size=t||this.DEFAULT_BATCH_SIZE,this.max_parallel_requests=n||this.DEFAULT_MAX_PARALLEL_REQUESTS,this.thumb_url_queue=[],this.batch_queue=[],this.callback_by_id={},this.request_ids_by_url={},this.num_requests_in_flight=0,this.flushing=!1,this.next_thumb_request_id=0,this.next_batch_id=0,this.cancelled_urls={},this.outstanding_batches={},this._request_callback_by_request_id={}}return i.prototype.DEFAULT_BATCH_SIZE=16,i.prototype.DEFAULT_MAX_PARALLEL_REQUESTS=6,i.prototype.MAX_URL_LENGTH=6e3,i.prototype.vend_request_id=function(){var e;return e=this.next_thumb_request_id,this.next_thumb_request_id++,e},i.prototype.queue_thumb=function(t,n,i){var o,s,a,l,c,u,d,p,_,m;if(null==i&&(i={}),_=i.request_id,u=i.onrequest,!t)return null;if(e.support.cors&&r.BATCH_THUMB_ENDPOINTS.length){if(null==_&&(_=this.vend_request_id()),(null!=(d=this.request_ids_by_url[t])?d.length:void 0)>0){a=!1;for(o in this.outstanding_batches)for(p=this.outstanding_batches[o].urls,l=0,c=p.length;l<c;l++)m=p[l],m===t&&(a=!0);a&&"function"==typeof u&&u()}else this.thumb_url_queue.push(t),this.request_ids_by_url[t]=[];return this.request_ids_by_url[t].push(_),this.callback_by_id[_]={url:t,callback:n},this._request_callback_by_request_id[_]=u,this.thumb_url_queue.length>=this.batch_size&&(this.batch_queue.push(this.thumb_url_queue.splice(0,this.batch_size)),this._send_batch_requests()),_}return"function"==typeof u&&u(),s=!0,"function"==typeof n&&n(t,s),null},i.prototype.cancel_thumb=function(e){var t,n,r,i,o,s,a,l,c,u,d,p,_,m,h,f,y,g,v,b,w,I,S,T,A;if(null!=this.callback_by_id[e]){for(T=this.callback_by_id[e].url,delete this.callback_by_id[e],delete this._request_callback_by_request_id[e],y=this.request_ids_by_url[T],i=a=0,c=y.length;a<c;i=++a)if(o=y[i],o===e){this.request_ids_by_url[T].splice(i,1);break}if(0===this.request_ids_by_url[T].length){for(delete this.request_ids_by_url[T],g=this.thumb_url_queue,i=l=0,u=g.length;l<u;i=++l)if(S=g[i],S===T)return void this.thumb_url_queue.splice(i,1);for(v=this.batch_queue,i=m=0,d=v.length;m<d;i=++m)for(n=v[i],s=h=0,p=n.length;h<p;s=++h)if(S=n[s],S===T)return n.splice(s,1),void(0===n.length&&this.batch_queue.splice(i,1));this.cancelled_urls[T]=1,I=[];for(r in this.outstanding_batches){for(b=this.outstanding_batches[r],A=b.urls,w=b.request,t=!0,f=0,_=A.length;f<_;f++)T=A[f],t=null!=this.cancelled_urls[T]&&t;if(t){w.abort();break}I.push(void 0)}return I}}},i.prototype.flush=function(){for(;this.thumb_url_queue.length;)this.batch_queue.push(this.thumb_url_queue.splice(0,this.batch_size));return this._send_batch_requests()},i.prototype.reset=function(e){var t;return t=e.batch_size,this.batch_logger=e.batch_logger,this.batch_size=t||this.DEFAULT_BATCH_SIZE},i.prototype.clear=function(){return this.thumb_url_queue=[]},i.prototype.pause=function(){return this.flushing=!1},i.prototype._send_batch_requests=function(){var e,n,r,i,o,s,a,l,c,u,d,p,_,m,h;if(!(0===this.batch_queue.length||this.num_requests_in_flight>=this.max_parallel_requests)){for(this.flushing=!0,m=this.batch_queue.shift(),u=this._generate_request_params(m),i=u[0],c=u[1],r=u[2],"function"==typeof this.on_batch&&this.on_batch(m),o=0,a=m.length;o<a;o++)for(h=m[o],d=this.request_ids_by_url[h],s=0,l=d.length;s<l;s++)_=d[s],"function"==typeof(e=this._request_callback_by_request_id)[_]&&e[_](),delete this._request_callback_by_request_id[_];return n=this.next_batch_id,this.next_batch_id++,this.num_requests_in_flight++,p=t.SilentBackgroundRequest({xhrFields:{withCredentials:!0},url:i,type:c,data:r,success:this._success.bind(this,m),error:this._error.bind(this,m),complete:this._complete.bind(this,n)}),this.outstanding_batches[n]={urls:m,request:p},this._send_batch_requests()}},i.prototype._success=function(e,t){var n,r,i,o,s,a,l,c,u,d,p,_,m,h,f,y,g;for(d=t.split("\n"),p={},i=0,s=e.length;i<s;i++)g=e[i],p[g]=!1;for(u=o=0,a=d.length;o<a;u=++o)c=d[u],m=c.indexOf(":"),m!==-1&&(h=c.substring(0,m).split("-"),r=parseInt(h[0],10),n=c.substring(m+1),g=e[r],p[g]=!0,this._call_callback(g,n),"function"==typeof this.batch_logger&&this.batch_logger(u,e.length));for("function"==typeof this.on_batch_success&&this.on_batch_success(e),f=e.filter(function(e){return!p[e]}),y=[],_=0,l=f.length;_<l;_++)g=f[_],null==this.cancelled_urls[g]?y.push(this._call_callback(g,g)):y.push(void 0);return y},i.prototype._error=function(e){var t,n,r,i;for(r=[],t=0,n=e.length;t<n;t++)i=e[t],r.push(this._call_callback(i,i));return r},i.prototype._complete=function(e){var t,n,r,i,o;for(this.num_requests_in_flight--,r=this.outstanding_batches[e],o=r.urls,r.request,t=0,n=o.length;t<n;t++)i=o[t],delete this.cancelled_urls[i];if(delete this.outstanding_batches[e],this.flushing)return this._send_batch_requests()},i.prototype._call_callback=function(e,t){var n,r,i,o,s;if(n=0===t.indexOf("data:image")?t:e,null!=this.request_ids_by_url[e])for(o=this.request_ids_by_url[e],r=0,i=o.length;r<i;r++)s=o[r],this.callback_by_id[s].callback(n,!1),delete this.callback_by_id[s];return delete this.request_ids_by_url[e]},i.prototype._generate_request_params=function(t){var i,o,s,a,l,c,u,d;return u=e.map(t,function(e){return n.parse(e).setScheme().setAuthority().toString()}),d=JSON.stringify(u),a=Math.abs(this._hash_string_to_int(d)),o=a%r.BATCH_THUMB_ENDPOINTS.length,i=r.BATCH_THUMB_ENDPOINTS[o],c={image_urls:d,parallel:!0},s=n.parse(i).setQuery(c).toString(),l=s.length>this.MAX_URL_LENGTH?"POST":"GET",[i,l,c]},i.prototype._hash_string_to_int=function(e){var t,n,r,i,o;if(n=0,0===e.length)return n;for(r=i=0,o=e.length;0<=o?i<o:i>o;r=0<=o?++i:--i)t=e.charCodeAt(r),n=(n<<5)-n+t;return n},i})()}),define("modules/clean/react/account_menu/account_info",["require","exports","external/react","modules/clean/react/account_menu/avatar","modules/core/i18n"],function(e,t,n,r,i){"use strict";t.AccountInfo=function(e){return n.createElement("div",{className:"account-info"},n.createElement("button",{className:"account-info-change-avatar-button",onClick:e.onClickChangeAvatar},n.createElement(r.AccountMenuAvatar,{photoUrl:e.accountPhotoUrl,dimension:32,alt:i._("Account photo")})),n.createElement("div",{className:"account-info-text"},n.createElement("div",{className:"account-info-name"},e.userDisplayName),!e.accountPhotoUrl&&n.createElement("button",{className:"button-as-link account-info-add-avatar-prompt",onClick:e.onClickChangeAvatar},i._("Add account photo"))))}}),define("modules/clean/react/account_menu/account_menu",["require","exports","tslib","external/react","modules/clean/event_handler","modules/clean/react/account_menu/account_menu_contents","modules/clean/react/account_menu/avatar","modules/clean/react/bubble_dropdown_v2","modules/clean/react/css","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,o,s,a,l,c,u){"use strict";var d=(function(t){function i(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={accountPhotoUrl:n.props.accountPhotoUrl||n.props.user.photo_circle_url,isDisabled:!0},n.handleChangeAvatar=function(){n.refs.dropdown.getWrappedComponent().hideDropdown(),e(["modules/clean/account_photo_modal/controller"],function(e){return(0,e.show)()})},n}return n.__extends(i,t),i.prototype.componentDidMount=function(){var e=this;this.events.on(document,"db:account_photo:photo_set",function(t,n){var r=u.parse(n.saved_photo_url).updateQuery({size:"64x64"}).toString();e.setState({accountPhotoUrl:r})}),this.events.on(document,"db:account_photo:photo_deleted",function(){e.setState({accountPhotoUrl:null})}),this.setState({isDisabled:!1})},i.prototype.render=function(){var e=this.state,t=e.isDisabled,n=e.accountPhotoUrl,i=this.props,l=i.dropdownHorizontalDisplacement,u=i.logoutContinuationPath,d=i.onClick,p=i.openLinksInNewTab,_=i.position,m=i.shouldArrowDecrement,h=i.showBusinessUpgradeLink,f=i.showInstallLink,y=i.showProGiftingLink,g=i.showProUpgradeLink,v=i.showLimitedTeamUpgradeLink,b=i.showSettingsLink,w=i.user,I=i.viewer,S=r.createElement("button",{className:"button-as-link account-menu-target notification-button","aria-label":c._("Account menu"),title:c._("Account menu"),onClick:d,disabled:t},r.createElement(s.AccountMenuAvatar,{photoUrl:n,dimension:32}));return r.createElement(a,{ref:"dropdown",targetButton:S,targetFixed:!0,position:_,className:"account-menu",horizontalDisplacement:l,shouldArrowDecrement:m},r.createElement(o.AccountMenuContents,{accountPhotoUrl:n,logoutContinuationPath:u,openLinksInNewTab:p,showBusinessUpgradeLink:h,showInstallLink:f,showProGiftingLink:y,showProUpgradeLink:g,showLimitedTeamUpgradeLink:v,showSettingsLink:b,viewer:I,user:w,onClickChangeAvatar:this.handleChangeAvatar}))},i})(r.Component);d.defaultProps={accountPhotoUrl:null,position:a.POSITIONS.BOTTOM,dropdownHorizontalDisplacement:0,openLinksInNewTab:!0,shouldArrowDecrement:!0},d=n.__decorate([i.eventHandler],d);var p=l(d,["/static/css/account_menu_common-vflylwKvy.css","/static/css/pagelet-vflAggOj0.css"]);t.AccountMenu=p}),define("modules/clean/react/account_menu/account_menu_contents",["require","exports","tslib","external/react","modules/clean/react/account_menu/account_info","modules/clean/react/account_menu/business_upgrade_link","modules/clean/react/account_menu/install_link","modules/clean/react/account_menu/limited_team_plans_upgrade_link","modules/clean/react/account_menu/logout_link","modules/clean/react/account_menu/pro_gifting_link","modules/clean/react/account_menu/pro_upgrade_link","modules/clean/react/account_menu/settings_link"],function(e,t,n,r,i,o,s,a,l,c,u,d){"use strict";var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderInstallLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(s.InstallLink,{openLinksInNewTab:this.props.openLinksInNewTab}))},t.prototype.renderLogoutLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(l.LogoutLink,{continuationPath:this.props.logoutContinuationPath}))},t.prototype.renderBusinessUpgradeLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(o.BusinessUpgradeLink,{openLinksInNewTab:this.props.openLinksInNewTab,isLimitedTeam:this.props.viewer.team_is_limited}))},t.prototype.renderProUpgradeLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(u.ProUpgradeLink,{openLinksInNewTab:this.props.openLinksInNewTab,isLimitedTeam:this.props.viewer.team_is_limited}))},t.prototype.renderLimitedTeamUpgradeLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(a.LimitedTeamPlansUpgradeLink,{openLinksInNewTab:this.props.openLinksInNewTab}))},t.prototype.renderProGiftingLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(c.ProGiftingLink,{openLinksInNewTab:this.props.openLinksInNewTab}))},t.prototype.renderSettingsLink=function(){return r.createElement("li",{className:"link-item"},r.createElement(d.SettingsLink,{openLinksInNewTab:this.props.openLinksInNewTab}))},t.prototype.render=function(){return r.createElement("div",{className:"dropdown-content-wrapper"},r.createElement(i.AccountInfo,{userDisplayName:this.props.user.display_name,accountPhotoUrl:this.props.accountPhotoUrl,onClickChangeAvatar:this.props.onClickChangeAvatar}),r.createElement("ul",{className:"links"},this.props.showSettingsLink&&this.renderSettingsLink(),this.props.showInstallLink&&this.renderInstallLink(),this.props.showProUpgradeLink&&this.renderProUpgradeLink(),this.props.showLimitedTeamUpgradeLink&&this.renderLimitedTeamUpgradeLink(),this.props.showBusinessUpgradeLink&&this.renderBusinessUpgradeLink(),this.props.showProGiftingLink&&this.renderProGiftingLink()),r.createElement("ul",{className:"links"},this.renderLogoutLink()))},t})(r.PureComponent);p.defaultProps={accountPhotoUrl:null,logoutContinuationPath:null,openLinksInNewTab:!1,showBusinessUpgradeLink:!1,showInstallLink:!0,showProGiftingLink:!1,showProUpgradeLink:!1,showLimitedTeamUpgradeLink:!1,showSettingsLink:!0},t.AccountMenuContents=p}),define("modules/clean/react/account_menu/avatar",["require","exports","tslib","external/react","modules/clean/avatar/photo_avatar","modules/clean/avatar/faceholder"],function(e,t,n,r,i,o){"use strict";var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.alt,n=e.photoUrl,s=e.dimension;return n?r.createElement(i,{alt:t,dimension:s,photoUrl:n}):r.createElement(o,{dimension:s,alt:t})},t})(r.PureComponent);t.AccountMenuAvatar=s}),define("modules/clean/react/account_menu/business_upgrade_link",["require","exports","tslib","external/react","modules/constants/python","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,o,s){"use strict";var a=function(e){var t,n;return e?(t="/team/upgrade",n={tk:"teams",oqa:"drop_down_menu"}):(t="/business",n={}),new s({scheme:"https",authority:"www.dropbox.com",path:t,query:n}).toString()},l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("a",{href:a(this.props.isLimitedTeam),className:"link",tabIndex:0,target:this.props.openLinksInNewTab?"_blank":"",rel:"noopener"},o._("Try %(trademark_business)s").format({trademark_business:i.TRADEMARK_BUSINESS}))},t})(r.PureComponent);t.BusinessUpgradeLink=l}),define("modules/clean/react/account_menu/install_link",["require","exports","tslib","external/react","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,o){"use strict";var s=new o({scheme:"https",authority:"www.dropbox.com",path:"/install"}).toString(),a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("a",{href:s,className:"link",tabIndex:0,target:this.props.openLinksInNewTab?"_blank":"",rel:"noopener"},i._("Install"))},t})(r.PureComponent);t.InstallLink=a}),define("modules/clean/react/account_menu/limited_team_plans_upgrade_link",["require","exports","external/react","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i){"use strict";var o=new i({scheme:"https",authority:"www.dropbox.com",path:"/plans",query:{tk:"teams",oqa:"drop_down_menu"}}).toString();t.LimitedTeamPlansUpgradeLink=function(e){return n.createElement("a",{href:o,className:"link",tabIndex:0,target:e.openLinksInNewTab?"_blank":"",rel:"noopener"},r._("Upgrade"))}}),define("modules/clean/react/account_menu/logout_link",["require","exports","external/react","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i){"use strict";var o=function(e){return new i({scheme:"https",authority:"www.dropbox.com",path:"/logout",query:e?{cont:e}:void 0}).toString()};t.LogoutLink=function(e){return n.createElement("a",{href:o(e.continuationPath),tabIndex:0,className:"link"},r._("Sign out"))}}),define("modules/clean/react/account_menu/maestro_account_menu",["require","exports","tslib","modules/clean/react/account_menu/account_menu","modules/clean/react/bubble_dropdown_v2","external/react","modules/constants/browse","modules/constants/payments","modules/constants/viewer"],function(e,t,n,r,i,o,s,a,l){"use strict";var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.user,n=e.viewer,c=!1,u=a.PRO_GIFTING_LINK_VIEWABLE,d=!1,p=s.SHOW_INSTALL_LINK,_=this.props.shouldArrowDecrement!==!1,m=s.EXP_SUBGROWTH_BIZ_WEB_CLIENT_GIFTING_LINK,h="US"===l.LOCALE,f="personal"===t.role&&t.paid;m&&(u=h,f||n.is_work_user_signed_in||(c=!h,d=!0));var y=!1;return n.team_is_limited?(y=!0,n.get_users(!0).some(function(e){return!!e.paid})||(d=!0)):(n.role_exists("personal")||c)&&(n.personal_user&&n.personal_user.paid||c?n.role_exists("work")||(y=!0):d=!0),o.createElement(r.AccountMenu,{user:t,viewer:n,position:i.POSITIONS.BOTTOM_LEFT,dropdownHorizontalDisplacement:-40,openLinksInNewTab:!0,showBusinessUpgradeLink:y,showInstallLink:p,showProGiftingLink:u,showProUpgradeLink:d,shouldArrowDecrement:_})},t})(o.Component);c.propTypes={user:o.PropTypes.object.isRequired,viewer:o.PropTypes.object.isRequired,onSelectUser:o.PropTypes.func.isRequired,shouldArrowDecrement:o.PropTypes.bool},t.MaestroAccountMenu=c}),define("modules/clean/react/account_menu/pro_gifting_link",["require","exports","tslib","external/react","modules/constants/python","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,o,s){"use strict";var a=new s({scheme:"https",authority:"www.dropbox.com",path:"/gift",query:{trigger:"dropdown"}}).toString(),l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("a",{href:a,tabIndex:0,className:"link",target:this.props.openLinksInNewTab?"_blank":"",rel:"noopener"},o._("Gift Dropbox %(trademark_plus)s").format({trademark_plus:i.TRADEMARK_PLUS}))},t})(r.PureComponent);t.ProGiftingLink=l}),define("modules/clean/react/account_menu/pro_upgrade_link",["require","exports","tslib","external/react","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,o){"use strict";var s=function(e){var t,n;return e?(t="/upgrade",n={tk:"teams",oqa:"drop_down_menu"}):(t="/pro/buy",n={trigger:"direct"}),new o({scheme:"https",authority:"www.dropbox.com",path:t,query:n}).toString()},a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("a",{href:s(this.props.isLimitedTeam),className:"link",tabIndex:0,target:this.props.openLinksInNewTab?"_blank":"",rel:"noopener"},i._("Upgrade"))},t})(r.PureComponent);t.ProUpgradeLink=a}),define("modules/clean/react/account_menu/settings_link",["require","exports","tslib","external/react","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,o){"use strict";var s=new o({scheme:"https",authority:"www.dropbox.com",path:"/account"}).toString(),a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("a",{href:s,className:"link",tabIndex:0,target:this.props.openLinksInNewTab?"_blank":"",rel:"noopener"},i._("Settings"))},t})(r.PureComponent);t.SettingsLink=a}),define("modules/clean/react/maestro/header_conditions",["require","exports"],function(e,t){"use strict";function n(e){return!e.is_team_assume_user_session}t.showAccountMenu=n}),
define("modules/clean/react/maestro/non_pagelet_top_menu_container",["external/classnames","external/underscore","external/react","modules/clean/viewer","modules/clean/react/css","modules/clean/react/account_menu/maestro_account_menu","modules/clean/react/maestro/header_conditions","modules/clean/search/search_bar","modules/clean/react/user_notifications/dropdown","modules/core/browser","modules/core/exception","modules/core/uri","modules/clean/react/browse/models"],function(e,t,n,r,i,o,s,a,l,c,u,d,p){var _,m,h,f,y,g,v,assert,b,w,I;return m=o.MaestroAccountMenu,I=s.showAccountMenu,g=a.SearchBar,v=l.UserNotificationsDropdown,assert=u.assert,_=p.File,y=p.Paper,w=n.DOM,b=n.createElement,f=n.createClass({displayName:"TopMenuContainer",propTypes:{user:n.PropTypes.object.isRequired,viewer:n.PropTypes.object.isRequired,showSearchBar:n.PropTypes.bool,currentPath:n.PropTypes.string,onSearch:n.PropTypes.func,onCancelSearch:n.PropTypes.func,onFileOrFolderOpen:n.PropTypes.func,limitedTeamBannerUpsell:n.PropTypes.bool,trademarkBusiness:n.PropTypes.string,onSelectUser:n.PropTypes.func.isRequired,isPagelet:n.PropTypes.bool},getDefaultProps:function(){return{showSearchBar:!0,currentPath:"/",isPagelet:!1}},onSearch:function(e,t){var n;if(n=d({path:"/search/"+this.props.user.role}),e)return c.redirect(n.updateQuery({path:this.props.currentPath,query:e,qsid:t}))},onFileOrFolderOpen:function(e){var t,n;return e instanceof _?e.is_dir?c.open_tab(e.href):(t=e.fq_path.substring(1),assert(this.props.user.role),n=d({path:"/"+this.props.user.role}).updateQuery({preview:t}),c.open_tab(n)):e instanceof y?c.open_tab(e.url):void 0},render:function(){var t,n;return t=I(this.props.viewer),n=[w.div({className:"notifications-widget-container",key:"notifications-widget"},b(v,{isMaestroDesign:!0,isPagelet:this.props.isPagelet})),w.div({className:"account-menu-widget-container",key:"account-menu-widget"},t?b(m,{user:this.props.user,viewer:this.props.viewer,onSelectUser:this.props.onSelectUser}):void 0)],w.div({className:e({"top-menu-container":!0,"top-menu-container--account-menu-hidden":!t})},this.props.showSearchBar?b(g,{user:this.props.user,currentPath:this.props.currentPath,isMaestroDesign:!0,isSearchActive:!1,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen||this.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness}):void 0,n)}}),h=i(f,["/static/css/pagelet-vflAggOj0.css"],[g,v]),{NonPageletTopMenuContainer:h}}),define("modules/clean/react/maestro/nonpagelet_header",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/viewer","modules/clean/react/maestro/header_base","modules/clean/react/maestro/non_pagelet_top_menu_container"],function(e,t,n,r,i,o,s,a){"use strict";var l=function(){var e=o.get_viewer().get_users();return 0===e.length?null:e[0]},c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){if(null===this.props.user)throw new Error("No logged in user detected. This header can only be used with a logged in user.");var e=r.createElement(a.NonPageletTopMenuContainer,{user:this.props.user,viewer:this.props.viewer,showSearchBar:this.props.showSearchBar,currentPath:this.props.currentPath,onSearch:this.props.onSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness,onSelectUser:this.props.onSelectUser,isPagelet:!1});return r.createElement("div",{className:"maestro-header--without-nav"},r.createElement("header",{className:"maestro-header page-header__shadow"},r.createElement("div",{className:"page-header"},r.createElement(s.MaestroHeaderLogo,null),r.createElement("div",{className:"maestro-header--right-content"},e))))},t})(r.Component);c.defaultProps={showSearchBar:!1};var u=i(c,["/static/css/maestro_header_without_nav-vfljt5A4P.css"],[],!0);t.NonPageletMaestroHeaderWithoutNavigationPanel=u;var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelectUser=function(e,t){},t}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"maestro"},r.createElement(u,{viewer:this.props.viewer,user:this.props.user,onSelectUser:this.onSelectUser}))},t})(r.Component);d.defaultProps={viewer:o.get_viewer(),user:l()},t.NonPageletMaestroHeader=d}),define("modules/clean/react/user_notifications/actions",["external/underscore","modules/clean/browse_interface","modules/clean/loggers/notification_logger","modules/clean/notserver","modules/clean/react/user_notifications/api","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dispatcher","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/store","modules/clean/referrer_cleansing_redirect","modules/clean/sharing/api/client","modules/clean/sharing/notifications","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,r,i,o,s,a,l,c,u,d,p,_,m,h){var f,y,g,v,b,w,I;return v=n.NotificationLogger,g=r.NotClients,f=o.ActionTypes,w=s.userNotificationsDispatcher,y=a.BluenoteActionTypes,I=l.userNotificationsStore,b=_._,new((function(){function n(){}return n.prototype.load=function(){return w.dispatch({type:f.LOAD_REQUEST}),i.getAll(I.getCursor(),this._activeUserOnlyMode).then(function(e){var t;return t=[],t=t.concat(e.notifications),v.logReceive(t),w.dispatch({type:f.LOAD_SUCCESS,data:e}),e},function(){return w.dispatch({type:f.LOAD_FAILURE})})},n.prototype.loadOnceAndWatch=function(e){if(!this._hasLoadedOnce)return this._hasLoadedOnce=!0,this._activeUserOnlyMode=e,this.load().then((function(e){return function(t){return e._watch(t)}})(this),function(){return null})},n.prototype.acknowledge=function(e){return w.dispatch({type:f.ACKNOWLEDGEMENT_REQUEST_SINGLE,data:{notifications:[e]}}),i.ack(e)},n.prototype._markAllAsSeen=function(){var e;if(e=I.getUnseen(),0!==e.length)return i.markAsSeen(e),w.dispatch({type:f.MARK_AS_SEEN_REQUEST})},n.prototype._watch=function(t){return e.each(g,(function(e){return function(n,r){var i,o,s;if(i="undefined"!=typeof ensemble&&null!==ensemble&&null!=(s=ensemble.viewer)?s.getActiveUser():void 0,!e._activeUserOnlyMode||(null!=i?i.userId:void 0)===parseInt(r))return o=n.subscribe_user({name:"UserNotificationsActions",handler:function(){return e.load().then(function(e){return n.handler_success(o,{nid:e.cursor[r]})},function(){return n.handler_failure(o)})},nid:t.cursor[r]})}})(this))},n.prototype.acknowledgeAll=function(){if(0!==I.getUnacknowledgedCount())return w.dispatch({type:f.ACKNOWLEDGEMENT_REQUEST}),i.ackAll(this._activeUserOnlyMode)},n.prototype.viewNotifications=function(){return this._markAllAsSeen()},n.prototype._actionPerformed=function(e,t){if(v.logAction(e,t),e.isUnread)return this.acknowledge(e)},n.prototype.triggerGenericLegacyNotificationAction=function(e){return this._actionPerformed(e,"click")},n.prototype.dismissLegacySharingNotification=function(e,t){return this._actionPerformed(e,"button_1"),d.register_dismiss(t)},n.prototype.mountFromLegacySharingNotification=function(e,t){return this._actionPerformed(e,"button_0"),d.register_mount(t)},n.prototype.upgradeToMountFromLegacySharingNotification=function(e){return this._actionPerformed(e,"button_0"),d.upgrade_to_mount()},n.prototype.triggerBluenoteAction=function(e,t,n){return this._actionPerformed(e,n),t.actionType===y.OpenUrl?this._performBluenoteOpenUrlAction(t.params):t.actionType===y.MountSharedFolder?this._performBluenoteMountSharedFolder(e,t.params):void 0},n.prototype._performBluenoteOpenUrlAction=function(e){return c.redirect(e.urlPath)},n.prototype._performBluenoteMountSharedFolder=function(e,n){var r,i,o;return o=p.get_viewer(),i=o.get_user_by_id(e.userId),r=new u.FolderShareApiClient({userId:i.id}),m.info(b("Adding shared folder ...")),r.mount({contentId:n.nsId,origin:"NOTIFICATION_WEB"}).then(function(e){var n;return n=h({path:t.get_browse_root(i)+e.path_lower}).toString(),c.redirect(n),m.clear(),m.success(b("Added the shared folder %(folder_name)s.").format({folder_name:e.name}))},function(e){var t,n,r;return m.clear(),"insufficient_quota"===(null!=e&&null!=(n=e.error)?n[".tag"]:void 0)?(m.info(b("Continue upgrading to add the shared folder to your Dropbox.")),t=i.is_team&&o.team_is_limited?"/team/upgrade":"/pro/buy",r=h({scheme:"https",authority:"www.dropbox.com",path:t}),r.updateQuery({cont:"sf",oqa:"sf_aoq_b_n"}),c.redirect(r.toString())):null!=(null!=e?e.message:void 0)?m.error(e.message):m.error(b("Failed to add the shared folder."))})},n})())}),define("modules/clean/react/user_notifications/api",["require","exports","jquery","modules/clean/ajax","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/models"],function(e,t,n,r,i,o){"use strict";function s(e){return new o.UserNotification({id:e.nid,userId:e.user_id,typeId:e.type_id,typeData:a(e),targetObjectKey:e.target_object_key,status:e.status,seenState:e.seen_state,feedTimeInSec:e.feed_time,rawDropdownRowHtml:e.notification_div,roleLabel:e.role_label,bluenoteActor:y(e),bluenoteObject:g(e),bluenoteNotificationTypeId:e.bluenote_notification_type_id,bluenoteTypedData:v(e)})}function a(e){switch(e.type_id){case o.NotificationTypes.SharedFolderInvite:return l(e);case o.NotificationTypes.Bluenote:return c(e)}}function l(e){return{overQuotaStatus:e.sf_invite_overquota}}function c(e){var t=e.bluenote_payload;if(null!=t)return{templateType:t.template_type,templateVersion:t.template_version,campaignInfo:_(t.campaign_info),displayMessage:t.home_params.message,icon:m(t.image),surfaceAction:h(t.home_params.surface_action),buttonActions:(t.home_params.button_actions||[]).map(h),preview:u(t.preview)}}function u(e){if(null!=e)return{showThumbnail:e.show_thumbnail||!1,quote:e.quote,tasks:d(e.tasks)}}function d(e){if(null!=e)return{taskEndpoint:e.task_endpoint,tasks:(e.tasks||[]).map(p)}}function p(e){if(null!=e)return{name:e.name,id:e.id,isComplete:e.is_complete}}function _(e){if(null!=e)return{campaignId:e.campaignId,categoryId:e.categoryId,versionId:e.versionId?""+e.versionId:void 0,contentId:e.contentId}}function m(e){if(null!=e)return"avatar"===e.type?{avatarInitials:e.avatar_initials,avatarUrl:e.avatar_url}:{lowResIconUrl:e.system_url32,highResIconUrl:e.system_url64}}function h(e){if(null!=e){var t=void 0;if("open_url"===e.action_name?t=o.BluenoteActionTypes.OpenUrl:"mount_shared_folder"===e.action_name&&(t=o.BluenoteActionTypes.MountSharedFolder),t)return{buttonLabel:e.label,actionType:t,params:f(t,e.params)}}}function f(e,t){if(null!=t){if(e===o.BluenoteActionTypes.OpenUrl)return{urlPath:t.url_path};if(o.BluenoteActionTypes.MountSharedFolder)return{nsId:t.ns_id}}}function y(e){var t=e.bluenote_actor;if(null!=t)return{accountId:t.actor_account_id,avatarUrl:t.actor_avatar_url,displayName:t.actor_display_name,initials:t.actor_initials}}function g(e){var t=e.bluenote_object;if(null!=t)return{id:t.id,ignore:t.ignore,name:t.name,thumbnailUrl:t.thumbnail_url,type:t.type,url:t.url}}function v(e){var t=e.bluenote_notification_type_id,n=e.bluenote_typed_data;if(null!=t&&null!=n)switch(t){case i.BNNotificationTypeIdentifier.NONE:return;case i.BNNotificationTypeIdentifier.DROPBOX_FILE_COMMENT:return b(n);case i.BNNotificationTypeIdentifier.DROPBOX_SHARED_CONTENT:return w(n);case i.BNNotificationTypeIdentifier.PAPER_SHARE:return I(n);case i.BNNotificationTypeIdentifier.PAPER_COMMENT:return S(n);case i.BNNotificationTypeIdentifier.PAPER_MENTION:return T(n);default:return}}function b(e){return{commentText:e.comment_text}}function w(e){return{shareText:e.share_text}}function I(e){return{shareText:e.share_text}}function S(e){return{commentText:e.comment_text,numOtherCommenters:e.num_other_commenters,numOtherComments:e.num_other_comments}}function T(e){return{mentionText:e.mention_text}}function A(e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var i={count:100,template_version:4};null!=e&&(i.last_received_nid_by_user_id=JSON.stringify(e));var o;if(t){if(null===e){var s=window,a=s.__REGISTER_NOTIFICATIONS_PREFETCH_HANDLER;if(a)return a.prefetchDeferred||(a.prefetchDeferred=n.Deferred(),a(function(e){a.prefetchDeferred.resolve(N(e))},function(){return null})),a.prefetchDeferred}o=r.SilentBackgroundRequest({url:"/web/notifications/retrieve_user",data:i,subject_user:window.ensemble.viewer.getActiveUser().userId,dataType:"json"})}else o=r.SilentBackgroundRequest({url:"/web/notifications/retrieve",data:i,dataType:"json"});return o.then(N)}function N(e){var t=e.notifications.map(s);return{cursor:e.latest_nid,notifications:t}}function P(e){void 0===e&&(e=!1);var t;return t=e?r.SilentBackgroundRequest({url:"/web/notifications/ack_all_user",subject_user:window.ensemble.viewer.getActiveUser().userId,dataType:"json"}):r.SilentBackgroundRequest({url:"/web/notifications/ack_all",dataType:"json"}),t.then(function(e){return e.map(s)})}function k(e){r.SilentBackgroundBeaconRequest({url:"/web/notifications/ack",subject_user:e.userId,data:{nids:JSON.stringify([e.id])},dataType:"json"})}function E(e){for(var t={},n=0,i=e;n<i.length;n++){var o=i[n];o.userId&&o.id&&(t[o.userId]||(t[o.userId]=[])).push(o.id)}var s={nids_by_user_id:JSON.stringify(t)};r.SilentBackgroundRequest({url:"/web/notifications/mark_seen",data:s,dataType:"json"})}t.getAll=A,t.ackAll=P,t.ack=k,t.markAsSeen=E}),define("modules/clean/react/user_notifications/avatar_icon",["external/react","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/user_notifications/models"],function(e,t,n,r,i){var o,s;return s=n.VALID_AVATAR_DIMENSIONS,o=n.AVATAR_DIMENSION_BY_SIZE,i.BluenoteAvatarIcon,e.createClass({displayName:"AvatarIcon",propTypes:{avatarIconRecord:e.PropTypes.object.isRequired,thumbStore:e.PropTypes.instanceOf(r).isRequired,className:e.PropTypes.string,size:e.PropTypes.oneOf(s)},componentDidMount:function(){return this._bindAvatarUrl(this.props)},componentWillUnmount:function(){return this._unbindAvatarUrl()},componentWillReceiveProps:function(e){var t,n;if(t=this.props.avatarIconRecord,n=e.avatarIconRecord,t.avatarUrl!==n.avatarUrl)return this._unbindAvatarUrl(),this._bindAvatarUrl(e)},getInitialState:function(){var e,t;return e=void 0,t=this.props.avatarIconRecord,null!=t.avatarUrl&&(e=this.props.thumbStore.get_thumb(t.avatarUrl)),{avatarImage:e}},getDefaultProps:function(){return{size:o.MEDIUM}},_bindAvatarUrl:function(e){var t;if(t=e.avatarIconRecord,null!=t.avatarUrl)return this._thumbRequestId=e.thumbStore.bind_url(t.avatarUrl,{onSuccess:(function(n){return function(){var r;if(r=e.thumbStore.get_thumb(t.avatarUrl),n.state.avatarImage!==r)return n.setState({avatarImage:r})}})(this)})},_unbindAvatarUrl:function(){return this.props.thumbStore.unbind_url(this._thumbRequestId)},render:function(){var n;return n=this.props.avatarIconRecord,null!=this.state.avatarImage?e.createElement("img",{className:this.props.className,src:this.state.avatarImage,width:this.props.size,height:this.props.size}):e.createElement(t,{name:n.avatarInitials,dimension:this.props.size,initials:n.avatarInitials,shape:"CIRCLE",optionalClass:this.props.className})}})}),define("modules/clean/react/user_notifications/constants",["require","exports"],function(e,t){"use strict";t.ActionTypes={LOAD_REQUEST:"USER_NOTIFICATIONS_LOAD_REQUEST",LOAD_SUCCESS:"USER_NOTIFICATIONS_LOAD_SUCCESS",LOAD_FAILURE:"USER_NOTIFICATIONS_LOAD_FAILURE",ACKNOWLEDGEMENT_REQUEST:"USER_NOTIFICATIONS_ACKNOWLEDGEMENT_REQUEST",ACKNOWLEDGEMENT_REQUEST_SINGLE:"USER_NOTIFICATIONS_ACKNOWLEDGEMENT_REQUEST_SINGLE",MARK_AS_SEEN_REQUEST:"USER_NOTIFICATIONS_MARK_AS_SEEN_REQUEST"},t.EventTypes={RENDERED_NOTIFICATIONS:"USER_NOTIFICATIONS_RENDERED_NOTIFICATIONS"},t.BellDesignTypes={BLUE_ICON:"BLUE_ICON",GRAY_ICON:"GRAY_ICON"},t.BNNotificationTypeIdentifier={NONE:"NONE",DROPBOX_FILE_COMMENT:"DROPBOX_FILE_COMMENT",DROPBOX_SHARED_CONTENT:"DROPBOX_SHARED_CONTENT",PAPER_SHARE:"PAPER_SHARE",PAPER_COMMENT:"PAPER_COMMENT",PAPER_MENTION:"PAPER_MENTION"},t.BluenoteObjectTypes={DROPBOX_FILE:"dropbox-file",DROPBOX_FOLDER:"dropbox-folder",PAPER_PAD:"paper-pad",PAPER_FOLDER:"paper-folder"}}),define("modules/clean/react/user_notifications/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,t,n){"use strict";t.userNotificationsDispatcher=n}),define("modules/clean/react/user_notifications/dropdown",["require","exports","tslib","external/classnames","external/react","modules/clean/accessibility/tabbable","modules/clean/loggers/notification_logger","modules/clean/loggers/notification_tray_logger","modules/clean/react/bubble_dropdown_v2","modules/clean/react/css","modules/clean/react/title_bubble","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dropdown_bell","modules/clean/react/user_notifications/dropdown_body","modules/clean/react/user_notifications/shared/tray_chrome","modules/clean/react/user_notifications/renderer","modules/clean/react/user_notifications/store","modules/constants/notifications","external/mcl/popover","modules/core/i18n"],function(e,t,n,r,i,o,s,a,l,c,u,d,p,_,m,h,f,y,g,v,b){"use strict";var w=(function(e){function t(t){var n=e.call(this,t)||this;return n.onTrayMount=function(){a.logTrayOpen(n.state.actionableCount),d.viewNotifications()},n.state={actionableCount:y.userNotificationsStore.getActionableCount(),ackedNotifications:y.userNotificationsStore.getAcknowledged(),unAckedNotifications:y.userNotificationsStore.getUnacknowledged(),isStoreLoading:y.userNotificationsStore.isLoading(),isDisabled:!0},n}return n.__extends(t,e),t.prototype.componentWillMount=function(){new o},t.prototype.componentDidMount=function(){d.loadOnceAndWatch(this.props.isPagelet),this.removeStoreListener=y.userNotificationsStore.addListener(this.onUpdateFromStore.bind(this)),this.onUpdateFromStore();var e=new f.NotificationRenderer;this.notificationRenderFunc=e.renderNotification.bind(e),this.setState(function(e,t){return e.isDisabled=!1,e})},t.prototype.componentWillUnmount=function(){this.removeStoreListener()},t.prototype.onUpdateFromStore=function(){this.setState(function(e,t){return e.actionableCount=y.userNotificationsStore.getActionableCount(),e.ackedNotifications=y.userNotificationsStore.getAcknowledged(),e.unAckedNotifications=y.userNotificationsStore.getUnacknowledged(),e.isStoreLoading=y.userNotificationsStore.isLoading(),e})},t.prototype.render=function(){if(this.props.isMaestroDesign){var e=void 0;e=g.SHARED_TRAY_MODULE_ENABLED?i.createElement("div",{id:"event-feed-container"},i.createElement("div",{id:"event-feed"},i.createElement(h.NotificationsTrayChrome,{unreadSectionTitle:b._("Unread"),readSectionTitle:b._("Recent"),unreadNotifications:this.state.unAckedNotifications,readNotifications:this.state.ackedNotifications,markAllAsReadButtonTitle:b._("Mark All as Read"),markAllAsReadAction:d.acknowledgeAll,isLoading:this.state.isStoreLoading,loadingMessage:b._("Loading ..."),emptyMessage:b._("You donâ€™t have any notifications yet."),notifRenderFunc:this.notificationRenderFunc,notifLogRenderFunc:s.NotificationLogger.logRender,onTrayMount:this.onTrayMount}))):i.createElement(m.UserNotificationsDropdownBody,{isMaestroDesign:!0});var t=i.createElement(v.Popover,{onSelection:function(){}},i.createElement(v.PopoverTrigger,{"aria-label":b._("Notifications menu"),className:"notification-button"},i.createElement(_.UserNotificationsDropdownBell,{isMaestroDesign:!0,actionableCount:this.state.actionableCount,bellDesign:this.props.bellDesign})),i.createElement(v.PopoverContent,{attachment:"right",width:"380px",className:"notifications-popover-content notifications-popover-content--specific"},i.createElement(v.PopoverContentTitle,null,b._("Notifications")),i.createElement("div",{className:"notifications-dropdown"},e)));return this.props.isMaestroDesign&&this.props.bellDesign===p.BellDesignTypes.GRAY_ICON&&(t=i.createElement(u,{content:b._("Notifications"),position:u.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"react-title-bar--title-bubble",isTargetPositionFixed:!0},t)),t}var n,o=r("header-nav-link","sprite-button","notification-button"),a=i.createElement("button",{className:o,title:b._("Notifications menu"),onClick:this.props.onClick,disabled:this.state.isDisabled},i.createElement(_.UserNotificationsDropdownBell,{actionableCount:this.state.actionableCount,isMaestroDesign:!1,bellDesign:this.props.bellDesign}));return n=this.props.accountMenuVisible?l.POSITIONS.BOTTOM_LEFT:l.POSITIONS.BOTTOM_ALIGN_RIGHT,i.createElement(l,{targetButton:a,targetFixed:!0,position:n,className:"no-padding notifications-dropdown"},i.createElement("div",{className:"notifications-header"},b._("Notifications")),i.createElement(m.UserNotificationsDropdownBody,{isMaestroDesign:!1}))},t})(i.Component);w.displayName="UserNotificationsDropdown",w.defaultProps={isPagelet:!1,isMaestroDesign:!1,accountMenuVisible:!0,bellDesign:p.BellDesignTypes.BLUE_ICON};var I=c(w,["/static/css/components/title_bubble-vfl3yK_gU.css","/static/css/components/bubble_dropdown_v2-vflhhYVBe.css","/static/css/mcl/index-vflGN-K2b.css","/static/css/notifications-vflOgOMfM.css"]);t.UserNotificationsDropdown=I}),define("modules/clean/react/user_notifications/dropdown_bell",["require","exports","tslib","external/classnames","external/mcl/icon","external/react","modules/clean/components/scooter/badge","modules/clean/react/css","modules/clean/react/maestro/svg_icon","modules/clean/react/sprite","modules/clean/react/user_notifications/constants","modules/constants/maestro","modules/core/i18n"],function(e,t,n,r,i,o,s,a,l,c,u,d,p){"use strict";var _=(function(e){function t(t){var n=e.call(this,t)||this,r=n.props.actionableCount>0;return r&&n.scheduleShakeReset(),n.state={isShaking:r},n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){clearTimeout(this.shakeResetTimeout)},t.prototype.componentWillReceiveProps=function(e){e.actionableCount>0&&e.actionableCount!==this.props.actionableCount&&(this.setState({isShaking:!0}),this.scheduleShakeReset())},t.prototype.scheduleShakeReset=function(){var e=this;clearTimeout(this.shakeResetTimeout),this.shakeResetTimeout=setTimeout(function(){e.setState({isShaking:!1})},500)},t.prototype.renderBell=function(){if(this.props.isMaestroDesign)return d.MAESTRO_ICONS_ENABLED?o.createElement(i.Icon,{name:"global-notifications",className:"mcl-notifications-icon"}):o.createElement(l.SvgIcon,{name:"bell"});var e=r({web:!0,"notifications-bell":!0,shake:this.state.isShaking});return o.createElement(c,{group:"web",name:"notifications_icon_blue",className:e,alt:p._("Notifications")})},t.prototype.renderBadge=function(){return this.props.isMaestroDesign&&this.props.bellDesign!==u.BellDesignTypes.GRAY_ICON?this.props.actionableCount?o.createElement("div",{className:"badge-red-dot"}):null:o.createElement(s.CounterBadge,{count:this.props.actionableCount,maxCount:99,position:s.CounterBadge.POSITIONS.TOP_RIGHT,isMaestroDesign:this.props.isMaestroDesign})},t.prototype.render=function(){var e="";return this.props.actionableCount>0&&(e=p.ungettext("%(count)s new","%(count)s new",this.props.actionableCount,{comment:"new notification count"}).format({count:this.props.actionableCount})),o.createElement("div",{className:"notification-button-bell-container"},o.createElement("span",{className:"ax-visually-hidden"},e),this.renderBell(),this.renderBadge())},t})(o.Component);_.defaultProps={actionableCount:0,isMaestroDesign:!1,bellDesign:u.BellDesignTypes.BLUE_ICON};var m=a(_,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]);t.UserNotificationsDropdownBell=m}),define("modules/clean/react/user_notifications/dropdown_bluenote_row",["require","exports","tslib","external/classnames","external/purify","external/react","modules/clean/keycode","modules/clean/react/button","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/avatar_icon","modules/clean/react/user_notifications/generic_icon","modules/clean/react/user_notifications/thumbnail_preview"],function(e,t,n,r,i,o,s,a,l,c,u,d){"use strict";var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleSurfaceAction=function(){var e=n.props.notification,t=e.typeData.surfaceAction;null!=t&&l.triggerBluenoteAction(e,t,"surface")},n.handleKeyDown=function(e){e.keyCode!==s.KeyCode.ENTER&&e.keyCode!==s.KeyCode.SPACE||n.handleSurfaceAction()},n}return n.__extends(t,e),t.prototype.renderNotificationText=function(e){var t=e.typeData.displayMessage;return t?o.createElement("div",{className:"feed-text--button-wrapper"},o.createElement("button",{tabIndex:-1,className:"u-unbutton u-font-left feed-text__button"},o.createElement("div",{className:"feed-text__button-text",dangerouslySetInnerHTML:{__html:i.sanitize(t)}}))):null},t.prototype.renderImage=function(e){var t=e.typeData.icon;return t&&(t.avatarInitials||t.avatarUrl)?o.createElement(c,{avatarIconRecord:t,thumbStore:this.props.thumbStore,className:"feed-image feed-image--bluenote"}):o.createElement(u,{genericIconRecord:t,className:"feed-image feed-image--bluenote"})},t.prototype.renderTimeAndRoleLabel=function(e){if(this.props.hideDisplayTimestamp)return null;var t=e.displayTime;return e.roleLabel&&!this.props.isMaestroDesign&&(t=t+"Â Â·Â "+e.roleLabel),o.createElement("span",{className:"feed-time"},t)},t.prototype.renderPreview=function(e){var t=e.typeData.preview;if(!t)return null;var n=null;t.showThumbnail&&e.bluenoteObject&&(n=o.createElement(d.ThumbnailPreview,{object:e.bluenoteObject}));var r=null;return t.quote&&(r=o.createElement("div",{className:"preview-quote"},t.quote)),o.createElement("div",null,n,r)},t.prototype.renderButton=function(e,t,n){return o.createElement(a.button,{className:"notification u-mar-right-xs u-mar-top-xs",importance:n>0?"tertiary":void 0,onClick:function(t){t.target.disabled=!0;var r=(e.typeData.buttonActions||[])[n];l.triggerBluenoteAction(e,r,"button_"+n),t.stopPropagation()}},t)},t.prototype.renderButtonActions=function(e){var t=this,n=[];return(e.typeData.buttonActions||[]).forEach(function(r,i){n.push(t.renderButton(e,r.buttonLabel,i))}),n.length>0?o.createElement("span",{className:"feed-action action-available"},n):null},t.prototype.render=function(){var e=this.props.notification,t=e.typeData;if(!t)return null;var n=r({"feed-row":!0,clickable:null!=t.surfaceAction,read:this.props.isAcknowledged});return o.createElement("div",{onClick:this.handleSurfaceAction,onKeyDown:this.handleKeyDown,className:n,role:"button",tabIndex:0},this.renderImage(e),this.renderNotificationText(e),this.renderPreview(e),this.renderTimeAndRoleLabel(e),this.renderButtonActions(e))},t})(o.Component);p.displayName="UserNotificationsDropdownBluenoteRow",p.defaultProps={isMaestroDesign:!1},t.UserNotificationsDropdownBluenoteRow=p}),define("modules/clean/react/user_notifications/dropdown_body",["require","exports","tslib","external/react","external/react-dom","jquery","modules/clean/loggers/folder_invite_impression_logger","modules/clean/loggers/notification_logger","modules/clean/loggers/notification_tray_logger","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/static_urls","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dropdown_row","modules/clean/react/user_notifications/dropdown_bluenote_row","modules/clean/react/user_notifications/event_emitter","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/store","modules/core/i18n","modules/clean/react/user_notifications/legacy_thumb_loader"],function(e,t,n,r,i,o,s,a,l,c,u,d,p,_,m,h,f,y,g,v){"use strict";var b=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUpdateFromStore=function(){t.setStateFromStore(),t.legacyRender()},t.onScroll=function(){t.hasMore&&t.scrollWithinOffsetToBottom(10)&&t.appendNotifications(10)},t.onMouseScroll=function(e){var n=e.originalEvent||e,r=n.detail?n.detail*-40:n.wheelDelta,o=i.findDOMNode(t);!t.hasMore&&r<=0&&t.scrollWithinOffsetToBottom(0)?e.preventDefault():r>=0&&0===o.scrollTop&&e.preventDefault()},t}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.folderInviteImpressionLogger=new s.FolderInviteImpressionLogger,this.folderInviteImpressionLogger.listenTo(h)},t.prototype.componentDidMount=function(){this.removeStoreListener=y.userNotificationsStore.addListener(this.onUpdateFromStore),this.addEventHandlers(),this.setStateFromStore(),this.legacyRender(),l.logTrayOpen(this.badgeCount),d.viewNotifications()},t.prototype.shouldComponentUpdate=function(){return!1},t.prototype.componentWillUnmount=function(){this.removeStoreListener(),this.folderInviteImpressionLogger.unlistenTo(h)},t.prototype.addEventHandlers=function(){var e=o(i.findDOMNode(this));e.scroll(this.onScroll),e.on("mousewheel",this.onMouseScroll),e.on("DOMMouseScroll",this.onMouseScroll)},t.prototype.setStateFromStore=function(){var e=y.userNotificationsStore.getAll();this.notifications=e.filter(function(e){return!e.isInvisible}),this.isLoading=y.userNotificationsStore.isLoading(),this.badgeCount=y.userNotificationsStore.getActionableCount()},t.prototype.removeNotifications=function(){return o(i.findDOMNode(this)).find("#event-feed").empty(),this.hasMore=this.notifications.length>0},t.prototype.appendNotifications=function(e){var t=o(i.findDOMNode(this)),n=t.find(".feed-row").length,s=this.notifications.slice(n,n+e);a.NotificationLogger.logRender(s,n);for(var l=new c,u=new v.LegacyThumbLoader,d=0,g=s;d<g.length;d++){var b=g[d],w=y.userNotificationsStore.isAcknowledged(b);if(b.rawDropdownRowHtml){var I=document.createElement("div");t.find("#event-feed").append(I),i.render(r.createElement(_,{notification:b,legacyThumbLoader:u,isAcknowledged:w}),I)}else if(b.typeId===f.NotificationTypes.Bluenote){var I=document.createElement("div");t.find("#event-feed").append(I),i.render(r.createElement(m.UserNotificationsDropdownBluenoteRow,{notification:b,thumbStore:l,isMaestroDesign:this.props.isMaestroDesign,isAcknowledged:w}),I)}}var S=n+s.length;this.hasMore=S<this.notifications.length,t.toggleClass("empty",0===S),h.emit(p.EventTypes.RENDERED_NOTIFICATIONS,{notifications:s})},t.prototype.scrollWithinOffsetToBottom=function(e){var t=i.findDOMNode(this);return t.scrollHeight-t.scrollTop-t.offsetHeight<=e},t.prototype.legacyRender=function(){this.isLoading||(this.removeNotifications(),this.appendNotifications(10))},t.prototype.render=function(){return r.createElement("div",{id:"event-feed-container",className:"show"},r.createElement("div",{id:"event-feed"},r.createElement("div",{id:"notification-loading"},r.createElement("img",{src:u.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:g._("Loading...")}))),r.createElement("div",{id:"event-feed-empty"},r.createElement("img",{src:u.static_url("/static/images/empty_notifications-vflQy8YVJ.png"),alt:""}),r.createElement("div",{id:"event-feed-empty-text"},g._("Weâ€™ll let you know when weâ€™ve got something new for you!"))))},t})(r.Component);b.displayName="UserNotificationsDropdownBody",b.defaultProps={isMaestroDesign:!1},t.UserNotificationsDropdownBody=b}),define("modules/clean/react/user_notifications/dropdown_row",["external/react","external/underscore","jquery","modules/clean/datetime","modules/clean/react/user_notifications/legacy_thumb_loader","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/models","modules/clean/sprite"],function(e,t,n,r,i,o,s,a){var l,c,u;return l=i.LegacyThumbLoader,c=s.UserNotification,u=e.DOM.div,e.createClass({displayName:"UserNotificationsDropdownRow",propTypes:{notification:e.PropTypes.instanceOf(c).isRequired,legacyThumbLoader:e.PropTypes.instanceOf(l).isRequired,isAcknowledged:e.PropTypes.bool.isRequired,hideDisplayTimestamp:e.PropTypes.bool},
componentDidMount:function(){return this._buildLegacyElement(this.props.notification,this.props.isAcknowledged)},_buildLegacyElement:function(e,t){var r;return r=n(this.refs.dropdownLegacyRow),r.html(e.rawDropdownRowHtml),this._initImages(r),this._setTimeLabel(r,e),this._addClientStateClasses(r,e,t),this._initActionHandlers(e,r),r},_initImages:function(e){return e.find("img").each((function(e){return function(t,r){var i;return i=n(r),i.attr("alt",""),e._loadImage(i)}})(this))},_setTimeLabel:function(e,t){var n;if(n=e.find("#feed-time-label"),null!=n)return this.props.hideDisplayTimestamp?n.text(""):n.text(t.displayTime)},_loadImage:function(e){var n;if(n=e.data("src"))return this.props.legacyThumbLoader.load(n).progress(function(){return e.data("src",null),e.data("loading-src",n)}).then(function(n){var r;return e.data("loading-src",null),r=function(){return e.addClass("thumbnail"),e.parent(".feed-thumbnail").addClass("has-frame")},0===n.indexOf("data:image")?r():(e.load(r),e.error(t.once(function(){var t;return t=e.data("fail-src")||a.SPACER,e.attr("src",t)}))),e.attr("src",n)})},_addClientStateClasses:function(e,t,n){var r;if(r=e.hasClass("feed-row")?e:e.find(".feed-row"),t.isInvisible&&r.addClass("invisible"),n)return r.addClass("read")},_initActionHandlers:function(e,t){return t.on("click",function(){return o.triggerGenericLegacyNotificationAction(e),!0}),t.on("click",".share-content-dismiss",function(){return o.dismissLegacySharingNotification(e,this),!1}),t.on("click",".share-content-mount",function(){return o.mountFromLegacySharingNotification(e,this),!1}),t.on("click",".share-content-upgrade-mount",function(){return o.upgradeToMountFromLegacySharingNotification(e),!1})},render:function(){return u({ref:"dropdownLegacyRow"})}})}),define("modules/clean/react/user_notifications/event_emitter",["external/eventemitter3"],function(e){return new e}),define("modules/clean/react/user_notifications/generic_icon",["external/react","modules/clean/react/image","modules/clean/static_urls"],function(e,t,n){var r;return r=n.static_url,e.createClass({displayName:"GenericIcon",propTypes:{genericIconRecord:e.PropTypes.object,className:e.PropTypes.string},render:function(){var n,i,o;return i=this.props.genericIconRecord,o=null!=i?i.lowResIconUrl:void 0,n=null!=i?i.highResIconUrl:void 0,null!=o&&null!=n||(o=r("/static/images/icons32/system_notification_default_icon-vflY4Rt4U.png"),n=r("/static/images/icons64/system_notification_default_icon-vflc0pSwy.png")),e.createElement("div",{className:this.props.className},e.createElement(t,{src:o,srcHiRes:n}))}})}),define("modules/clean/react/user_notifications/legacy_thumb_loader",["external/underscore","jquery","modules/clean/photos/batch_thumb_loader"],function(e,t,n){var r,i,o,s;return o=16,i=24,s={},r=(function(){function r(){var t;this._cache={},t=new n({batch_size:o,max_parallel_request:i}),this._queueThumb=function(e,n,r){return t.queue_thumb(e,n,{onrequest:r})},this._flushQueue=e.debounce(function(){return t.flush()},0)}return r.prototype.load=function(e){var n;return this._cache[e]||(n=new t.Deferred,this._queueThumb(e,n.resolve,n.notify),this._flushQueue(),this._cache[e]=n.promise()),this._cache[e]},r})(),s.LegacyThumbLoader=r,s}),define("modules/clean/react/user_notifications/models",["require","exports","modules/clean/datetime"],function(e,t,n){"use strict";(function(e){e[e.OpenUrl=1]="OpenUrl",e[e.MountSharedFolder=2]="MountSharedFolder"})(t.BluenoteActionTypes||(t.BluenoteActionTypes={}));var r;(function(e){e[e.Unread=0]="Unread",e[e.Read=1]="Read",e[e.Invisible=2]="Invisible"})(r=t.NotificationStatuses||(t.NotificationStatuses={}));var i;(function(e){e[e.Unseen=1]="Unseen",e[e.Seen=2]="Seen"})(i=t.NotificationSeenState||(t.NotificationSeenState={})),t.NotificationStatusStrings={0:"unread",1:"read",2:"invisible"},t.SharedFolderInviteOverQuotaStatuses={ALREADY_OVER:"overquota",WILL_BE_OVER:"will_be_overquota"};var o;(function(e){e[e.SharedFolderInvite=100]="SharedFolderInvite",e[e.Bluenote=2200]="Bluenote"})(o=t.NotificationTypes||(t.NotificationTypes={}));var s=(function(){function e(e){var t=e.id,n=e.userId,r=e.typeId,i=e.typeData,o=e.targetObjectKey,s=e.status,a=e.seenState,l=e.feedTimeInSec,c=e.rawDropdownRowHtml,u=e.roleLabel,d=e.bluenoteActor,p=e.bluenoteObject,_=e.bluenoteNotificationTypeId,m=e.bluenoteTypedData;this.id=t,this.userId=n,this.typeId=r,this.typeData=i,this.targetObjectKey=o,this.status=s,this.seenState=a,this.feedTimeInSec=l,this.rawDropdownRowHtml=c,this.roleLabel=u,this.bluenoteActor=d,this.bluenoteObject=p,this.bluenoteNotificationTypeId=_,this.bluenoteTypedData=m}return Object.defineProperty(e.prototype,"key",{get:function(){return this.userId+" "+this.typeId+" "+this.targetObjectKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUnread",{get:function(){return this.status===r.Unread},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRead",{get:function(){return this.status===r.Read},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInvisible",{get:function(){return this.status===r.Invisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSeen",{get:function(){return!(this.seenState===i.Unseen&&this.status===r.Unread)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.typeId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"feedTime",{get:function(){return new Date(1e3*this.feedTimeInSec)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"campaignId",{get:function(){var e;if(this.typeId===o.Bluenote){var t=this.typeData;t.campaignInfo&&t.campaignInfo.campaignId&&(e=""+t.campaignInfo.campaignId)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"campaignVersion",{get:function(){if(this.typeId===o.Bluenote){var e=this.typeData;if(e.campaignInfo&&e.campaignInfo.versionId)return e.campaignInfo.versionId}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayTime",{get:function(){return Date.now()-1e3*this.feedTimeInSec>6048e5?n.nice_date_with_month_name(this.feedTime,!1):n.ago(this.feedTime)},enumerable:!0,configurable:!0}),e})();t.UserNotification=s;var a=(function(){function e(){}return e})();t.SharedFolderInviteData=a}),define("modules/clean/react/user_notifications/renderer",["require","exports","external/react","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/user_notifications/dropdown_bluenote_row","modules/clean/react/user_notifications/dropdown_row","modules/clean/react/user_notifications/legacy_thumb_loader","modules/clean/react/user_notifications/models"],function(e,t,n,r,i,o,s,a){"use strict";var l=(function(){function e(){this.legacyThumbLoader=new s.LegacyThumbLoader,this.genericThumbStore=new r}return e.prototype.renderNotification=function(e,t){return e.rawDropdownRowHtml?n.createElement(o,{notification:e,legacyThumbLoader:this.legacyThumbLoader,isAcknowledged:t,hideDisplayTimestamp:!0}):e.typeId===a.NotificationTypes.Bluenote?n.createElement(i.UserNotificationsDropdownBluenoteRow,{notification:e,isMaestroDesign:!0,thumbStore:this.genericThumbStore,hideDisplayTimestamp:!0,isAcknowledged:t}):null},e})();t.NotificationRenderer=l}),define("modules/clean/react/user_notifications/shared/notification_row_wrapper",["require","exports","tslib","external/classnames","external/react","modules/clean/react/css"],function(e,t,n,r,i,o){"use strict";var s=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={hover:!1},n.onMouseOver=n.onMouseOver.bind(n),n.onMouseOut=n.onMouseOut.bind(n),n}return n.__extends(t,e),t.prototype.onMouseOver=function(){this.setState({hover:!0})},t.prototype.onMouseOut=function(){this.setState({hover:!1})},t.prototype.renderInfoSheet=function(){var e=r({"notification-row-info-sheet":!0,"notification-row-info-sheet--visible":this.state.hover,"notification-row-info-sheet--unread":this.props.unread});return i.createElement("div",{className:e},i.createElement("div",{className:"notification-row-info-sheet--timestamp"},this.props.timestamp))},t.prototype.render=function(){return i.createElement("div",{className:"notification-row-wrapper",onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},this.renderInfoSheet(),this.props.row)},t})(i.Component),a=o(s,["/static/css/user_notifications_shared-vflL8eiHC.css"]);t.NotificationRowWrapper=a}),define("modules/clean/react/user_notifications/shared/tray_chrome",["require","exports","tslib","external/react","external/react-dom","modules/clean/react/css","modules/clean/react/user_notifications/shared/tray_section"],function(e,t,n,r,i,o,s){"use strict";var a=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleOnScroll=function(){n.scrollWithinOffsetToBottom(10)&&(n.logRendersForPage(n.state.visiblePages),n.setState({visiblePages:n.state.visiblePages+1}))},n.state={visiblePages:1},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTrayMount(),this.logRendersForPage(0)},t.prototype.logRendersForPage=function(e){var t=this.props.unreadNotifications.concat(this.props.readNotifications).slice(10*e,10*(e+1));this.props.notifLogRenderFunc(t,10*e)},t.prototype.shouldComponentUpdate=function(e,t,n){return!(e.isLoading&&!this.props.isLoading)},t.prototype.scrollWithinOffsetToBottom=function(e){var t=i.findDOMNode(this);return t.scrollHeight-t.scrollTop-t.offsetHeight<=e},t.prototype.render=function(){if(this.props.isLoading)return r.createElement("div",{className:"notifications-tray--loading"},this.props.loadingMessage);if(0===this.props.unreadNotifications.length&&0===this.props.readNotifications.length)return r.createElement("div",{className:"notifications-tray--empty"},this.props.emptyMessage);var e=this.props.unreadNotifications.slice(0,10*this.state.visiblePages),t=this.props.readNotifications.slice(0,10*this.state.visiblePages-e.length);return r.createElement("div",{className:"notifications-tray--loaded",onScroll:this.handleOnScroll},r.createElement(s.NotificationsTraySection,{notifications:e,sectionTitle:this.props.unreadSectionTitle,actionButtonText:this.props.markAllAsReadButtonTitle,actionButtonAction:this.props.markAllAsReadAction,notifRenderFunc:this.props.notifRenderFunc,isUnreadSection:!0}),r.createElement(s.NotificationsTraySection,{notifications:t,sectionTitle:this.props.readSectionTitle,notifRenderFunc:this.props.notifRenderFunc,isUnreadSection:!1}))},t})(r.Component);a.displayName="NotificationsTrayChrome";var l=o(a,["/static/css/user_notifications_shared-vflL8eiHC.css"]);t.NotificationsTrayChrome=l}),define("modules/clean/react/user_notifications/shared/tray_section",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/user_notifications/shared/notification_row_wrapper"],function(e,t,n,r,i,o){"use strict";var s=(function(e){function t(t){var n=e.call(this,t)||this;return n.onClickActionButton=n.onClickActionButton.bind(n),n}return n.__extends(t,e),t.prototype.onClickActionButton=function(){this.props.actionButtonAction&&this.props.actionButtonAction()},t.prototype.renderReadSectionHeader=function(){var e=null;return this.props.actionButtonText&&(e=r.createElement("button",{className:"notifications-tray-section-header--button",onClick:this.onClickActionButton},this.props.actionButtonText)),r.createElement("div",{className:"notifications-tray-section-header"},r.createElement("span",{className:"notifications-tray-section-header--title"},this.props.sectionTitle),e)},t.prototype.render=function(){if(0===this.props.notifications.length)return null;for(var e=[],t=0,n=this.props.notifications;t<n.length;t++){var i=n[t],s=this.props.notifRenderFunc(i,!this.props.isUnreadSection);null!=s&&e.push(r.createElement(o.NotificationRowWrapper,{row:s,timestamp:i.displayTime,unread:this.props.isUnreadSection}))}return r.createElement("div",null,this.renderReadSectionHeader(),e)},t})(r.Component),a=i(s,["/static/css/user_notifications_shared-vflL8eiHC.css"]);t.NotificationsTraySection=a}),define("modules/clean/react/user_notifications/store",["require","exports","tslib","external/underscore","external/immutable","modules/clean/flux/flux_store","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dispatcher"],function(e,t,n,r,i,o,s,a){"use strict";var l=(function(e){function t(t){var n=e.call(this,t)||this;return n.isLoadingFlag=!1,n.userNotifications=i.List(),n.acknowledgedNotificationKeys=i.Set(),n.additionalSeenNotificationKeys=i.Set(),n}return n.__extends(t,e),t.prototype.isLoading=function(){return this.isLoadingFlag},t.prototype.getActionableCount=function(){return this.getUnseenInternal().size},t.prototype.getUnacknowledgedCount=function(){return this.getUnacknowledgedInternal().size},t.prototype.getCursor=function(){return this.cursor},t.prototype.getAll=function(){return this.userNotifications.toArray()},t.prototype.isAcknowledged=function(e){return e.isRead||this.acknowledgedNotificationKeys.has(e.key)},t.prototype.getUnacknowledged=function(){return this.getUnacknowledgedInternal().toArray()},t.prototype.getUnacknowledgedInternal=function(){var e=this;return this.userNotifications.filter(function(e){return e.isUnread}).filter(function(t){return!e.isAcknowledged(t)})},t.prototype.getAcknowledged=function(){var e=this;return this.userNotifications.filter(function(t){return e.isAcknowledged(t)}).toArray()},t.prototype.getUnseen=function(){return this.getUnseenInternal().toArray()},t.prototype.getUnseenInternal=function(){var e=this;return this.userNotifications.filter(function(e){return!e.isSeen}).filter(function(t){return!e.additionalSeenNotificationKeys.has(t.key)})},t.prototype.userNotificationComparator=function(e,t){return t.feedTime.getTime()-e.feedTime.getTime()},t.prototype.onLoadRequest=function(){this.isLoadingFlag||(this.isLoadingFlag=!0,this.__emitChange())},t.prototype.onLoadSuccess=function(e){if(this.isLoadingFlag&&(this.isLoadingFlag=!1,this.__emitChange()),r.isEqual(e.cursor,this.cursor)||(this.cursor=e.cursor,this.__emitChange()),e.notifications.length>0){this.additionalSeenNotificationKeys=this.additionalSeenNotificationKeys.clear();for(var t=i.OrderedMap(),n=0,o=e.notifications.concat(this.userNotifications.toArray());n<o.length;n++){var s=o[n];t.has(s.key)||(t=t.set(s.key,s))}this.userNotifications=t.toList().sort(this.userNotificationComparator),this.__emitChange()}},t.prototype.onLoadFailure=function(){this.isLoadingFlag&&(this.isLoadingFlag=!1,this.__emitChange())},t.prototype.onAcknowledgementRequest=function(){var e=i.Set(this.getUnacknowledgedInternal().map(function(e){return e.key}));this.acknowledgedNotificationKeys.equals(e)||(this.acknowledgedNotificationKeys=e,this.__emitChange())},t.prototype.onAcknowledgementRequestSingle=function(e){var t=this.acknowledgedNotificationKeys.add(e.key);t.equals(this.acknowledgedNotificationKeys)||(this.acknowledgedNotificationKeys=t,this.__emitChange())},t.prototype.onMarkAsSeenRequest=function(){this.additionalSeenNotificationKeys=i.Set(this.getUnseenInternal().map(function(e){return e.key})),this.__emitChange()},t.prototype.__onDispatch=function(e){switch(e.action.type){case s.ActionTypes.LOAD_REQUEST:this.onLoadRequest();break;case s.ActionTypes.LOAD_SUCCESS:this.onLoadSuccess(e.action.data);break;case s.ActionTypes.LOAD_FAILURE:this.onLoadFailure();break;case s.ActionTypes.ACKNOWLEDGEMENT_REQUEST:this.onAcknowledgementRequest();break;case s.ActionTypes.ACKNOWLEDGEMENT_REQUEST_SINGLE:this.onAcknowledgementRequestSingle(e.action.data.notifications[0]);break;case s.ActionTypes.MARK_AS_SEEN_REQUEST:this.onMarkAsSeenRequest()}},t})(o);t.userNotificationsStore=new l(a.userNotificationsDispatcher)}),define("modules/clean/react/user_notifications/thumbnail_preview",["require","exports","tslib","external/react","modules/clean/static_urls"],function(e,t,n,r,i){"use strict";var o={"paper-pad":"paper_doc_32","paper-folder":"folder_paper_team_32","dropbox-file":"page_white_gray_32","dropbox-folder":"folder_32"},s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.object;if(!e||!e.type||!e.name)return null;var t=e.thumbnailUrl;if(!t){var n=o[e.type];if(!n)return null;t=i.static_url("/static/images/sprites/file_icons_32/"+n+".png")}return r.createElement("span",{className:"preview-thumbnail"},r.createElement("img",{className:"preview-thumbnail--icon",src:t,alt:""}),r.createElement("span",{className:"preview-thumbnail--text"},e.name))},t})(r.Component);s.displayName="ThumbnailPreview",t.ThumbnailPreview=s});var extend=function(e,t){function n(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,bind=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/sharing/api/client",["external/immutable","external/underscore","modules/clean/api_v2/root_aware_client","modules/clean/api_v2/error","modules/clean/contacts/types","modules/clean/sharing/constants","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/core/exception","modules/core/user_i18n","modules/clean/viewer"],function(e,t,n,r,i,o,s,a,l,c,u){var d,p,_,m,h,f,y,g,v,b,w,I,S,T,A,N,assert,P,k,E,R,L,M,C,x,O,U,D,q,F,B,j,H,G;return T=n.UserActionsRootAwareClient,p=r.AppError,P=r.catchApiError,d=o.ACCESS_LEVEL,y=o.MEMBER_ACTION,o.TRUELINK,_=s.FilePolicy,h=s.FolderPolicy,g=s.MemberPermission,I=s.SharingMembership,S=s.TeamSharingPolicies,A=a.accessLevelConstToApi,N=a.accountInfoApiToRecord,k=a.combinedPolicyDiffToApi,E=a.fileMetadataApiToRecord,R=a.folderMetadataApiToRecord,L=a.fullAccountApiToRecord,M=a.hasFolderMetadataRecordInMetadata,C=a.linkMetadataApiToRecord,x=a.listFilesResultApiToRecord,O=a.listFoldersResultApiToRecord,U=a.makeMemberSelector,D=a.memberAccessLevelApiToRecord,q=a.memberCountsApiToRecord,F=a.membershipApiToRecord,B=a.parseFolderPolicy,H=a.sharedContentLinkMetadataToRecord,G=a.sharingPrefsApiToRecord,assert=l.assert,w=(function(e){function t(e){this.message=e,this.name="ShareError",this.stack=(new Error).stack}return extend(t,e),t})(Error),b=(function(){function n(e){var t,n,r;this.userId=e.userId,this.client=null!=(n=e.client)?n:null,t=null!=(r=e.isNonUserRelativeContext)&&r,null==this.client&&(this.client=new T),t&&null==this.teamMemberId&&(this.teamMemberId=u.get_viewer().work_user.team_member_id)}return n.prototype._getHeaders=function(e){return null==e&&(e=null),null!=this.teamMemberId&&(null===e&&(e={}),e["Dropbox-API-Select-Admin"]=this.teamMemberId),e},n.prototype._rpc=function(e,t,n,r,i){return null==n&&(n=null),null==r&&(r=!1),null==i&&(i=null),i=this._getHeaders(i),this.client.rpc(e,t,n,r,i)},n.prototype.addMembers=function(e){var t,n;throw e.contentId,e.members,e.accessLevel,null!=(t=e.customMessage)?t:null,null!=(n=e.quiet)&&n,new TypeError("Not implemented")},n.prototype.removeMember=function(e){throw e.contentId,e.memberId,new TypeError("Not implemented")},n.prototype.getMetadata=function(e){var t;throw e.contentId,null!=(t=e.actions)?t:[],new TypeError("Not implemented")},n.prototype.getMetadataInternal=function(e){var t;throw e.contentId,null!=(t=e.actions)?t:[],new TypeError("Not implemented")},n.prototype.getMetadataAlpha=function(e){var t;throw e.contentId,null!=(t=e.actions)?t:[],new TypeError("Not implemented")},n.prototype.listMembers=function(e){throw e.contentId,e.isAlpha,new TypeError("Not implemented")},n.prototype.listMembersContinue=function(e){throw e.cursor,e.isAlpha,new TypeError("Not implemented")},n.prototype.getMemberCounts=function(e){throw e.contentId,new TypeError("Not implemented")},n.prototype.getParentFolderAccess=function(e){throw e.contentId,e.memberId,e.accessLevel,new TypeError("Not implemented")},n.prototype.updateMember=function(e){throw e.contentId,e.memberId,e.accessLevel,new TypeError("Not implemented")},n.prototype.dismissInviteNotification=function(e){var t;return t=e.contentId,this._rpc(this.userId,"sharing/dismiss_invite_notification",{content_id:t})},n.prototype.getSharingPrefs=function(){return this._rpc(this.userId,"users/get_sharing_prefs",null,!1).then(G)},n.prototype.setSharingPrefs=function(e){return this._rpc(this.userId,"users/set_sharing_prefs",e)},n.prototype.getSharingPaywallInfo=function(){return this._rpc(this.userId,"users/get_sharing_paywall_info")},n.prototype.claimMembership=function(e){var t;return t=e.contentUrl,this._rpc(this.userId,"sharing/claim_membership",{content_url:t})},n.prototype.checkJobStatus=function(e){var t;return t=e.jobId,this._rpc(this.userId,"sharing/check_job_status",{async_job_id:t})},n.prototype.getAccountBatch=function(e){var t;return t=e.accountIds,t.length>0?this._rpc(this.userId,"users/get_account_batch",{account_ids:t}).then(function(e){return e.map(N)}):Promise.resolve([])},n.prototype._getAccountBatchCache={},n.prototype.getAccountBatchCached=function(e){var n,r,i,o,s,a;return n=e.accountIds,o=this._getAccountBatchCache,s=t.partition(n,function(e){return e in o}),i=s[0],a=s[1],r=t.values(t.pick(o,i)),this.getAccountBatch({accountIds:a}).then(function(e){var n;return n=t.object(e.map(function(e){return[e.account_id,e]})),t.extendOwn(o,n),e.concat(r)})},n.prototype.resetGetAccountBatchCache=function(){return this._getAccountBatchCache={}},n.prototype.getCurrentAccount=function(e){return this._rpc(this.userId,"users/get_current_account").then(function(e){return L(e)})},n.prototype._getCurrentAccountCache=null,n.prototype.getCurrentAccountCached=function(e){return null==this._getCurrentAccountCache&&(this._getCurrentAccountCache=this.getCurrentAccount()),this._getCurrentAccountCache},n.prototype.resetGetCurrentAccountCache=function(){return this._getCurrentAccountCache={}},n.prototype.requestAccess=function(e){var t,n;return t=e.contentUrl,n=e.customMessage,this._rpc(this.userId,"sharing/request_access",{content_url:t,custom_message:n})},n.prototype.sharedLinkInfo=function(e){var t,n;return t=e.fileIdOrPath,assert(null!=t,"an fqPath or fileId must be present to retrieve shared link info"),n=this._rpc(this.userId,"sharing/alpha/list_shared_links",{path:t,direct_only:!0}),n.then(function(e){return 0===e.links.length?null:C(e.links[0])})},n.prototype.createSharedLink=function(e){var t;return t=e.fileIdOrPath,this._rpc(this.userId,"sharing/alpha/create_shared_link_with_settings",{path:t}).then(C)},n.prototype.modifySharedLinkSettings=function(e){var t,n,r;return r=e.url,n=e.settings,t=e.remove_expiration,this._rpc(this.userId,"sharing/alpha/modify_shared_link_settings",{url:r,settings:n,remove_expiration:t}).then(C)},n.prototype.revokeSharedLink=function(e){var t;return t=e.url,this._rpc(this.userId,"sharing/revoke_shared_link",{url:t})},n.prototype.getLinkMetadata=function(e){var t;return t=e.url,this._rpc(this.userId,"sharing/alpha/get_link_metadata",{url:t}).then(H)},n.prototype.setLinkSettings=function(e){var t,n;return t=e.linkSettings,n=e.url,this._rpc(this.userId,"sharing/alpha/set_link_settings",{link_settings:t,url:n}).then(H)},n.prototype._addAccountsToMembership=function(t){return this._addAccountsToMembershipBatch(e.Map([[1,t]])).then(function(e){return e.get(1)})},n.prototype._addAccountsToMembershipBatch=function(t){var n;return n=t.valueSeq().flatMap(function(e){return e.users.valueSeq()}).map(function(e){return e.memberId()}).toSet().toArray(),n.length>0?this.getAccountBatchCached({accountIds:n}).then(function(n){var r;return r=e.Map(n.map(function(e){return[e.account_id,e]})),t.map(function(e,t){return e.set("users",e.users.map((function(e){return function(e){var t;return t=r.get(e.account_id),null!=t?e.set("account",t):e}})(this)))})}):Promise.resolve(t)},n})(),v=(function(e){function t(){this.validateFqPath=bind(this.validateFqPath,this),this.getMetadataAlpha=bind(this.getMetadataAlpha,this),this.getMetadataInternal=bind(this.getMetadataInternal,this),this.getMetadata=bind(this.getMetadata,this),t.__super__.constructor.apply(this,arguments),this._promises={}}return extend(t,e),t.prototype.addMembers=function(e){var t,n;return e.contentId,e.members,e.accessLevel,null!=(t=e.customMessage)?t:null,null!=(n=e.quiet)&&n,this.createPromise("addMembers")},t.prototype.getMetadata=function(e){var t;return e.contentId,null!=(t=e.actions)?t:[],this.createPromise("getMetadata")},t.prototype.getMetadataInternal=function(e){var t;return e.contentId,null!=(t=e.actions)?t:[],this.createPromise("getMetadataInternal")},t.prototype.getMetadataAlpha=function(e){var t;return e.contentId,null!=(t=e.actions)?t:[],this.createPromise("getMetadataAlpha")},t.prototype.dismissInviteNotification=function(e){var t;return e.contentId,null!=(t=e.cursor)?t:null,this.createPromise("dismissInviteNotification")},t.prototype.getSharingPrefs=function(){return this.createPromise("getSharingPrefs")},t.prototype.getSharingPaywallInfo=function(){return this.createPromise("getSharingPaywallInfo")},t.prototype.getOwnedSharedFolders=function(){return this.createPromise("getOwnedSharedFolders")},t.prototype.listMembers=function(e){return e.contentId,e.isAlpha,this.createPromise("listMembers")},t.prototype.listMembersContinue=function(e){return e.cursor,e.isAlpha,this.createPromise("listMembersContinue")},t.prototype.getMemberCounts=function(e){return e.contentId,this.createPromise("getMemberCounts")},t.prototype.getParentFolderAccess=function(e){return e.contentId,e.memberId,e.accessLevel,this.createPromise("getParentFolderAccess")},t.prototype.removeMember=function(e){return e.contentId,e.memberId,this.createPromise("removeMember")},t.prototype.setLinkSettings=function(e){return e.linkSettings,e.url,this.createPromise("setLinkSettings")},t.prototype.share=function(e){var t,n,r,i;return e.fqPath,null!=(t=e.memberPolicy)?t:null,null!=(n=e.aclUpdatePolicy)?n:null,null!=(r=e.sharedLinkPolicy)?r:null,null!=(i=e.forceAsync)&&i,this.createPromise("share")},t.prototype.shareInternal=function(e){var t,n,r;return e.fqPath,null!=(t=e.folderPolicy)?t:null,null!=(n=e.forceAsync)&&n,null!=(r=e.confidential)&&r,this.createPromise("shareInternal")},t.prototype.requestAccess=function(e){return e.contentUrl,e.customMessage,this.createPromise("requestAccess")},t.prototype.sharedLinkInfo=function(e){return e.fileIdOrPath,this.createPromise("sharedLinkInfo")},t.prototype.transferContent=function(e){return e.contentId,e.memberId,this.createPromise("transferContent")},t.prototype.createSharedLink=function(e){return e.fileIdOrPath,this.createPromise("createSharedLink")},t.prototype.updateMember=function(){return this.createPromise("updateMember")},t.prototype.updatePolicyAlpha=function(){return this.createPromise("updatePolicyAlpha")},t.prototype.validateFqPath=function(e){var t;return e.fqPath,null!=(t=e.actions)?t:[],this.createPromise("validateFqPath")},t.prototype.getCurrentAccountCached=function(e){return this.createPromise("getCurrentAccountCached")},t.prototype.modifySharedLinkSettings=function(e){return e.url,e.settings,e.remove_expiration,this.createPromise("modifySharedLinkSettings")},t.prototype.revokeSharedLink=function(e){return e.url,this.createPromise("revokeSharedLink")},t.prototype.relinquishMembership=function(e){var t;return e.contentId,null!=(t=e.leaveACopy)&&t,this.createPromise("relinquishMembership")},t.prototype.setConfidentiality=function(e){return e.contentId,e.confidential,this.createPromise("setConfidentiality")},t.prototype.createPromise=function(e){var t;return t=this._promises[e],t&&t.calledBeforeCreatePromise?(this._promises[e]=null,t.promise):(t={},t.promise=new Promise(function(e,n){return t.resolve=e,t.reject=n}),this._promises[e]=t,t.promise)},t.prototype.getPromise=function(e){var t;return null!=(t=this._promises[e])?t.promise:void 0},t.prototype.resolvePromise=function(e,t,n){var r;return null==n&&(n=!1),this._promises[e]||this.createPromise(e),r=this._promises[e],r.calledBeforeCreatePromise=n,r.resolve.apply(null,t),r.promise},t.prototype.rejectPromise=function(e,t){var n;return this._promises[e]||this.createPromise(e),n=this._promises[e],n.reject.apply(null,t),n.promise},t})(b),m=(function(t){function n(){return this.getMetadataBatchAlpha=bind(this.getMetadataBatchAlpha,this),this.getMetadataAlpha=bind(this.getMetadataAlpha,this),this.getMetadata=bind(this.getMetadata,this),n.__super__.constructor.apply(this,arguments)}return extend(n,t),n.prototype.addMembers=function(e){var t,n,r,i,o,s,a,l,c,u,p;return i=e.contentId,s=e.members,o=null!=(l=e.customMessage)?l:null,a=null!=(c=e.quiet)&&c,t=null!=(u=e.accessLevel)?u:d.READER,n=null!=(p=e.addMessageAsComment)&&p,r=A(t),0===(null!=o?o.length:void 0)&&(o=null),this._rpc(this.userId,"sharing/add_file_member",{file:i,members:s,custom_message:o,quiet:a,access_level:r,add_message_as_comment:n})},n.prototype.removeMember=function(e){var t,n;return t=e.contentId,n=e.memberId,this._rpc(this.userId,"sharing/remove_file_member_2",{file:t,member:U(n)},!1).then((function(e){return function(t){return D(e.userId,t)}})(this))},n.prototype.getMetadata=function(e){var t,n,r;return n=e.contentId,t=null!=(r=e.actions)?r:[],this._rpc(this.userId,"sharing/get_file_metadata",{file:n,actions:t},!1).then(E)},n.prototype.getMetadataAlpha=function(e){var t,n,r,i;return n=e.contentId,t=null!=(r=e.actions)?r:[],i=e.sourceURL,this._rpc(this.userId,"sharing/alpha/get_file_metadata",{file:n,actions:t,url:i},!1).then(E)},n.prototype.getMetadataBatchAlpha=function(e){var t,n,r;return n=e.contentIds,t=null!=(r=e.actions)?r:[],this._rpc(this.userId,"sharing/alpha/get_file_metadata/batch",{files:n,actions:t},!1).then(function(e){return e.map(function(e){return E(e.result)})})},n.prototype.listMembers=function(e){var t,n,r,i,o,s,a;return t=e.contentId,a=null!=(i=e.url)?i:null,r=null!=(o=e.limit)?o:100,n=null!=(s=e.isAlpha)&&s,this._rpc(this.userId,n?"sharing/alpha/list_file_members":"sharing/list_file_members",{file:t,actions:y.ALL,include_inherited:!0,limit:r,url:n?a:void 0},!1).then(F).then(this._addAccountsToMembership.bind(this))},n.prototype.listMembersContinue=function(e){var t,n,r,i,o;return t=e.cursor,o=null!=(r=e.url)?r:null,n=null!=(i=e.isAlpha)&&i,this._rpc(this.userId,n?"sharing/alpha/list_file_members/continue":"sharing/list_file_members/continue",{cursor:t,url:n?o:void 0}).then(function(e){return F(e,null)}).then(this._addAccountsToMembership.bind(this))},n.prototype.listMembersBatch=function(t){var n,r,i;return n=t.contentIds,r=null!=(i=t.limit)?i:10,this._rpc(this.userId,"sharing/list_file_members/batch",{files:n,limit:r}).then(function(t){var n,r,i,o;for(o={},r=0,i=t.length;r<i;r++)n=t[r],"result"===n.result[".tag"]&&(o[n.file]=F(n.result.members,n.result.member_count));return e.Map(o)}).then(this._addAccountsToMembershipBatch.bind(this))},n.prototype.getMemberCounts=function(e){var t,n,r,i;return t=e.contentId,n=e.limit,i=null!=(r=e.url)?r:null,this._rpc(this.userId,"sharing/get_file_member_counts",{file:t,limit:n,url:i})},n.prototype.getParentFolderAccess=function(e){throw e.contentId,e.memberId,e.accessLevel,new w("Parent folder access points not implemented for files")},n.prototype.relinquishMembership=function(e){var t;return t=e.contentId,this._rpc(this.userId,"sharing/relinquish_file_membership",{file:String(t)})},n.prototype.listReceivedFiles=function(e){var t,n,r,i;return n=null!=(r=e.limit)?r:100,t=null!=(i=e.actions)?i:[],this._rpc(this.userId,"sharing/list_received_files",{limit:n,actions:t}).then(x)},n.prototype.listReceivedFilesContinue=function(e){var t;return t=e.cursor,this._rpc(this.userId,"sharing/list_received_files/continue",{cursor:t}).then(x)},n.prototype.updateMember=function(e){var t,n,r;return n=e.contentId,r=e.memberId,t=e.accessLevel,this._rpc(this.userId,"sharing/update_file_member",{file:String(n),member:U(r),access_level:A(t)}).then((function(e){return function(t){return D(e.userId,t)}})(this))},n.prototype.updatePolicy=function(e){var t,n,r,i;return r=e.contentId,i=e.newPolicy,t=e.actions,n=k(i),
n.actions=t,n.file=r,this._rpc(this.userId,"sharing/alpha/update_file_policy",n).then(function(e){return null!=e.metadata&&(e=e.metadata),E(e)})},n.prototype.unshare=function(e){var t;return t=e.contentId,this._rpc(this.userId,"sharing/unshare_file",{file:String(t)})},n})(b),f=(function(e){function t(){return this.updatePolicyAlpha=bind(this.updatePolicyAlpha,this),this.updatePolicy=bind(this.updatePolicy,this),this.validateFqPath=bind(this.validateFqPath,this),this.getMetadataInternal=bind(this.getMetadataInternal,this),this.getMetadataAlpha=bind(this.getMetadataAlpha,this),this.getMetadata=bind(this.getMetadata,this),this._shareComplete=bind(this._shareComplete,this),t.__super__.constructor.apply(this,arguments)}return extend(t,e),t.prototype.share=function(e){var t,n,r,i,o;return r=e.fqPath,t=null!=(i=e.folderPolicy)?i:null,n=null!=(o=e.forceAsync)&&o,this._share({fqPath:r,folderPolicy:t,forceAsync:n,confidential:!1,internal:!1})},t.prototype.shareAlpha=function(e){var t,n,r,i;return r=e.fqPath,n=null!=(i=e.folderPolicy)?i:null,t=k(n),t.path=r,this._rpc(this.userId,"sharing/alpha/share_folder",t,!1).then((function(e){return function(t){return e._shareComplete(t,!1)}})(this))},t.prototype.shareInternal=function(e){var t,n,r,i,o,s,a;return i=e.fqPath,n=null!=(o=e.folderPolicy)?o:null,r=null!=(s=e.forceAsync)&&s,t=null!=(a=e.confidential)&&a,this._share({fqPath:i,folderPolicy:n,forceAsync:r,confidential:t,internal:!0})},t.prototype._share=function(e){var t,n,r,i,o,s;return i=e.fqPath,r=e.folderPolicy,e.forceAsync,n=e.confidential,o=e.internal,t={path:i},null!=r&&r.forEach(function(e,n){if(null!=e&&"resolved_member_policy"!==n)return t[n]={".tag":e}}),s="sharing/share_folder",o&&(t.confidentiality=n?"confidential":"not_confidential",s="sharing/share_folder_internal"),this._rpc(this.userId,s,t,!1).then((function(e){return function(t){return e._shareComplete(t,o)}})(this))},t.prototype._shareComplete=function(e,t){return("complete"===e[".tag"]?Promise.resolve(e):j(this.checkShareJobStatus.bind(this,{jobId:e.async_job_id,internal:t}))).then(R)},t.prototype.checkShareJobStatus=function(e){var t,n,r;return n=e.jobId,t=e.internal,r=t?"sharing/check_share_internal_job_status":"sharing/check_share_job_status",this._rpc(this.userId,r,{async_job_id:n})},t.prototype.checkRemoveMemberJobStatus=function(e){var t;return t=e.jobId,this._rpc(this.userId,"sharing/check_remove_member_job_status",{async_job_id:t})},t.prototype.addMembers=function(e){var t,n,r,i,o,s,a,l,c,u;return i=e.contentId,a=e.members,t=e.accessLevel,o=null!=(c=e.customMessage)?c:null,l=null!=(u=e.quiet)&&u,r=A(t),0===(null!=o?o.length:void 0)&&(o=null),n={shared_folder_id:String(i),members:(function(){var e,t,n;for(n=[],e=0,t=a.length;e<t;e++)s=a[e],n.push({member:s,access_level:r});return n})(),custom_message:o,quiet:l},this._rpc(this.userId,"sharing/add_folder_member",n,!1)},t.prototype.fetchNsId=function(e){return this._rpc(this.userId,"files/get_metadata",{path:e}).then(function(e){var t;return null!=(t=e.sharing_info)?t.shared_folder_id:void 0})},t.prototype.getMetadata=function(e){var t,n,r;return n=e.contentId,t=null!=(r=e.actions)?r:[],this._getMetadata({contentId:n,actions:t,metadataApi:"sharing/get_folder_metadata"})},t.prototype.getMetadataAlpha=function(e){var t,n,r;return n=e.contentId,t=null!=(r=e.actions)?r:[],this._getMetadata({contentId:n,actions:t,metadataApi:"sharing/alpha/get_folder_metadata"})},t.prototype.getMetadataInternal=function(e){var t,n,r;return n=e.contentId,t=null!=(r=e.actions)?r:[],this._getMetadata({contentId:n,actions:t,metadataApi:"sharing/get_folder_metadata_2"})},t.prototype._getMetadata=function(e){var t,n,r,i;return n=e.contentId,t=null!=(i=e.actions)?i:[],r=e.metadataApi,this._rpc(this.userId,r,{shared_folder_id:String(n),actions:t},!1).then(R)},t.prototype._metadataAndInheritMembers=function(e){var t;return t=e.members_cursor,t?this.listMembersContinue({cursor:t}).then(function(t){return{metadata:e,inheritedMembers:t}}):{metadata:e,inheritedMembers:new I}},t.prototype.validateFqPath=function(e){var t,n,r,i,o,s,a,l;return n=e.fqPath,t=null!=(i=e.actions)?i:[],r=null!=(o=e.listMembersArg)?o:{},l=null!=(s=e.shouldParseMetadataFromError)&&s,a=this._rpc(this.userId,"sharing/validate_folder_path",{path:n,actions:t,list_members_arg:r},!1),this.validatePathContinue(a,l)},t.prototype.validatePathContinue=function(e,t){return e.catch(P(function(e){var n,r;if("already_shared"===(null!=(n=e.error)&&null!=(r=n.bad_path)?r[".tag"]:void 0))return e.error.bad_path;if(t&&e instanceof p&&e.error&&"no_permission"===e.error[".tag"]&&M(e.error))return e.error;throw e})).then(R).then(this._metadataAndInheritMembers.bind(this))},t.prototype.validateFolderPathBatch=function(e){var t;return t=e.paths,this._rpc(this.userId,"sharing/validate_folder_path/batch",{paths:t}).then(function(e){return e.entries.map(function(e){var t,n,r,i,o,s;return s=e.result,t=null,"metadata"===s[".tag"]?t=s:"no_permission"===(null!=(r=s.path_error)?r[".tag"]:void 0)?t=s.path_error:"already_shared"===(null!=(i=s.path_error)&&null!=(o=i.bad_path)?o[".tag"]:void 0)&&(t=s.path_error.bad_path),n=null,t&&t.link_metadata&&(n=R(t)),{path:e.path,metadata:n}})})},t.prototype.updatePolicy=function(e){var t,n,r;return n=e.contentId,r=e.newPolicy,t=r,t.shared_folder_id=String(n),this._rpc(this.userId,"sharing/update_folder_policy",t,!1).then(R)},t.prototype.updatePolicyAlpha=function(e){var t,n,r;return n=e.contentId,r=e.newPolicy,t=k(r),t.shared_folder_id=String(n),this._rpc(this.userId,"sharing/alpha/update_folder_policy",t,!1).then(R)},t.prototype.unshare=function(e){var t,n,r;return t=e.contentId,n=null!=(r=e.leaveACopy)&&r,this._rpc(this.userId,"sharing/unshare_folder",{shared_folder_id:String(t),leave_a_copy:n}).then((function(e){return function(t){return"complete"===t[".tag"]?Promise.resolve(t):j(e.checkJobStatus.bind(e,{jobId:t.async_job_id}))}})(this))},t.prototype.getOwnedSharedFolders=function(){return this._rpc(this.userId,"users/list_owned_shared_folders").then(function(e){return Promise.resolve(e)})},t.prototype.unshareFolderBatch=function(e){var t,n,r;return n=e.nsIds,t=null!=(r=e.leaveACopy)&&r,this._rpc(this.userId,"sharing/unshare_folder/batch",{shared_folder_ids:n,leave_a_copy:t}).then(function(e){return"async_job_id"===e[".tag"]?Promise.resolve(e):Promise.reject(e)})},t.prototype.listMembers=function(e){var t,n,r,i;return t=e.contentId,n=null!=(r=e.limit)?r:100,null!=(i=e.isAlpha)&&i,this._rpc(this.userId,"sharing/list_folder_members",{shared_folder_id:String(t),actions:y.ALL,limit:n},!1).then(F).then(this._addAccountsToMembership.bind(this))},t.prototype.listMembersContinue=function(e){var t,n;return t=e.cursor,null!=(n=e.isAlpha)&&n,this._rpc(this.userId,"sharing/list_folder_members/continue",{cursor:t},!1).then(function(e){return F(e,null)}).then(this._addAccountsToMembership.bind(this))},t.prototype.listMountableFolders=function(e){var t,n,r,i,o;return r=null!=e?e:{},n=null!=(i=r.limit)?i:100,t=null!=(o=r.actions)?o:[],this._rpc(this.userId,"sharing/list_mountable_folders",{limit:n,actions:t}).then(O)},t.prototype.listMountableFoldersContinue=function(e){var t;return t=e.cursor,this._rpc(this.userId,"sharing/list_mountable_folders/continue",{cursor:t}).then(O)},t.prototype.listMountableFoldersAlpha=function(e){var t,n,r,i,o;return r=null!=e?e:{},n=null!=(i=r.limit)?i:100,t=null!=(o=r.actions)?o:[],this._rpc(this.userId,"sharing/alpha/list_mountable_folders",{limit:n,actions:t}).then(O)},t.prototype.listMountableFoldersContinueAlpha=function(e){var t;return t=e.cursor,this._rpc(this.userId,"sharing/alpha/list_mountable_folders/continue",{cursor:t}).then(O)},t.prototype.getMemberCounts=function(e){var t;return t=e.contentId,this._rpc(this.userId,"sharing/get_folder_member_counts",{shared_folder_id:String(t)},!1).then(q)},t.prototype.getParentFolderAccess=function(e){var t,n,r;return n=e.contentId,r=e.memberId,t=e.accessLevel,this._rpc(this.userId,"sharing/get_parent_folder_access",{shared_folder_id:String(n),member:U(r),access_level:null!=t?A(t):void 0},!1).then(D.bind(null,this.userId))},t.prototype.relinquishMembership=function(e){var t,n,r;return t=e.contentId,n=null!=(r=e.leaveACopy)&&r,this._rpc(this.userId,"sharing/relinquish_folder_membership",{shared_folder_id:String(t),leave_a_copy:n}).then((function(e){return function(t){return"complete"===t[".tag"]?Promise.resolve():j(e.checkJobStatus.bind(e,{jobId:t.async_job_id}))}})(this))},t.prototype.removeMember=function(e){var t,n,r,i;return t=e.contentId,r=e.memberId,n=null!=(i=e.leaveACopy)&&i,this._rpc(this.userId,"sharing/remove_folder_member",{shared_folder_id:String(t),member:U(r),leave_a_copy:n},!1).then((function(e){return function(t){return"complete"===t[".tag"]?Promise.resolve():j(e.checkRemoveMemberJobStatus.bind(e,{jobId:t.async_job_id}))}})(this)).then((function(e){return function(t){return D(e.userId,t)}})(this))},t.prototype.transferContent=function(e){var t,n;return t=e.contentId,n=e.memberId,this._rpc(this.userId,"sharing/transfer_folder",{shared_folder_id:String(t),to_dropbox_id:n})},t.prototype.updateMember=function(e){var t,n,r;return n=e.contentId,r=e.memberId,t=e.accessLevel,this._rpc(this.userId,"sharing/update_folder_member",{shared_folder_id:String(n),member:U(r),access_level:A(t)},!1).then((function(e){return function(t){return D(e.userId,t)}})(this))},t.prototype.mount=function(e){var t;return t=e.contentId,this._rpc(this.userId,"sharing/mount_folder",{shared_folder_id:String(t)}).then(R)},t.prototype.unmount=function(e){var t;return t=e.contentId,this._rpc(this.userId,"sharing/unmount_folder",{shared_folder_id:String(t)})},t.prototype.setConfidentiality=function(e){var t,n;return n=e.contentId,t=e.confidential,this._rpc(this.userId,"sharing/set_confidentiality",{shared_folder_id:String(n),confidentiality:t?"confidential":"not_confidential"}).then((function(e){return function(t){return"complete"===t[".tag"]?Promise.resolve(t):j(e.checkShareJobStatus.bind(e,{jobId:t.async_job_id,internal:!0}))}})(this)).then(R)},t})(b),j=function(e,t){var n,r,i,o,s,a,l;return o=null!=t?t:{},i=null!=(s=o.interval)?s:1e3,l=null!=(a=o.timeout)?a:null,r=null!=l?Date.now()+l:null,n=function(t,o){return null!=r&&Date.now()>r?o():e().then(function(e){switch(e[".tag"]){case"failed":return o(e);case"complete":return t(e);case"in_progress":return window.setTimeout(n,i,t,o)}})},new Promise(n)},{FilePolicy:_,FileShareApiClient:m,FolderPolicy:h,FolderShareApiClient:f,MemberPermission:g,MockShareApiClient:v,parseFolderPolicy:B,ShareError:w,ShareApiClient:b,TeamSharingPolicies:S}}),define("modules/clean/sharing/api/types/metadata",["require","exports","tslib","external/immutable","modules/clean/api_v2/types"],function(e,t,n,r,i){"use strict";t.MemberPolicy={team:new i.UnionScalar("team"),anyone:new i.UnionScalar("anyone")},t.AclUpdatePolicy={owner:new i.UnionScalar("owner"),editors:new i.UnionScalar("editors")},t.SharedLinkPolicy={anyone:new i.UnionScalar("anyone"),members:new i.UnionScalar("members")},t.SharedFolderMemberMemberPolicy={team:new i.UnionScalar("team"),anyone:new i.UnionScalar("anyone")},t.SharedFolderJoinPolicy={from_team_only:new i.UnionScalar("from_team_only"),from_anyone:new i.UnionScalar("from_anyone")},t.SharedLinkCreatePolicy={default_public:new i.UnionScalar("default_public"),default_team_only:new i.UnionScalar("default_team_only"),team_only:new i.UnionScalar("team_only")},t.RequestedVisibilityPolicy={policy_name:"requested_visibility",password:"password",public:"public",team_only:"team_only"},t.ResolvedVisibilityPolicy={policy_name:"resolved_visibility",only_you:"only_you",password:"password",public:"public",shared_folder_only:"shared_folder_only",team_and_password:"team_and_password",team_only:"team_only"},t.VisibilityDisallowedReason={delete_and_recreate:"delete_and_recreate",restricted_by_shared_folder:"restricted_by_shared_folder",restricted_by_team:"restricted_by_team",user_account_type:"user_account_type",user_not_on_team:"user_not_on_team",permission_denied:"permission_denied"},t.LinkExpiryPolicy={policy_name:"expires"},t.PassPolicy={policy_name:"pass_policy",enabled:"enabled",disabled:"disabled"},t.DownloadPolicy={policy_name:"download_policy",allow:"allow",disallow:"disallow"},t.LinkAudience={public:"public",team:"team",members:"members",default_on:"default_on"},t.GroupManagementType={user_managed:new i.UnionScalar("user_managed"),company_managed:new i.UnionScalar("company_managed"),system_managed:new i.UnionScalar("system_managed")};var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({id:null,name:null},"Team"));t.Team=o;var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({display_name:null,member_id:null,team_info:null},"TeamMemberInfo"));t.TeamMemberInfo=s;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({id:null,name:null,sharing_policies:null},"FullTeam"));t.FullTeam=a;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({shared_folder_member_policy:null,shared_folder_join_policy:null,shared_link_create_policy:null},"TeamSharingPolicies"));t.TeamSharingPolicies=l;var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({account_id:null,display_name:null,disabled:!1,email:null,email_verified:!1,familiar_name:null,given_name:null,is_teammate:!1,profile_photo_url:null,surname:null,team_member_id:null},"BasicAccount"));t.BasicAccount=c;var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({account_id:null,display_name:null,disabled:!1,email:null,email_verified:!1,familiar_name:null,given_name:null,profile_photo_url:null,surname:null,team:null,team_member_id:null},"FullAccount"));t.FullAccount=u;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({allow:!1,reason:null},"PermissionSetting"));t.PermissionSetting=d;var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.contentId=function(){return this.shared_folder_id||this.path_lower},t.prototype.isSharedFolder=function(){return Boolean(this.shared_folder_id)},t.prototype.isNewSharedFolder=function(){return!this.shared_folder_id},t})(r.Record({access_type:null,is_confidential:!1,is_inside_team_folder:!1,is_team_folder:!1,link_metadata:null,members_cursor:null,name:null,owner_team:null,parent_shared_folder_id:null,path_lower:null,permissions:null,policy:null,preview_url:null,shared_folder_id:null,time_invited:null},"SharedFolderMetadata"));t.SharedFolderMetadata=p;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({acl_update_policy:null,download_policy:null,member_policy:null,pass_policy:null,resolved_member_policy:null,shared_link_policy:null},"FolderPolicy"));t.FolderPolicy=_;var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({acl_update_policy:null,download_policy:null,member_policy:null,pass_policy:null,shared_link_policy:null,audience:null,access_level:null,expiry:null,password:null},"CombinedPolicy"));t.CombinedPolicy=m;var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({change_options:null,disable_pass:null,edit_contents:null,enable_pass:null,invite_editor:null,invite_viewer:null,invite_viewer_no_comment:null,leave_a_copy:null,relinquish_membership:null,remove_download_policy:null,set_download_policy:null,update_confidentiality:null,unmount:null,unshare:null},"FolderPermissions"));t.FolderPermissions=h;var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({entries:r.Map(),cursor:null},"ListFoldersResult"));t.ListFoldersResult=f;var y=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.contentId=function(){return this.id},t.prototype.isSharedFolder=function(){return!1},t.prototype.isNewSharedFolder=function(){return!1},t})(r.Record({access_type:null,id:null,file_policy:null,link_metadata:null,name:null,owner_team:null,policy:null,parent_shared_folder_id:null,path_display:null,path_lower:null,permissions:null,preview_url:null,time_invited:null},"SharedFileMetadata"));t.SharedFileMetadata=y;var g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({change_options:null,disable_pass:null,edit_contents:null,enable_pass:null,invite_viewer:null,invite_viewer_no_comment:null,relinquish_membership:null,remove_download_policy:null,set_download_policy:null,unshare:null,view_members:null},"FilePermissions"));t.FilePermissions=g;var v=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({download_policy:null,pass_policy:null},"FilePolicy"));t.FilePolicy=v;var b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({entries:r.Map(),cursor:null},"ListFilesResult"));t.ListFilesResult=b;var w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMemberCount=function(){return this.memberCount||this.invitees.count()+this.groups.count()+this.users.count()},t})(r.Record({cursor:null,invitees:r.Map(),groups:r.Map(),users:r.Map(),memberCount:null},"SharingMembership"));t.SharingMembership=w,t.makeMemberKey=function(e,t){return e+":"+t};var I=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.memberId=function(){return this.account_id},r.prototype.memberKey=function(){return t.makeMemberKey(this.is_inherited,this.memberId())},r.prototype.displayName=function(){return this.account?this.account.display_name:void 0},r.prototype.type=function(){return"users"},r})(r.Record({access_type:null,account:null,account_id:null,initials:null,is_inherited:!1,permissions:null,same_team:null,team_member_id:null,time_last_seen:null},"UserMembershipInfo"));t.UserMembershipInfo=I;var S=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.memberId=function(){return this.contact_type+":"+this.contact},r.prototype.memberKey=function(){return t.makeMemberKey(this.is_inherited,this.memberId())},r.prototype.displayName=function(){return this.contact},r.prototype.type=function(){return"invitees"},r})(r.Record({access_type:null,contact:null,contact_type:null,initials:!1,is_inherited:null,permissions:null,same_team:null},"InviteeMembershipInfo"));t.InviteeMembershipInfo=S;var T=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.memberId=function(){return this.group_id},r.prototype.memberKey=function(){return t.makeMemberKey(this.is_inherited,this.memberId())},r.prototype.displayName=function(){return this.group_name},r.prototype.type=function(){return"groups"},r})(r.Record({access_type:null,group_external_id:null,group_id:null,group_management_type:null,group_name:null,group_type:null,initials:null,is_inherited:!1,is_member:!1,is_owner:!1,member_count:null,permissions:null,same_team:!0},"GroupMembershipInfo"));t.GroupMembershipInfo=T;var A=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({leave_a_copy:null,make_editor:null,make_owner:null,make_viewer:null,make_viewer_no_comment:null,remove:null},"MemberPermissions"));t.MemberPermissions=A;var N=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({total_unique_users:null,users_outside_team:null,exceeds_count:!1},"MemberCounts"));t.MemberCounts=N;var P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({access_level:null,warning:null,parentFolders:null},"MemberAccessLevelResult"));t.MemberAccessLevelResult=P;var k=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({name:null,shared_folder_id:null,path:null,permissions:null},"ParentFolderInfo"));t.ParentFolderInfo=k;var E=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.isFolder=function(){return"folder"===this.file_type},t.prototype.teamInfo=function(){return this.content_owner_team_info?this.content_owner_team_info:this.team_member_info?this.team_member_info.team_info:void 0},t})(r.Record({url:null,client_modified:null,content_owner_team_info:null,expires:null,file_type:null,id:null,link_permissions:null,name:null,path_lower:null,rev:null,server_modified:null,size:null,team_member_info:null,preview_type:null},"LinkMetadata"));t.LinkMetadata=E;var R=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({requested_visibility:null,link_password:null,expires:null,allow_download:null},"LinkPolicy"));t.LinkPolicy=R;var L=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({allow_comments:null,can_revoke:null,allow_download:null,can_allow_download:null,can_disallow_download:null,can_set_expiry:null,can_remove_expiry:null,requested_visibility:null,resolved_visibility:null,restricting_shared_folder_path:null,revoke_failure_reason:null,team_restricts_comments:null,visibility_policies:null},"LinkPermissions"));t.LinkPermissions=L;var M=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({policy:null,resolved_policy:null,allowed:null,disallowed_reason:null},"LinkVisibilityPolicy"));t.LinkVisibilityPolicy=M;var C=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({add_message_as_comment_checked:null,add_message_as_comment_help_shown:null,access_reader_no_comment_content_links:null,access_reader_no_comment_shared_folders:null},"SharingPrefs"));t.SharingPrefs=C;var x=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({change_audience:null,remove_expiry:null,remove_password:null,set_expiry:null,set_password:null},"SharedContentLinkPermissions"));t.SharedContentLinkPermissions=x;var O=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({shared_folder_id:null,name:null,audience:null},"AudienceRestrictingSharedFolder"));t.AudienceRestrictingSharedFolder=O;var U=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({audience_options:null,current_audience:null,expiry:null,link_permissions:null,password_protected:null,url:null,audience_restricting_shared_folder:null,access_level:null},"SharedContentLinkMetadata"));t.SharedContentLinkMetadata=U;var D=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({audience:null,remove_expiry:null,set_expiry:null,remove_password:null,set_password:null,access_level:null},"SharedContentLinkSettings"));t.SharedContentLinkSettings=D}),define("modules/clean/sharing/api/util/types",["require","exports","tslib","modules/clean/contacts/types","external/immutable","external/underscore","modules/clean/api_v2/types","modules/clean/sharing/constants","modules/clean/sharing/link_info","modules/clean/sharing/api/types/metadata"],function(e,t,n,r,i,o,s,a,l,c){"use strict";t.accessLevelConstToApi=function(e){switch(e){case a.ACCESS_LEVEL.OWNER:return new s.UnionScalar("owner");case a.ACCESS_LEVEL.WRITER:return new s.UnionScalar("editor");case a.ACCESS_LEVEL.READER:return new s.UnionScalar("viewer");case a.ACCESS_LEVEL.READER_NO_COMMENT:return new s.UnionScalar("viewer_no_comment");default:throw new Error("unknown access level")}},t.accessLevelApiToConst=function(e){switch(e.type||e){case"owner":return a.ACCESS_LEVEL.OWNER;case"editor":return a.ACCESS_LEVEL.WRITER;case"viewer":return a.ACCESS_LEVEL.READER;case"viewer_no_comment":return a.ACCESS_LEVEL.READER_NO_COMMENT}},t.groupManagementTypeApiToConst=function(e){if(!e)return null;switch(e[".tag"]){case"user_managed":return c.GroupManagementType.user_managed;case"company_managed":return c.GroupManagementType.company_managed;case"system_managed":return c.GroupManagementType.system_managed;default:return}},t.hasFolderMetadataRecordInMetadata=function(e){return null!=e.path_lower&&null!=e.access_type&&null!=e.policy},t.folderPolicyApiToRecord=function(e){return null==e?new c.FolderPolicy:new c.FolderPolicy({acl_update_policy:e.acl_update_policy&&e.acl_update_policy[".tag"],download_policy:e.download_policy&&e.download_policy[".tag"],member_policy:e.member_policy&&e.member_policy[".tag"],resolved_member_policy:e.resolved_member_policy&&e.resolved_member_policy[".tag"],shared_link_policy:e.shared_link_policy&&e.shared_link_policy[".tag"],pass_policy:e.pass_policy&&e.pass_policy[".tag"]})};var u=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i.action[".tag"]]=new c.PermissionSetting({allow:i.allow,reason:i.reason?i.reason[".tag"]:void 0})}return t};t.sharedContentLinkPermissionsApiToRecord=function(e){var t=u(e);return new c.SharedContentLinkPermissions(t)},t.audienceRestrictingSharedFolderToRecord=function(e){return new c.AudienceRestrictingSharedFolder({shared_folder_id:e.shared_folder_id,name:e.name,audience:e.audience[".tag"]})},t.sharedContentLinkMetadataToRecord=function(e){return new c.SharedContentLinkMetadata({audience_options:i.List(e.audience_options.map(function(e){return e[".tag"]})),current_audience:e.current_audience[".tag"],expiry:e.expiry&&new Date(e.expiry)>new Date?new Date(e.expiry):void 0,link_permissions:t.sharedContentLinkPermissionsApiToRecord(e.link_permissions),password_protected:e.password_protected,url:e.url,audience_restricting_shared_folder:e.audience_restricting_shared_folder&&t.audienceRestrictingSharedFolderToRecord(e.audience_restricting_shared_folder),access_level:e.access_level&&e.access_level[".tag"]})},t.parseFolderPolicy=t.folderPolicyApiToRecord,t.folderPermissionsApiToRecord=function(e){var t=u(e);return new c.FolderPermissions(t)},t.folderMetadataApiToRecord=function(e){return new c.SharedFolderMetadata({access_type:t.accessLevelApiToConst(s.Union.parse(e.access_type)),is_inside_team_folder:e.is_inside_team_folder,is_team_folder:e.is_team_folder,link_metadata:null!=e.link_metadata?t.sharedContentLinkMetadataToRecord(e.link_metadata):void 0,members_cursor:e.members_cursor,name:e.name,owner_team:null!=e.owner_team?new c.Team(e.owner_team):void 0,parent_shared_folder_id:e.parent_shared_folder_id,path_lower:e.path_lower,permissions:null!=e.permissions?t.folderPermissionsApiToRecord(e.permissions):void 0,policy:t.parseFolderPolicy(e.policy),preview_url:e.preview_url,shared_folder_id:e.shared_folder_id,time_invited:null!=e.time_invited?new Date(e.time_invited):void 0,is_confidential:null!=e.is_confidential?e.is_confidential:void 0})},t.listFoldersResultApiToRecord=function(e){return new c.ListFoldersResult({entries:i.Map(e.entries.map(t.folderMetadataApiToRecord).map(function(e){return[e.shared_folder_id,e]})),cursor:e.cursor})},t.filePermissionsApiToRecord=function(e){var t={};if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n];t[i.action[".tag"]]=new c.PermissionSetting({allow:i.allow,reason:i.reason&&i.reason[".tag"]})}return new c.FilePermissions(t)},t.getFilePolicy=function(e){var t={};return t[c.PassPolicy.policy_name]=e.pass_policy&&e.pass_policy[".tag"]||c.PassPolicy.enabled,t[c.DownloadPolicy.policy_name]=e.download_policy&&e.download_policy[".tag"]||c.DownloadPolicy.allow,new c.FilePolicy(t)},t.fileMetadataApiToRecord=function(e){return new c.SharedFileMetadata({access_type:null!=e.access_type?t.accessLevelApiToConst(s.Union.parse(e.access_type)):a.ACCESS_LEVEL.READER,id:e.id,file_policy:t.getFilePolicy(e),link_metadata:e.link_metadata&&t.sharedContentLinkMetadataToRecord(e.link_metadata),name:e.name,owner_team:e.owner_team&&new c.Team(e.owner_team),policy:null!=e.policy?t.parseFolderPolicy(e.policy):new c.FolderPolicy,parent_shared_folder_id:e.parent_shared_folder_id,path_display:e.path_display,path_lower:e.path_lower,permissions:t.filePermissionsApiToRecord(e.permissions),preview_url:e.preview_url,time_invited:e.time_invited&&new Date(e.time_invited)})},t.listFilesResultApiToRecord=function(e){return new c.ListFilesResult({entries:i.Map(e.entries.map(function(e){return[e.id,t.fileMetadataApiToRecord(e)]})),cursor:e.cursor})},t.memberPermissionsApiToRecord=function(e){var t={};if(null!=e)for(var n=0,r=e;n<r.length;n++){var i=r[n];t[i.action[".tag"]]=new c.PermissionSetting({allow:i.allow,reason:i.reason&&i.reason[".tag"]})}return new c.MemberPermissions(t)},t.inviteeMembershipApiToRecord=function(e){var n=e.invitee[".tag"];return new c.InviteeMembershipInfo({access_type:t.accessLevelApiToConst(s.Union.parse(e.access_type)),contact:e.invitee[n],contact_type:n,initials:e.initials,is_inherited:e.is_inherited,permissions:t.memberPermissionsApiToRecord(e.permissions),same_team:Boolean(e.user&&e.user.same_team)})},t.groupMembershipApiToRecord=function(e){return new c.GroupMembershipInfo({access_type:t.accessLevelApiToConst(s.Union.parse(e.access_type)),group_external_id:e.group.group_external_id,group_id:e.group.group_id,group_management_type:t.groupManagementTypeApiToConst(e.group.group_management_type),group_name:e.group.group_name,group_type:e.group.group_type[".tag"],initials:e.initials,is_inherited:e.is_inherited,is_member:e.group.is_member,is_owner:e.group.is_owner,member_count:e.group.member_count,permissions:t.memberPermissionsApiToRecord(e.permissions),same_team:e.group.same_team})},t.userMembershipApiToRecord=function(e){return new c.UserMembershipInfo({access_type:t.accessLevelApiToConst(s.Union.parse(e.access_type)),account_id:e.user.account_id,initials:e.initials,is_inherited:e.is_inherited,permissions:t.memberPermissionsApiToRecord(e.permissions),same_team:e.user.same_team,team_member_id:e.user.team_member_id,time_last_seen:e.time_last_seen&&new Date(e.time_last_seen)})},t.membershipApiToRecord=function(e,n){return void 0===n&&(n=null),new c.SharingMembership({cursor:e.cursor,invitees:i.Map(e.invitees.map(function(e){var n=t.inviteeMembershipApiToRecord(e);return[n.memberKey(),n]})),groups:i.Map(e.groups.map(function(e){var n=t.groupMembershipApiToRecord(e);return[n.memberKey(),n]})),users:i.Map(e.users.map(function(e){var n=t.userMembershipApiToRecord(e);return[n.memberKey(),n]})),memberCount:n})},t.memberCountsApiToRecord=function(e){return new c.MemberCounts(e)},t.parentFolderInfoApiToRecord=function(e){return new c.ParentFolderInfo({name:e.folder_name,shared_folder_id:e.shared_folder_id,path:e.path,permissions:t.memberPermissionsApiToRecord(e.permissions)})},t.memberAccessLevelApiToRecord=function(e,n){if(null==n)return new c.MemberAccessLevelResult;var r;return null!=n.access_details&&(r=n.access_details.map(function(e){return t.parentFolderInfoApiToRecord(e)})),new c.MemberAccessLevelResult({access_level:n.access_level&&t.accessLevelApiToConst(s.Union.parse(n.access_level)),warning:n.warning,parentFolders:r})},t.teamMemberInfoApiToRecord=function(e){return null==e?null:new c.TeamMemberInfo({display_name:e.display_name,member_id:e.member_id,team_info:e.team_info&&new c.Team(e.team_info)})},t.visibilityPolicyApiToRecord=function(e){return new c.LinkVisibilityPolicy({policy:e.policy&&e.policy[".tag"],resolved_policy:e.resolved_policy&&e.resolved_policy[".tag"],allowed:e.allowed,disallowed_reason:e.disallowed_reason&&e.disallowed_reason[".tag"]})},t.linkPermissionsApiToRecord=function(e){
return null==e?new c.LinkPermissions:new c.LinkPermissions({allow_download:e.allow_download,allow_comments:e.allow_comments,can_allow_download:e.can_allow_download,can_disallow_download:e.can_disallow_download,can_revoke:e.can_revoke,can_set_expiry:e.can_set_expiry,can_remove_expiry:e.can_remove_expiry,requested_visibility:e.requested_visibility&&e.requested_visibility[".tag"],resolved_visibility:e.resolved_visibility&&e.resolved_visibility[".tag"],restricting_shared_folder_path:e.restricting_shared_folder_path,revoke_failure_reason:e.revoke_failure_reason&&e.revoke_failure_reason[".tag"],team_restricts_comments:e.team_restricts_comments,visibility_policies:e.visibility_policies&&e.visibility_policies.map(t.visibilityPolicyApiToRecord)})},t.linkMetadataApiToRecord=function(e){return new c.LinkMetadata({url:e.url,client_modified:e.client_modified&&new Date(e.client_modified),content_owner_team_info:e.content_owner_team_info&&new c.Team(e.content_owner_team_info),expires:e.expires&&new Date(e.expires),file_type:e[".tag"],id:e.id,link_permissions:t.linkPermissionsApiToRecord(e.link_permissions),name:e.name,path_lower:e.path_lower,rev:e.rev,server_modified:e.server_modified&&new Date(e.server_modified),size:e.size,team_member_info:t.teamMemberInfoApiToRecord(e.team_member_info),preview_type:e.preview_type})},t.accountInfoApiToRecord=function(e){return new c.BasicAccount({account_id:e.account_id,disabled:e.disabled,display_name:e.name.display_name,email:e.email,email_verified:e.email_verified,familiar_name:e.name.familiar_name,given_name:e.name.given_name,is_teammate:e.is_teammate,profile_photo_url:e.profile_photo_url,surname:e.name.surname,team_member_id:e.team_member_id})},t.teamSharingPoliciesApiToRecord=function(e){return e&&new c.TeamSharingPolicies({shared_folder_member_policy:e.shared_folder_member_policy&&e.shared_folder_member_policy[".tag"],shared_folder_join_policy:e.shared_folder_join_policy&&e.shared_folder_join_policy[".tag"],shared_link_create_policy:e.shared_link_create_policy&&e.shared_link_create_policy[".tag"]})},t.fullAccountApiToRecord=function(e){var n=e.team&&new c.FullTeam({id:e.team.id,name:e.team.name,sharing_policies:t.teamSharingPoliciesApiToRecord(e.team.sharing_policies)});return new c.FullAccount({account_id:e.account_id,disabled:e.disabled,display_name:e.name.display_name,email:e.email,email_verified:e.email_verified,familiar_name:e.name.familiar_name,given_name:e.name.given_name,profile_photo_url:e.profile_photo_url,surname:e.name.surname,team_member_id:e.team_member_id,team:n})},t.sharingPrefsApiToRecord=function(e){return new c.SharingPrefs({add_message_as_comment_checked:e.add_message_as_comment_checked,add_message_as_comment_help_shown:e.add_message_as_comment_help_shown,access_reader_no_comment_content_links:e.access_reader_no_comment_content_links,access_reader_no_comment_shared_folders:e.access_reader_no_comment_shared_folders})},t.makeMemberSelector=function(e){return e.startsWith("email:")?new s.UnionScalar("email",e.substr(6)):new s.UnionScalar("dropbox_id",e)},t.parseSharedLinkMetadata=function(e){if(null==e)return null;var t=s.Union.parse(e.link_permissions.resolved_visibility).type,r=null!=e.team_member_info?{teamId:e.team_member_info.team_info.id,teamName:e.team_member_info.team_info.name}:{teamId:null,teamName:null},i={isFolder:"folder"===e[".tag"],url:e.url,name:e.name,expires:e.expires&&new Date(e.expires),visibility:t,isPackage:e.is_package};return i=n.__assign({},i,r),new l.LinkInfo(i)},t.contactsToMembers=function(e){return e.map(function(e){if(e.type===r.NEW_STYLE_GROUP)return new s.UnionScalar("dropbox_id",e.getContactID());if(e.type!==r.INVALID_ID)return new s.UnionScalar("email",e.getContactID());throw new Error("Unknown contact type")})},t.getCombinedPolicy=function(e,t){return new c.CombinedPolicy({acl_update_policy:e instanceof c.FolderPolicy?e.acl_update_policy:void 0,download_policy:e.download_policy||"allow",member_policy:e instanceof c.FolderPolicy?e.resolved_member_policy:void 0,pass_policy:e.pass_policy,shared_link_policy:e instanceof c.FolderPolicy?e.shared_link_policy:void 0,audience:t&&t.current_audience,access_level:t&&t.access_level,expiry:{status:t&&t.expiry?"on":"off",value:t&&t.expiry||""},password:{status:t&&t.password_protected?"on":"off"}})},t.combinedPolicyDiffToApi=function(e){var t={};if(!e)return t;null!=e.acl_update_policy&&(t.acl_update_policy=e.acl_update_policy),null!=e.download_policy&&(t.download_policy=e.download_policy),null!=e.member_policy&&(t.member_policy=e.member_policy),null!=e.pass_policy&&(t.pass_policy=e.pass_policy),null!=e.shared_link_policy&&(t.shared_link_policy=e.shared_link_policy);var n={};if(null!=e.audience&&(n.audience=new s.UnionScalar(e.audience)),null!=e.access_level&&(n.access_level=new s.UnionScalar(e.access_level)),null!=e.expiry){var r=e.expiry;if("on"===r.status&&r.value)r.value.setHours(23),r.value.setMinutes(59),r.value.setSeconds(59),n.expiry=new s.UnionScalar("set_expiry",s.formatTimestamp(r.value)).toJSON();else{if("off"!==r.status)throw new Error("Bad expiry settings");n.expiry=new s.UnionScalar("remove_expiry").toJSON()}}if(null!=e.password){var i=e.password;"on"===i.status&&i.value?n.password=new s.UnionScalar("set_password",i.value).toJSON():"off"===i.status&&(n.password=new s.UnionScalar("remove_password").toJSON())}return o.keys(n).length>0&&(t.link_settings=n),t}}),define("modules/clean/sharing/link_info",[],function(){var e;return e=(function(){function e(e){this.expires=e.expires,this.isFolder=e.isFolder,this.name=e.name,this.teamId=e.teamId,this.teamName=e.teamName,this.url=e.url,this.visibility=e.visibility,this.isPackage=e.isPackage}return e})(),{LinkInfo:e}}),define("modules/clean/sharing/notifications",["jquery","modules/clean/browse_interface","modules/clean/sharing/api/client","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,r,i,o,s,a){var l,c,u,d,p,_;return c=n.ShareApiClient,l=n.FolderShareApiClient,u=o._,d=function(t){var n,r;return n=e(t).closest("form"),null!=(r=n.closest(".sc-invite-action"))&&r.addClass("loading"),n.length&&new c({userId:n[0]._subject_uid.value}).dismissInviteNotification({contentId:n[0].content_id.value}).finally(function(){return n.closest(".sc-invite-action").removeClass("loading"),n.closest(".feed-row").remove()}),!1},p=function(n){var o,c;return o=e(n),o.closest(".sc-invite-action").addClass("loading"),c=r.get_viewer().get_user_by_id(n._subject_uid.value),new l({userId:c.id}).mount({contentId:n.sf_id.value,origin:"NOTIFICATION_WEB"}).then(function(e){var n,r,l;return n=o.closest(".sc-invite-action"),n.addClass("sf-mounted"),r=e.path_lower,l=a({path:t.get_browse_root(c)+r}).toString(),i.redirect(l),s.success(u("Added the shared folder %(folder_name)s.").format({folder_name:e.name}))}).finally(function(){return o.closest(".sc-invite-action").removeClass("loading")}),!1},_=function(){var e;return s.info(u("Continue upgrading to add the shared folder to your Dropbox.")),e=a({scheme:"https",authority:"www.dropbox.com",path:"/pro/buy"}),e.updateQuery({cont:"sf",oqa:"sf_aoq_b_n"}),i.redirect(e.toString()),!1},{register_dismiss:d,register_mount:p,upgrade_to_mount:_}}),define("modules/clean/sprite",["jquery","modules/core/html","modules/clean/static_urls"],function(e,t,n){var r;return r=n.static_url,{SPACER:r("/static/images/icons/icon_spacer-vflN3BYt2.gif"),CLASS_PREFIX:"s_",_make_class:function(e,t){return this.CLASS_PREFIX+e+"_"+t},src:function(t,n,r){return this.clear(t),e(t).addClass(this._make_class(n,r))},replace:function(t,n,r,i){return e(t).removeClass(this._make_class(n,r)).addClass(this._make_class(n,i))},clear:function(t){var n;return n=t.className.split(" "),n=e.grep(n,(function(e){return function(t){return t&&0!==t.indexOf(e.CLASS_PREFIX)}})(this)),t.className=n.join(" ")},make:function(t,n,r){var i;return r=this._prep_attrs(t,n,r),i=e("<img />",r),i[0]},html:function(e,n,r){var i,o;r=this._prep_attrs(e,n,r),i=["<img "];for(o in r)i.push(o,'="',t._raw_escape(r[o]),'" ');return i.push("/>"),new t(i.join(""))},_prep_attrs:function(e,t,n){var r;return null==n&&(n={}),n.src=n.src||this.SPACER,r=["sprite","sprite_"+e,this._make_class(e,t)],n.class&&r.push(n.class),n.class=r.join(" "),n},_get:function(e){return e.className},_set:function(e,t){return e.className=t,e.src=this.SPACER}}});
//# sourceMappingURL=pkg-maestro-nonpagelet_header.min.js-vfly85cKp.map