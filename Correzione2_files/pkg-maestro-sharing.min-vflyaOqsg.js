define("modules/clean/react/tabs/tabs",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/core/browser"],function(e,t,n,s,r,o,i){var a,l,d,c;return c=s.DOM,a=s.PropTypes,d=s.createClass({displayName:"Tabs",propTypes:{idPrefix:a.string,variant:a.string,selectedIndex:a.number,onChange:a.func,className:a.string},getDefaultProps:function(){return{variant:o.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),{selectedIndex:0,idPrefix:e}},componentWillMount:function(){var t,n,r;return r=[],n=this.state.selectedIndex,t=this.state.idPrefix,s.Children.forEach(this.props.children,function(e,s){var i;if(i=o.getTabContentId(t,s),r.push({label:e.props.title,contentId:i,hashPrefix:e.props.hashPrefix,hashURL:e.props.hashURL,rightAlign:e.props.rightAlign}),e.props.isSelected)return n=s}),this.setState({tabs:r,selectedIndex:n}),e(window).on("hashchange",this._selectTabFromHash)},componentWillReceiveProps:function(e){if(void 0!==e.selectedIndex&&e.selectedIndex!==this.state.selectedIndex)return this.setState({selectedIndex:e.selectedIndex})},componentWillUnmount:function(){return e(window).off("hashchange",this._selectTabFromHash)},componentDidMount:function(){return this._selectTabFromHash()},_onChange:function(e,t){var n;return this.setState({selectedIndex:t}),n=this.state.tabs[t],n.hashURL&&i.set_hash(n.hashURL),this.props.onChange(e,t)},_selectTabFromHash:function(){var e,t,n,s,r,o,a,l,d;if(e=i.get_hash(),null!=e){for(d=this.state.tabs,a=[],s=r=0,o=d.length;r<o;s=++r){if(l=d[s],t=l.hashPrefix,n=l.hashURL,null!=t&&0===(null!=e?e.indexOf(t):void 0)||e===n){this.setState({selectedIndex:s});break}a.push(void 0)}return a}},render:function(){return c.div({className:n(this.props.variant,this.props.className)},s.createElement(r,{tabs:this.state.tabs,onChange:this._onChange,idPrefix:this.state.idPrefix,selectedIndex:this.state.selectedIndex}),s.Children.map(this.props.children,(function(e){return function(t,n){return s.cloneElement(t,{isSelected:n===e.state.selectedIndex,id:o.getTabContentId(e.state.idPrefix,n),tabId:o.getTabId(e.state.idPrefix,n)})}})(this)))}}),l=s.createClass({displayName:"TabContent",propTypes:{id:a.string,isSelected:a.bool,tabId:a.string,hashPrefix:a.string,hashURL:a.string,title:a.string},render:function(){var e;return e={"c-tabs__content":!0,"c-tabs__content--selected":this.props.isSelected},c.div({id:this.props.id,className:n(e),role:"tabpanel","aria-labelledby":this.props.tabId},this.props.children)}}),{Tabs:d,TabContent:l}}),define("modules/clean/react/tabs/tab_bar",["jquery","external/classnames","external/underscore","external/react","external/react-dom","modules/clean/css","modules/clean/keycode","modules/clean/react/tabs/tab_util"],function(e,t,n,s,r,o,i,a){var l,d;return l=i.KeyCode,d=s.PropTypes,s.createClass({displayName:"TabBar",propTypes:{tabs:d.arrayOf(d.oneOfType([d.string,d.number,d.shape({value:d.oneOfType([d.string,d.number]),label:d.string,rightAlign:d.bool})])).isRequired,selectedIndex:d.number,onChange:d.func,idPrefix:d.string},getDefaultProps:function(){return{selectedIndex:0,onChange:function(){}}},componentDidMount:function(){return this._fixTabWidth()},componentDidUpdate:function(){return this._fixTabWidth()},_cleanUpTabWidth:function(){return e("a",r.findDOMNode(this)).css("width","")},_fixTabWidth:function(){return this._cleanUpTabWidth(),e("a",r.findDOMNode(this)).width(function(){return e(this).width()})},_normalizedTabs:function(){return this.props.tabs.map(function(e){return"string"!=typeof e&&"number"!=typeof e||(e={value:e,label:e}),e})},_onKeydown:function(e){var t,n,s,r;if(r=this._normalizedTabs(),t=null,(n=e.keyCode)===l.LEFT||n===l.UP?t=0===this.props.selectedIndex?r.length-1:this.props.selectedIndex-1:(s=e.keyCode)!==l.RIGHT&&s!==l.DOWN||(t=this.props.selectedIndex===r.length-1?0:this.props.selectedIndex+1),null!=t)return e.preventDefault(),this._selectTab(t,{focusOnTab:!0})},_selectTab:function(e,t){var n;if(null==t&&(t={}),n=this._normalizedTabs()[e],this.props.onChange(n.value,e),t.focusOnTab===!0)return r.findDOMNode(this.refs[e]).focus()},_onClick:function(e,t){if(t.preventDefault(),e!==this.props.selectedIndex)return this._selectTab(e,{focusOnTab:!0})},_renderTab:function(e,n,r){var o,i,l,d,c;return i=t({"c-tabs__tab":!0,"c-tabs__tab--selected":n===this.props.selectedIndex,"c-tabs__tab--fr":e.rightAlign,"c-tabs__tab--rightmost":r}),d=n===this.props.selectedIndex,l=e.contentId?e.contentId:d?a.getTabContentId(this.props.idPrefix):"",c=d?"0":"-1",o=s.createElement("a",{href:"#",ref:n,id:a.getTabId(this.props.idPrefix,n),onClick:this._onClick.bind(this,n),onKeyDown:this._onKeydown,role:"tab","aria-selected":d,"aria-controls":l,tabIndex:c,className:"c-tabs__label"},e.label),s.createElement("li",{key:n,className:i,role:"presentation","data-value":e.value},o)},render:function(){var e,t,n,r;return r=this._normalizedTabs(),t=function(){var t,s,o;for(o=[],e=t=0,s=r.length;t<s;e=++t)n=r[e],o.push(this._renderTab(n,e,e===r.length-1));return o}.call(this),s.createElement("ul",{className:"c-tabs__bar",role:"tablist",ref:"tablist"},t)}})}),define("modules/clean/react/tabs/tab_util",[],function(){return{variants:{DEFAULT:"c-tabs",CENTER:"c-tabs c-tabs--center",MINIMAL:"c-tabs c-tabs--minimal",UNDERLINE:"c-tabs--underline",OVERLINE:"c-tabs--overline"},getTabId:function(e,t){return e+"_tab"+(null!=t?t:"")},getTabContentId:function(e,t){return e+"_tabcontent"+(null!=t?t:"")}}}),define("modules/clean/react/tabs/tab_nav",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/css","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/clean/react/tabs/tabs"],function(e,t,n,s,r,o,i,a){var l,d,c,p;return d=a.TabContent,p=s.DOM,l=s.PropTypes,c=s.createClass({displayName:"TabNav",propTypes:{tabs:l.arrayOf(l.oneOfType([l.string,l.number,l.shape({value:l.oneOfType([l.string,l.number]),label:l.string,rightAlign:l.bool})])),defaultSelectedIndex:l.number,onChange:l.func,idPrefix:l.string,variant:l.string,className:l.string},getDefaultProps:function(){return{defaultSelectedIndex:0,variant:i.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){return{selectedIndex:this.props.defaultSelectedIndex}},componentWillReceiveProps:function(e){if(this.props.defaultSelectedIndex!==e.defaultSelectedIndex)return this.setState({selectedIndex:e.defaultSelectedIndex})},_onChange:function(e,t){return this.props.onChange(e,t),this.setState({selectedIndex:t})},render:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),p.div({className:n(this.props.variant,this.props.className)},s.createElement(o,{tabs:this.props.tabs,onChange:this._onChange,idPrefix:e,selectedIndex:this.state.selectedIndex}),s.createElement(d,{isSelected:!0,id:i.getTabContentId(e),tabId:i.getTabId(e,this.state.selectedIndex)},this.props.children))}}),r(c,["/static/css/components/tabs-vflVBuar6.css"])});var hasProp={}.hasOwnProperty;define("modules/clean/flux/store_listener",["external/react"],function(e){var t;return t=function(t,n,s){var r;return e.createClass({displayName:"StoreListener("+(null!=(r=t.displayName)?r:"Unknown")+")",getInitialState:function(){return{childProps:s(this.props,n)}},componentDidMount:function(){var e,t;for(t in n)hasProp.call(n,t)&&(e=n[t],e.add_change_listener(this._handleStoreChanged));return this.setState({childProps:s(this.props,n)})},componentWillUnmount:function(){var e,t,s;e=[];for(s in n)hasProp.call(n,s)&&(t=n[s],e.push(t.remove_change_listener(this._handleStoreChanged)));return e},render:function(){var n,s,r,o;n={ref:"wrapped"},r=this.state.childProps;for(s in r)hasProp.call(r,s)&&(o=r[s],n[s]=o);return e.createElement(t,n,this.props.children)},getWrappedComponent:function(){return this.refs.wrapped},getStores:function(){return n},_handleStoreChanged:function(){var e;if(this.isMounted()&&(e=s(this.props,n),null!=e))return this.setState({childProps:e})}})},{listenToStores:t}}),define("modules/clean/avatar/triple_avatars",["external/react","modules/clean/ajax","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l){var d,c,p,u,h;return d=o.AVATAR_DIMENSION_BY_SIZE,u=e.createElement,h=e.DOM,p=e.createClass({displayName:"TripleAvatars",getPropTypes:function(){return{contacts:e.PropTypes.arrayOf(e.PropTypes.shape({email:e.PropTypes.string,display_name:e.PropTypes.string,photo_url:e.PropTypes.string})),count:e.PropTypes.integer}},getAvatar:function(e){return u(n,{dimension:d.XLARGE,photoUrl:e.photo_url,defaultAvatar:u(s,{dimension:d.XLARGE,shape:"CIRCLE",initials:l.getInitials(e.display_name),name:e.display_name})})},render:function(){var e;return this.props.contacts&&0!==this.props.contacts.length?(e=this.props.contacts.length,this.props.count&&this.props.count>this.props.contacts.length&&(e=this.props.count),h.div({className:"triple-avatars-section"},this.getAvatar(this.props.contacts[0]),this.props.contacts.length>1?this.getAvatar(this.props.contacts[1]):void 0,3===e?this.getAvatar(this.props.contacts[2]):e>3?u(r,{dimension:d.XLARGE,count:e-2}):void 0)):h.div({})}}),c=i(p,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]),{TripleAvatars:c}}),define("modules/clean/react/bubble",["external/react","external/underscore","modules/clean/css"],function(e,t,n){var s,r;return r=e.DOM,s={TOP:"top",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",RIGHT:"right",RIGHT_TOP:"right-top",RIGHT_BOTTOM:"right-bottom",LEFT:"left",LEFT_TOP:"left-top",LEFT_BOTTOM:"left-bottom"},e.createClass({displayName:"Bubble",statics:{ARROW:s},propTypes:{arrow:e.PropTypes.oneOf(t.values(s)),className:e.PropTypes.string},getDefaultProps:function(){return{arrow:null,className:""}},componentWillMount:function(){if("undefined"!=typeof window&&null!==window)return n.require_css("/static/css/react/bubble_box-vflhusCtq.css")},render:function(){var e,n;return e=["react-bubble-box","react-bubble-box--arrow-"+this.props.arrow,this.props.className],n=t.extend({},t.omit(this.props,["arrow","className"]),{className:e.join(" ")}),r.div(n,this._renderArrow(),this.props.children)},_renderArrow:function(){return null!=this.props.arrow?[r.div({className:"react-bubble-box__arrow-border",key:"arrow-border"}),r.div({className:"react-bubble-box__arrow",key:"arrow"})]:[]}})}),define("modules/clean/clipboard",["jquery","modules/clean/static_urls","modules/core/dom","external/swfobject"],function(e,t,n,s){var r,o,i,a,l;return l=t.static_url,o=function(){var e,t;return e=(new Date).getTime(),t=("00000"+Math.floor(1e6*Math.random())).slice(-6),"swf_"+e+"_"+t},i=function(e,t){return e.on("mouseover",function(){return t.addClass("hovered")}),e.on("mousedown",function(){return t.addClass("pressed")}),e.on("mouseout",function(){return t.removeClass("hovered pressed")}),e.on("mouseup",function(){return t.removeClass("pressed")})},a=function(e,t){return window.ClipboardSWFRegister=window.ClipboardSWFRegister||{},window.ClipboardSWFRegister[e]=function(){return t()},"ClipboardSWFRegister."+e},r=function(t,r,d,c){var p,u,h;return null==d&&(d=null),null==c&&(c=null),c=c||e(document.body),h=o(),p=e("<div />",{id:"flash_copy_container"}).append(e("<div />",{id:h})).css({position:"absolute",zIndex:1}),i(p,r),c.append(p),n.clone_position(p,r,{}),u=a(h,d),window.copyLoaded=(function(n){return function(){var n;return n=e("#"+h)[0],n.setCopyText(t),n.setCallbackFunction(u)}})(this),s.embedSWF(l("/static/swf/copy_clipboard-vflvMcZTC.swf"),h,"100%","100%","6.0.65",!1,!1,{wmode:"transparent",scale:"exactfit",allowScriptAccess:"always"}),p},{clipboard_overlay:r}});var bind=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/clipboard_v2",["jquery","external/flash_detect","external/react","modules/core/browser","modules/core/exception","modules/clean/clipboard"],function(e,t,n,s,r,o){return r.assert,(function(){function n(e,t,n,s){this.copyText=e,this.onSuccess=t,this.onError=n,this.clickHandler=s,this.do_copy=bind(this.do_copy,this)}return n.prototype.setupCopy=function(t,s){var r,i,a;if(r=e(s),i=e(t),!n.is_flashless_clipboard_supported())return a=(function(e){return function(){return"function"==typeof e.onSuccess&&e.onSuccess(),"function"==typeof e.clickHandler?e.clickHandler():void 0}})(this),o.clipboard_overlay(this.copyText,i,a,r)},n.prototype.do_copy=function(){var e;if(n.is_supported())return n.is_flashless_clipboard_supported()?(e=document.execCommand("copy",!1),e?"function"==typeof this.onSuccess?this.onSuccess():void 0:"function"==typeof this.onError?this.onError():void 0):void 0},n.is_supported=function(){return n.is_flashless_clipboard_supported()||t.installed},n.is_flashless_clipboard_supported=function(){var e;return e=parseInt(s.version),s.chrome?e>=42:s.mozilla?e>=41:s.opera?e>=29:s.msie?e>=9:!!s.edge||!!s.safari&&e>=10},n})()}),define("modules/clean/file_events",[],function(){return{DELETE:"db:bulk_delete",COPY:"db:bulk_copy",MOVE:"db:bulk_move",RENAME:"db:bulk_rename",PURGE:"db:bulk_purge",RESTORE:"db:bulk_restore",UPLOAD:"db:upload",COMPRESS:"db:compress",SF_NEW:"db:sf_new",SF_LEAVE:"db:sf_leave",SF_UNSHARE:"db:sf_unshare",SF_ADD_TO_DROPBOX:"db:sf_add_to_dropbox",SF_INVITE:"db:sf_invite",SF_IGNORE:"db:sf_ignore",LINKS_REMOVE:"db:link_remove",LINKS_ADD:"db:link_add",FILE_ACTIVITY_UPDATE:"db:file_activity_update"}}),define("modules/clean/growth/experiments/logger",["modules/clean/ajax"],function(e){return(function(){function t(){}var n,s;return t.start_times={},t.DEFAULT_TIMER_NAME="view_time",t.get_timer_name=function(e){return null==e||"boolean"==typeof e?t.DEFAULT_TIMER_NAME:e},t.set_start_time=function(e){var n;return n=t.get_timer_name(e),t.start_times[n]=Date.now()},t.do_log_view_time=function(e,n){var s;return s=t.get_timer_name(n),e[s]=Math.round((Date.now()-t.start_times[s])/1e3)},s={},n=[5,15,60,120,300],t.start_counter=function(e,t){var r,o,i,a;for(i=[],r=0,o=n.length;r<o;r++)a=n[r],i.push((function(n){return s[e+n]=setTimeout(function(){return t(e,{time_since_first_view:n})},1e3*n)})(a));return i},t.stop_counter=function(e){var t,r,o,i;for(o=[],t=0,r=n.length;t<r;t++)i=n[t],o.push(clearTimeout(s[e+i]));return o},t.log=function(n,s,r,o){switch(null==o&&(o=!1),r=r||{},n){case"paywall_device_limit":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_paywall_device_limit_log",data:{evt:s,extra:JSON.stringify(r)}});case"paywall_shared_folder":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_paywall_shared_folder_log",data:{evt:s,extra:JSON.stringify(r)}});case"onboarding":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_onboarding_log",data:{evt:s,extra:JSON.stringify(r)}});case"sharing":return t.do_log_view_time(r),e.SilentBackgroundRequest({url:"/growth_sharing_log",data:{evt:s,extra:JSON.stringify(r)}});case"post_client_install_tab":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_post_client_install_tab_log",data:{evt:s,extra:JSON.stringify(r)}});case"secondary_client_link":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/secondary_client_link_upsell_log",data:{evt:s,extra:JSON.stringify(r)}});case"biz_trial_onboarding":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/biz_trial_onboarding_log",data:{evt:s,extra:JSON.stringify(r)}});default:throw new Error("Invalid series name")}},t})()}),define("modules/clean/growth/experiments/manage_shared_folders_modal",["external/classnames","external/react","external/underscore","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/list","modules/clean/avatar/size","modules/clean/datetime","modules/clean/flux/store_mixin","modules/clean/growth/experiments/sharing_paywall_actions_store","modules/clean/react/css","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react/title_bubble","modules/clean/sharing/member_avatars","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g){var y,b,v,S,I,w,C,E,P,T,N,M,k;return y=i.AVATAR_DIMENSION_BY_SIZE,S=d.ManageSharedFoldersStore,b=d.ManageSharedFoldersActionHandler,w=d.PAGES,N=p.reactFormat,I=u.Modal,M=f.i18n_default_project("growth-exps"),C=M._,k=M.ungettext,P=t.createElement,T=t.DOM,E=t.createClass({displayName:"ManageSharedFoldersModal",propTypes:{maxOwned:t.PropTypes.number.isRequired,numOwned:t.PropTypes.number.isRequired,user:t.PropTypes.object.isRequired,onUnshare:t.PropTypes.func.isRequired},mixins:[l(S)],_get_state_from_stores:function(){return{areFoldersLoaded:S.areFoldersLoaded(),currentPage:S.currentPage(),keepACopy:S.keepACopy(),ownedFolders:S.ownedFolders(),selectedFolderIds:S.selectedFolderIds(),isMembershipLoaded:S.membershipLoaded(),membershipInfoById:S.membershipInfo()}},componentWillMount:function(){return b.initFromProps(this.props),b.fetchOwnedSharedFolders(),b.fetchMembershipData(this.props.user),b.changePage(w.MANAGE_SHARED_FOLDERS)},_handleSelectFolder:function(e){if(this.state.currentPage===w.MANAGE_SHARED_FOLDERS)return this.state.selectedFolderIds.contains(e)?b.unselectFolder(e):b.selectFolder(e)},_handleContinueClick:function(){return b.changePage(w.CONFIRM_UNSHARE)},_handleKeepACopyClick:function(){var e;return e=Boolean(!this.state.keepACopy),b.keepACopy(e)},_handleCancelClick:function(){return b.resetAndCloseModal()},_handleUnshareClick:function(){return b.unshareFoldersSelected(this.state.selectedFolderIds),this.props.onUnshare(this.state.selectedFolderIds,this.state.keepACopy)},_handleUpgradeClick:function(){return b.clickUpgrade()},_renderKeepACopy:function(){var n,s;return s=this.state.keepACopy,n=e({manage_shared_folders_modal__table_checkbox:!0,checked:s}),t.createElement("tr",null,t.createElement("td",{className:"manage_shared_folders_modal__table_keep",colSpan:"2"},t.createElement("button",{role:"checkbox",className:n,onClick:this._handleKeepACopyClick,"aria-checked":s}),t.createElement("div",null,C("Let members keep a copy"))))},_renderFolderTable:function(){var e,s,r;return this.state.areFoldersLoaded?(this.state.currentPage===w.MANAGE_SHARED_FOLDERS?e=this.state.ownedFolders:(e=n.filter(this.state.ownedFolders,(function(e){return function(t){return e.state.selectedFolderIds.contains(t.id)}})(this)),r=this._renderKeepACopy()),e.sort((function(e){return function(e,t){return e.last_active<t.last_active}})(this)),s=e.map((function(e){return function(t){return e._renderFolderRow(t)}})(this))):s=t.createElement("tr",{className:"manage_shared_folders_modal__table_row"},t.createElement("th",{className:"manage_shared_folders_modal__table_loader"},t.createElement("div",{className:"c-loader"},"Loading..."))),t.createElement("table",{className:"manage_shared_folders_modal__table"},t.createElement("tbody",null,t.createElement("thead",null,t.createElement("tr",{className:"manage_shared_folders_modal__table_header"},t.createElement("th",{className:"manage_shared_folders_modal__table_header_item"},C("Shared folders you own")),t.createElement("th",{className:"manage_shared_folders_modal__table_header_item"},C("Shared with")))),t.createElement("tbody",{className:"manage_shared_folders_modal__table_rows"},s),t.createElement("tfoot",null,r)))},_renderFolderRow:function(n){var s,r,i,l,d,c,p,u,m,_,f;return s=null,u=null,f=e({manage_shared_folders_modal__table_row:!0}),this.state.currentPage===w.MANAGE_SHARED_FOLDERS&&(c=this.state.selectedFolderIds.contains(n.id),f=e({manage_shared_folders_modal__table_row:!0,"manage_shared_folders_modal__table_row--selected":c}),r=e({manage_shared_folders_modal__table_checkbox:!0,"manage_shared_folders_modal__folders_row--selected":c,checked:c}),s=t.createElement("button",{role:"checkbox",className:r,"aria-checked":c}),u=a.ago(new Date(n.last_active))),_=e({remove_icon:!0,hidden:!c&&this.state.currentPage!==w.CONFIRM_UNSHARE}),l=t.createElement("div",{className:"manage_shared_folders_modal__table_info"},t.createElement("div",{className:"manage_shared_folders_modal__table_name"},n.name),t.createElement("div",{className:"manage_shared_folders_modal__table_date"},u)),i="--",this.state.isMembershipLoaded&&this.state.membershipInfoById[n.id]&&(m=this.state.membershipInfoById[n.id],p=m.joinedMembers.map((function(e){return function(t){return e._renderAvatar(t.display_name,t.initials,t.photo_url)}})(this)),d=m.invitations.map((function(e){return function(t){return e._renderAvatar(t.email_or_fbname,g.getInitials(t.email_or_fbname))}})(this)),i=P(o,{avatars:p.concat(d),avatarDimension:y.SMALL,maxVisible:7,undisplayableCount:m.numUndisplayableUsersAndInvites})),t.createElement("tr",{className:f,onClick:(function(e){return function(){return e._handleSelectFolder(n.id)}})(this)},t.createElement("td",{className:"manage_shared_folders_modal__table_options"},s,t.createElement("div",{className:"manage_shared_folders_modal__table_icon"},t.createElement(h,{alt:"",group:"web",name:"folder_user_32"}),t.createElement("img",{className:_,width:"16",height:"16",src:"/static/images/growth/experiments/icon-remove-lrg-vflSBVc6s.svg"})),l),t.createElement("td",{className:"manage_shared_folders_modal__table_shared"},i))},_renderAvatar:function(e,t,n){var o,i;return o=C("Shared with %(name)s").format({name:e}),i={alt:o,dimension:y.SMALL,photoUrl:n,defaultAvatar:P(r,{dimension:y.SMALL,alt:o,name:e,initials:t,shape:"CIRCLE"})},this._renderTitleBubble(P(s,i),o)},_renderTitleBubble:function(e,t){return P(m,{content:t,position:m.POSITIONS.BOTTOM,isTargetPositionFixed:!0},e)},_renderUpgradeText:function(){return t.createElement("div",{className:"manage_shared_folders_modal__footer"},N(C("To keep sharing all these folders, <button>upgrade your plan</button>."),{button:t.createElement("button",{className:"button-as-link",onClick:this._handleUpgradeClick})}))},render:function(){var e,t,n,s,r;switch(this.state.currentPage){case w.MANAGE_SHARED_FOLDERS:s=this.props.numOwned-this.props.maxOwned+1,r=k("Unshare at least %(num)s folder","Unshare at least %(num)s folders",s).format({num:s}),n="Next",e=this._handleContinueClick,t=Boolean(s-this.state.selectedFolderIds.size>0);break;case w.CONFIRM_UNSHARE:s=this.state.selectedFolderIds.size,r=k("Unshare this folder?","Unshare these %(num)s folders?",s).format({num:s}),n="Unshare",e=this._handleUnshareClick,t=!1}return P(I,{autoClose:!1,className:"manage_shared_folders_modal",title:r,acceptButtonText:n,onAccept:e,acceptButtonDisabled:t,dismissButtonText:"Cancel",onDismiss:this._handleCancelClick,clickOutToClose:!1,showX:!0},T.div({className:"manage_shared_folders_modal__header"},C("Unshared folders will stay in your Dropbox, but all members will be removed.")),T.div({className:"manage_shared_folders_modal__content"},this._renderFolderTable(),this._renderUpgradeText()))}}),v=c(E,["/static/css/growth/experiments/sharing_paywall_modals-vfl5S3mYn.css"]),{ManageSharedFoldersModal:v}}),define("modules/clean/growth/experiments/shared_folder_paywall_view",["external/react","modules/clean/react_format","modules/clean/react/image","modules/clean/sharing/actions/share_modal","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o){var i,a,l;return a=t.reactFormat,l=r.static_url,i=o.i18n_default_project("growth-exps")._,e.createElement,e.DOM,e.createClass({displayName:"SharedFolderPaywall",propTypes:{actionHandler:e.PropTypes.instanceOf(s).isRequired,maxOwned:e.PropTypes.number.isRequired,numOwned:e.PropTypes.number.isRequired,onLearnMoreClick:e.PropTypes.func.isRequired,onUpgradeClick:e.PropTypes.func.isRequired,onManageClick:e.PropTypes.func.isRequired},_handleAndLogManageSharedFoldersClick:function(){return this.props.actionHandler.logPaywallEvent("click_manage_shared_folders_from_paywall"),this.props.onManageClick()},_handleAndLogUpgradeClick:function(){return this.props.actionHandler.logPaywallEvent("click_upgrade_from_paywall"),this.props.onUpgradeClick()},render:function(){return e.createElement("div",{className:"paywall-blocker unified-share-modal__no-permission u-pad-l u-pad-bottom-l"},e.createElement(n,{className:"paywall-blocker__image u-mar-bottom-s",src:l("/static/images/sharing/db_shared_folder-vflK0RLgD.png"),srcHiRes:l("/static/images/sharing/db_shared_folder@2x-vflEd6s7Z.png")}),e.createElement("div",{className:"paywall-blocker__infotext"},i("You own %(folder_count)s shared folders (max is %(max)s).").format({folder_count:this.props.numOwned,max:this.props.maxOwned})),e.createElement("button",{className:"c-btn c-btn--primary u-mar-bottom-s",onClick:this._handleAndLogUpgradeClick},i("Upgrade for unlimited sharing")),e.createElement("div",null,a(i("<manage>Manage your shared folders</manage> or <learn>learn more</learn>"),{manage:e.createElement("button",{className:"paywall-blocker__link button-as-link",onClick:this._handleAndLogManageSharedFoldersClick}),learn:e.createElement("button",{className:"paywall-blocker__link button-as-link",onClick:this.props.onLearnMoreClick})})))}})});var extend=function(e,t){function n(){this.constructor=e}for(var s in t)hasProp.call(t,s)&&(e[s]=t[s]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/growth/experiments/sharing_paywall_actions_store",["external/immutable","external/react","external/underscore","modules/clean/api_v2/root_aware_client","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/growth/experiments/logger","modules/clean/sharing/api/client","modules/clean/ajax","modules/core/browser"],function(e,t,n,s,r,o,i,a,l,d){var c,p,u,h,m,_,f,g,y;return e.OrderedSet,y=e.Set,c=s.ApiV2RootAwareClient,p=a.FolderShareApiClient,f={MANAGE_SHARED_FOLDERS:"MANAGE_SHARED_FOLDERS",CONFIRM_UNSHARE:"CONFIRM_UNSHARE"},u=7,m={FETCH_OWNED_SF_REQUEST:"FETCH_OWNED_SF_REQUEST",FETCH_OWNED_SF_SUCCESS:"FETCH_OWNED_SF_SUCCESS",CHANGE_PAGE:"CHANGE_PAGE",SELECT_FOLDER:"SELECT_FOLDER",FETCH_MEMBERSHIP_REQUEST:"FETCH_MEMBERSHIP_REQUEST",FETCH_MEMBERSHIP_SUCCESS:"FETCH_MEMBERSHIP_SUCCESS",UNSELECT_FOLDER:"UNSELECT_FOLDER",UNSHARE_FOLDERS:"UNSHARE_FOLDERS",CLICK_UPGRADE:"CLICK_UPGRADE",TOGGLE_KEEP_A_COPY:"TOGGLE_KEEP_A_COPY",CLOSE_MODAL:"CLOSE_MODAL"},g="paywall_shared_folder",h=(function(){function e(){}return e.initFromProps=function(e){return this._client=new p({userId:e.user.id,client:new c})},e.fetchOwnedSharedFolders=function(){return o.dispatch({type:m.FETCH_OWNED_SF_REQUEST}),this._client.getOwnedSharedFolders().then(function(e){return o.dispatch({type:m.FETCH_OWNED_SF_SUCCESS,data:e})})},e.fetchMembershipData=function(e){return o.dispatch({type:m.FETCH_MEMBERSHIP_REQUEST}),l.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:e,data:{max_results:u,fq_path_prefix:"",include_inherited:!1},success:function(e){return o.dispatch({type:m.FETCH_MEMBERSHIP_SUCCESS,data:e})}})},e.changePage=function(e){return o.dispatch({type:m.CHANGE_PAGE,data:e})},e.selectFolder=function(e){return o.dispatch({type:m.SELECT_FOLDER,data:e})},e.unselectFolder=function(e){return o.dispatch({type:m.UNSELECT_FOLDER,data:e})},e.unshareFoldersSelected=function(e){return o.dispatch({type:m.UNSHARE_FOLDERS,data:e})},e.clickUpgrade=function(){return o.dispatch({type:m.CLICK_UPGRADE})},e.keepACopy=function(e){return o.dispatch({type:m.TOGGLE_KEEP_A_COPY,data:e})},e.resetAndCloseModal=function(){return o.dispatch({type:m.CLOSE_MODAL})},e})(),_=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t.prototype._init=function(){return this._selectedFolderIds=y(),this._keepACopy=!0,this._currentPage=f.MANAGE_SHARED_FOLDERS},t.prototype._clear=function(){return this._selectedFolderIds=y(),this._keepACopy=!0,this._currentPage=f.MANAGE_SHARED_FOLDERS},t.prototype._setOwnedSharedFolders=function(e){return this._ownedFolders=e,this.emit_change()},t.prototype._setFoldersLoaded=function(e){return this._areFoldersLoaded=e,this.emit_change()},t.prototype._setCurrentPage=function(e){return this._currentPage=e,this.emit_change()},t.prototype._setMembershipList=function(e){var t,n,s,r,o,i,a;for(s=this._ownedFolders.map(function(e){return e.id}),a={},t=0,n=e.length;t<n;t++)i=e[t],o=i.ns_id,indexOf.call(s,o)>=0&&(r={numUndisplayableUsersAndInvites:i.num_avatars_not_shown,groups:i.groups,invitations:i.invitations,joinedMembers:i.joined_members,audienceDescription:i.audience_description},a[i.ns_id]=r);return this._membershipInfoById=a,this.emit_change()},t.prototype._setMembershipLoaded=function(e){return this._membershipLoaded=e,this.emit_change()},t.prototype._selectFolderId=function(e){return this._selectedFolderIds=this._selectedFolderIds.add(e),this.emit_change()},t.prototype._unselectFolderId=function(e){return this._selectedFolderIds=this._selectedFolderIds.delete(e),this.emit_change()},t.prototype._setKeepACopy=function(e){return this._keepACopy=e,this.emit_change()},t.prototype._logPaywallEvent=function(e,t){return t=t||{},t.num_folders_owned=this._ownedFolders.length,i.log(g,e,t)},t.prototype._logUnshareAction=function(){return this._logPaywallEvent("click_unshare",{num_folders_to_unshare:this._selectedFolderIds.size})},t.prototype._logUpgradeClick=function(){this._currentPage===f.MANAGE_SHARED_FOLDERS?this._logPaywallEvent("click_upgrade_from_manage_folders"):this._logPaywallEvent("click_upgrade_from_confirm_unshare")},t.prototype.ownedFolders=function(){return this._ownedFolders},t.prototype.areFoldersLoaded=function(){return this._areFoldersLoaded},t.prototype.currentPage=function(){return this._currentPage},t.prototype.membershipInfo=function(){return this._membershipInfoById},t.prototype.membershipLoaded=function(){return this._membershipLoaded},t.prototype.selectedFolderIds=function(){return this._selectedFolderIds},t.prototype.keepACopy=function(){return this._keepACopy},t.prototype._new_payload=function(e){var t;switch(t=e.action.data,e.action.type){case m.CHANGE_PAGE:return t===f.CONFIRM_UNSHARE&&this._logPaywallEvent("view_confirm_unshare_modal"),this._setCurrentPage(t);case m.CLICK_UPGRADE:return this._logUpgradeClick(),d.redirect("/upgrade?oqa=spw");case m.CLOSE_MODAL:return this._clear();case m.FETCH_MEMBERSHIP_REQUEST:return this._setMembershipLoaded(!1);case m.FETCH_MEMBERSHIP_SUCCESS:return this._setMembershipList(t),this._setMembershipLoaded(!0);case m.FETCH_OWNED_SF_REQUEST:return this._setFoldersLoaded(!1);case m.FETCH_OWNED_SF_SUCCESS:return this._setOwnedSharedFolders(t.entries),this._setFoldersLoaded(!0);case m.SELECT_FOLDER:return this._selectFolderId(t);case m.TOGGLE_KEEP_A_COPY:return this._setKeepACopy(t);case m.UNSELECT_FOLDER:return this._unselectFolderId(t);case m.UNSHARE_FOLDERS:return this._logUnshareAction(),this._clear()}},t})(r),{ManageSharedFoldersStore:new _,ManageSharedFoldersActionHandler:h,PAGES:f,PAYWALL_SERIES_LOGGING_NAME:g}}),define("modules/clean/growth/experiments/sharing_paywall_info_modal",["external/classnames","external/react","modules/clean/react_format","modules/clean/react/button","modules/clean/react/css","modules/clean/react/modal","modules/clean/sharing/actions/share_modal","modules/clean/viewer","modules/core/browser","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d){var c,p,u,h,m,_,f,g;return g=n.reactFormat,c=s.Button,p=o.Modal,h=d._,_=t.createElement,f=t.DOM,a.get_viewer(),m=t.createClass({displayName:"SharingPaywallInfoModal",propTypes:function(){return{actionHandler:t.PropTypes.instanceOf(i).isRequired,sharedFolderCount:t.PropTypes.number,grandfather:t.PropTypes.boolean,onDismiss:t.PropTypes.func,onManage:t.PropTypes.func}},_handleAndLogLearnMoreClick:function(){
return this.props.actionHandler.logPaywallEvent("click_learn_more_from_grandfathered_notice"),this.navigateToHelpCenterArticle()},_handleAndLogNotNowClick:function(){return this.props.actionHandler.logPaywallEvent("click_not_now_from_grandfathered_notice"),this.props.onDismiss()},_handleAndLogManageSharedFoldersClick:function(){return this.props.actionHandler.logPaywallEvent("click_manage_shared_folders_from_grandfathered_notice"),this.props.onManage()},_handleAndLogUpgradeClick:function(){return this.props.grandfather?this.props.actionHandler.logPaywallEvent("click_upgrade_from_grandfathered_notice"):this.props.actionHandler.logPaywallEvent("click_upgrade_from_learn_more"),this.navigateToUpgradePage()},render:function(){var n;return n=e({"sharing-paywall-info-modal":!0,"sharing-paywall-grandfather":this.props.grandfather}),t.createElement(p,{className:n,buttonComponent:this.renderButtons(),style:"clean"},f.div({className:"sharing-paywall-info-modal__content"},f.img({src:"/static/images/sharing/db_shared_folder-vflK0RLgD.png",className:"sharing-paywall-info-modal__content_image"}),f.div({className:"sharing-paywall-info-modal__content_header"},this.getHeader()),f.div({className:"sharing-paywall-info-modal__content_subheader"},this.getSubheader())))},renderButtons:function(){return this.props.grandfather?f.div({className:"db-modal-buttons"},f.div({},_(c,{key:"primary",className:"dbmodal-button",importance:"primary",disabled:!1,onClick:this._handleAndLogUpgradeClick},h("Upgrade your Dropbox")),_(c,{key:"tertiary",className:"dbmodal-button",importance:"tertiary",disabled:!1,onClick:this._handleAndLogNotNowClick},h("Not now"))),f.div({},f.button({className:"button-as-link",onClick:this._handleAndLogManageSharedFoldersClick},h("Manage your shared folders")))):f.div({className:"db-modal-buttons"},_(c,{key:"primary",className:"dbmodal-button",importance:"primary",disabled:!1,onClick:this._handleAndLogUpgradeClick},h("Upgrade for unlimited sharing")))},getHeader:function(){return h(this.props.grandfather?"Shared folder limits have changed":"You can own 5 shared folders at a time")},getSubheader:function(){return this.props.grandfather?f.span({},f.div({},h("Now you can only own 5 shared folders with Dropbox Basic. Since you have  %(count)s, you’ll need to unshare some folders or upgrade.").format({count:this.props.sharedFolderCount}),g(h(" <learn>Learn more</learn>"),{learn:f.button({className:"button-as-link inline-link",onClick:this._handleAndLogLearnMoreClick})}))):f.span({},f.div({},h("Creating and sharing a folder makes you the owner, which gives you more  control over who can access it. Folders people have shared with you don’t  count towards your 5-folder limit.")))},navigateToHelpCenterArticle:function(){return l.open_tab("/help/9264")},navigateToUpgradePage:function(){return l.redirect("/upgrade?oqa=spw")}}),u=r(m,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/growth/experiments/sharing_paywall_info_modal-vflke5gnX.css"]),{SharingPaywallInfoModal:u}});var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/preview_sf_members",["jquery","external/classnames","external/react","external/react-dom","external/underscore","modules/clean/ajax","modules/clean/analytics","modules/clean/avatar/photo_avatar","modules/clean/avatar/size","modules/clean/components/loading_indicator","modules/clean/components/title_bubble","modules/clean/em_string","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/css","modules/clean/react/flag","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/member_avatars","modules/clean/static_urls","modules/clean/sharing/action_types","modules/clean/sharing/api","modules/clean/sharing/share_modal_util","modules/clean/sharing/ui_util","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T,N,M,k){var A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X,J,Z;return H=i.SharedFolderActivityLogger,i.TeamsWebActionsLogger,x=l.AVATAR_DIMENSION_BY_SIZE,V=m.SharedWithActionTypes,L=_.BrowseContext,_.QuotaStats,b.Modal,Q=S.reactFormat,J=w.static_url,B=C.ShareModalActionTypes,G=E.SharingApi,X=P.showShareModal,O=T.GoldenGate,K=M._,Z=M.ungettext,z=n.createElement,j=n.DOM,D=15,R=10,F=x.MEDIUM,W="south",A=!0,U=n.createClass({displayName:"PreviewSFMembersPanel",propTypes:{context:n.PropTypes.instanceOf(L).isRequired,user:n.PropTypes.object.isRequired,viewer:n.PropTypes.instanceOf(N),isMaestroDesign:n.PropTypes.bool},getInitialState:function(){return{firstMemberRender:!0,hasPendingRequest:!0,sharedFolderData:{},sharedLinkData:void 0}},getDefaultProps:function(){return{viewer:N.get_viewer(),isMaestroDesign:!1}},componentDidMount:function(){return this._fetchSharedFolderData(),this._log_event("preview_sf_members_shown"),e(document).on(G.REQUEST_SUCCEEDED_EVENT,this._sharing_api_request_handler),this._dispatchToken=h.register(this.onEventDispatched)},componentWillUnmount:function(){var t,n;if(null!=(t=this._currentSFDataRequest)&&t.abort(),null!=(n=this._currentLinkDataRequest)&&n.abort(),e(document).off(G.REQUEST_SUCCEEDED_EVENT,this._sharing_api_request_handler),this._dispatchToken)return h.unregister(this._dispatchToken)},componentDidUpdate:function(e,t){var n,s;if((null!=(n=e.context)?n.currentFQPath:void 0)!==(null!=(s=this.props.context)?s.currentFQPath:void 0)&&(this._fetchSharedFolderData(),this._log_event("preview_sf_members_shown")),t.firstMemberRender&&!t.hasPendingRequest&&(!r.isEmpty(t.sharedFolderData)||null!=t.sharedLinkData))return this.setState({firstMemberRender:!1})},onEventDispatched:function(e){var t,n,s,r,o;return t=null!=e&&null!=(s=e.action)?s.type:void 0,r=[V.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,V.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,V.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE],t&&indexOf.call(r,t)>=0?this._fetchSharedFolderData():t&&t===B.FETCH_LINK_METADATA_SUCCESS&&(n=this.props.context.currentNSPath?this.props.context.currentFQPath:this.props.context.currentNSID,o=this.props.user.id+":"+n,e.action.sharingKey===o)?this._fetchSharedLinkData():void 0},_canShareAsNestedSharedFolder:function(){return this.props.context.currentNSPath&&this.props.context.currentNSAllowsNesting},_isViewingTeamRootFolder:function(){return this.props.context.isInsideAutoTeamFolder&&"/"===u.parent_dir(this.props.context.currentFQPath)},_isViewingLimitedTeamRootFolder:function(){return this._isViewingTeamRootFolder()&&this.props.viewer.team_is_limited},_sharing_api_request_handler:function(e,t){var n;if(n=t.request_url,!(n.indexOf("/share_ajax/leave")>-1)&&this.props.context.isInFolderMode&&t.ns_id===this.props.context.currentNSID)return this._fetchSharedFolderData()},_getMaxVisibleAvatars:function(){return O.hasNewMembershipUI(this.props.user.id)?R:D},_fetchSharedFolderData:function(){return this._fetchSharedFolderMembers(),this._fetchSharedLinkData(),this._setHasPendingRequest()},_fetchSharedFolderMembers:function(){var e;if(this.props.context.currentMountPoint)return e="/share_ajax/preview_members/"+this.props.context.currentNSID,this._currentSFDataRequest=o.WebRequest({url:e,subject_user:this.props.user,data:{max_results:this._getMaxVisibleAvatars(),sort_by_name:O.hasNewMembershipUI(this.props.user.id)},success:(function(e){return function(t){var n;if(t=JSON.parse(t),t.ns_id===e.props.context.currentNSID)return n={numUndisplayableUsersAndInvites:t.num_avatars_not_shown,numUsersAndInvites:t.num_users_and_invites,numUsersAndInvitesOutsideTeam:t.num_users_and_invites_outside_team,groups:t.groups,invitations:t.invitations,joinedMembers:t.joined_members},e.setState({sharedFolderData:n})}})(this),complete:(function(e){return function(){return e._currentSFDataRequest=null,e._setHasPendingRequest()}})(this)})},_fetchSharedLinkData:function(){var e,t;if(O.hasNewMembershipUI(this.props.user.id)&&(e=this.props.context.currentFQPath,null!=e&&"/"!==e))return t=[e],this._currentLinkDataRequest=o.SilentBackgroundRequest({url:"/sm/get_token_info",dataType:"json",data:{paths:JSON.stringify(t)},subject_user:this.props.user,success:(function(e){return function(t){var n;if(n=t.shmodels[0],!(null!=n&&n.disabled||null!=(null!=n?n.path:void 0)&&n.path!==e.props.context.currentFQPath))return e.setState({sharedLinkData:n})}})(this),complete:(function(e){return function(){return e._currentLinkDataRequest=null,e._setHasPendingRequest()}})(this)})},_setHasPendingRequest:function(){try{return this.setState({hasPendingRequest:null!=this._currentSFDataRequest||null!=this._currentLinkDataRequest})}catch(e){}},settings_button_click_handler:function(){return this._log_event("preview_sf_members_settings_button_clicked"),X(this.props.user,this.props.context,{origin:"BROWSE_SHARED_FOLDER_BANNER"})},_avatar_click_handler:function(e){return this._log_event(e),document.activeElement!==document.body&&document.activeElement.blur(),X(this.props.user,this.props.context,{origin:"BROWSE_SHARED_FOLDER_BANNER"})},avatar_click_handler:function(){return this._avatar_click_handler("preview_sf_members_avatar_clicked")},shared_link_click_handler:function(){return this._avatar_click_handler("preview_sf_members_shared_link_clicked")},overflow_click_handler:function(){return this._log_event("preview_sf_members_overflow_number_clicked"),X(this.props.user,this.props.context,{origin:"BROWSE_SHARED_FOLDER_BANNER"})},_log_event:function(e,t){return null==t&&(t={}),t.ns_id=this.props.context.currentNSID,H.log("web",e,this.props.user,t)},render:function(){var t;return t={folderName:this.props.context.getNameOfTargetFolder(),user:this.props.user,viewer:this.props.viewer,onSettingsButtonClick:this.settings_button_click_handler,onOverflowCountClick:this.overflow_click_handler,onAvatarClick:this.avatar_click_handler,maxVisibleAvatars:this._getMaxVisibleAvatars(),folderType:this.props.context.isInsideAutoTeamFolder?"TEAM":"SHARED",buttonText:null,isViewingLimitedTeamRootFolder:this._isViewingLimitedTeamRootFolder(),animation:this.state.firstMemberRender,showCreateTeamPromo:this.props.context.showSharedFolderCreateTeamPromo,onSharedLinkClick:this.shared_link_click_handler,sharedLinkData:this.state.sharedLinkData,isFirstDataLoading:this.state.hasPendingRequest&&this.state.firstMemberRender,isMaestroDesign:this.props.isMaestroDesign},t=e.extend(t,this.state.sharedFolderData),j.div({className:"PreviewSFMembersPanel"},z(q,t))}}),Y=n.createClass({displayName:"PreviewSFMembersView",mixins:[I],propTypes:{folderName:n.PropTypes.string.isRequired,folderType:n.PropTypes.oneOf(["SHARED","TEAM"]).isRequired,user:n.PropTypes.object.isRequired,viewer:n.PropTypes.instanceOf(N).isRequired,onSettingsButtonClick:n.PropTypes.func.isRequired,onOverflowCountClick:n.PropTypes.func,onAvatarClick:n.PropTypes.func,buttonText:n.PropTypes.string,isViewingLimitedTeamRootFolder:n.PropTypes.bool,isFirstDataLoading:n.PropTypes.bool,numUndisplayableUsersAndInvites:n.PropTypes.number,numUsersAndInvites:n.PropTypes.number,numUsersAndInvitesOutsideTeam:n.PropTypes.number,groups:n.PropTypes.array,invitations:n.PropTypes.array,joinedMembers:n.PropTypes.array,onSharedLinkClick:n.PropTypes.func,sharedLinkData:n.PropTypes.object,animation:n.PropTypes.bool,avatarDimension:n.PropTypes.number,titleButtonDirection:n.PropTypes.string,maxVisibleAvatars:n.PropTypes.number,showCreateTeamPromo:n.PropTypes.bool,isMaestroDesign:n.PropTypes.bool,isInSFPreviewPanel:n.PropTypes.bool},getDefaultProps:function(){return{titleButtonDirection:W,avatarDimension:F,maxVisibleAvatars:D,animation:A,isMaestroDesign:!1,isInSFPreviewPanel:!0}},renderCreateTeamPromo:function(){var e,t,n;return t="",n=this.props.viewer.personal_email,null!=this.props.joinedMembers&&(t=function(){var t,s,r,o;for(r=this.props.joinedMembers,o=[],t=0,s=r.length;t<s;t++)e=r[t],e.email!==n&&o.push(e.email);return o}.call(this).join()),j.div({className:"team-upsell-banner c-card c-card--arrow c-card--arrow-sw"},Q(K("<createLink>Create a Team Dropbox</createLink> with the people in this folder"),{createLink:j.a({href:"/team?tk=sf_upsell&_camp=sf&invite_members="+t})}),j.span({className:"u-mar-left-xxs"},z(c,{text:K("With teams you get access to a shared team folder, a separate work Dropbox, groups, and other tools and features."),direction:"north"},z(v,{className:"team-upsell-banner__info-sprite",group:"web",name:"info",alt:K("More information about teams")}))))},_renderContent:function(){return[this.renderFolderInfo(),this.props.numUsersAndInvites?"SHARED"===this.props.folderType?this.renderAvatars():this.renderTeamFolder():this._renderLoadingIndicator()]},_renderGoldenGateContent:function(){return this.props.isFirstDataLoading?this._renderLoadingIndicator():z(g.Flag,{rightAttachment:this.renderAvatars()},this.renderGoldenGateFolderInfo())},_renderLoadingIndicator:function(){return j.div({className:"loading-indicator-container"},z(d,null))},render:function(){return j.div({className:"sf-member-preview-container"},this.props.showCreateTeamPromo?this.renderCreateTeamPromo():void 0,j.div({className:this.getClassName()},z(g.Flag,{rightAttachment:this.renderButtons()},O.hasNewMembershipUI(this.props.user.id)?this._renderGoldenGateContent():this._renderContent())))},getClassName:function(){return t({"preview-sf-members--with-team-promo":this.props.showCreateTeamPromo,"c-banner c-banner--unpinned u-pad-s":!0,"team-folder":"TEAM"===this.props.folderType})},renderTeamFolder:function(){var e,t;return e=null,this.props.groups&&(t=this.props.groups[0],t&&t.is_automatic&&(e=K("editor"===t.access_type?"%(group_name)s can edit":"%(group_name)s can view"),e=e.format({group_name:t.name}))),e||(e=K("Shared with all members of %(team_name)s").format({team_name:this.props.viewer.team_name})),j.div({className:"team-folder-member-entry"},z(a,{dimension:32,photoUrl:J("/static/images/icons/team_32-vflk8mBzO.png"),shape:"SQUARE",optionalClass:"u-mar-right-xs"}),j.span({className:"u-l-ib u-l-ib--m"},e))},renderButtons:function(){var e,n,s;if((!this.props.isViewingLimitedTeamRootFolder||this.props.user.is_team_admin)&&!this.props.isMaestroDesign)return n=O.hasNewMembershipUI(this.props.user.id),s=!this.props.isViewingLimitedTeamRootFolder,e=this.props.buttonText?this.props.buttonText:K(s?"Share":"Settings"),j.div(null,j.button({className:t(["c-btn","settings-button",n?"c-btn--primary":"c-btn--secondary"]),onClick:this.props.onSettingsButtonClick,title:e},e))},renderFolderInfo:function(){return j.div({className:"shared-folder-info u-mar-bottom-xs"},j.strong({className:"shared-folder-name"},p.em_snippet(this.props.folderName,18)),this.props.numUsersAndInvites?j.span({className:"u-mar-horizontal-xs"},"•"):void 0,this.props.numUsersAndInvites?j.span({className:"members-string u-font-meta"},this._buildNumberOfMembersString()):void 0)},renderGoldenGateFolderInfo:function(){var e,t;return this.props.numUsersAndInvites?(t=Z("%(num_total)s member","%(num_total)s members",this.props.numUsersAndInvites,{comment:'Another pluralized string MAY be concatenated to this to make a string like: "15 members (4 outside of TechCorp Inc.)"'}).format({num_total:this.props.numUsersAndInvites}),this.props.numUsersAndInvitesOutsideTeam&&(e=Z("%(num_outside)s outside your Dropbox team","%(num_outside)s outside your Dropbox team",this.props.numUsersAndInvitesOutsideTeam,{comment:'This will be concatenated to another string to make a string like: "15 members (4 outside your Dropbox team)"'}).format({num_outside:this.props.numUsersAndInvitesOutsideTeam}))):t=this.props.sharedLinkData?this.getDescriptionForSharedLinkInfo(this.props.sharedLinkData):K("Not shared"),j.div({className:"u-l-ib shared-folder-info__members"},j.strong({},t),null!=e?j.div({className:"u-font-meta"},e):void 0)},_buildNumberOfMembersString:function(){var e,t;return t=Z("%(num_total)s member","%(num_total)s members",this.props.numUsersAndInvites,{comment:'Another pluralized string MAY be concatenated to this to make a string like: "15 members (4 outside of TechCorp Inc.)"'}),this.props.numUsersAndInvitesOutsideTeam?(t+=Z(" (%(num_outside)s outside your Dropbox team)"," (%(num_outside)s outside your Dropbox team)",this.props.numUsersAndInvitesOutsideTeam,{comment:'This will be concatenated to another string to make a string like: "15 members (4 outside your Dropbox team)"'}),e=t.format({num_total:this.props.numUsersAndInvites,num_outside:this.props.numUsersAndInvitesOutsideTeam,team_name:p.em_snippet(this.props.viewer.team_name,16)})):e=t.format({num_total:this.props.numUsersAndInvites}),e},renderAvatars:function(){var e,t,n,s,r;return e=[],r=[],this.props.sharedLinkData&&e.push(this.renderSharedLink(this.props.sharedLinkData)),this.props.numUsersAndInvites&&(O.hasNewMembershipUI(this.props.user.id)||(s=this.findOwnerAndMeInJoinedMembers(this.props.joinedMembers),n=s[0],t=s[1],null!=n&&(e.push(this.renderJoinedMember(n)),r.push(n.user_id)),null!=t&&t!==n&&(e.push(this.renderJoinedMember(t)),r.push(t.user_id))),this.addGroupsMembersInvitations(e,this.props.groups,this.props.joinedMembers,this.props.invitations,r)),this.renderAvatarList(e,this.getAvatarListClassName())},getAvatarListClassName:function(){return t({"u-pad-right-m":O.hasNewMembershipUI(this.props.user.id)})}}),q=f(Y,["/static/css/avatar_list-vflLcMc4Y.css","/static/css/components/loading_indicator-vflbadB1S.css","/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/shared_folder_members_preview/team_promo-vflu998jd.css"]),{PreviewSFMembersPanel:U,PreviewSFMembersView:q}});var extend=function(e,t){function n(){this.constructor=e}for(var s in t)hasProp.call(t,s)&&(e[s]=t[s]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/shared_with",["jquery","external/react","external/react-dom","external/underscore","modules/core/i18n","modules/core/user_i18n","modules/clean/ajax","modules/clean/avatar/size","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/flux/store_mixin","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/sharing/shared_with_view","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal_util","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/ui_util","modules/clean/file_events","modules/clean/web_timing_logger","modules/core/dom"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T){var N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te;return r._,M=a.AVATAR_DIMENSION_BY_SIZE,k=u.BrowseActionTypes,R=u.FileTypes,q=u.LoadingStates,G=u.SharedWithActionTypes,A=h.BrowseContext,x=h.File,F=m.BrowseStore,j=_.SharedWithView,X=f.SharingApi,L=g.FileShareApiClient,O=g.FolderShareApiClient,H=y.MemberCounts,J=b.TRUELINK,ee=v.shouldUsePublicFolderSharing,te=S.showShareModal,$=I.sharingInfoStore,Q=w.SharingActions,Z=t.createElement,B=5,D=3,N=5,U=100,V=100,"file_row_sharing_menu",z=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t.prototype.initializeWith=function(e){var t,n;return n=e.path,t=e.files,this._browseInitializeEverything({path:n,files:t})},t.prototype._init=function(){return this._sharedFolderDataByTargetNs={},this._sharedFolderMemberCountsByTargetNs={},this._sharedLinkDataMapsByFolderFQPath={},this._filesWeHaveSharedLinkDataFor={},this._sharedFileDataByFileId={},this._hasSharedDataLoadedByContainingPath={}},t.prototype.hasLinkDataForFile=function(e){return e.fq_path in this._filesWeHaveSharedLinkDataFor},t.prototype.clearSharedLinkDataCache=function(){return this._filesWeHaveSharedLinkDataFor={}},t.prototype.getDataForFile=function(e){var t,n,s;return t=null,null!=e.target_ns&&(t=this._sharedFolderDataByTargetNs[e.target_ns]),this._canBeSharedFile(e)&&(t=this._sharedFileDataByFileId[null!=(n=e.file_id)?n:e.fq_path]),s=this._getSharedLinkInfoByFile(e),s?(t||(t={}),t.sharedLinkInfo=s):null!=t&&delete t.sharedLinkInfo,t||(t={}),t.inheritedMemberCounts=this._getMemberCounts(),t.hasSharedDataLoaded=this._getHasSharedDataLoaded(),t},t.prototype.getAudienceBoxDataForFile=function(e){var t,n,r,o,i,a,l,d,c,p,u,h;return e&&!e.target_ns&&this._canBeSharedFile(e)?(t=this._sharedFileDataByFileId[null!=(i=e.file_id)?i:e.fq_path]||{},r=this._sharedFolderDataByTargetNs[F.context().currentNSID]||{},o={},(null!=(a=t.joinedMembers)?a.length:void 0)||(null!=(l=t.groups)?l.length:void 0)||(null!=(d=t.invitations)?d.length:void 0)||(o.audienceDescription=r.audienceDescription),o.groups=s.uniq(s.union(t.groups,r.groups),!1,function(e){return e.gid}),o.invitations=s.uniq(s.union(t.invitations,r.invitations),!1,function(e){return e.invitation_id}),o.joinedMembers=s.uniq(s.union(t.joinedMembers,r.joinedMembers),!1,function(e){return e.user_id}),o.numUndisplayableUsersAndInvites=(t.numUndisplayableUsersAndInvites||0)+(r.numUndisplayableUsersAndInvites||0),n=r.memberCount||0,n+=((null!=(c=t.joinedMembers)?c.length:void 0)||0)+((null!=(p=t.invitations)?p.length:void 0)||0)+(t.numUndisplayableUsersAndInvites||0),n+=(null!=(u=t.groups)?u.map(function(e){return e.num_users||1}).reduce(function(e,t){return e+t},0):void 0)||0,o.memberCount=n):o=e&&e.target_ns?this._sharedFolderDataByTargetNs[e.target_ns]:this._sharedFolderDataByTargetNs[F.context().currentNSID],h=this._getSharedLinkInfoByFile(e),h?(o||(o={}),o.sharedLinkInfo=h):null!=o&&delete o.sharedLinkInfo,o||(o={}),o.hasSharedDataLoaded=this._getHasSharedDataLoaded(),o},t.prototype._getSharedLinkInfoByFile=function(e){var t,n,s;return t=F.path(),s=this._sharedLinkDataMapsByFolderFQPath[t],s&&e&&(n=s[this._sharedLinkKey(e)]),n},t.prototype._sharedLinkKey=function(e){return e.fq_path+"_"+e.ns_id+"_"+e.sjid},t.prototype._new_payload=function(e){switch(e.action.type){case k.LOAD_PATH:return this._pathLoaded(e.action.data);case k.ADD_FILES:return this._filesAdded(e.action.data);case k.INITIALIZE_EVERYTHING:return this._browseInitializeEverything(e.action.data);case k.CHANGE_FILES:return this._filesChanged(e.action.data);case G.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:return this._signalSharedFileDataOutOfDate(e.action.data);case G.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:return this._signalSharedFolderDataOutOfDate(e.action.data);case G.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:return this._signalSharedLinkDataOutOfDate(e.action.data);case G.SET_SHARED_FOLDER_DATA:return this._setNSSharedWithData(e.action.data);case G.SET_MEMBER_COUNTS_FOR_NS:return this._setMemberCountsForNs(e.action.data);case G.SET_SHARED_LINK_DATA:return this._setSharedLinkData(e.action.data);case G.SET_SHARED_FILE_DATA:return this._setSharedFileData(e.action.data);case G.CLEAR_SHARED_FOLDER_DATA_FOR_NS:return this._clearSharedFolderDataForNs(e.action.data);case G.REMOVE_SHARED_LINK_DATA:return this._removeSharedLinkData(e.action.data)}},t.prototype._fillInMissingSharedLinkData=function(e){var t,n,s,r,o,i,a;for(a=e.parentPath,s=e.files,r=[],o=0,i=s.length;o<i;o++)n=s[o],this.hasLinkDataForFile(n)||(this._filesWeHaveSharedLinkDataFor[n.fq_path]=!0,r.push(n));return W.loadLinkDataForFiles({parentPath:a,fileFqPaths:(function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)t=r[e],s.push(t.fq_path);return s})()}),W.loadLinkMetadata(r)},t.prototype._getMemberCounts=function(){var e;return e=F.context().currentNSID,e in this._sharedFolderMemberCountsByTargetNs?this._sharedFolderMemberCountsByTargetNs[e]:new H},t.prototype._getHasSharedDataLoaded=function(){var e;return e=F.path(),e in this._hasSharedDataLoadedByContainingPath&&this._hasSharedDataLoadedByContainingPath[e]},t.prototype._setHasSharedDataLoaded=function(e){var t;return t=F.path(),this._hasSharedDataLoadedByContainingPath[t]=e},t.prototype._canBeSharedFile=function(e){return!(e.is_dir||e.isDeleted)},t.prototype._loadSharedFileData=function(e){var t,n,s,r,o,i;for(s=(null!=e?e:{invalidateCache:!1}).invalidateCache,s&&(this._sharedFileDataByFileId={}),n=[],i=F.files().toArray(),r=0,o=i.length;r<o;r++)t=i[r],!this._canBeSharedFile(t)||t.file_id in this._sharedFileDataByFileId||n.push(t.file_id);return W.loadSharedFileDataForFiles({fileIds:n})},t.prototype._pathLoaded=function(e){var t,n;return t=e.files,n=e.path,this._setHasSharedDataLoaded(!1),W.loadMemberCountsForContainingNs(),W.loadSFDataForPath({parentPath:n}),this._loadSharedFileData({invalidateCache:!0}),this._filesAdded({files:t,path:n})},t.prototype._filesAdded=function(e){var t,n;return t=e.files,n=e.path,this._fillInMissingSharedLinkData({parentPath:n,files:t}),this._loadSharedFileData()},t.prototype._filesChanged=function(e){var t,n,s;if(s=e.path,n=e.fileDeltas,s===F.path()&&null!=n&&n.length)return c.waitFor([F.dispatchToken]),W.loadSFDataForPath({parentPath:s}),this.clearSharedLinkDataCache(),t=F.files().toArray(),this._fillInMissingSharedLinkData({parentPath:s,files:t}),this._loadSharedFileData({invalidateCache:!0})},t.prototype._signalSharedFileDataOutOfDate=function(e){var t;return t=e.fileIds,W.loadSharedFileDataForFiles({fileIds:t})},t.prototype._signalSharedFolderDataOutOfDate=function(e){var t;return t=e.parentPath,null==t&&(t=F.path()),W.loadMemberCountsForContainingNs(),W.loadSFDataForPath({parentPath:t})},t.prototype._signalSharedLinkDataOutOfDate=function(e){var t,n;return n=e.parentPath,t=e.fileFqPaths,null==n&&(n=F.path()),W.loadLinkDataForFiles({parentPath:n,fileFqPaths:t})},t.prototype._setNSSharedWithData=function(e){var t,n;return n=e.sharedFolderData,t=e.containingPath,this._sharedFolderDataByTargetNs=n,this._hasSharedDataLoadedByContainingPath[t]=!0,this.emit_change()},t.prototype._setMemberCountsForNs=function(e){var t,n;return n=e.targetNs,t=e.memberCounts,this._sharedFolderMemberCountsByTargetNs[n]=t,this.emit_change()},t.prototype._setSharedLinkData=function(e){var t,n,s,r,o,i,a,l;for(r=e.parentPath,i=e.sharedLinkData,l=this._sharedLinkDataMapsByFolderFQPath[r]||{},n=0,s=i.length;n<s;n++)o=i[n],t=o.file,a=o.sharedLinkToken,l[this._sharedLinkKey(t)]=a;return this._sharedLinkDataMapsByFolderFQPath[r]=l,this.emit_change()},t.prototype._setSharedFileData=function(e){var t;return t=e.sharedFileData,s.extend(this._sharedFileDataByFileId,t),this.emit_change()},t.prototype._clearSharedFolderDataForNs=function(e){var t;return t=e.targetNs,this._sharedFolderDataByTargetNs[t]=void 0,this.emit_change()},t.prototype._browseInitializeEverything=function(e){var t,n;return n=e.path,t=e.files,W.loadMemberCountsForContainingNs(),W.loadSFDataForPath({parentPath:n}),this._filesAdded({path:n,files:t})},t.prototype._removeSharedLinkData=function(e){var t,n,s,r,o,i;for(o=e.parentPath,n=e.files,i=this._sharedLinkDataMapsByFolderFQPath[o]||{},s=0,r=n.length;s<r;s++)t=n[s],i[this._sharedLinkKey(t)]=void 0;return this._sharedLinkDataMapsByFolderFQPath[o]=i,this.emit_change()},t})(d),Y=new z,e(document).on(X.REQUEST_SUCCEEDED_EVENT,function(e,t){var n;return n=t.request_url,n.indexOf("/share_ajax/leave")>-1?c.dispatch({type:G.CLEAR_SHARED_FOLDER_DATA_FOR_NS,data:{targetNs:t.ns_id}}):c.dispatch({type:G.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{parentPath:F.path()}})}),W=(function(){function e(){}return e.loadLinkMetadata=function(e){var t,n,s,r,o,i;if(i=F.user(),J.TRUELINK_BROWSE_LINK_ICON[i.id]&&J.TRUELINK_UI[i.id])return t=5,s=e.filter(function(e){return e.is_dir}).map(function(e){return"ns:"+e.ns_id+e.ns_path}),o=function(){var e;if(0!==s.length)return e=s.slice(0,t),s=s.slice(t),Q.loadFolderLinkMetadataBatch(i,e).then(o)},n=e.filter(function(e){return!e.is_dir}).map(function(e){return e.file_id||e.fq_path}),r=function(){var e;if(0!==n.length)return e=n.slice(0,t),n=n.slice(t),Q.loadFileMetadataBatch(i,e).then(r)},o(),r()},e.loadSFDataForPath=function(e){var t,n,s;return n=e.parentPath,s=F.user(),t=F.context().isNonUserRelativeContext,i.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:s,data:{max_results:B,fq_path_prefix:n,include_inherited:C.GoldenGate.hasAudienceBox(s.id),admin_console:t?"true":void 0,sort_by_name:C.GoldenGate.hasNewMembershipUI(s.id)},success:function(e){var t,s,r,o,i;for(i={},t=0,s=e.length;t<s;t++)o=e[t],r={numUndisplayableUsersAndInvites:o.num_avatars_not_shown,groups:o.groups,invitations:o.invitations,joinedMembers:o.joined_members,audienceDescription:o.audience_description,memberCount:o.num_users_and_invites},i[o.ns_id]=r;return c.dispatch({type:G.SET_SHARED_FOLDER_DATA,data:{sharedFolderData:i,containingPath:n}})}})},e.loadMemberCountsForContainingNs=function(){var e,t,n,s;if(s=F.user(),n=F.context(),n.isNonUserRelativeContext&&(t=n.rootNSID?n.currentNSID:void 0,s.is_email_verified&&t))return e=new O({userId:s.id,isNonUserRelativeContext:n.isNonUserRelativeContext}),e.getMemberCounts({contentId:t}).then(function(e){return c.dispatch({type:G.SET_MEMBER_COUNTS_FOR_NS,data:{memberCounts:e,targetNs:t}})})},e.loadSharedFileDataForFiles=function(e){var t,n,s,r;if(n=e.fileIds,r=F.user(),r.is_email_verified)return t=new L({userId:r.id}),(s=function(e){var n,r,o;if(0!==e.length)return o=e.slice(0,V),n=e.slice(V),r=t.listMembersBatch({contentIds:o,limit:B}),r.then(function(e){var t;if(t={},e.forEach(function(e,n){return t[n]={numUndisplayableUsersAndInvites:0,groups:e.groups.valueSeq().map(C.apiGroupMemberToAvatarInfo).toArray(),invitations:e.invitees.valueSeq().map(C.apiInviteeMemberToAvatarInfo).toArray(),joinedMembers:e.users.valueSeq().map(C.apiUserMemberToAvatarInfo).toArray()}}),c.dispatch({type:G.SET_SHARED_FILE_DATA,data:{sharedFileData:t}}),n)return s(n)})})(n)},e.loadLinkDataForFiles=function(e){var t,n,s,r;if(n=e.parentPath,t=e.fileFqPaths,!J.TRUELINK_UI[F.user().id])return r=F.user(),(s=function(e){var t,o;if(0!==e.length)return o=e.slice(0,U),t=e.slice(U),i.SilentBackgroundRequest({url:"/sm/get_token_info",dataType:"json",data:{paths:JSON.stringify(o)},subject_user:r,success:function(e){var r,i,a,l,d,p,u,h,m,_,f;for(a=F.filesMap(),m=[],u=e.shmodels,l=0,d=u.length;l<d;l++)f=u[l],f.disabled||(r=a.get(f.path),r&&m.push({file:r,sharedLinkToken:f}));if(m.length&&c.dispatch({type:G.SET_SHARED_LINK_DATA,data:{parentPath:n,sharedLinkData:m}}),_=(function(){var t,n,s,r;for(s=e.shmodels,r=[],t=0,n=s.length;t<n;t++)h=s[t],r.push(h.path);return r})(),i=(function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)p=o[e],indexOf.call(_,p)>=0||n.push(a.get(p));return n})().filter(function(e){return null!=e}),i.length&&c.dispatch({type:G.REMOVE_SHARED_LINK_DATA,data:{parentPath:n,files:i}}),t)return s(t)}})})(t)},e})(),K=t.createClass({displayName:"SharedWithController",mixins:[p(Y,$,F)],propTypes:{browseContext:t.PropTypes.instanceOf(A).isRequired,file:t.PropTypes.instanceOf(x),isInAudienceBox:t.PropTypes.bool,isMaestroDesign:t.PropTypes.bool,inSelectMode:t.PropTypes.bool,tabIndex:t.PropTypes.oneOf([0,-1]),actionHandlers:t.PropTypes.object},_get_state_from_stores:function(e){var t,n,s,r,o,i,a,l,d,c,p,u,h,m,_;return _=F.user().id,s=null!=(r=this.props.browseContext)?r.isNonUserRelativeContext:void 0,t=!C.GoldenGate.hasAudienceBox(_)||s&&!this.props.isMaestroDesign?Y.getDataForFile(e.file):Y.getAudienceBoxDataForFile(e.file),m=$.getSharingInfo(_,null!=(o=e.file)?o.fq_path:void 0),n=F.loadingState()===q.LOADING_FIRST_PAGE,{audienceDescription:null!=t?t.audienceDescription:void 0,numUndisplayableUsersAndInvites:null!=(i=null!=t?t.numUndisplayableUsersAndInvites:void 0)?i:0,numInheritedMembers:null!=(a=null!=t&&null!=(l=t.inheritedMemberCounts)?l.total_unique_users:void 0)?a:0,groups:null!=(d=null!=t?t.groups:void 0)?d:[],hasSharedDataLoaded:(null!=t?t.hasSharedDataLoaded:void 0)&&!n,invitations:null!=(c=null!=t?t.invitations:void 0)?c:[],
joinedMembers:null!=(p=null!=t?t.joinedMembers:void 0)?p:[],memberCount:null!=(u=null!=t?t.memberCount:void 0)?u:null,sharedLinkInfo:null!=(h=null!=t?t.sharedLinkInfo:void 0)?h:null,linkMetadata:null!=m?m.linkMetadata():void 0}},componentDidUpdate:function(){var e,t,s,r,o;if(null!=this.props.tabIndex){for(t=T.getFocusableElementsIn(n.findDOMNode(this),!1),o=[],s=0,r=t.length;s<r;s++)e=t[s],o.push(e.tabIndex=this.props.tabIndex);return o}},componentWillReceiveProps:function(e){return this.setState(this._get_state_from_stores(e))},_showSharingModal:function(){var e,t,n,s,r;if((null!=this.props.file||!F.context().isCurrentlyInRoot)&&(null==this.props.file||!x.isTeamMemberFolder(this.props.file))&&(null==this.props.file||x.canViewFileMembers(this.props.file,F.context())))return t=[F.user(),this.props.file?this.props.file:F.context()],r=t[0],e=t[1],F.context().isNonUserRelativeContext&&this.props.file.type===R.TEAM_SHARED_FOLDER&&null!=(null!=(n=this.props.actionHandlers)?n.onTeamFolderManage:void 0)?null!=(s=this.props.actionHandlers)?s.onTeamFolderManage(this.props.file):void 0:te(r,e,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},handleOverflowCountClick:function(){return this._showSharingModal()},handleAvatarClick:function(){return this._showSharingModal()},handleSharedLinkClick:function(){return te(F.user(),this.props.file,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},_getMaxVisibleAvatars:function(){return this.props.isMaestroDesign?N:C.GoldenGate.hasNewMembershipUI(F.user().id)?this.props.browseContext.isInsideSharedFolder?D:D+1:B},render:function(){var e,t,n,s,r,o,i;return t=F.context(),i=F.user(),t.isCurrentlyInRoot&&null==this.props.file&&!i.is_cdm_member?null:(t.isNonUserRelativeContext?(n=!t.rootNSID&&C.GoldenGate.hasContentManagerCdm(i.id),s=this.props.file.fq_path.split("/")[1]):(n=!1,s=t.getNameOfTargetFolder()),e=this.props.file?x.canViewFileMembers(this.props.file,t):t.canViewContainingNSMembers,Z(j,{user:F.user(),file:this.props.file,onOverflowCountClick:this.handleOverflowCountClick,onAvatarClick:this.handleAvatarClick,groups:this.state.groups,invitations:this.state.invitations,joinedMembers:this.state.joinedMembers,numUndisplayableUsersAndInvites:this.state.numUndisplayableUsersAndInvites,memberCount:this.state.memberCount,numInheritedMembers:this.state.numInheritedMembers,parentFolderName:s,animation:!1,avatarDimension:this.props.isInAudienceBox?M.MEDIUM:void 0,maxVisibleAvatars:this._getMaxVisibleAvatars(),sharedLinkInfo:this.state.sharedLinkInfo,onSharedLinkClick:this.handleSharedLinkClick,publicFolderSharing:this.props.file&&ee(null!=(r=null!=(o=this.props.browseContext)?o.config:void 0)?r:{},this.props.file.fq_path),isMaestroDesign:this.props.isMaestroDesign,inSelectMode:this.props.inSelectMode,isInAudienceBox:this.props.isInAudienceBox,audienceDescription:this.state.audienceDescription,hasSharedDataLoaded:this.state.hasSharedDataLoaded,canViewMembers:e&&!t.isInsideDeletedFolder,inContentManagerCdmRoot:n,linkMetadata:this.state.linkMetadata}))}}),{SharedWithActions:W,SharedWithController:K,SharedWithStore:Y}});var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/content_manager/api",["jquery","external/underscore","modules/clean/analytics","modules/clean/ajax","modules/clean/react/browse/constants","modules/clean/filepath","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/browse/store","modules/clean/sharing/api/util/types","modules/clean/sharing/ui_util","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/constants/browse","modules/constants/viewer","require"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w){var C,E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne,se,re;return T=n.ContentManagerActionsLogger,r.LoadingStates,N=d.FileTypes,c.Config,c.BrowseContext,H=p.compare,P=u.BrowseStore,u.File,K=h.folderMetadataApiToRecord,M=m.GoldenGate,E=_.AdminConsoleApiClient,R=y._,te=y.ungettext,O=function(e){return{fq_path:"/"+e.name,href:"/work/"+e.name,is_dir:!0,bytes:0,target_ns:e.team_folder_id,icon:q[e.status[".tag"]],team_folder_status:e.status[".tag"],type:N.TEAM_SHARED_FOLDER}},C="undefined"!=typeof window&&null!==window?e(window):null,L=180,F=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|<|>|\\"|\\|)'),k=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|\\"|\\|)'),x=new RegExp("[\\ufffe-\\uffff\\ud800-\\udfff]"),A=[".",".."],se=function(e){return""===e?"":e.length>255?R("The folder name should be under 255 characters"):indexOf.call(A,e)>=0?R("The names dot (.) and dot dot (..) are’t allowed"):F.test(e)?R("The following characters aren’t allowed: \\ / : ? * < > ” |"):x.test(e)?R("The folder name contains invalid characters"):null},ne=function(e){return""===e?"":e.length>255?R("The file name should be under 255 characters"):k.test(e)?R("The following characters aren’t allowed: \\ / : ? * ” |"):x.test(e)?R("The file name contains invalid characters"):null},D=function(e,t){var n,s,r,o;for(o=[],n=0,r=e.length;n<r;n++)s=e[n],o.push(s.fq_path="/"+t+s.fq_path);return o},U=function(){var e;return e=M.hasContentManagerCdmInTSD(P.user().id),new E(isCMforCDM=e,flashError=!1)},j=function(e){var n,r,o,i,a,l,d,c,p,u,h,m,_;return d=e.path,_=e.userId,h=e.sortFoldersFirst,o=e.includeDeletedFiles,i=e.nsId,l=e.onSuccess,a=e.onError,n=M.hasContentManagerCdmInTSD(_),r=U(),"/"!==d||n?(c=d.split("/"),p=c[1],u=n?1:2,m="/"+c.slice(u).join("/"),s.WebRequest({data:{show_deleted:o||"",admin_console:!0,ns_id:i,sort_folders_first:h},url:v({path:"/browse"+m}),subject_user:_,success:function(e){try{t.isString(e)&&(e=JSON.parse(e)),n||(e.paginated?D(e.first_page.items,p):D(e.file_info,p)),C.scrollTop(0),l({path:d,data:e})}catch(e){}},error:function(e,t,n){return"function"==typeof a?a(e,t,n):void 0}})):r.teamFoldersList().then(function(e){var t,n,s;return e.team_folders=e.team_folders.sort(function(e,t){return H(e.name.toUpperCase(),t.name.toUpperCase(),1)}),n=(function(){var t,n,r,o;for(r=e.team_folders,o=[],t=0,n=r.length;t<n;t++)s=r[t],o.push(O(s));return o})(),t={file_info:n,paginated:!1,inside_auto_team_folder:!0,is_non_user_relative_context:!0},l({path:d,data:t})}).catch(function(e){if(!e.headers)throw e;return"function"==typeof a?a(e.headers,e.raw.status,e.raw.responseBody):void 0})},V=function(e){var t,n,s,r,o,i;return r=e.files,o=e.newPath,e.userId,e.onSuccess,t=w("modules/clean/react/browse/actions"),n=U(),s=P.context(),i=s.rootNSID,b.info(R("Copying files...",L)),n.bulkFileCopy(i,r,o).then(function(e){var n;return b.success(R("Copy completed.")),t.setPath({path:P.path(),nsId:s.rootNSID}),n=1===r.length?"copy":"copyBatch",B(n)}).catch(function(e){var t;return"cant_copy_shared_folder"===(null!=(t=e.error)?t[".tag"]:void 0)?b.error(R("Copying a shared folder isn’t supported for beta.")):b.error(R("There was a problem completing this request."))})},W=function(e){var t,n,s,r;return r=e.files,s=e.context,t=w("modules/clean/react/browse/actions"),n=U(),b.info(R("Deleting files...",L)),n.bulkFileDelete(r).then(function(e){var n;return n=te("Deleted %d item.","Deleted %d items.",r.length).format(r.length),b.success(n),t.setPath({path:P.path(),nsId:s.rootNSID}),B(1===r.length?r[0].is_dir?"deleteFolder":"deleteFile":"deleteBatch")}).catch(function(e){return b.error(R("There was a problem completing this request."))})},J=function(e){var t,n,s,r,o,i,a;return o=e.file,e.userId,e.onSuccess,a=e.onError,i=e.newName,t=w("modules/clean/react/browse/actions"),s=P.context(),(r=o.is_dir?se(i):ne(i))?(b.error(r),void a()):(n=U(),n.fileRename(o.ns_id,o.ns_path,i).then(function(e){return o.is_dir?b.success(R("Folder renamed.")):b.success(R("File renamed.")),t.setPath({path:P.path(),nsId:s.rootNSID}),B("rename")}).catch(function(e){return b.error(R("There was a problem completing this request."))}))},Q=function(e){var t,n,s,r,o,i;return e.path,r=e.files,o=e.newPath,e.userId,e.onSuccess,t=w("modules/clean/react/browse/actions"),n=U(),s=P.context(),i=s.rootNSID,b.info(R("Moving files...",L)),n.bulkFileMove(i,r,o).then(function(e){var n;return b.success(R("Move completed.")),t.setPath({path:P.path(),nsId:s.rootNSID}),n=1===r.length?"move":"moveBatch",B(n)}).catch(function(e){var t;return"cant_move_folder_into_itself"===(null!=(t=e.error)?t[".tag"]:void 0)?b.error(R("Moving a folder into itself isn’t allowed.")):b.error(R("There was a problem completing this request."))})},Y=function(e){throw e.path,e.userId,e.namespaceToJournalIdMap,e.includeDeletedFiles,e.onSuccess,new Error("Not Implemented")},G=function(e){var t,n,s,r,o,i,a,l;return l=e.pathName,r=e.folderName,o=e.nsId,e.userId,a=e.onSuccess,i=e.onError,t=w("modules/clean/react/browse/actions"),(s=se(r))?(b.error(s),void i()):(n=U(),n.folderCreate(o,l,r).then(function(e){var n;return b.success(R("Folder created.")),n={fq_path:"/"+r},a({changesets:null,createdFolder:n}),t.setPath({path:P.path(),nsId:o}),B("createFolder")}).catch(function(e){var t,n,s,r;return i(),"path"===(null!=(t=e.error)?t[".tag"]:void 0)&&"disallowed_name"===(null!=(n=e.error.path)?n[".tag"]:void 0)?b.error(R("The folder name is invalid.")):"path"===(null!=(s=e.error)?s[".tag"]:void 0)&&"conflict"===(null!=(r=e.error.path)?r[".tag"]:void 0)?b.error(R("A folder with the same name exists.")):b.error(R("Failed to create the folder."))}))},ee=function(e){var t,n,s,r,o;return n=e.nsId,s=e.nsPath,o=e.policyUpdate,r=e.onSuccess,e.onError,t=new U,t.shareFolder(n,s,o).then(K).then(r)},re=function(e){var t,n,s,r,o;return r=e.nsId,o=e.nsPath,t=e.actions,s=e.listMembersArg,B("validateFolderPath"),n=U(),n.validateFolderPath(r,o,t,s)},Z=function(e,t,n,s){var r;return r=U(),r.restoreFile(e,t,n).then(s)},X=function(e,t,n){var s;return s=U(),s.permanentDeleteFile(e,t).then(n)},B=function(e){return T.log(P.context().rootNSID,e)},q={},$=function(e){return q=e},z=function(e){return"/"===e.path&&!M.hasContentManagerCdmInTSD(e.user.id)},{validateFolderName:se,loadPath:j,renameFile:J,copyFiles:V,deleteFiles:W,moveFiles:Q,getChangesForDirectory:Y,setIcons:$,createNewFolder:G,shareFolder:ee,validateFolderPath:re,restoreFile:Z,permanentDeleteFile:X,isInCMGoldenGateRoot:z}}),define("modules/clean/react/exp_overquota_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/exp_overquota_modal_content"],function(e,t,n,s,r,o,i,a){"use strict";var l=(function(e){function t(t){var n=e.call(this,t)||this;return n.oqContent=a.OQContent[n.props.expOverquotaFileActionVariant],n._handleDismiss=n._handleDismiss.bind(n),n}return n.__extends(t,e),t.prototype._handleDismiss=function(){i.Modal.close()},t.prototype._renderButtons=function(){return"V1"===this.props.expOverquotaFileActionVariant||"V3"===this.props.expOverquotaFileActionVariant?s.createElement(i.ModalButtons,{className:"oq-modal__buttons"},s.createElement("a",{href:this.oqContent.redirectURL,className:"button-primary"},this.oqContent.acceptButtonText)):s.createElement(i.ModalButtons,{className:"oq-modal__buttons"},s.createElement("div",{className:"oq-modal__button oq-modal__button--left"},s.createElement(i.ModalButton,{importance:"tertiary",onClick:this._handleDismiss},this.oqContent.dismissButtonText)),s.createElement("div",{className:"oq-modal__button oq-modal__button--right"},s.createElement("a",{href:this.oqContent.redirectURL,className:"button-primary"},this.oqContent.acceptButtonText)))},t.prototype._renderContentTitle=function(){return"V1"===this.props.expOverquotaFileActionVariant||"V3"===this.props.expOverquotaFileActionVariant?s.createElement("p",{className:"oq-modal__content--title"},this.oqContent.title):null},t.prototype._renderImage=function(){return this.oqContent.image?s.createElement(o,{src:this.oqContent.image.image,srcHiRes:this.oqContent.image.imageHiRes}):null},t.prototype.render=function(){return s.createElement(i.Modal,{className:"exp_overquota_modal__"+this.props.expOverquotaFileActionVariant,title:this.oqContent.title,buttonComponent:this._renderButtons(),showX:this.oqContent.showX},s.createElement("div",{className:"oq-modal__content"},this._renderImage(),this._renderContentTitle(),s.createElement("p",null,this.oqContent.content)))},t})(s.Component);t.ExpOverquotaModalElement=l,t.ExpOverquotaModal=r(l,["/static/css/react/exp_overquota_modal-vfldmY9N8.css"])}),define("modules/clean/react/exp_overquota_modal_content",["require","exports","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s){"use strict";t.OQContent={V1:{title:s._("Your Dropbox is full"),content:s._("Before you can update or move your files, you need more space."),image:{image:n.static_url("/static/images/pro/overquota/overquota-folder-vflgFxxXj.png"),imageHiRes:n.static_url("/static/images/pro/overquota/overquota-folder@2x-vfloUmya6.png")},acceptButtonText:s._("Get more space"),dismissButtonText:null,redirectURL:"/upgrade?oqa=upl_f",showX:!0},V2:{title:s._("Your Dropbox is full"),content:s._("Before you can update or move your files, you need more space."),image:null,acceptButtonText:s._("Get more space"),dismissButtonText:s._("Cancel"),redirectURL:"/upgrade?oqa=upl_f",showX:!1},V3:{title:s._("Your Dropbox is full"),content:s._("Before you can update or move your files, you need more space."),image:{image:n.static_url("/static/images/pro/overquota/overquota-folder-vflgFxxXj.png"),imageHiRes:n.static_url("/static/images/pro/overquota/overquota-folder@2x-vfloUmya6.png")},acceptButtonText:s._("Get more space"),dismissButtonText:null,redirectURL:"/pro/out-of-space?oqa=upl_f",showX:!0},V4:{title:s._("Your Dropbox is full"),content:s._("Before you can update or move your files, you need more space."),image:null,acceptButtonText:s._("Get more space"),dismissButtonText:s._("Cancel"),redirectURL:"/pro/out-of-space?oqa=upl_f",showX:!1}}}),define("modules/clean/react/file_modal_controller",["external/react","external/underscore","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/react/css","modules/clean/react/file_modals","modules/clean/react/modal","modules/clean/react/exp_overquota_modal"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u,h,m,_,f,g,y,b,v;return m=o.FileTransferModal,b=o.RestoreFilesModal,y=o.PermanentlyDeleteModal,d=o.DeleteFileModal,c=o.ExpDeleteFileModal,p=o.ExpOQDeleteFileModal,l=o.ContentManagerBridgeModal,f=o.NoAccessFolderModal,_=i.Modal,u=a.ExpOverquotaModal,v=e.createElement,g={COPY:"copy",MOVE:"move"},h=(function(){function e(){}return e.showCopy=function(e,t,n){var s,r,o,i,a,l,d;return o=null!=(a=n.onSuccess)?a:null,i=null!=(l=n.onUndo)?l:null,r=null!=(d=n.onRequestNotSent)?d:null,s=v(m,{files:t,operation:g.COPY,user:e,onSuccess:o,onUndo:i,onRequestNotSent:r}),_.showInstance(s)},e.showMove=function(e,t,n,s){var r,o,i,a,l,d,c;return i=null!=(l=s.onSuccess)?l:null,a=null!=(d=s.onUndo)?d:null,o=null!=(c=s.onRequestNotSent)?c:null,r=v(m,{files:t,path:n,operation:g.MOVE,user:e,onSuccess:i,onUndo:a,onRequestNotSent:o}),_.showInstance(r)},e.showOverquota=function(e){var t;return t=v(u,{expOverquotaFileActionVariant:e}),_.showInstance(t)},e.showRestore=function(e,t,n){var s;return s=v(b,{files:t,userId:e.id,onSuccess:n}),_.showInstance(s)},e.showPermanentlyDelete=function(e,t,n){var s;return s=v(y,{files:t,userId:e.id,onSuccess:n}),_.showInstance(s)},e.showDelete=function(e,t,s,r,o,i){var a,l,u;return null==o&&(o=null),null==i&&(i=!1),l=n.filename(s.currentFQPath),u=s.isInsideSharedFolder,a="V1"===o||"V2"===o?v(c,{files:t,user:e,parentSharedFolderName:u?l:null,onUndo:r,expOQProVariant:o}):i?v(p,{files:t,user:e,parentSharedFolderName:u?l:null,onUndo:r,expSubgrowthBizWebClientOQDelete:i}):v(d,{files:t,user:e,parentSharedFolderName:u?l:null,onUndo:r}),_.showInstance(a)},e.showContentManagerBridge=function(e,t,n){var s;return s=v(l,{files:e,type:t,isLimitedTeam:n}),_.showInstance(s)},e.showNoAccess=function(e,t,s){var r;return r=v(f,{folderName:n.filename(t.fq_path),userIsSameTeam:e.team_dbtid&&s.teamFolderOwnerTeamApiId&&e.team_dbtid===s.teamFolderOwnerTeamApiId}),_.showInstance(r)},e})(),{FileModalController:h}});var bind=function(e,t){return function(){return e.apply(t,arguments)}},extend=function(e,t){function n(){this.constructor=e}for(var s in t)hasProp.call(t,s)&&(e[s]=t[s]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;define("modules/clean/react/file_modals",["external/react","external/react-dom","external/underscore","modules/clean/em_string","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/render_partials","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/css","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/sharing/constants","modules/clean/sharing/browse_exports","modules/clean/user","modules/clean/viewer","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/uri","modules/constants/python"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C){var E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X;return x=o.FileTypes,k=i.File,A=a.FileIcon,E=l.BrowseStore,Q=p.reactFormat,O=u.Modal,L=h.FolderTreeView,H=f.SNIPPET_SIZES,W=g.asyncGenContentManagerBridgeUri,R=g.GoldenGate,G=I._,X=I.ungettext,V=C.TRADEMARK_PLUS,Y=e.DOM,K=e.createElement,U={COPY:"copy",MOVE:"move"},z=function(){var e;return e=E.context(),e.isNonUserRelativeContext?d:r},j=function(e,t){var n;return n=E.context(),n.isNonUserRelativeContext&&!R.hasContentManagerCdmInTSD(t.id)?e[0].fq_path.split("/")[1]:null},q=e.createClass({displayName:"PermanentlyDeleteModal",propTypes:{files:e.PropTypes.arrayOf(e.PropTypes.instanceOf(k)).isRequired,userId:e.PropTypes.number.isRequired},getDefaultProps:function(){return{onSuccess:n.noop}},handlePurged:function(){return m.notifyPurgeSuccess(this.props.files.length),this.props.onSuccess.apply(null,arguments)},handleAccept:function(){var e;return E.context().isNonUserRelativeContext?(e=this.props.files[0],d.permanentDeleteFile(e.ns_id,e.ns_path,this.handlePurged)):r.purgeFiles({files:this.props.files,userId:this.props.userId,onSuccess:this.handlePurged})},isSingleSharedFolder:function(e){return 1===e.length&&e[0].type===x.SHARED_FOLDER},getTitle:function(e){var t;return t=e.length,this.isSingleSharedFolder(e)?G("Remove access to folder?"):X("Permanently delete %(num)s file?","Delete %(num)s items permanently?",t).format({num:t})},renderContent:function(e){var t,n;return t=e.length,1===t?(n=_.filename(e[0].fq_path),this.isSingleSharedFolder(e)?Q(G("Are you sure you want to remove your access to <strong>%(filename)s</strong>? It will no longer be viewable in your list of shared folders, and you won’t be able to re-add it to your Dropbox unless you’re re-invited."),{strong:Y.strong(),filename:n}):Q(G("Are you sure you want to delete <strong>%(filename)s</strong> from your Dropbox permanently?"),{strong:Y.strong(),filename:n})):Y.span(null,X("Are you sure you want to permanently delete %(num)s item from your Dropbox?","Are you sure you want to permanently delete %(num)s items from your Dropbox?",t).format({num:t}))},render:function(){var e;return e={ref:"modal",title:this.getTitle(this.props.files),acceptButtonText:G(this.isSingleSharedFolder(this.props.files)?"Remove my access":"Delete permanently"),dismissButtonText:G("Cancel"),onAccept:this.handleAccept},K(O,e,this.renderContent(this.props.files))}}),B=e.createClass({displayName:"RestoreFilesModal",propTypes:{files:e.PropTypes.arrayOf(e.PropTypes.instanceOf(k)).isRequired,userId:e.PropTypes.number.isRequired,onSuccess:e.PropTypes.func},getDefaultProps:function(){return{onSuccess:n.noop}},handleRestoreSuccess:function(){return m.notifyRestoreSuccess(this.props.files),this.props.onSuccess.apply(null,arguments)},handleRestoreClick:function(e){var t,n;return e.preventDefault(),t=E.context(),t.isNonUserRelativeContext?(n=this.props.files[0],d.restoreFile(n.ns_id,n.ns_path,n.latest_rev,this.handleRestoreSuccess)):r.restoreFiles({files:this.props.files,userId:this.props.userId,onSuccess:this.handleRestoreSuccess}),this.refs.modal.close()},handleCancelClick:function(e){return e.preventDefault(),this.refs.modal.close()},getTitle:function(e){return X("Restore %(num)s file?","Restore %(num)s items…",e).format({num:e})},renderSingleFileContent:function(e,t){var n;return n=_.filename(e.fq_path),[Q(G("The most recent version of <strong>%(filename)s</strong> will be restored."),{strong:Y.strong(),filename:n}),Y.div({className:"file-modal__single-file-row"},K(A,{file:e,className:"file-modal__single-file-row-icon"}),E.context().isNonUserRelativeContext?n:Y.a({href:t,className:"file-modal__single-file-row-link"},n))]},renderMultiFileContent:function(e){return Y.span({},X("Are you sure you want to restore %(num)s item?","Are you sure you want to restore %(num)s items?",e.length).format({num:e.length}))},renderButtons:function(e){return Y.div({className:"file-modal__buttons"},e?Y.div({className:"file-modal__buttons__alt",ref:"revisionButton"},Y.a({href:e},G("View other versions"))):void 0,Y.div({className:"file-modal__buttons__main"},Y.button({className:"button-primary db-modal-button",onClick:this.handleRestoreClick,ref:"primaryButton"},G("Restore")),Y.button({className:"button-tertiary db-modal-button",onClick:this.handleCancelClick,ref:"tertiaryButton"},G("Cancel"))))},render:function(){var e,t,n,s;return t=this.props.files.length,s=null,1!==t||E.context().isNonUserRelativeContext||(s=r.getFileHistoryUrl({fqPath:this.props.files[0].fq_path,userId:this.props.userId})),n={ref:"modal",title:this.getTitle(t),buttonComponent:this.renderButtons(s)},e=1===t?this.renderSingleFileContent(this.props.files[0],s):this.renderMultiFileContent(this.props.files),K(O,n,e)}}),B=c(B,["/static/css/react/file_modal-vfl5O9OmZ.css"]),F=e.createClass({displayName:"FileTransferModal",statics:{Operations:U},propTypes:{files:e.PropTypes.arrayOf(e.PropTypes.shape({fq_path:e.PropTypes.string,is_dir:e.PropTypes.bool})).isRequired,operation:e.PropTypes.oneOf([U.COPY,U.MOVE]).isRequired,user:e.PropTypes.instanceOf(y).isRequired,onSuccess:e.PropTypes.func,onUndo:e.PropTypes.func,onRequestNotSent:e.PropTypes.func,path:e.PropTypes.string},getDefaultProps:function(){return{onSuccess:n.noop}},getInitialState:function(){return{selectedPath:null}},handleOperationSuccess:function(e){var t,n,s,r;return t=e.changesets,s=e.rollbackHints,n=this.props.files.length,r=this.props.user,this.props.operation===U.MOVE?m.notifyMoveSuccess(n,r,t,this.state.selectedPath,s,this.props.onUndo):this.props.operation===U.COPY&&m.notifyCopySuccess(n,r,t,this.state.selectedPath,s,this.props.onUndo),this.props.onSuccess.apply(null,arguments)},handleAccept:function(){var e,t,n,s;if(e=z(),this.props.operation===U.MOVE){if(s=e.moveFiles({path:this.props.path,files:this.props.files,newPath:this.state.selectedPath,userId:this.props.user.id,onSuccess:this.handleOperationSuccess}),!s)return"function"==typeof(t=this.props).onRequestNotSent?t.onRequestNotSent():void 0}else if(this.props.operation===U.COPY&&(s=e.copyFiles({files:this.props.files,newPath:this.state.selectedPath,userId:this.props.user.id,onSuccess:this.handleOperationSuccess}),!s))return"function"==typeof(n=this.props).onRequestNotSent?n.onRequestNotSent():void 0},handleFolderSelected:function(e){return this.setState({selectedPath:e})},_getTitle:function(){var e,t;return e=this.props.files.length,this.props.operation===U.MOVE?t=this.props.files[0].is_dir?X("Move %(num)s folder to…","Move %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'}):X("Move %(num)s file to…","Move %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'}):this.props.operation===U.COPY&&(t=this.props.files[0].is_dir?X("Copy %(num)s folder to…","Copy %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'}):X("Copy %(num)s file to…","Copy %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'})),t.format({num:e})},_getActionButtonText:function(){return this.props.operation===U.COPY?G("Copy"):this.props.operation===U.MOVE?G("Move"):void 0},handleModalShown:function(){var e;if(e=t.findDOMNode(this.refs.treeView))return e.focus()},render:function(){return K(O,{ref:"modal",title:this._getTitle(),acceptButtonText:this._getActionButtonText(),onAccept:this.handleAccept,acceptButtonDisabled:!this.state.selectedPath,autoFocusPrimaryInput:!1,onShow:this.handleModalShown,dismissButtonText:G("Cancel")},K(L,{ref:"treeView",rootPath:"/",user:this.props.user,onFolderSelected:this.handleFolderSelected,isRootSelectable:!0,treeRootName:j(this.props.files,this.props.user)}))}}),T=e.createClass({displayName:"DeleteFileModal",propTypes:{files:e.PropTypes.arrayOf(e.PropTypes.shape({fq_path:e.PropTypes.string,is_dir:e.PropTypes.bool})).isRequired,user:e.PropTypes.instanceOf(y).isRequired,parentSharedFolderName:e.PropTypes.string,onUndo:e.PropTypes.func,expOQProVariant:e.PropTypes.string,expSubgrowthBizWebClientOQDelete:e.PropTypes.bool},getDefaultProps:function(){return{parentSharedFolderName:null}},handleNotify:function(e){var t,n;return t=e.changesets,n=e.rollbackHints,m.notifyDeleteSuccess(this.props.files.length,this.props.user,t,n,this.props.onUndo)},handleAccept:function(){var e;return e=E.context(),e.isNonUserRelativeContext?d.deleteFiles({files:this.props.files,context:e}):r.deleteFiles({files:this.props.files,userId:this.props.user.id,onSuccess:this.handleNotify})},_isRemovingSharedFolder:function(){return 1===this.props.files.length&&this.props.files[0].target_ns},_getTitle:function(){var e;return e=this.props.files,e.length<1?"":this._isRemovingSharedFolder()&&!R.canDeepNest(this.props.user.id)?G("Remove shared folder?"):1===e.length?G(e[0].is_dir?"Delete folder?":"Delete file?"):X("Delete %(item_count)s item?","Delete %(item_count)s items?",e.length).format({item_count:e.length})},_getContents:function(){var e,t,n,s,r;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":(n=_.filename(e[0].fq_path),t=e[0].target_ns,null!=this.props.parentSharedFolderName?(s=this.props.parentSharedFolderName,1===e.length&&t&&!R.canDeepNest(this.props.user.id)?(r=w({path:"/work"+e[0].fq_path,query:{shareoptions:1,sharesubfolder:0}}).toString(),Q(G("Are you sure you want to delete <b>%(filename)s</b> from the shared folder ‘%(shared_folder_name)s’? People outside %(team_name)s with whom you’ve shared this folder will stil have access until you remove them from the <memberListLink>member list</memberListLink>."),{filename:n,shared_folder_name:s,team_name:b.get_viewer().team_name,b:Y.b(),memberListLink:Y.a({href:r})})):1===e.length?Q(G("Are you sure you want to delete <b>%(filename)s</b> from the shared folder ‘%(shared_folder_name)s’?"),{filename:n,shared_folder_name:s,b:Y.b()}):X("Are you sure you want to delete %(item_count)s item from the shared folder ‘%(shared_folder_name)s’?","Are you sure you want to delete %(item_count)s items from the shared folder ‘%(shared_folder_name)s’?",e.length).format({item_count:e.length,shared_folder_name:s})):1===e.length&&t&&!E.context().isNonUserRelativeContext?Q(G("Are you sure you want to remove the shared folder <b>%(filename)s</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."),{filename:n,b:Y.b()}):1===e.length?Q(G("Are you sure you want to delete <b>%(filename)s</b> from your Dropbox?"),{filename:n,b:Y.b()}):X("Are you sure you want to delete %(item_count)s item from your Dropbox?","Are you sure you want to delete %(item_count)s items from your Dropbox?",e.length).format({item_count:e.length}))},render:function(){return K(O,{ref:"modal",title:this._getTitle(),onAccept:this.handleAccept,acceptButtonText:G(this._isRemovingSharedFolder()&&!E.context().isNonUserRelativeContext?"Remove":"Delete"),dismissButtonText:G("Cancel")},this._getContents())}}),M=(function(e){function t(e,n){this._handleAccept=bind(this._handleAccept,this),t.__super__.constructor.call(this,e,n)}return extend(t,e),t.prototype.render=function(){return K(O,{ref:"modal",title:this._getTitle(),onAccept:this.handleAccept,buttonComponent:this._renderButtons(),acceptButtonText:G(this._isRemovingSharedFolder()?"Remove":"Delete"),dismissButtonText:G("Cancel")},this._getContents(),this._renderAdditionalContent())},t.prototype._renderAdditionalContent=function(){var e;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":e[0].target_ns&&1===e.length&&!E.context().isNonUserRelativeContext?Y.div({className:"u-mar-top-s"},G("Or, get more space for your files when you upgrade your account.")):!e[0].target_ns||e.length>1?Y.span({className:"oq-delete-file-modal-upsell__additional-text"},G("Instead, get more space for your files when you upgrade your account.")):void 0},t.prototype._handleAccept=function(){return this.handleAccept(),O.close()},t.prototype._upgradeRedirect=function(){var e;return e=w({path:"/plans",query:{trigger:"nr",tk:"oq_delete_modal"}}),v.redirect(e)},t.prototype._renderButtons=function(){return Y.div({className:"oq-delete-file-modal-upsell__buttons"},Y.button({className:"button-primary db-modal-button",onClick:this._upgradeRedirect,ref:"primaryButton"},G("Upgrade")),Y.button({className:"button-secondary db-modal-button u-mar-left-s",onClick:this._handleAccept,ref:"secondaryButton"},G(this._isRemovingSharedFolder()?"Remove":"Delete")))},t})(T),N=(function(e){function t(e,n){this._handleAccept=bind(this._handleAccept,this),t.__super__.constructor.call(this,e,n)}return extend(t,e),t.prototype.render=function(){var e,t;return e="V1"===this.props.expOQProVariant?this._renderFooter():null,t="V2"===this.props.expOQProVariant?this._renderButtons():null,K(O,{ref:"modal",title:this._getTitle(),onAccept:this.handleAccept,altAction:e,buttonComponent:t,acceptButtonText:G(this._isRemovingSharedFolder()?"Remove":"Delete"),dismissButtonText:G("Cancel")},this._getContents(),"V2"===this.props.expOQProVariant?this._renderAdditionalContent():void 0)},t.prototype._renderFooter=function(){var e,t;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":(_.filename(e[0].fq_path),t=e[0].target_ns,Y.div({className:"delete-file-modal-upsell"},Y.div({className:"delete-file-modal-upsell__footer"},1===e.length&&t&&!E.context().isNonUserRelativeContext?Q(G("Are you sure you want to delete this shared folder? Instead, keep all your files with Dropbox %(trademark_plus)s. <upgradeLink>Upgrade now.</upgradeLink>"),{upgradeLink:Y.a({className:"delete-file-modal-upsell__footer--nowrap",href:w({path:"/pro/buy",query:{oqa:"oqdel"}})}),trademark_plus:V}):1===e.length?Q(G("Are you sure you want to delete this file? Instead, keep all your files with Dropbox %(trademark_plus)s. <upgradeLink>Upgrade now.</upgradeLink>"),{upgradeLink:Y.a({className:"delete-file-modal-upsell__footer--nowrap",href:w({path:"/pro/buy",query:{oqa:"oqdel"}})}),trademark_plus:V}):Q(G("Are you sure you want to delete these files? Instead, keep all your files with Dropbox %(trademark_plus)s. <upgradeLink>Upgrade now.</upgradeLink>"),{upgradeLink:Y.a({className:"delete-file-modal-upsell__footer--nowrap",href:w({path:"/pro/buy",query:{oqa:"oqdel"}})}),trademark_plus:V}))))},t.prototype._renderAdditionalContent=function(){var e;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":!e[0].target_ns||e.length>1?Y.span({className:"delete-file-modal-upsell__additional-text"},Q(G("Instead, keep all your files with Dropbox %(trademark_plus)s."),{trademark_plus:V})):void 0},
t.prototype._handleAccept=function(){return this.handleAccept(),O.close()},t.prototype._upgradeRedirect=function(){var e;return e=w({path:"/pro/buy",query:{oqa:"oqdel"}}),v.redirect(e)},t.prototype._renderButtons=function(){return Y.div({className:"delete-file-modal-upsell__buttons"},Y.button({className:"button-secondary db-modal-button",onClick:this._handleAccept,ref:"secondaryButton"},G(this._isRemovingSharedFolder()?"Remove":"Delete")),Y.button({className:"button-primary db-modal-button u-mar-left-s",onClick:this._upgradeRedirect,ref:"primaryButton"},G("Upgrade")))},t})(T),N=c(N,["/static/css/react/exp_file_modal-vfl8ta8sG.css"]),P=e.createClass({displayName:"ContentManagerBridgeModal",propTypes:{files:e.PropTypes.arrayOf(e.PropTypes.shape({fq_path:e.PropTypes.string,is_dir:e.PropTypes.bool})).isRequired,type:e.PropTypes.string,isLimitedTeam:e.PropTypes.bool},handleAccept:function(){return W(this.props.isLimitedTeam,this.props.files[0].fq_path).then(function(e){return v.open_tab(e.toString())})},render:function(){return K(O,{ref:"modal",style:"clean",onAccept:this.handleAccept,acceptButtonText:G("Go to Admin Console"),altAction:Y.a({onClick:function(){return O.close()}},G("Cancel")),width:350,showX:!1,className:"content-manager-bridge-modal"},"archive"===this.props.type?G("You can archive team folders in the Admin Console."):"rename"===this.props.type?G("You can rename team folders in the Admin Console."):void 0)}}),D=e.createClass({displayName:"NoAccessFolderModal",propTypes:{folderName:e.PropTypes.string.isRequired,userIsSameTeam:e.PropTypes.bool.isRequired},render:function(){var e;return e="",e=G(this.props.userIsSameTeam?"You don’t have permission to open the folder “%(folder_name)s”. Contact your <admin_link>team admins</admin_link> to gain access.":"You don’t have permission to open the folder “%(folder_name)s”."),K(O,{ref:"modal",style:"default",acceptButtonText:G("Done"),title:G("No access to the folder “%(folder_name)s”").format({folder_name:s.em_snippet(this.props.folderName,H.FILENAME)})},Y.div({},Q(e,{folder_name:s.em_snippet(this.props.folderName,H.FILENAME),admin_link:Y.a({href:"/team?_tk=left_nav_team",target:"_blank",key:"admin_link"})})))}}),{FileTransferModal:F,RestoreFilesModal:B,PermanentlyDeleteModal:q,DeleteFileModal:T,ContentManagerBridgeModal:P,NoAccessFolderModal:D,ExpDeleteFileModal:N,ExpOQDeleteFileModal:M}});var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/radio",["external/classnames","external/react","external/react-dom"],function(e,t,n){var s,r,o,i,a,l;return t.DOM,l=t.PropTypes,o={Normal:"normal",Large:"large"},a=Object.keys(o).map(function(e){return o[e]}),i=l.oneOfType([l.string,l.number,l.bool]),r=t.createClass({displayName:"RadioItem",propTypes:{className:l.string,value:i,_radioGroupData:l.shape({variant:l.oneOf(a),name:l.string.isRequired,radioGroupValue:i,onSelect:l.func})},_handleClick:function(){var e;this._isSelected()||(n.findDOMNode(this.refs.input).focus(),"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value))},_handleChange:function(){var e;"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value)},_getId:function(){return this.props._radioGroupData.name+"_"+this.props.value},_isSelected:function(){return this.props._radioGroupData.radioGroupValue===this.props.value},render:function(){var n,s,r,i;return s=this.props._radioGroupData,i=["c-radio-wrapper",this.props.className],n={"c-radio":!0,"c-radio--selected":this._isSelected()},r=s.variant,indexOf.call(a,r)>=0&&s.variant!==o.Normal&&(n["c-radio--"+s.variant]=!0),t.createElement("div",{className:e(i),onClick:this._handleClick},t.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:s.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),t.createElement("div",{className:e(n)},t.createElement("div",{className:"c-radio__inner"})),t.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))}}),s=t.createClass({displayName:"RadioGroup",propTypes:{className:l.string,variant:l.oneOf(a),name:l.string,legend:l.string.isRequired,align:l.oneOf(["top","bottom","middle","baseline"]),displayLegend:l.bool,valueLink:l.object},getDefaultProps:function(){return{className:null,type:o.Normal,align:"middle",displayLegend:!1}},_onRadioItemSelect:function(e){var t;null!=(t=this.props.valueLink)&&t.requestChange(e)},render:function(){var n,s,o,i;return s=this.props.name||"radio-"+Math.floor(1e9*Math.random()),n=t.Children.map(this.props.children,(function(e){return function(n){return n.type===r?t.cloneElement(n,{_radioGroupData:{variant:e.props.variant,name:s,radioGroupValue:e.props.valueLink.value,onSelect:e._onRadioItemSelect}}):n}})(this)),o={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},i=["c-radio-group","align-"+this.props.align,this.props.className],t.createElement("fieldset",{className:e(i)},t.createElement("legend",{className:e(o)},this.props.legend),n)}}),{RadioGroup:s,RadioItem:r,RadioItemVariant:o}}),define("modules/clean/react/sharing/shared_with_view",["external/classnames","external/react","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/size","modules/clean/components/loading_indicator","modules/clean/components/title_bubble","modules/clean/sharing/constants","modules/clean/em_string","modules/clean/react/browse/models","modules/clean/sharing/api/types/metadata","modules/clean/sharing/member_avatars","modules/clean/sharing/ui_util","modules/clean/static_urls","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/constants/viewer","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f){var g,y,b,v,S,I,w,C,E,P,T,N,M,k,A,F,x,L,R;return y=s.AVATAR_DIMENSION_BY_SIZE,P=i.SNIPPET_SIZES,M=i.TRUELINK,v=l.File,I=d.LinkAudience,T=d.SharedContentLinkMetadata,S=p.GoldenGate,L=u.static_url,k=h.UserEducationEffect,A=f._,R=f.ungettext,x=t.DOM,F=t.createElement,w=5,g=y.SMALL,b=12,C="--",E="--",N=t.createClass({displayName:"SharedWithView",mixins:[c],propTypes:{user:t.PropTypes.object.isRequired,file:t.PropTypes.instanceOf(v),onOverflowCountClick:t.PropTypes.func,onAvatarClick:t.PropTypes.func,groups:t.PropTypes.array,invitations:t.PropTypes.array,joinedMembers:t.PropTypes.array,numUndisplayableUsersAndInvites:t.PropTypes.number,memberCount:t.PropTypes.number,numInheritedMembers:t.PropTypes.number,parentFolderName:t.PropTypes.string,animation:t.PropTypes.bool,titleButtonDirection:t.PropTypes.string,avatarDimension:t.PropTypes.number,maxVisibleAvatars:t.PropTypes.number,sharedLinkInfo:t.PropTypes.object,onSharedLinkClick:t.PropTypes.func,isMaestroDesign:t.PropTypes.bool,inSelectMode:t.PropTypes.bool,isInAudienceBox:t.PropTypes.bool,audienceDescription:t.PropTypes.string,hasSharedDataLoaded:t.PropTypes.bool,canViewMembers:t.PropTypes.bool,inContentManagerCdmRoot:t.PropTypes.bool,linkMetadata:t.PropTypes.instanceOf(T),publicFolderSharing:t.PropTypes.bool},getDefaultProps:function(){return{titleButtonDirection:"south",avatarDimension:g,maxVisibleAvatars:w,file:null,canViewMembers:!0,inContentManagerCdmRoot:!1,inSelectMode:!1}},render:function(){var e,t;return this.props.inContentManagerCdmRoot?0===this.props.groups.length?x.div({}):(e=this.props.groups[0].num_users,x.div({className:"audience-description",onClick:function(e){return e.stopPropagation()}},R("%(num)s member","%(num)s members",e).format({num:e}))):this.props.isInAudienceBox&&S.hasAudienceBox(this.props.user.id)?this.props.canViewMembers?(null!=(t=this.props.file)?t.isDeleted:void 0)?null:x.div({className:this.getClassName()},this.props.hasSharedDataLoaded?F(k,{containerName:this.constructor.displayName,name:"AudienceBoxAvatars"},this.renderAudienceBoxAvatars()):F(r,{style:r.LoadingIndicatorStyle.DOTS})):null:this.props.isMaestroDesign&&S.hasAudienceBox(this.props.user.id)?x.div({className:this.getClassName()},this._hasSharedLink()?this.renderSharedLinkInColumn():void 0,this.renderAudienceDescription()):x.div({className:this.getClassName()},this.renderAvatars())},getClassName:function(){return e({"shared-with-members":!0,"shared-with-members--golden-gate":!this.props.isMaestroDesign,clearfix:!0,"audience-box u-pad-top-xs u-pad-bottom-s u-mar-buttom-xs":this.props.isInAudienceBox})},renderSharedLinkInColumn:function(){var e,t;return t=this.props.onSharedLinkClick,e=this.props.inSelectMode,F(o,{key:"shared_link",text:this.getDescriptionForSharedLinkInfo(this.props.sharedLinkInfo,this.props.linkMetadata),direction:this.props.titleButtonDirection,className:"audience-description__link-avatar"},x.img({src:L("/static/images/avatar/shared-link-icon-vflHCU_m6.svg"),alt:this.props.alt||A("Shared link"),width:b,height:b,onClick:function(n){if(!e)return t(),n.stopPropagation()}}))},renderAudienceDescription:function(){var e,t,n,s,r,i,l,d,c,p,u,h,m,_,f,g,y;return this.props.hasSharedDataLoaded?((null!=(_=this.props.file)?_.isDeleted:void 0)?n=A("Deleted"):this.props.canViewMembers?this.props.audienceDescription&&(n=this.props.audienceDescription):n=E,s=(this.props.groups||[]).concat(this.props.joinedMembers||[]).concat(this.props.invitations||[]),p=s.length+(this.props.numUndisplayableUsersAndInvites||0),f=this.findOwnerAndMeInJoinedMembers(this.props.joinedMembers||[]),f[0],c=f[1],p>0&&(1!==p||null==c)&&(n||(n=R("%(num)s member","%(num)s members",this.props.memberCount).format({num:this.props.memberCount})),y=s.slice(0,this.props.maxVisibleAvatars),h=(function(){var e,t,n;for(n=[],e=0,t=y.length;e<t;e++)d=y[e],n.push(a.em_snippet(d.display_name||d.name||d.email_or_fbname,P.DISPLAY_NAME));return n})(),p>this.props.maxVisibleAvatars&&(h.pop(),e=p-(this.props.maxVisibleAvatars-1),u=R("and %(num)s more...","and %(num)s more...",e,{comment:"Number of additional members in the file. Expected to be >= 2."}).format({num:e}),h.push(u)),r=h.join("\n")),this.props.publicFolderSharing&&this.props.file&&!this.props.file.is_dir?n||(n=A("Anyone")):n||(n=A("Only you")),m=this.props.onAvatarClick,i=this.props.inSelectMode,l=null!=(g=this.props.file)?g.isDeleted:void 0,t=x.div({className:"audience-description",onClick:function(e){if(!i&&!l)return m(),e.stopPropagation()}},n),r?F(o,{key:"membership_column_bubble",respectLineBreaks:!0,text:r,direction:this.props.titleButtonDirection},t):t):null},renderAudienceBoxAvatars:function(){var e,t,n,s,r,o,i;return e=[],s=this.props.joinedMembers?this.props.joinedMembers:[],t=this.props.groups?this.props.groups.slice():[],n=this.props.invitations?this.props.invitations.slice():[],this._addSharedLinkIfExists(e),i=[],o=this.findOwnerAndMeInJoinedMembers(s),o[0],r=o[1],null!=r&&(i.push(r.user_id),e.push(this.renderJoinedMember(r))),this.addGroupsMembersInvitations(e,t,s,n,i),1===e.length&&null!=r?x.div({className:"audience-box--text-only"},A("Only you have access")):this.renderAvatarList(e)},renderAvatars:function(){var e,t,n,s,r,o,i,a,l,d;return(null!=(a=this.props.file)?a.isDeleted:void 0)?x.span({"aria-hidden":!0},A("deleted")):(r=this.props.joinedMembers?this.props.joinedMembers:[],n=this.props.groups?this.props.groups.slice():[],s=this.props.invitations?this.props.invitations.slice():[],e=[],this._addSharedLinkIfExists(e),d=[],l=this.findOwnerAndMeInJoinedMembers(r),i=l[0],o=l[1],S.hasNewMembershipUI(this.props.user.id)||(null!=i&&i===o&&(i=null),null!=i&&(d.push(i.user_id),e.push(this.renderJoinedMember(i)))),null!=o&&d.push(o.user_id),this.addGroupsMembersInvitations(e,n,r,s,d),t=0===e.length&&(0===this.props.numInheritedMembers||!S.hasNewMembershipUI(this.props.user.id)),t?this.props.hasSharedDataLoaded?x.span({"aria-hidden":!0},C):void 0:this.renderAvatarList(e))},_addSharedLinkIfExists:function(e){if(this._hasSharedLink())return M.TRUELINK_UI[this.props.user.id]?e.push(this.renderSharedLink(null,this.props.linkMetadata)):e.push(this.renderSharedLink(this.props.sharedLinkInfo))},_hasSharedLink:function(){return M.TRUELINK_UI[this.props.user.id]?this.props.linkMetadata&&this.props.linkMetadata.current_audience!==I.members:Boolean(this.props.sharedLinkInfo)}}),{SharedWithView:N}}),define("modules/clean/react/starred/browse_exports",["require","exports","modules/clean/react/starred/store","modules/clean/react/starred/star","modules/clean/react/starred/actions"],function(e,t,n,s,r){"use strict";t.StarredStore=n.StarredStore,t.Star=s.Star,t.StarredActions=r.StarredActions}),define("modules/clean/react/teams/modals/limited_team_folder_settings_modal",["external/react","external/underscore","modules/core/i18n","modules/clean/analytics","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/sharing/folder_settings_modal","modules/constants/python"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u;return p=n._,c=s.TeamsWebActionsLogger,l=r.Modal,d=i.SharedFolderSettingsModal,u=e.createElement,{showWithProps:function(e){var n,s;return n={altAction:u(o,{upsellText:p("Want to access these settings as well as other admin controls? Upgrade to %(trademark_business)s.").format({trademark_business:a.TRADEMARK_BUSINESS}),upgradeButtonText:p("Upgrade now"),redirectQuery:{tk:"team_settings",_camp:"modal"},logEventName:"team_folder_settings_upsell"})},s=l.showInstance(u(d,t(e).extend(n))),c.log("team_folder_settings",null,null,null,!1,c.LOG_CATEGORY.TEAM_INFO),s}}}),define("modules/clean/react/teams/modals/limited_team_share_folder_modal",["external/react","modules/core/i18n","modules/clean/analytics","modules/clean/filepath","modules/clean/react/modal","modules/core/browser","modules/core/uri"],function(e,t,n,s,r,o,i){var a,l,d,c,p,u,h;return c=t._,d=n.TeamsWebActionsLogger,l=r.Modal,h=e.DOM,u=e.createElement,p=function(e){return d.log(e,null,null,null,!1,d.LOG_CATEGORY.TEAM_INFO)},a=e.createClass({mixins:[e.addons.PureRenderMixin],displayName:"LimitedTeamShareFolderModal",propTypes:{fqPath:e.PropTypes.string.isRequired},_navigateToTeam:function(){return p("team_folder_share_invite"),o.redirect(i({path:"/team",query:{invite_members:"",tk:"team_folder_share_invite",_camp:"modal"}}))},render:function(){var e;return e=s.filename(this.props.fqPath),u(l,{title:c("Share %(folder_name)s").format({folder_name:e}),acceptButtonText:c("Invite"),onAccept:this._navigateToTeam,showButtonDivider:!0},h.div({},c("To share the %(folder_name)s with someone, invite them to join your team!").format({folder_name:e})))}}),{showModalInstance:function(e){var t;return t=l.showInstance(u(a,e)),p("team_folder_share"),t}}}),define("modules/clean/react/teams/modals/limited_team_upsell_modal_banner",["external/react","modules/core/browser","modules/core/uri","modules/clean/react/button","modules/clean/analytics"],function(e,t,n,s,r){var o,i,a,l,d;return i=s.button,o=r.TeamsWebActionsLogger,l=e.DOM,a=e.createElement,d=e.PropTypes,e.createClass({mixins:[e.addons.PureRenderMixin],propTypes:{upgradeButtonText:d.string.isRequired,upsellText:d.string.isRequired,logEventName:d.string,redirectUrl:d.string,redirectQuery:d.shape({tk:d.string,_camp:d.string})},displayName:"LimitedTeamUpsellModalBanner",_handleCTAClick:function(){return this.props.logEventName&&o.log(this.props.logEventName,{},null,null,!1,o.LOG_CATEGORY.UPGRADE),t.redirect(n({path:this.props.redirectUrl?this.props.redirectUrl:"/team/upgrade",query:this.props.redirectQuery}))},render:function(){return l.div({className:"modal-upsell-bar"},l.div({className:"modal-upsell-bar__message"},this.props.upsellText),l.div({className:"modal-upsell-bar__action"},a(i,{className:"modal-upsell-bar__cta-button",onClick:this._handleCTAClick},this.props.upgradeButtonText)))}})}),define("modules/clean/react/tree_view",["jquery","external/immutable","external/underscore","external/classnames","external/react","external/react-dom","modules/clean/ajax","modules/clean/em_string","modules/clean/filepath","modules/clean/react/css","modules/clean/react/browse/store","modules/clean/react/image","modules/clean/react/sprite","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/clean/keycode"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f){var g,y,b,v,S,I,w,C,E,P,T,N,M,k,A,F;return F=l.filename,g=c.BrowseStore,M=m._,v=f.KeyCode,A=r.DOM,k=r.createElement,S=20,b=15,I={None:"None",TreeItem:"TreeItem",HeaderItem:"HeaderItem",StaticHeader:"StaticHeader"},P=t.Record({key:void 0,label:"",icon:null,disabled:!1,canExpand:!1,forceExpanded:!1}),w=t.Record({childItemsByParentKey:t.Map(),parentItemByChildKey:t.Map(),items:t.Map(),rootItem:new P}),w.createWithRootItem=function(e){return new w({rootItem:e,items:t.Map([[e.key,e]])})},w.prototype.getParentItem=function(e){var t;if(e)return t=this.parentItemByChildKey.get(e.key),t?this.items.get(t):null},w.prototype.getChildItems=function(e){return this.childItemsByParentKey.get(e.key)||null},w.prototype.isParent=function(e){return this.childItemsByParentKey.has(e.key)},w.prototype.setChildItems=function(e,n){return this.withMutations(function(s){var r;return n=t.List(n),r=t.Map(n.map(function(e){return[e.key,e]})),s.set("items",s.items.merge(r)),s.set("childItemsByParentKey",s.childItemsByParentKey.set(e.key,n)),n.forEach(function(t){return s.set("parentItemByChildKey",s.parentItemByChildKey.set(t.key,e.key))})})},C=r.createClass({displayName:"TreeGroupView",propTypes:{ariaLabel:r.PropTypes.string},render:function(){return A.ul({className:"tree-view__group",role:"group"},this.props.children)}}),T=r.createClass({displayName:"TreeItemView",propTypes:{item:r.PropTypes.instanceOf(P).isRequired,id:r.PropTypes.string.isRequired,isSelected:r.PropTypes.bool,isExpanded:r.PropTypes.bool,canExpand:r.PropTypes.bool,level:r.PropTypes.number,onClick:r.PropTypes.func,onExpandButtonClick:r.PropTypes.func,showAsHeader:r.PropTypes.bool},getDefaultProps:function(){return{isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:n.noop,onExpandButtonClick:n.noop,showAsHeader:!1}},handleClick:function(e){var t;if(e.preventDefault(),e.stopPropagation(),!(this.props.item.disabled||null!=(t=o.findDOMNode(this.refs.expandButton))&&t.contains(e.target)))return this.props.onClick(this.props.item)},handleExpandClick:function(e){return e.preventDefault(),this.props.onExpandButtonClick(this.props.item,!this.props.isExpanded)},_renderExpandButton:function(){return A.div({className:"tree-view__expand-button",onClick:this.handleExpandClick,ref:"expandButton",role:"button"},k(u,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:M(this.props.isExpanded?"Collapse":"Expand")}))},_renderIcon:function(){return A.div({className:"tree-view__icon-wrapper"},k(u,{className:"tree-view__item-icon",group:"web",name:this.props.item.icon,alt:""}))},render:function(){var e,t,n;return t=!this.props.canExpand,e=s({"tree-view__item":!0,"tree-view__item--leaf":t}),n={key:this.props.item.key,id:this.props.id,className:e,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1},this.props.canExpand&&!this.props.showAsHeader&&(n["aria-expanded"]=this.props.isExpanded),this.props.isSelected&&(n["aria-selected"]=!0),A.li(n,A.span({className:s({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled}),style:{paddingLeft:this.props.showAsHeader?0:this.props.level*b}},this.props.showAsHeader||t?void 0:this._renderExpandButton(),this.props.item.icon?this._renderIcon():void 0,this.props.item.label?A.span({className:"tree-view__item-label"},a.em_snippet(this.props.item.label,S)):void 0),this.props.children)}}),E=r.createClass({displayName:"TreeHeaderView",propTypes:{item:r.PropTypes.instanceOf(P).isRequired,id:r.PropTypes.string.isRequired},_renderIcon:function(){return this.props.item.icon?k(u,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null},render:function(){return A.div({className:"tree-view__item-row"},this._renderIcon(),A.h3({className:"tree-view__header",id:this.props.id},this.props.item.label))}}),N=r.createClass({displayName:"TreeView",propTypes:{tree:r.PropTypes.instanceOf(w).isRequired,rootStyle:r.PropTypes.oneOf(n.keys(I)),onItemSelected:r.PropTypes.func,onItemExpanded:r.PropTypes.func},getDefaultProps:function(){return{rootStyle:I.None,treeItemView:T,onItemSelected:function(){},onItemExpanded:function(){}}},getInitialState:function(){return{selectedItemKey:null,expandedItemKeys:t.Set([this.props.tree.rootItem.key]),showFocused:!1}},componentDidMount:function(){return e(o.findDOMNode(this)).on("keydown",this.handleKeyDown)},componentWillUnmount:function(){return e(o.findDOMNode(this)).off("keydown")},componentDidUpdate:function(t,n){var s,r;if(this.state.selectedItemKey&&this.state.selectedItemKey!==n.selectedItemKey&&(s=e(o.findDOMNode(this)),r=s.find('[aria-selected="true"]').eq(0),r.length))return this._scrollElementIntoViewIfNeeded(r,s)},_scrollElementIntoViewIfNeeded:function(e,t){var n,s,r,o,i,a,l;return r=t.scrollTop(),i=r+e.position().top,l=i-r,l<0?void t.scrollTop(i):(n=t.innerHeight(),s=r+n,o=e.innerHeight(),a=i+o,a>s?t.scrollTop(i-n+o):void 0)},_hasSelectableRootItem:function(){var e;return e=this.props.rootStyle,e===I.TreeItem||e===I.HeaderItem},_getHTMLIdPrefix:function(){return this._HTMLIdPrefix||(this._HTMLIdPrefix="tree-view-"+Math.floor(16777215*Math.random()).toString(16))},selectItem:function(e){return this.setState({selectedItemKey:null!=e?e.key:void 0}),this.props.onItemSelected(e)},_getLastLeafOf:function(e){var t;return t=this.props.tree.getChildItems(e),this.state.expandedItemKeys.contains(e.key)&&(null!=t?t.size:void 0)>0?this._getLastLeafOf(t.last()):e},_getPrevItem:function(e){var t,n,s,r;return(s=this.props.tree.getParentItem(e))?(r=this.props.tree.getChildItems(s),n=r.indexOf(e),n>0?this._getLastLeafOf(r.get(n-1)):0===n?(t=s===this.props.tree.rootItem,t&&!this._hasSelectableRootItem()?null:s):null):null},_getNextItem:function(e,t){var n,s,r,o,i,a;return null==t&&(t=!0),e?(r=this.state.expandedItemKeys.contains(e.key),n=r&&this.props.tree.isParent(e),t&&n?this.props.tree.getChildItems(e).first():(i=this.props.tree.getParentItem(e))?(a=this.props.tree.getChildItems(i),o=a.size-1,s=a.indexOf(e),s===o?this._getNextItem(i,!1):0<=s&&s<o?a.get(s+1):null):null):null},advanceSelection:function(e){var t,n,s;return null==e&&(e=!1),this.state.selectedItemKey?(s=this.props.tree.items.get(this.state.selectedItemKey),n=e?this._getPrevItem(s):this._getNextItem(s),n?(this.selectItem(n),!0):void 0):(t=this._hasSelectableRootItem()?this.props.tree.rootItem:this.props.tree.getChildItems(this.props.tree.rootItem).first(),this.selectItem(t),!0)},_getValidHTMLIdForItem:function(e){return(""+this._getHTMLIdPrefix()+e.key).replace(/\s+/g,"_")},_setItemExpanded:function(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)},_canItemExpand:function(e){return e&&(e.canExpand||this.props.tree.isParent(e))},handleExpandButtonClick:function(e,t){return this.setState({expandedItemKeys:this._setItemExpanded(e.key,t)}),this.props.onItemExpanded(e,t)},handleKeyDown:function(e){var t;switch(e.which){case v.UP:if(this.advanceSelection(!0))return e.preventDefault();break;case v.DOWN:if(this.advanceSelection(!1))return e.preventDefault();break;case v.RIGHT:if(t=this.props.tree.items.get(this.state.selectedItemKey),this._canItemExpand(t))return this.handleExpandButtonClick(t,!0),e.preventDefault();break;case v.LEFT:if(t=this.props.tree.items.get(this.state.selectedItemKey),this._canItemExpand(t))return this.handleExpandButtonClick(t,!1),e.preventDefault()}},_renderSingleItem:function(e,t,s,r){var o,i;return null==s&&(s=null),null==r&&(r={}),o={id:this._getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this._canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},i=n.extend({},o,r),k(this.props.treeItemView,i,s)},_renderItemAndDescendants:function(e,t){var n,s;return s=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,this.props.tree.isParent(e)&&s&&(n=this._renderChildrenOfItemAsGroup(e,t+1)),this._renderSingleItem(e,t,n)},_renderChildrenOfItemAsGroup:function(e,t){var n;return e&&this.props.tree.isParent(e)?(n=this.props.tree.getChildItems(e).map((function(e){return function(n){return e._renderItemAndDescendants(n,t)}})(this)),k(C,null,n.toJS())):null},render:function(){var e,t,n,r,o;if(t={role:"tree",tabIndex:0,onFocus:(function(e){return function(){return e.setState({showFocused:!0})}})(this),onBlur:(function(e){return function(){return e.setState({showFocused:!1})}})(this),className:s("tree-view","ax-focusable",{"is-focused":this.state.showFocused})},n=this.props.tree.rootItem,this.state.selectedItemKey&&(r=this.props.tree.items.get(this.state.selectedItemKey),t["aria-activedescendant"]=this._getValidHTMLIdForItem(r)),this.props.rootStyle===I.TreeItem)o=k(C,null,this._renderItemAndDescendants(n,0));else if(this.props.rootStyle===I.HeaderItem)e=this._getValidHTMLIdForItem(n),o=k(C,null,this._renderSingleItem(n,0,null,{showAsHeader:!0,id:e}),this._renderChildrenOfItemAsGroup(n,0));else if(this.props.rootStyle===I.StaticHeader)e=this._getValidHTMLIdForItem(n),o=k(C,null,k(E,{item:n,id:e}),this._renderChildrenOfItemAsGroup(n,0));else{if(this.props.rootStyle!==I.None)throw new Error("Unknown root style: "+this.props.rootStyle);o=this._renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}return e&&(t["aria-labelledby"]=e),A.div(t,o,this.props.children)}}),N=d(N,["/static/css/react/tree_view-vflOwUm_p.css","/static/css/accessibility-vflRPMGHg.css"]),y=r.createClass({displayName:"FolderTreeView",propTypes:{user:r.PropTypes.object.isRequired,rootPath:r.PropTypes.string,onFolderSelected:r.PropTypes.func,isRootSelectable:r.PropTypes.bool,treeRootName:r.PropTypes.string},getDefaultProps:function(){return{rootPath:"/",onFolderSelected:function(){},isRootSelectable:!1,treeRootName:null}},getInitialState:function(){return{showLoadingScreen:!1,tree:null}},componentWillMount:function(){var e;if(!this.state.tree)return e=this._constructRootItem(),this.setState({tree:w.createWithRootItem(e)})},componentDidMount:function(){return this._isMounted=!0,this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)},componentWillUnmount:function(){if(this._isMounted=!1,this._pendingAjaxRequest)return this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=null},_constructRootItem:function(){var e,t;return t=this.props.treeRootName||h.get_role_title(this.props.user)||M("Dropbox"),e=h.get_viewer().is_paired?this.props.user.is_team?"s_briefcase":"s_house":"dropbox",new P({key:this.props.rootPath,icon:e,label:t})},_parseFolderList:function(e){var n,s,r,o,i,a;for(i=JSON.parse(e),a=[],s=0,o=i.length;s<o;s++)n=i[s],r=n.path,a.push(new P({key:r,label:F(n.path),canExpand:n.has_subdirs,icon:n.icon,disabled:n.read_only}));return t.List(a)},asyncFetchSubFoldersForItem:function(e){var t,n,s,r,o;return r=e.key,s=e===this.state.tree.rootItem,s&&this.setState({showLoadingScreen:!0}),t=g.context(),t.isNonUserRelativeContext?(o="/browse_util/tree_view_team_folder_contents",n={ns_id:t.rootNSID,ns_path:r,hide_tmfs:!0}):(o="/browse_util/tree_view_folders",n={folder:r}),this._pendingAjaxRequest&&this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=i.WebRequestOref({url:o,type:"POST",subject_user:this.props.user.id,data:n,success:(function(t){return function(n){var s,r;return s=t._parseFolderList(n),r=t.state.tree.setChildItems(e,s),t.setState({tree:r})}})(this),error:function(){return _.error(M("An error occurred while trying to load your folder."))},complete:(function(e){return function(){if(e._pendingAjaxRequest=null,e._isMounted&&s)return e.setState({showLoadingScreen:!1})}})(this)})},handleItemSelected:function(e){return this.props.onFolderSelected(e.key)},handleExpandButtonClick:function(e,t){if(t&&!this.state.tree.isParent(e))return this.asyncFetchSubFoldersForItem(e)},_renderLoadingMessage:function(){return A.span({className:"tree-view__loading-label"},M("Loading your folders…"))},render:function(){var e;return e=this.props.isRootSelectable?I.HeaderItem:I.StaticHeader,k(N,{tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick},this.state.showLoadingScreen?this._renderLoadingMessage():void 0)}}),{INDENT_SIZE_PX:b,MAX_LABEL_LENGTH:S,RootStyle:I,FolderTreeView:y,TreeView:N,TreeItemView:T,TreeItem:P,Tree:w}});var bind=function(e,t){return function(){return e.apply(t,arguments)}},indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/sharing/actions/share_modal",["jquery","require","external/react","external/react-dom","external/underscore","modules/clean/ajax","modules/clean/analytics","modules/clean/api_v2/error","modules/clean/browse_interface","modules/clean/flux/dispatcher","modules/clean/growth/experiments/logger","modules/clean/growth/experiments/sharing_paywall_actions_store","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/file_viewer/store","modules/clean/react/modal","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/react/pass/store","modules/clean/react/pass/utils","modules/clean/sharing/action_types","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal","modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal","modules/clean/sharing/confirmation_modals/simple_confirm_modal","modules/clean/sharing/constants","modules/clean/sharing/link_settings_modal","modules/clean/sharing/parent_folder_access_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/ui_util","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/teams/membership_discovery_util","modules/clean/teams/modals/create_team_prompt_modal","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/zendesk_feedback","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y){var z,j,Q,X,J,Z,$,ee,te,ne,se,re,oe,ie,ae,le,de,ce,pe,ue,he,me,_e,fe,ge,ye,be,ve,Se,Ie,we,Ce,Ee,Pe,Te,Ne,Me,ke,Ae,Fe,xe,Le,Re,Oe,De,Ue,qe,Be,He,Ve,Ge,We;return Ie=i.SharingExperimentsLogger,Ee=i.TeamsWebActionsLogger,J=a.AppError,Me=a.catchApiError,ce=p.PAYWALL_SERIES_LOGGING_NAME,be=h.SharedWithActionTypes,Z=_.BrowseStore,re=g.FileViewerStore,le=y.Modal,ue=b.PassActions,de=v.PASS_FETCHING_STATUS,xe=v.fetchingStatusIsSuccessful,he=I.PassHelpers,fe=w.ShareModalActionTypes,ve=C.SharingActions,Se=E.SharingApi,ee=P.CombinedPolicy,ie=P.LinkAudience,me=P.PassPolicy,Ae=T.combinedPolicyDiffToApi,Fe=T.contactsToMembers,Be=T.memberAccessLevelApiToRecord,Ve=N.showMemberAccessChangeConfirmationModal,Ge=M.showRelinquishMembershipConfirmationModal,we=k.SimpleConfirmModal,z=A.ACCESS_LEVEL,j=A.ALPHA_FILE_METADATA_PERMISSIONS,Q=A.ALPHA_FOLDER_METADATA_PERMISSIONS,ne=A.FOLDER_METADATA_PERMISSIONS,se=A.FOLDER_METADATA_PERMISSIONS_INTERNAL,ae=A.MEMBER_ACTION,_e=A.SHARING_EXPERIMENTS,Ce=A.TRUELINK,Te=A.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE,Pe=A.VALIDATE_PATH_PERMISSIONS,ye=F.SharedLinkSettingsModal,We=F.showUpgradeToBizBanner,pe=x.ParentFolderAccessModal,ge=L.SharePageActionTypes,He=R.sharingInfoStore,De=O.getContentIdsForContentInfo,$=D.CONTACT_ERROR_LEVEL,Re=D.genAddMemberErrorMessage,Oe=D.genShareSuccessMessage,
Ue=D.getNewFolderPathFromContentName,oe=D.GoldenGate,qe=D.logTiburonEvent,X=U.AdminConsoleApiClient,Le=q.filterSuggestableUsers,te=B.CreateTeamPromptModal,ke=n.createElement,Ne=K.i18n_default_project("sharing")._,(function(){function n(e,t,n){this.waitForAllMembersLoaded=bind(this.waitForAllMembersLoaded,this),this.updateLinkSettings=bind(this.updateLinkSettings,this),this.turnLinkOnIfQualified=bind(this.turnLinkOnIfQualified,this),this._parseParentFolderAccessError=bind(this._parseParentFolderAccessError,this),this.showParentFolderAccessModalIfQualified=bind(this.showParentFolderAccessModalIfQualified,this),this.shareIfFileFolder=bind(this.shareIfFileFolder,this),this.sendShare=bind(this.sendShare,this),this.refreshSharedWithColumnContentData=bind(this.refreshSharedWithColumnContentData,this),this.redirectToPath=bind(this.redirectToPath,this),this.recipientsChange=bind(this.recipientsChange,this),this.openShareModal=bind(this.openShareModal,this),this.handleSelectLinkAudience=bind(this.handleSelectLinkAudience,this),this.handleLoadingError=bind(this.handleLoadingError,this),this.handleLinkSettingsClick=bind(this.handleLinkSettingsClick,this),this.handleGetMetadataSuccess=bind(this.handleGetMetadataSuccess,this),this.handleMemberAccessChange=bind(this.handleMemberAccessChange,this),this._fetchMetadataForSharedFolder=bind(this._fetchMetadataForSharedFolder,this),this._fetchMetadataForFileFolder=bind(this._fetchMetadataForFileFolder,this),this.fetchMetadataForFile=bind(this.fetchMetadataForFile,this),this.changeRecipientAccess=bind(this.changeRecipientAccess,this),this.changeLinkAudience=bind(this.changeLinkAudience,this),this.changeAccess=bind(this.changeAccess,this),this._client=e,this._user=t,this._shareModalClass=n,this._linkSeenStateInfo=null,this._groupSeenStateInfo=null,this._presentAccountIds=null,this._hasLoggedSet={}}return n.prototype.initializeShareModal=function(e,t){var n;return null==t&&(t={}),n=e.contentInfo,d.dispatch({type:fe.SHARE_MODAL_OPEN,data:{shareModalInfo:e,initialProps:t},contentIds:De(n),user:this._user}),this._sharingInfo=He.getSharingInfo(this._user.id,n.id),this._fetchInitialData()},n.prototype._fetchInitialData=function(){var e,t,n,s;return e=this._sharingInfo.contentInfo(),t=this._sharingInfo.isNonUserRelativeContext(),this._beginTime=Date.now(),this.admin_client=new X(!1),this._fetchPassInfo(),this._fetchUpsellExperimentVariant(),s=[],e.isFileFolder()?s.push(this._fetchMetadataForFileFolder(e)):(s.push(this.listMembers(e.id,e.url())),e.isFile()?s.push(this.fetchMetadataForFile(e)):e.isSharedFolder()&&s.push(this._fetchMetadataForSharedFolder(e))),s.push(this._fetchMemberCounts()),Ce.TRUELINK_UI[this._user.id]?(this._sharingInfo.isTeamPolicyLoaded()||s.push(this._fetchTeamPolicy()),this._sharingInfo.areSharingPrefsLoaded()||s.push(this._fetchSharingPrefs())):(s.push(this._fetchTeamPolicy()),s.push(this._fetchSharingPrefs()),this._sharingInfo.canShareLink()&&!t&&e.isMounted()&&s.push(this.fetchLinkMetadata())),n=_e.PAYWALL_SHARED_FOLDER[this._user.id],indexOf.call(_e.PAYWALL_SHARED_FOLDERS_ON_VARIANTS,n)>=0&&s.push(this._fetchSharingPaywallInfo()),Promise.all(s)},n.prototype._fetchPassInfo=function(){var e,t,n,s,r,o;if(this._sharingInfo.shouldBlockMemberListOnPassLoad()&&setTimeout((function(e){return function(){return e._dispatch(fe.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD)}})(this),4e3),s=this._getPassFileInfo(),t=s.nsId,o=s.sjid,e=s.fromBrowse,e&&(u.is_pass_ga_receive_enabled(this._user)||u.is_pass_enabled(this._user)))return n=S.passFetchingStatus(t,o),xe(n)?(r=S.getLinkAndGroupInfo(t,o),this._linkSeenStateInfo=r[0],this._groupSeenStateInfo=r[1],this._presentAccountIds=S.presence(t,o)):null==n?he.setup(this._user,this._getFileData(),null,!1):void 0},n.prototype.getSharingInfo=function(){return this._sharingInfo},n.prototype.clearCachedPassInfo=function(){var e;return e=[null,null,null],this._linkSeenStateInfo=e[0],this._groupSeenStateInfo=e[1],this._presentAccountIds=e[2],e},n.prototype.getPassInfo=function(){var e,t,n,s,r,o,i,a,l,d,c;if(e=this._getContentInfo(),!u.is_pass_ga_receive_enabled(this._user)&&!u.is_pass_enabled(this._user)||e.isFolder())return[[],{},[],de.ERROR];if(null!=this._linkSeenStateInfo&&null!=this._groupSeenStateInfo&&null!=this._presentAccountIds)return[this._linkSeenStateInfo,this._groupSeenStateInfo,this._presentAccountIds,de.PASS_SUCCESS];if(a=this._getPassFileInfo(),s=a.nsId,c=a.sjid,null==s||null==c)return l=[[],{},[]],this._linkSeenStateInfo=l[0],this._groupSeenStateInfo=l[1],this._presentAccountIds=l[2],[[],{},[],de.ERROR];if(u.is_pass_ga_receive_enabled(this._user)){if(o=S.getPassPermissions(s,c),t=S.isPassPermissionsPending(e.id),t||null===o)return[[],{},[],de.FETCHING];if(null!=o&&!o.canReadPresence)return[[],{},[],de.ERROR]}return r=S.passFetchingStatus(s,c),xe(r)?(n=S.getLinkAndGroupInfo(s,c),i=S.presence(s,c),this._linkSeenStateInfo=n[0],this._groupSeenStateInfo=n[1],this._presentAccountIds=i.slice(),this._isContentInfoForFilePreview(e)&&(d=this._user.account_id,indexOf.call(this._presentAccountIds,d)<0)&&this._presentAccountIds.push(this._user.account_id),[this._linkSeenStateInfo,this._groupSeenStateInfo,this._presentAccountIds,r]):[[],{},[],r]},n.prototype._getPassFileInfo=function(){var e,t,n,s,r,o,i,a,l;return t=this._getContentInfo(),n=("BROWSE_FILE_ROW"===(o=t.extras.origin)||"BROWSE_FILE_FACEPILE"===o)&&!t.isFolder(),s="BROWSE_FILE_ROW"===(i=t.extras.origin)||"BROWSE_FILE_FACEPILE"===i||"PREVIEW_PAGE_FACEPILE"===i||"PREVIEW_PAGE"===i,s&&!t.isSharedFolder()?(r=t.nsId(),l=t.sjid(),e=t.beaconContext()):(a=[null,null,null],r=a[0],l=a[1],e=a[2]),{nsId:r,sjid:l,beaconContext:e,fromBrowse:n,contentInfoId:t.id}},n.prototype._getUrl=function(){var e;return this._getPassFileInfo().fromBrowse?null:null!=(e=re.instance.getSharedLinkInfo())?e.url:void 0},n.prototype._getFileData=function(e){var t,n,s,r;return null==e&&(e=null),s=this._getPassFileInfo(),n=s.nsId,r=s.sjid,t=s.beaconContext,{file:{ns_id:n,sjid:r,beacon_context:t},url:e}},n.prototype._getContentInfo=function(){return this._sharingInfo.contentInfo()},n.prototype._dispatch=function(e,t){return null==t&&(t={}),d.dispatch({type:e,data:t,contentIds:[this._getContentInfo().id],user:this._user})},n.prototype.changeAccess=function(e,t,n){var s,r,o,i,a;return null==n&&(n=!1),a=Promise.resolve(),i=e.memberId(),r=this._getContentInfo(),s=r.id,t===ae.REMOVE?i===this._user.account_id?this._client.relinquishMembership({contentId:s,leaveACopy:n}).then((function(e){return function(){return r.isFolder()?Y.success(Ne("Folder access removed.")):Y.success(Ne("File access removed.")),le.close(),e.redirectToBrowseUrl("/")}})(this)):(a=(r.isFileFolder()?this._client.getParentFolderAccess({contentId:this._sharingInfo.parentSharedFolderId(),memberId:i}):this.removeMember(s,e,n,r.isFolder())).then((function(t){return function(n){return t.showParentFolderAccessModalIfQualified("remove",e,n)}})(this)),this.openShareModal()):a=t===z.OWNER?this._client.transferContent({contentId:s,memberId:i}).then((function(t){return function(){return t._dispatch(fe.TRANSFER_OWNER_SUCCESS),Y.success(Ne("Made %(name)s the owner").format({name:e.displayName()})),t._fetchInitialData(),t.openShareModal()}})(this)):(r.isFileFolder()&&t===z.READER?this._client.getParentFolderAccess({contentId:this._sharingInfo.parentSharedFolderId(),memberId:i,accessLevel:t}):(o=this._getContentInfo().isFileFolder(),o&&this._dispatch(fe.MEMBER_ACTION_PENDING,{member:e}),this.shareIfFileFolder().then((function(n){return function(){return o&&n._dispatch(fe.MEMBER_ACTION_COMPLETE,{member:e}),n._changeMemberAccess(n._getContentInfo().id,e,t)}})(this)).catch((function(t){return function(){if(o)return t._dispatch(fe.MEMBER_ACTION_COMPLETE,{member:e})}})(this)))).then((function(t){return function(n){return t.showParentFolderAccessModalIfQualified("update",e,n)}})(this)),a.then(this.refreshSharedWithColumnContentData)},n.prototype.changeLinkAudience=function(e){var t,n,s,r,o;return n=ee({audience:e}),this._getContentInfo().isFileFolder()?this.shareIfFileFolder(n):(r=(null!=(o=this._sharingInfo.linkMetadata())?o.current_audience:void 0)||ie.members,this._dispatch(fe.CHANGE_LINK_AUDIENCE_REQUEST,{newAudience:e}),this._getContentInfo().isFile()?(s=j,t=this._client.updatePolicy.bind(this._client)):(s=ne,t=this._client.updatePolicyAlpha.bind(this._client)),t({actions:Object.keys(s),contentId:this._getContentInfo().id,newPolicy:n}).then((function(e){return function(t){return e._dispatch(fe.CHANGE_LINK_AUDIENCE_SUCCESS,{metadata:t})}})(this)).catch(Me((function(e){return function(){return e._dispatch(fe.CHANGE_LINK_AUDIENCE_FAILURE,{prevAudience:r}),Promise.reject()}})(this))))},n.prototype._changeMemberAccess=function(e,t,n){var s;return s=t.access_type,this._dispatch(fe.CHANGE_MEMBER_ACCESS_REQUEST,{member:t,newAccess:n}),this._client.updateMember({contentId:e,memberId:t.memberId(),accessLevel:n}).then((function(e){return function(n){if(null!=n.access_level&&null!=n.warning)return e._dispatch(fe.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:n.access_level}),n}})(this)).catch(Me((function(e){return function(n){return e._dispatch(fe.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:s}),e._parseParentFolderAccessError(n)}})(this)))},n.prototype.changeRecipientAccess=function(e){return this._dispatch(fe.CHANGE_RECIPIENT_ACCESS,{newAccess:e})},n.prototype.changeRecipientMessage=function(e){return this._dispatch(fe.CHANGE_RECIPIENT_MESSAGE,{message:e})},n.prototype.createSharedLink=function(){return this.log("CLICK_TIB_CREATE_LINK"),this._dispatch(fe.CREATE_LINK_REQUEST),this._client.createSharedLink({fileIdOrPath:this._getContentInfo().displayPath()}).then((function(e){return function(t){return e._dispatch(fe.CREATE_LINK_SUCCESS,{linkMetadata:t}),e._refreshSharedWithColumnLinkData()}})(this)).catch(Me((function(e){return function(t){var n;return t instanceof J&&"access_denied"===(null!=(n=t.error)?n[".tag"]:void 0)&&(e._getContentInfo().isFolder()?Y.error("You don’t have permission to create a link to this folder"):Y.error("You don’t have permission to create a link to this file")),e._dispatch(fe.CREATE_LINK_FAILURE),Promise.reject(t)}})(this)))},n.prototype.fetchLinkMetadata=function(){if(!Ce.TRUELINK_UI[this._user.id])return this._dispatch(fe.FETCH_LINK_METADATA_REQUEST),this._client.sharedLinkInfo({fileIdOrPath:this._getContentInfo().idForLink()}).then((function(e){return function(t){return e._dispatch(fe.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:t})}})(this)).catch((function(e){return function(){if(e._dispatch(fe.FETCH_LINK_METADATA_FAILURE),!Z.context().isNonUserRelativeContext)return Y.error(Ne("There was a problem completing this request.")),le.close()}})(this))},n.prototype._fetchMemberCounts=function(){var e;return e=this._getContentInfo(),this._dispatch(fe.FETCH_MEMBER_COUNTS_REQUEST),e.isSharedFolder()||e.isFolder()&&e.isInSharedFolder()?this._client.getMemberCounts({contentId:e.isSharedFolder()?e.sharedFolderId():e.nsId()}).then((function(e){return function(t){return e._dispatch(fe.FETCH_MEMBER_COUNTS_SUCCESS,{memberCounts:t})}})(this)):Promise.resolve()},n.prototype.fetchMetadataForFile=function(e){return ve.loadFileMetadata({user:this._user,contentId:e.id,sourceUrl:e.url(),client:this._client}).catch(Me(this.handleLoadingError))},n.prototype._fetchMetadataForFileFolder=function(e){var t,n,s,o,i;return n=oe.canActOnInheritedMembers(this._user.id)?ae.ALL:[],o=this._user.is_cdm_member?Te:Pe,t={actions:Object.keys(o),listMembersArg:{actions:n},shouldParseMetadataFromError:oe.canDeepNest(this._user.id)},Z.context().isNonUserRelativeContext?(i=(function(e){return function(t){var n;return n=f.validateFolderPath(t),e._client.validatePathContinue(n,!1)}})(this),s={nsId:e.nsId(),nsPath:e.nsPath()}):(i=this._client.validateFqPath,s={fqPath:e.displayPath()}),i(r.extend(s,t)).then((function(t){return function(n){var s,r;return r=n.metadata,s=n.inheritedMembers,t.handleGetMetadataSuccess(r),e=t._getContentInfo(),t.listMembers(e.id,e.url(),e.isFileFolder()&&s)}})(this)).catch(Me(this.handleLoadingError))},n.prototype._fetchMetadataForSharedFolder=function(e){var t,n;return this._user.is_cdm_member?(n=se,t=this._client.getMetadataInternal):Ce.TRUELINK_UI[this._user.id]?(n=Q,t=this._client.getMetadataAlpha):(n=ne,t=this._client.getMetadata),t({contentId:e.id,actions:Object.keys(n)}).then(this.handleGetMetadataSuccess).catch(Me(this.handleLoadingError))},n.prototype._fetchSharingPrefs=function(){return this._dispatch(fe.FETCH_SHARING_PREFS_REQUEST),this._client.getSharingPrefs().then((function(e){return function(t){return e._dispatch(fe.FETCH_SHARING_PREFS_SUCCESS,{sharingPrefs:t})}})(this))},n.prototype._fetchUpsellExperimentVariant=function(){return o.SilentBackgroundRequest({url:"/get_sl_upsell_variant",data:{_subject_uid:this._user.id},success:(function(e){return function(t){var n;try{if(n=JSON.parse(t),null!=n?n.variant:void 0)return e._dispatch(fe.FETCH_UPSELL_EXPERIMENT_VARIANT,n)}catch(e){}}})(this)})},n.prototype._fetchSharingPaywallInfo=function(){return this._dispatch(fe.FETCH_SHARING_PAYWALL_INFO_REQUEST),this._client.getSharingPaywallInfo().then((function(e){return function(t){return e._dispatch(fe.FETCH_SHARING_PAYWALL_INFO_SUCCESS,{sharingPaywallInfo:t})}})(this))},n.prototype.logPaywallEvent=function(e,t){return t=t||{},t.num_folders_owned=this._sharingInfo.paywallNumOwned(),c.log(ce,e,t)},n.prototype.onShareModalUnmount=function(e){var t,n;return this._teardownPass(),(null!=(n=this._sharingInfo.foldersToUnshare())?n.size:void 0)>0&&this.unshareFoldersBatch(),t=(null!=e?e.serializeInputData():void 0)||{},this._dispatch(fe.SHARE_MODAL_CLOSE,t)},n.prototype.onUnshareFromPaywall=function(e){return this._dispatch(fe.UNSHARE_FROM_PAYWALL,e)},n.prototype.unshareFoldersBatch=function(){var e,t;return t=this._sharingInfo.foldersToUnshare().map(function(e){return String(e)}),e=this._sharingInfo.paywallKeepACopy(),this._client.unshareFolderBatch({nsIds:t,leaveACopy:e}),this._dispatch(fe.CLEAR_UNSHARE_FROM_PAYWALL)},n.prototype._fetchTeamPolicy=function(){return this._dispatch(fe.FETCH_TEAM_POLICY_REQUEST),this._client.getCurrentAccountCached().then((function(e){return function(t){var n;return e._dispatch(fe.FETCH_TEAM_POLICY_SUCCESS,{teamPolicy:null!=(n=t.team)?n.sharing_policies:void 0})}})(this))},n.prototype._getSuggestableUsers=function(e){return Le(e,(function(e){return function(n){var s,r;return s=n.contacts,r=n.is_admin,s.length>0?t(["modules/clean/teams/membership_suggestion_modal"],function(t){var n;return n=t.MembershipSuggestionModal,le.showInstance(ke(n,{isAdmin:r,isFile:e._sharingInfo.contentInfo().isFile(),contacts:s}))}):le.close()}})(this),function(){return le.close()})},n.prototype.handleMemberAccessChange=function(e,t){var n,s,r,o,i,a,l,d;return s=e.displayName(),t===ae.REMOVE||t===z.OWNER?(i=t===ae.REMOVE&&e.memberId()===this._user.account_id,r=this._getContentInfo().isFolder(),o=this._getContentInfo().isNestedSharedFolder(),n=null!=(d=e.permissions.leave_a_copy)?d.allow:void 0,a=(function(n){return function(s){return n.changeAccess(e,t,s===!0)}})(this),l=this.openShareModal,i?Ge(r,o,a,l,n):Ve(s,t,r,o,n,a,l)):this.changeAccess(e,t)},n.prototype.handleContentNameChange=function(e){var t;return t="SIMPLIFIED_WIZARD_UI::CONTENT_NAME_CHANGE",this._hasLoggedSet[t]||(this._sharingExperimentsLog(t),this._hasLoggedSet[t]=!0),this._dispatch(fe.HANDLE_CONTENT_NAME_CHANGE,{name:e})},n.prototype.handleContentNameFocusChange=function(e){return this._dispatch(fe.HANDLE_CONTENT_NAME_FOCUS_CHANGE,{focus:e})},n.prototype.handleGetMetadataSuccess=function(e){return this._dispatch(fe.FETCH_METADATA_SUCCESS,{metadata:e}),d.dispatch({type:ge.FETCH_METADATA_SUCCESS,metadata:e,user:this._user})},n.prototype.handleLinkSettingsClick=function(){var e,t,n,s;return e=(function(e){return function(){return e._refreshSharedWithColumnLinkData(),e.setLinkMetadata(null),e.openShareModal()}})(this),t=this._sharingInfo.getInitialProps().onDeleteLink||e,n=(function(e){return function(t){return e.setLinkMetadata(t),e._refreshSharedWithColumnLinkData()}})(this),s=We(this._user),Ee.log("open_link_settings_modal"),le.showInstance(ke(ye,{client:this._client,isFile:this._getContentInfo().isFile(),linkMetadata:this._sharingInfo.linkMetadata(),onClose:this.openShareModal,onDeleteLink:t,onPolicySet:n,showUpgradeToBiz:s,isTeam:this._user.is_team}))},n.prototype.handleLoadingError=function(e){var t,n;return e instanceof J?this._dispatch(fe.FETCH_METADATA_FAILURE,{reason:null!=(t=e.error)&&null!=(n=t.bad_path)?n[".tag"]:void 0}):(Y.error(e.message||Ne("There was a problem completing this request.")),le.close())},n.prototype.handleSelectLinkAudience=function(e){var t,n,s,r;return this._sharingInfo.contentInfo().isFile()?this.changeLinkAudience(e):(t=this._sharingInfo.linkMetadata(),s=(null!=t?t.current_audience:void 0)||ie.members,r=t.audience_options.toArray().indexOf(s),n=t.audience_options.toArray().indexOf(e),n<r?le.showInstance(ke(we,{title:Ne("Change link audience?"),confirmText:Ne("Change audience"),onConfirm:(function(t){return function(){return t.changeLinkAudience(e),t.openShareModal()}})(this),onCancel:this.openShareModal},e===ie.public?Ne("All items in this folder will become viewable by anyone with the link."):e===ie.team?Ne("All items in this folder will become viewable by anyone on your team."):void 0)):n>r?this.changeLinkAudience(e):void 0)},n.prototype.handleUpdateFilePolicy=function(e,t){var n,s,r,o,i,a,l,d,c;if(this.handleUpdateSharingSettings(e),s=this.getSharingInfo().filePolicy(),l=this._getPassFileInfo(),i=l.nsId,d=l.sjid,l.beaconContext,r=l.fromBrowse,n=l.contentInfoId,null!=i&&null!=d){if(s.pass_policy===me.disabled&&t.pass_policy===me.enabled)return this.clearCachedPassInfo(),ue.resetPassInfo(i,d),ue.fetchPassError(i,d),this._dispatch(fe.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO);if(o=s.audience===ie.members!=(t.audience===ie.members),a=s.pass_policy===me.enabled&&t.pass_policy===me.disabled,o||a)return this.clearCachedPassInfo(),c=this._getUrl(),a&&this.listMembers(n,c),he.setup(this._user,this._getFileData(c),null,!r)}},n.prototype.handleUpdateSharingSettings=function(e){return this._dispatch(fe.UPDATE_SHARING_SETTINGS_SUCCESS,{metadata:e})},n.prototype.listMembers=function(e,t,n){return ve.listMembers({user:this._user,contentId:this._getContentInfo().id,isFolder:this._sharingInfo.isFolder(),url:t,members:n,client:this._client})},n.prototype._isContentInfoForFilePreview=function(e){return("PREVIEW_PAGE"===e.extras.origin||"PREVIEW_PAGE_FACEPILE"===e.extras.origin)&&!e.isFolder()},n.prototype.log=function(e,t){return qe(this._getContentInfo(),this._user.id,e,t)},n.prototype.logIfHaventBefore=function(e,t,n){if(null==t&&(t={}),null==n&&(n=!0),!this._hasLoggedSet[e])return this._hasLoggedSet[e]=!0,n&&(t.timing=Date.now()-this._beginTime),this.log(e,t)},n.prototype.onClickX=function(e){return null!=e&&e.finishLogging(!0),this.showTruelinkFeedbackIfQualified(),le.close()},n.prototype.openShareModal=function(){return le.showInstance(ke(this._shareModalClass,{actionHandler:this}))},n.prototype.recipientsChange=function(e,t){return null==t&&(t=""),Promise.resolve().then((function(n){return function(){return n._dispatch(fe.CHANGE_RECIPIENTS,{recipientTokens:e,recipientRawInput:t})}})(this))},n.prototype.redirectToBrowseUrl=function(e){return m.setUrl({path:e})},n.prototype.redirectToPath=function(e,n){var s,r;return Z.user()?(r=(function(e){return function(){if(n)return t(["modules/clean/sharing/share_modal_util"],function(t){return t.showShareModal(e._user,Z.context(),{origin:"PARENT_FOLDER_MODAL"})})}})(this),e!==Z.context().currentFQPath?(m.setUrl({path:e}),m.setPath({path:e,onPathLoaded:r})):r()):(s=l.browse_uri_for_fq_path(this._user,e),n&&s.updateQuery({shareoptions:"1"}),void W.redirect(s))},n.prototype.redirectToUpgrade=function(){return W.redirect("/upgrade?oqa=spw")},n.prototype.refreshSharedWithColumnContentData=function(){return this._getContentInfo().isFolder()?d.dispatch({type:be.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{}}):d.dispatch({type:be.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[this._getContentInfo().id]}})},n.prototype._refreshSharedWithColumnLinkData=function(){return d.dispatch({type:be.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this._getContentInfo().displayPath()]}})},n.prototype.removeMember=function(e,t,n,s){return this._dispatch(fe.MEMBER_ACTION_PENDING,{member:t}),this._client.removeMember({contentId:e,memberId:t.memberId(),leaveACopy:n}).then((function(e){return function(n){return e._fetchMemberCounts().then(function(){return null!=(null!=n?n.access_level:void 0)&&null!=(null!=n?n.warning:void 0)?(e._dispatch(fe.REMOVE_MEMBER_KEEP_ACCESS,{member:t,access:n.access_level}),n):(s?Y.success(Ne("Folder access removed.")):Y.success(Ne("File access removed.")),e._dispatch(fe.REMOVE_MEMBER_SUCCESS,{member:t}))})}})(this)).catch(Me((function(e){return function(n){return e._dispatch(fe.MEMBER_ACTION_COMPLETE,{member:t}),e._parseParentFolderAccessError(n)}})(this)))},n.prototype.setAddMessageAsCommentChecked=function(e){return this._dispatch(fe.SET_COMMENT_CHECKBOX_PREF_REQUEST,{checked:e}),this._client.setSharingPrefs({add_message_as_comment_checked:e})},n.prototype.setAddMessageAsCommentHelpClosed=function(){return this._dispatch(fe.SET_COMMENT_CHECKBOX_HELP_PREF_REQUEST),this._client.setSharingPrefs({add_message_as_comment_help_shown:!1})},n.prototype.setContentNameAndSendShare=function(t,n){var r,o;return o=s.findDOMNode(n),r=null!=o?o.value:void 0,new Se(this._user).validate_new_sf_path(r,Ue(r,this._user.cdm_tmf_path),(function(e){return function(){return e._dispatch(fe.VALIDATE_CONTENT_NAME_SUCCESS,{contentName:r}),e._sendShare(t)}})(this),(function(t){return function(n){var s,r,i;return t._sharingExperimentsLog("SIMPLIFIED_WIZARD_UI::INVALID_CONTENT_NAME"),s=H.extract_errors(n.responseText),t._dispatch(fe.VALIDATE_CONTENT_NAME_ERROR,{errorMsg:null!=(r=s.folder_name)?r.message_text:void 0}),null!=(i=e(o))?i.select():void 0}})(this))},n.prototype.setLinkMetadata=function(e){return this._dispatch(fe.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:e})},n.prototype.paywallGrandfatherModalDismiss=function(){return this._dispatch(fe.PAYWALL_GRANDFATHER_MODAL_DISMISS)},n.prototype.paywallGrandfatherModalLearnMore=function(){return this.logPaywallEvent("view_learn_more"),this._dispatch(fe.PAYWALL_GRANDFATHER_MODAL_LEARN_MORE)},n.prototype.sendShare=function(e,t){return this._sharingInfo.contentInfo().pathExists()?this._sendShare(e):Promise.resolve().then((function(n){return function(){return n.setContentNameAndSendShare(e,t)}})(this))},n.prototype._sendShare=function(e){var t,n,s;return this.log("CLICK_TIB_SEND_BUTTON"),t=Date.now(),s=null,n=this._isNewlySharedContent(),this.recipientsChange(null!=e?e.getContacts():void 0).then((function(e){return function(){return e._sharingInfo.contactsError().level===$.ERROR?Promise.reject():(e._dispatch(fe.SEND_SHARE_REQUEST),s=Fe(e._sharingInfo.recipientTokens()),e.shareIfFileFolder())}})(this)).then((function(e){return function(){return e.turnLinkOnIfQualified(),e._client.addMembers({accessLevel:e._sharingInfo.recipientAccess(),contentId:e._sharingInfo.contentInfo().id,addMessageAsComment:e._sharingInfo.isAddMessageAsCommentChecked(),customMessage:e._sharingInfo.recipientMessage(),members:s})}})(this)).catch(Me((function(e){return function(n){return e._dispatch(fe.SEND_SHARE_FAILURE),Y.error(Re(n)),e.log("SHARE_MODAL_SEND_FAIL",{timing:Date.now()-t,num_recipients:s.length}),Promise.reject()}})(this))).then((function(r){return function(){var o,i;return r._dispatch(fe.SEND_SHARE_SUCCESS),Y.success(Oe(r._sharingInfo.recipientTokens(),r._sharingInfo.contentInfo().name(),r._sharingInfo.isTeamSharedFolder(),r._sharingInfo.isFolderInsideTeamFolderTree())),r.log("SHARE_MODAL_SEND_SUCCESS",{timing:Date.now()-t,num_recipients:s.length}),"function"==typeof(o=r._sharingInfo.getInitialProps()).onSuccessSharing&&o.onSuccessSharing(),null!=e&&e.finishLogging(!1),r.refreshSharedWithColumnContentData(),G.SHOW_CREATE_TEAM_MODAL_AFTER_SHARING&&n&&s.length>=2?le.showInstance(ke(te,{invitedMembers:r._sharingInfo.recipientTokens().filter(function(e){return e.email!==r._user.email})})):"V1"===G.SUBGROWTH_BIZ_UPSELL_VARIANT&&r._sharingInfo.ownerTeam()?(i=r._sharingInfo.recipientTokens().map(function(e){return e.email}),r._getSuggestableUsers(i)):(r.showTruelinkFeedbackIfQualified(),le.close())}})(this))},n.prototype._isNewlySharedContent=function(){var e;return this._getContentInfo().isFile()?1===(null!=(e=this._sharingInfo.members())?e.getMemberCount():void 0):!this._getContentInfo().isSharedFolder()},n.prototype.shareIfFileFolder=function(e){var t,n,s,r;return null==e&&(e=null),this._getContentInfo().isFileFolder()?this._sharingInfo.shareFolderPromise()?this._sharingInfo.shareFolderPromise():(n=this._sharingInfo.isNonUserRelativeContext()?"ns:"+this._getContentInfo().nsId()+this._getContentInfo().nsPath():this._getContentInfo().displayPath(),Ce.TRUELINK_UI[this._user.id]&&(null!=(r=this._sharingInfo.linkMetadata())?r.current_audience:void 0)!==ie.members&&(e||(e=new ee),e.audience||(e=e.set("audience",this._sharingInfo.linkMetadata().current_audience))),t={fqPath:n,folderPolicy:e},s=Ce.TRUELINK_UI[this._user.id]?this._client.shareAlpha(t):this._client.share(t),this._dispatch(fe.SHARE_FOLDER_REQUEST,{promise:s}),s.then((function(e){return function(t){return e._dispatch(fe.SHARE_FOLDER_SUCCESS,{metadata:t}),d.dispatch({type:ge.FETCH_METADATA_SUCCESS,metadata:t,user:e._user}),t}})(this)).catch((function(e){return function(){return e._dispatch(fe.SHARE_FOLDER_FAILURE),Promise.reject()}})(this)),s):Promise.resolve()},n.prototype.showParentFolderAccessModalIfQualified=function(e,t,n){if(null!=n)return le.showInstance(ke(pe,{contentInfo:this._getContentInfo(),memberAccessLevelResult:n,memberDisplayName:t.displayName(),originalAction:e,isInContentManager:this._sharingInfo.isNonUserRelativeContext(),onClose:this.openShareModal,onParentFolderClicked:this.redirectToPath}))},n.prototype._parseParentFolderAccessError=function(e){var t;return t=e.error,"member_error"===e.error[".tag"]&&(t=e.error.member_error),"no_explicit_access"===t[".tag"]?Be(this._user.id,t):Y.error(e.message||Ne("There was a problem completing this request."))},n.prototype._sharingExperimentsLog=function(e,t){var n;return null==t&&(t={}),n=this._getContentInfo().extras.modalSessionId,t.modalSessionId||(t.modalSessionId=n),Ie.log(this._user.id,e,t)},n.prototype.showTruelinkFeedbackIfQualified=function(){if(Ce.TRUELINK_UI[this._user.id])return this._sharingInfo.hasChangedSharingSettings()?V.showFeedbackFlyoutIfAllowed("settings"):this._sharingInfo.hasChangedLinkAudience()?V.showFeedbackFlyoutIfAllowed("sender"):void 0},n.prototype._teardownPass=function(){var e,t;if(this.clearCachedPassInfo(),t=this._getPassFileInfo(),t.nsId,t.sjid,t.beaconContext,e=t.fromBrowse,e)return he.teardown(this._user,this._getFileData(),!0,!1)},n.prototype.turnLinkOnIfQualified=function(){var e;return Ce.TRUELINK_UI[this._user.id]&&Ce.BROAD_AUDIENCE[this._user.id]&&!this._sharingInfo.parentSharedFolderId()&&(null!=(e=this._sharingInfo.linkMetadata())?e.current_audience:void 0)===ie.members?this.waitForAllMembersLoaded().then((function(e){return function(){if(!e._sharingInfo.hasNonOwnerMembers())return e.changeLinkAudience(ie.default_on)}})(this)):Promise.resolve()},n.prototype.updateBanner=function(e){return this._dispatch(fe.UPDATE_BANNER,{banner:e})},n.prototype.updateLinkSettings=function(e){var t,n;return n=e.newPolicy,t=Ae(n).link_settings,this._client.setLinkSettings({linkSettings:t,url:this._sharingInfo.linkMetadata().url}).then((function(e){return function(t){return e._dispatch(fe.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:t})}})(this))},n.prototype.waitForAllMembersLoaded=function(){var e;return this._sharingInfo.areMembersFullyLoaded()?Promise.resolve():(null!=(e=this._sharingInfo.fetchingMembersRequest())?e.promise:void 0)||Promise.resolve()},n})()}),define("modules/clean/sharing/api",["modules/clean/ajax","modules/core/exception","jquery"],function(e,t,n){var s,r,o;return o=e.WebRequest,s=e.FormWebRequest,t.assert,r=(function(){function e(e){this.user=e}return e.REQUEST_SUCCEEDED_EVENT="db:sharing_api:request_succeeded",e.prototype.get_sync_vars_for_ns_id=function(e,t,n,s){var r;return r={ns_id:e,sub_path:t},this._make_request("/sharing/get_sync_vars_for_ns_id",r,n,s,!0)},e.prototype.validate_new_sf_path=function(e,t,n,s){var r;return r={share_type:"new",folder_name:e,path:t},this._make_request("/share_ajax/validate_folder",r,n,s,!0)},e.prototype.validate_shareable_existing_sf_path=function(e,t,n){var s;return s={share_type:"shareable_existing",path:e},this._make_request("/share_ajax/validate_folder",s,t,n,!0)},e.prototype._make_request=function(t,r,i,a,l,d){var c,p;return null==l&&(l=!1),null==d&&(d=!0),c={url:t,data:r,success:function(s,o,a){return"function"==typeof i&&i(a),n(document).trigger(e.REQUEST_SUCCEEDED_EVENT,{request_url:t,ns_id:r.ns_id||null})},error:function(e){return"function"==typeof a?a(e):void 0},complete:(function(e){return function(){var t;return null!=(t=e.loading_elem)?t.removeClass("ajax-loading"):void 0}})(this)},d&&(c.subject_user=this.user.id),null!=(p=this.loading_elem)&&p.addClass("ajax-loading"),(l?s:o)(c)},e})(),{SharingApi:r}}),define("modules/clean/sharing/components/button_group",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css"],function(e,t,n,s,r,o){"use strict";var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this;return s.createElement("div",{className:"c-btn-group sharing-button-group"},this.props.options.map(function(t){var n=t.value,o=t.label,i=n===e.props.value;return s.createElement("button",{key:n,className:r({"c-btn":!0,"c-btn--secondary":!i,"c-btn--primary":i}),onClick:function(){return e.props.onSelectValue(n)},disabled:i},o)}))},t})(s.Component);t.ButtonGroup=o(i,["/static/css/sharing/components-vflrV8W4h.css"])}),define("modules/clean/sharing/confirmation_modals/confirm_with_option_modal",["require","exports","tslib","external/react","modules/clean/react/modal"],function(e,t,n,s,r){"use strict";var o=(function(e){function t(t){var n=e.call(this,t)||this;if(null==n.props.children)throw new Error("Must have children prop");return n.state={checked:!1},n.handleOptionClick=n.handleOptionClick.bind(n),n.handleAccept=n.handleAccept.bind(n),n.handleDismissCompleted=n.handleDismissCompleted.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(r.Modal,{acceptButtonText:this.props.confirmText,autoClose:this.props.autoClose,className:"simple-modal confirm-with-option-modal",dismissButtonText:this.props.cancelText,onAccept:this.handleAccept,onDismissCompleted:this.handleDismissCompleted,title:this.props.title},s.createElement("div",{className:"simple-modal-content"},s.createElement("div",{className:"confirm-with-option-modal__body-text"},this.props.children),this.renderOption()))},t.prototype.renderOption=function(){return this.props.showOption?s.createElement("div",{className:"u-mar-vertical-s confirm-with-option-modal__option"},s.createElement("input",{"aria-checked":this.state.checked,checked:this.state.checked,className:"confirm-with-option-modal__option-input",id:"confirm-with-option-modal__input",name:"confirmation_option",onClick:this.handleOptionClick,role:"checkbox",type:"checkbox"}),s.createElement("label",{className:"confirm-with-option-modal__option-label",htmlFor:"confirm-with-option-modal__input"},this.props.optionLabel)):null},t.prototype.handleOptionClick=function(){this.setState({checked:!this.state.checked})},t.prototype.handleAccept=function(){this.props.onConfirm&&this.props.onConfirm(this.state.checked)},t.prototype.handleDismissCompleted=function(){this.props.onCancel&&this.props.onCancel(this.state.checked)},t})(s.Component)
;t.ConfirmWithOptionModal=o}),define("modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal",["external/purify","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/react_format","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u,h,m,_;return c=s.Modal,m=r.reactFormat,l=o.ConfirmWithOptionModal,d=i.MEMBER_ACTION,u=t.createElement,h=t.DOM,p=a.i18n_default_project("sharing")._,_=function(e,t,s,r,o,i,a){var _,f,g,y,b;return y=n.em_snippet(e,40),g=null,t===d.REMOVE?(b=p("Remove access for %(name)s?").format({name:y}),s?(_=r?m(p("<strong>%(name)s</strong> may still have access to this folder through a company group or parent folder."),{strong:h.strong(),name:y}):m(p("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to these files."),{strong:h.strong(),name:y}),o&&(g=p("%(name)s should be able to keep a copy of these files").format({name:y}))):_=m(p("If you continue, <strong>%(name)s</strong> will lose access to this file."),{strong:h.strong(),name:y}),f=p("Remove")):(b=p("Make %(name)s the owner of this folder?").format({name:y}),_=m(p("Only <strong>%(name)s</strong> will be able to unshare this folder or change folder settings."),{strong:h.strong(),name:y}),f=p("Make owner")),c.showInstance(u(l,{autoClose:!1,confirmText:f,cancelText:p("Cancel"),onConfirm:i,onCancel:a,optionLabel:g,showOption:null!=g,title:b},_))},{showMemberAccessChangeConfirmationModal:_}}),define("modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal",["external/purify","external/react","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/core/i18n"],function(e,t,n,s,r){var o,i,a,l,d;return i=n.Modal,o=s.ConfirmWithOptionModal,l=t.createElement,a=r.i18n_default_project("sharing")._,d=function(e,t,n,s,r){var d,c,p;return c=null,e?(p=a("Remove your access to this folder?"),d=a(t?"You may still have access to this folder through a company group or parent folder.":"If you continue, you won’t be able to access this folder anymore."),r&&(c=a("Keep a copy of this folder"))):(p=a("Remove your access to this file?"),d=a("If you continue, you won’t be able to access this file anymore.")),i.showInstance(l(o,{cancelText:a("Cancel"),confirmText:a("Remove my access"),onCancel:s,onConfirm:n,optionLabel:c,showOption:null!=c,title:p},d))},{showRelinquishMembershipConfirmationModal:d}}),define("modules/clean/sharing/confirmation_modals/reset_access_modal",["require","exports","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,i,a){"use strict";function l(e){var t;t=d(e.linkAccessLanguage?e.isFolder?"Everyone else will lose access to this folder and its link         except those who have access from a parent folder.         You’ll still keep a copy of this folder in your Dropbox.":"Everyone else will lose access to this file and its link         except those who have access from a parent folder.         You’ll still keep a copy of this file in your Dropbox.":e.isFolder?"Everyone else will lose access to this folder. You’ll         still keep a copy of this folder in your Dropbox.":"Everyone else will lose access to this file. You’ll         still keep a copy of this folder in your Dropbox.");var a=d("Unshare “%(content_name)s”?").format({content_name:s.em_snippet(e.contentName,i.SNIPPET_SIZES.FILENAME)});r.Modal.showInstance(n.createElement(o.ConfirmWithOptionModal,{cancelText:d("Cancel"),confirmText:d("Unshare"),onCancel:e.onCancel,onConfirm:e.onConfirm,optionLabel:d("Let my collaborators keep a copy of these files."),showOption:e.allowLeaveACopy&&e.isFolder,title:a},t))}var d=a.i18n_default_project("sharing")._;t.confirmResetAccess=l}),define("modules/clean/sharing/confirmation_modals/simple_confirm_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/core/i18n"],function(e,t,n,s,r,o){"use strict";var i=o.i18n_default_project("sharing")._,a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(r.Modal,{style:"bare"},s.createElement("div",{className:"simple-confirm-modal"},s.createElement("div",{className:"simple-confirm-modal__main"},s.createElement("div",{className:"simple-confirm-modal__title"},this.props.title),s.createElement("div",{className:"simple-confirm-modal__body"},this.props.children)),s.createElement("div",{className:"simple-confirm-modal__footer"},s.createElement("button",{className:"simple-confirm-modal__cancel c-btn c-btn--secondary",onClick:this.props.onCancel},this.props.cancelText||i("Cancel")),s.createElement("button",{className:"simple-confirm-modal__confirm c-btn c-btn--primary",onClick:this.props.onConfirm},this.props.confirmText))))},t})(s.Component);t.SimpleConfirmModal=a}),define("modules/clean/sharing/content_info",["require","exports","tslib","external/immutable","modules/constants/python"],function(e,t,n,s,r){"use strict";function o(e){var t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.createFromParams=function(e){var n=new a(e);return new t({extras:n,id:o(n)})},t.prototype.setNsId=function(e){var t=this.setIn(["extras","targetNsId"],e);return t.set("id",o(t.extras))},t.prototype.setFQPath=function(e){var t=this.setIn(["extras","fqPath"],e);return t.set("id",o(t.extras))},t.prototype.isFolder=function(){return this.extras.isFolder},t.prototype.isFile=function(){return!this.isFolder()},t.prototype.isFileFolder=function(){return this.isFolder()&&!this.isSharedFolder()},t.prototype.isSharedFolder=function(){return Boolean(this.extras.targetNsId)},t.prototype.isTeamSharedFolder=function(){return this.extras.isTeamSharedFolder},t.prototype.isInSharedFolder=function(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)},t.prototype.isNestedSharedFolder=function(){return this.isInSharedFolder()&&this.isSharedFolder()},t.prototype.isOSXPackage=function(){var e=this.extras.fqPath,t=e.substr(e.lastIndexOf("."));return r.PACKAGE_EXTS.indexOf(t)>=0},t.prototype.isMounted=function(){return!this.extras.url},t.prototype.url=function(){return this.extras.url},t.prototype.pathExists=function(){return Boolean(this.extras.exists)},t.prototype.name=function(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()},t.prototype.idForLink=function(){var e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e},t.prototype.sharedFolderId=function(){var e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e},t.prototype.displayPath=function(){return this.extras.fqPath},t.prototype.filename=function(){return this.extras.filename},t.prototype.nsId=function(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId},t.prototype.nsPath=function(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath},t.prototype.sjid=function(){return this.extras.sjid},t.prototype.teamGroupInfo=function(){return this.extras&&this.extras.teamGroupInfo},t.prototype.beaconContext=function(){return this.extras&&this.extras.beaconContext},t})(s.Record({extras:null,id:null},"ContentInfo"));t.ContentInfo=i;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(s.Record({beaconContext:null,exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras"));t.ContentInfoExtras=a}),define("modules/clean/sharing/file_settings_modal",["external/purify","external/react","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/util","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_util","modules/clean/user","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I){var w,C,E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j;return G=n.catchApiError,O=i.SharedWithActionTypes,A=a.Modal,j=d.setStatePromise,D=c.SharingActions,M=p.FileShareApiClient,C=u.CombinedPolicy,u.DownloadPolicy,E=u.FilePermissions,P=u.FilePolicy,k=u.LinkMetadata,F=u.PassPolicy,R=u.SharedContentLinkMetadata,K=h.confirmResetAccess,w=m.ALPHA_FILE_METADATA_PERMISSIONS,x=m.SNIPPET_SIZES,B=m.TRUELINK,L=_.SettingsModalButtons,q=_.SinglePolicyControl,f.AUDIENCE_POLICY,f.EXPIRY_POLICY,f.PASSWORD_POLICY,f.FILE_SETTINGS,f.LINK_SETTINGS,U=g.SharingSettingsModal,V=y.canChangePolicy,z=y.isCommonSharingSettingsPolicy,b.showFileSettings,W=t.createElement,Y=t.DOM,H=S.i18n_default_project("sharing")._,T=t.createClass({displayName:"FileSettingsModal",propTypes:{fileName:t.PropTypes.string.isRequired,canChangeOptions:t.PropTypes.bool,canUnshareFile:t.PropTypes.bool.isRequired,contentId:t.PropTypes.string.isRequired,hasDisplayableMembers:t.PropTypes.bool,hasNonOwnerMembers:t.PropTypes.bool,initialPolicy:t.PropTypes.oneOfType([t.PropTypes.instanceOf(C),t.PropTypes.instanceOf(P)]),linkMetadata:t.PropTypes.oneOfType([t.PropTypes.instanceOf(k),t.PropTypes.instanceOf(R)]),onCancel:t.PropTypes.func,onPolicySet:t.PropTypes.func,ownerTeam:t.PropTypes.shape({id:t.PropTypes.string.isRequired,name:t.PropTypes.string.isRequired}),permissions:t.PropTypes.instanceOf(E),updateLinkSettings:t.PropTypes.func,user:t.PropTypes.instanceOf(v).isRequired},getInitialState:function(){return{isSubmitting:!1,desiredPolicy:this.props.initialPolicy}},render:function(){return B.TRUELINK_UI[this.props.user.id]?this._openSharingSettingsModal():W(N,{canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,contentId:this.props.contentId,desiredPolicy:this.state.desiredPolicy,fileName:this.props.fileName,handleUnshareFile:this._handleUnshareFile,isSubmitting:this.state.isSubmitting,onAccept:this._handleAcceptClick,onDismiss:this._handleDismissClick,onDismissCompleted:this._handleDismissCompleted,onPolicyUpdate:this._handlePolicyUpdate,user:this.props.user})},_getClient:function(){return new M({userId:this.props.user.id})},_openSharingSettingsModal:function(){var e;return e=(function(e){return function(t,n){var s;return s=e.props.canChangeOptions,z(t)&&(s=V(t,e.props.initialPolicy,e.state.desiredPolicy,e.props.linkMetadata,e.props.permissions)),[e.state.desiredPolicy.get(t),s]}})(this),W(U,{contentId:this.props.contentId,currentPolicy:this.props.initialPolicy,fileName:this.props.fileName,folderName:this.props.fileName,getEffectivePolicyValue:e,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isFolder:!1,isLoading:!1,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onDismiss:this._handleDismissClick,onOptionChange:this._handlePolicyUpdate,onSaveSettings:this._handleAcceptClick,onUnshare:this._handleUnshareFile,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,policyUpdate:this._getPolicyUpdate(),user:this.props.user})},_handleAcceptClick:function(){var e,t;return t=this._getPolicyUpdate(),null!=t?j(this,{isSubmitting:!0}).then((function(e){return function(){return e._getClient().updatePolicy({contentId:e.props.contentId,newPolicy:t,actions:Object.keys(w)})}})(this)).catch(G((function(e){return function(){return e.setState({isSubmitting:!1}),Promise.reject()}})(this))).then((function(e){return function(t){var n;return I.success(H("File settings updated")),"function"==typeof(n=e.props).onPolicySet?n.onPolicySet(t):void 0}})(this)):"function"==typeof(e=this.props).onPolicySet?e.onPolicySet(null):void 0},_handleDismissClick:function(){var e;return A.close(),"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleDismissCompleted:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handlePolicyUpdate:function(e,t){return this.setState({desiredPolicy:this.state.desiredPolicy.set(e,t)})},_getPolicyUpdate:function(){return this.state.desiredPolicy.equals(this.props.initialPolicy)?null:this.state.desiredPolicy},_handleUnshareFile:function(){var e;return e=(function(e){return function(){return e._getClient().unshare({contentId:e.props.contentId}).then(function(){if(e._refreshSharedMemberData(),I.success(H("Unshared %(file_name)s").format({file_name:e.props.fileName})),A.close(),B.TRUELINK_UI[e.props.user.id])return D.loadFileMetadata({user:e.props.user,contentId:e.props.contentId})})}})(this),K({allowLeaveACopy:!1,contentName:this.props.fileName,isFolder:!1,linkAccessLanguage:B.TRUELINK_UI[this.props.user.id],onConfirm:e})},_refreshSharedMemberData:function(){return r.dispatch({type:O.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[this.props.contentId]}})}}),N=t.createClass({displayName:"FileSettingsModalContents",propTypes:{desiredPolicy:t.PropTypes.instanceOf(P).isRequired,canChangeOptions:t.PropTypes.bool.isRequired,contentId:t.PropTypes.string.isRequired,fileName:t.PropTypes.string.isRequired,handleUnshareFile:t.PropTypes.func,isSubmitting:t.PropTypes.bool.isRequired,onAccept:t.PropTypes.func,onDismiss:t.PropTypes.func,onDismissCompleted:t.PropTypes.func,canUnshareFile:t.PropTypes.bool.isRequired,onPolicyUpdate:t.PropTypes.func,user:t.PropTypes.instanceOf(v).isRequired},getDefaultProps:function(){return{desiredPolicy:null,onPolicyUpdate:null}},render:function(){return W(A,{autoClose:!1,className:"file-settings-modal",buttonComponent:Y.span(),onDismissCompleted:this.props.onDismissCompleted,title:H("“%(file_name)s” settings").format({file_name:s.em_snippet(this.props.fileName,x.FILENAME)})},Y.div({className:"file-settings-form"},this._renderHeader(),this._renderPolicies(),this._renderButtons(),this.props.canChangeOptions?W(L,{disableSave:!1,isAccepting:this.props.isSubmitting,onAccept:this.props.onAccept,onDismiss:this.props.onDismiss}):void 0))},_renderHeader:function(){if(!this.props.canChangeOptions)return Y.div({className:"u-pad-xs u-font-center u-mar-bottom-s file-settings-form__no-permission-banner"},H("You don’t have permission to change the settings on this file."))},_renderPolicies:function(){var e,t;return e=o.is_pass_ga_receive_enabled(this.props.user)&&(null!=(t=l.getPassPermissions(this.props.contentId))?t.canReadPresence:void 0),Y.div({},o.is_pass_enabled(this.props.user)||e?this._renderPassPolicy():void 0)},_renderPassPolicy:function(){return W(q,{canChange:this.props.canChangeOptions,policyName:F.policy_name,policyDescription:H("Show who accessed this file?"),currentValue:this.props.desiredPolicy[F.policy_name],options:[{label:H("Only show to people on your Dropbox team"),value:F.enabled},{label:H("Don’t show"),value:F.disabled}],handleOptionChange:this.props.onPolicyUpdate})},_renderButtons:function(){return Y.div({className:"u-mar-top-m clearfix"},this.props.canUnshareFile?Y.div({className:"u-l-fl"},Y.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.handleUnshareFile},H("Unshare file"))):void 0)}}),{FileSettingsModal:T,FileSettingsModalContents:N}}),define("modules/clean/sharing/folder_settings_modal",["external/classnames","external/immutable","external/purify","external/react","external/underscore","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/util","modules/clean/sharing/actions/share_modal","modules/clean/sharing/constants","modules/clean/sharing/ui_util","modules/clean/sharing/settings_modal_components","modules/clean/sharing/share_page/action_types","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/user","modules/constants/python","modules/core/i18n","modules/core/uri","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T,N,M){var k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne,se,re,oe,ie,ae,le,de;return se=o.catchApiError,l.BrowseActionTypes,l.SharedWithActionTypes,k=d.BrowseStore,c.shareFolder,q=u.Modal,Q=u.SimpleModal,de=h.setStatePromise,H=_.SNIPPET_SIZES,Z=_.TRUELINK,D=f.GoldenGate,ae=f.genContentManagerBridgeUri,V=g.SettingsModalButtons,X=g.SinglePolicyControl,G=y.SharePageActionTypes,O=b.FolderShareApiClient,b.ShareApiClient,$=b.TeamSharingPolicies,A=v.CombinedPolicy,R=v.FolderPolicy,L=v.FolderPermissions,U=v.LinkMetadata,W=v.SharedContentLinkMetadata,K=v.SharedFolderMetadata,oe=S.confirmResetAccess,I.AUDIENCE_POLICY,I.EXPIRY_POLICY,I.PASSWORD_POLICY,I.FOLDER_SETTINGS,I.LINK_SETTINGS,j=w.SharingSettingsModal,ne=C.canChangePolicy,le=C.isCommonSharingSettingsPolicy,J=P.TRADEMARK_BUSINESS,re=s.createElement,ie=s.DOM,ee=T.i18n_default_project("sharing")._,F={shared_folder_member_policy:"team"},x={shared_folder_member_policy:"team"},B={member_policy:"shared_folder_member_policy"},Y=s.createClass({displayName:"SharedFolderSettingsModal",propTypes:{actionHandler:s.PropTypes.instanceOf(m),altAction:s.PropTypes.node,folderName:s.PropTypes.string.isRequired,folderId:s.PropTypes.string,folderPath:s.PropTypes.string,hasDisplayableMembers:s.PropTypes.bool,hasNonOwnerMembers:s.PropTypes.bool,nsId:s.PropTypes.string,nsPath:s.PropTypes.string,initialHasParentSharedFolder:s.PropTypes.bool,initialIsTeamSharedFolder:s.PropTypes.bool,initialMetadata:s.PropTypes.instanceOf(K),initialOwnerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),initialPermissions:s.PropTypes.instanceOf(L),initialPolicy:s.PropTypes.oneOfType([s.PropTypes.instanceOf(A),s.PropTypes.instanceOf(R)]),isFolderInsideTeamFolderTree:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isSharedFolder:s.PropTypes.bool,isUserOnOwnerTeam:s.PropTypes.bool,linkMetadata:s.PropTypes.oneOfType([s.PropTypes.instanceOf(U),s.PropTypes.instanceOf(W)]),onCancel:s.PropTypes.func,onPolicySet:s.PropTypes.func,onUnshare:s.PropTypes.func,showContentManagerBridge:s.PropTypes.bool,isInContentManager:s.PropTypes.bool,teamPolicy:s.PropTypes.instanceOf($),updateLinkSettings:s.PropTypes.func,user:s.PropTypes.instanceOf(E).isRequired},getInitialState:function(){return{currentPolicy:this.props.initialPolicy,hasParentSharedFolder:this.props.initialHasParentSharedFolder,isLoading:!(null!=this.props.initialPolicy&&null!=this.props.initialPermissions),isPolicyChangeRecursive:this._hasRecursivePolicyChanges(this.props.initialIsTeamSharedFolder,this.props.initialHasParentSharedFolder),isSubmitting:!1,isTeamSharedFolder:this.props.initialIsTeamSharedFolder,metadata:this.props.initialMetadata,teamPolicy:this.props.teamPolicy,newPolicy:this.props.initialPolicy,ownerTeam:this.props.initialOwnerTeam,permissions:this.props.initialPermissions}},componentDidMount:function(){if(this.state.isLoading)return this._fetchInitialState()},render:function(){var e;return e={altAction:this.props.altAction,contentId:this.props.folderId,currentPolicy:this.state.currentPolicy,folderId:this.props.folderId,folderName:this.props.folderName,folderPath:this.props.folderPath,getEffectivePolicyValue:this._getEffectivePolicyValue,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.state.hasParentSharedFolder,isFolder:!0,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isLimitedTeam:this.props.isLimitedTeam,isLoading:this.state.isLoading,isSharedFolder:this.props.isSharedFolder,isSubmitting:this.state.isSubmitting,isTeamSharedFolder:this.state.isTeamSharedFolder,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onDismiss:this._handleDismiss,onOptionChange:this._handleOptionChange,onSaveSettings:this._handleSaveSettings,onUnshare:this._handleUnshareFolder,ownerTeam:this.state.ownerTeam,permissions:this.state.permissions,showContentManagerBridge:this.props.showContentManagerBridge,shouldHideHeader:this.state.shouldHideHeader,teamPolicy:this.state.teamPolicy,policyUpdate:this._getPolicyUpdate(),user:this.props.user},Z.TRUELINK_UI[this.props.user.id]?re(j,e):re(z,e)},_getClient:function(){var e;return e=k.context().isNonUserRelativeContext,new O({userId:this.props.user.id,isNonUserRelativeContext:e})},_fetchFolderMetadata:function(){var e;return e=[{".tag":"change_options"},{".tag":"unshare"}],null!=this.props.folderId?this._getClient().getMetadata({contentId:this.props.folderId,actions:e}):this._getClient().validateFqPath({fqPath:this.props.folderPath,actions:e}).then(function(e){return e.metadata})},_fetchInitialState:function(){return this._fetchFolderMetadata().then((function(e){return function(t){var n,s,r,o;if(e.isMounted())return n=t.policy,s={hasParentSharedFolder:null!=t.parent_shared_folder_id,isTeamSharedFolder:t.is_team_folder,shouldHideHeader:"folder_is_limited_team_folder"===(null!=(r=t.permissions)&&null!=(o=r.change_options)?o.reason:void 0),isLoading:!1,permissions:t.permissions,newPolicy:n,ownerTeam:t.owner_team,metadata:t},null!=e.props.folderId&&(s.currentPolicy=n),s.isPolicyChangeRecursive=e._hasRecursivePolicyChanges(s.isTeamSharedFolder,s.hasParentSharedFolder),de(e,s)}})(this)).catch(se(function(){return q.close()}))},_hasRecursivePolicyChanges:function(e,t){return D.canDeepNest(this.props.user.id)&&(e||t)},_handlePolicyUpdate:function(e,t){return this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_handleSaveSettings:function(){var e,t,s;if(t=this._getPolicyUpdate(),null!=t)return e=(function(e){return function(){var n;return n=e.props.onPolicySet,(e.isMounted()?de(e,{isSubmitting:!0}):Promise.resolve()).then(function(){var n,s,r;return n=function(e){return M.success(ee("Folder settings updated")),Promise.resolve({policyUpdate:t,sharedFolderMetadata:e})},null!=e.props.folderId?(s=Z.TRUELINK_UI[e.props.user.id]?e._getClient().updatePolicyAlpha:e._getClient().updatePolicy,s({contentId:e.props.folderId,newPolicy:t,url:null!=(r=e.props.linkMetadata)?r.url:void 0}).then(n)):(t=Z.TRUELINK_UI?new A(t):new R(t),e.props.actionHandler.shareIfFileFolder(t).then(n))}).then(function(e){var t,s;return t=e.policyUpdate,s=e.sharedFolderMetadata,"function"==typeof n?n(t,s):void 0}).catch(se(function(){if(e.isMounted())return e.setState({isSubmitting:!1})}))}})(this),this.state.isPolicyChangeRecursive?(s=this.props,Q.show({title_text:ee("Save settings?"),body_html:this.state.isTeamSharedFolder?n.sanitize(ee("Your changes will be applied to this team folder and any folders inside it.")):n.sanitize(ee("Your changes will be applied to this folder and any folders inside it.")),confirm_text:ee("Save settings"),cancel_text:ee("Cancel"),autoclose:!1,confirm_callback:e,cancel_completed_callback:function(){return q.showInstance(re(Y,s))}})):e()},_handleDismiss:function(){var e;return q.close(),"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleDismissCompleted:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleUnshareFolder:function(){var e,t,n,s,r,o;if(null!=this.props.folderId&&(null!=(n=this.state.permissions)&&null!=(s=n.unshare)?s.allow:void 0))return e=(function(e){return function(t){var n;return n=e._getClient().unshare({contentId:e.props.folderId,leaveACopy:t}),n.then(function(){return M.success(ee("Unshared “%(folder_name)s”").format({folder_name:e.props.folderName})),q.close(),a.dispatch({type:G.UNSHARE_FOLDER_SUCCESS,metadata:e.state.metadata,user:e.props.user})})}})(this),t=(function(e){return function(){return q.showInstance(re(Y,e))}})(this.props),oe({allowLeaveACopy:null!=(r=this.state.permissions)&&null!=(o=r.leave_a_copy)?o.allow:void 0,contentName:this.state.metadata.name,isFolder:!0,linkAccessLanguage:Z.TRUELINK_UI[this.props.user.id],onCancel:t,onConfirm:e})},_getPolicyUpdate:function(){var e;return null==this.state.newPolicy&&null==this.state.currentPolicy?null:(e={},this.state.newPolicy.forEach((function(t){return function(n,s){var o,i,a,l;if(l=t._getEffectivePolicyValue(s),i=l[0],o=l[1],o&&(a="object"==typeof n?r.isEqual(n,i):n===i,!a))return e[s]=n}})(this)),e)},_handleOptionChange:function(e,t){var n;if((null!=(n=this._getPolicyUpdate())?n[e]:void 0)!==t)return"function"==typeof this._handlePolicyUpdate?this._handlePolicyUpdate(e,t):void 0},_getEffectivePolicyValue:function(e,t){var n,s,r,o,i,a;return null==t&&(t=void 0),i=B[e],null!=i&&null!=this.props.teamPolicy&&(a=this.props.teamPolicy.get(i)),s=null!=(r=null!=t?t[e]:void 0)?r:this.state.currentPolicy.get(e),n=null!=(o=this.state.permissions.change_options)?o.allow:void 0,null!=a&&F[i]===a&&(n=!1,s=x[i]),le(e)&&(n=ne(e,this.state.currentPolicy,this.state.newPolicy,this.props.linkMetadata,this.state.permissions,this.props.showContentManagerBridge)),this.props.showContentManagerBridge&&(n=!1),[s,n]}}),te=s.createClass({displayName:"SharedFolderSettingsModalContents",propTypes:{altAction:s.PropTypes.node,currentPolicy:s.PropTypes.instanceOf(R),folderId:s.PropTypes.string,folderName:s.PropTypes.string.isRequired,folderPath:s.PropTypes.string,permissions:s.PropTypes.instanceOf(L),getEffectivePolicyValue:s.PropTypes.func,hasParentSharedFolder:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isLoading:s.PropTypes.bool.isRequired,isSharedFolder:s.PropTypes.bool,isSubmitting:s.PropTypes.bool,isTeamSharedFolder:s.PropTypes.bool,isUserOnOwnerTeam:s.PropTypes.bool,onDismiss:s.PropTypes.func,onSaveSettings:s.PropTypes.func,onOptionChange:s.PropTypes.func,onUnshare:s.PropTypes.func,ownerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),showContentManagerBridge:s.PropTypes.bool,shouldHideHeader:s.PropTypes.bool,teamPolicy:s.PropTypes.instanceOf($),policyUpdate:s.PropTypes.instanceOf(R)},getDefaultProps:function(){return{currentPolicy:null,folderId:null,getEffectivePolicyValue:null,hasParentSharedFolder:!1,isTeamSharedFolder:!1,onDismiss:null,onOptionChange:null,onSaveSettings:null,onUnshareFolder:null,ownerTeam:null,shouldHideHeader:!1,teamPolicy:null,policyUpdate:null}},render:function(){var t,n;return re(q,{altAction:this.props.altAction,autoClose:!1,className:e({"shared-folder-settings-modal":!0,"shared-folder-settings-modal--no-permissions":!(null!=(t=this.props.permissions)&&null!=(n=t.change_options)?n.allow:void 0)}),buttonComponent:ie.span(),onDismissCompleted:this.props.onDismiss,title:this.props.isTeamSharedFolder?ee("“%(folder_name)s” team folder settings").format({folder_name:i.em_snippet(this.props.folderName,H.FILENAME)}):ee("“%(folder_name)s” settings").format({folder_name:i.em_snippet(this.props.folderName,H.FILENAME)})},this.props.isLoading?ie.div({className:"shared-folder-settings-modal__loading-text"},ee("Loading...")):ie.div({},this._renderHeader(),this._renderPolicies(),this._renderButtons()))},_renderHeader:function(){var t,n,s,o,i;if(!this.props.shouldHideHeader)return t={"shared-folder-settings-form__team-folder-banner":!0,"u-pad-xs":!0,"u-font-center":!0,"u-mar-bottom-s":!0},o=ie.div({},ee("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName})),this.props.isInContentManager?ie.div({className:e(t)},o):this.props.showContentManagerBridge?(i=ae(this.props.isLimitedTeam,this.props.folderPath),ie.div({className:e(t)},o,ie.div({},ee("You can change these settings in the Admin Console. "),ie.a({href:i.toString(),target:"_blank"},ee("Open in new tab."))))):(this.props.isTeamSharedFolder||this.props.hasParentSharedFolder)&&this.props.isUserOnOwnerTeam?ie.div({className:e(t)},o,ie.div({},ie.a({href:"/team",target:"_blank"},ee("To edit, ask your admin.")))):(null!=(n=this.props.permissions)&&null!=(s=n.change_options)?s.allow:void 0)?void 0:ie.div({className:e(r.extend(t,{"shared-folder-settings-form__team-folder-banner":!1,"shared-folder-settings-form__no-permissions-banner":!0}))},ee("You don’t have permission to change the settings on this folder."))},_renderPolicies:function(){var e,t;return t=null!=this.props.ownerTeam,e=this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree,ie.div({},t?this._renderPolicy("member_policy",ee(e?"Who can be added to folders?":"Who can be invited to this folder?"),[{label:this.props.isLimitedTeam?ee("Only people on your team"):ee("Only people on your %(trademark_business)s account").format({trademark_business:J}),value:"team"},{label:ee("Anyone"),value:"anyone"}]):void 0,this._renderPolicy("acl_update_policy",ee(e?"Who can manage access to folders?":"Who can manage access to this folder?"),[{label:ee(e?"Only Team Admins":"Only owners"),value:"owner"},{label:t?this.props.isLimitedTeam?ee("Anyone on your team with edit permissions"):ee("Anyone on your %(trademark_business)s account with edit permissions").format({trademark_business:J}):ee("People with edit permissions"),value:"editors"}]),t?this._renderPolicy("shared_link_policy",ee(this.props.isTeamSharedFolder?"Allow members of this team folder to share links with others?":"Allow links to be shared with people outside of this folder?"),[{label:ee("No"),value:"members"},{label:ee("Yes"),value:"anyone"}]):void 0)},_renderPolicy:function(e,t,n){var s,r,o;return o=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),r=o[0],s=o[1],re(X,{canChange:s,policyName:e,policyDescription:t,currentValue:r,options:n,handleOptionChange:this.props.onOptionChange})},_renderButtons:function(){var e,t,n;return e=null!=(t=this.props.permissions)&&null!=(n=t.unshare)?n.allow:void 0,ie.div({className:"u-mar-top-m clearfix"},this.props.isSharedFolder&&e?ie.div({className:"u-l-fl"},ie.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},ee(this.props.hasParentSharedFolder?"Reset membership":"Unshare folder"))):void 0,this._renderUpdateSettingsButtons())},_renderUpdateSettingsButtons:function(){var e;if(null!=(e=this.props.permissions)?e.change_options.allow:void 0)return re(V,{disableSave:null==this.props.policyUpdate,isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss})}}),z=p(te,["/static/css/sharing/share_modal-vflEotmBn.css"],[X]),{SharedFolderSettingsModal:Y,SharedFolderSettingsModalContents:z}});var indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1}
;define("modules/clean/sharing/link_settings_modal",["external/classnames","external/immutable","external/react","external/underscore","modules/clean/api_v2/types","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/react/bubble_menu","modules/clean/react/calendar","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/delete_link_modal","modules/clean/sharing/link_description","modules/clean/static_urls","modules/clean/user","modules/clean/previews/util","modules/constants/python","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w){var C,E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X;return Y=r.formatTimestamp,H=o.daysAfterToday,z=o.format_date,j=o.localized_date_format,G=a.file_extension,C=l.BubbleMenu,E=l.BubbleMenuItem,P=d.Calendar,M=p.Modal,F=h.ShareApiClient,T=m.LinkMetadata,N=m.LinkPolicy,k=m.RequestedVisibilityPolicy,A=m.ResolvedVisibilityPolicy,O=m.VisibilityDisallowedReason,V=f.deleteLinkWithConfirm,W=g.formatLinkCommentingVisibility,K=g.formatLinkVisibilityOption,X=y.static_url,L=S.TRADEMARK_BUSINESS,R=S.TRADEMARK_PLUS,q=n.createElement,B=n.DOM,D=I.i18n_default_project("sharing")._,U=n.createClass({displayName:"SharedLinkSettingsModal",propTypes:{client:n.PropTypes.instanceOf(F).isRequired,isFile:n.PropTypes.bool.isRequired,linkMetadata:n.PropTypes.instanceOf(T).isRequired,onClose:n.PropTypes.func,onDeleteLink:n.PropTypes.func,onPolicySet:n.PropTypes.func,showUpgradeToBiz:n.PropTypes.bool.isRequired,isTeam:n.PropTypes.bool},getInitialState:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.requested_visibility,n=this.props.linkMetadata.link_permissions.resolved_visibility,t===k.public&&n===A.team_only&&(t=k.team_only),e=N({requested_visibility:t,link_password:t===k.password?null:"",expires:this.props.linkMetadata.expires,allow_download:this.props.linkMetadata.link_permissions.allow_download}),{existingPolicy:e,isSubmitting:!1,newPolicy:e}},render:function(){var e,t;return e=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.disallowed_reason===O.user_account_type}),t=e.length>0,q(M,{autoClose:!1,className:"shared-link-settings-modal",buttonComponent:B.span(),onDismissCompleted:this._handleDismissed,title:D("Link permissions for “%(content_name)s”").format({content_name:this.props.linkMetadata.name})},q(x,{canSubmit:!this.state.existingPolicy.equals(this.state.newPolicy),isFile:this.props.isFile,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onCancel:this._dismissModal,onSubmit:this._saveSettings,onPolicyUpdate:this._handlePolicyUpdate,onDeleteLink:this._deleteLink,renderedPolicy:this.state.newPolicy,showUpgradeToBiz:this.props.showUpgradeToBiz,showUpgradeMessage:t,isTeam:this.props.isTeam}))},_handlePolicyUpdate:function(e,t){return"expires"===e&&null!=t&&(t.setHours(23),t.setMinutes(59),t.setSeconds(59)),this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_getModifiedSettings:function(){var e,t;if(t=this.state.newPolicy,t.requested_visibility===k.password){if(null==t.link_password)t=t.set("requested_visibility",null);else if(""===t.link_password)return w.error(D("Password can’t be empty")),null}else t=t.set("link_password",null);return e=this.props.linkMetadata.link_permissions.resolved_visibility,e===A.shared_folder_only&&(t=t.set("requested_visibility",null)),null!=t.expires&&(t=this.props.linkMetadata.link_permissions.can_set_expiry?t.set("expires",Y(t.expires)):t.set("expires",null)),t.allow_download===this.state.existingPolicy.allow_download&&(t=t.set("allow_download",void 0)),{url:this.props.linkMetadata.url,settings:t,remove_expiration:null!=this.props.linkMetadata.expires&&null==this.state.newPolicy.expires}},_saveSettings:function(){var e;if(e=this._getModifiedSettings(),null!=e)return this.setState({isSubmitting:!0}),this.props.client.modifySharedLinkSettings(e).catch((function(e){return function(){return e.setState({isSubmitting:!1}),Promise.reject()}})(this)).then((function(e){return function(t){var n;return w.success(D("Settings saved.")),"function"==typeof(n=e.props).onPolicySet&&n.onPolicySet(t),e._dismissModal()}})(this))},_dismissModal:function(){return M.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_deleteLink:function(){var e,t;return t=(function(e){return function(){var t;return"function"==typeof(t=e.props).onDeleteLink?t.onDeleteLink():void 0}})(this),e=(function(e){return function(){return M.showInstance(q(U,e))}})(this.props),V({client:this.props.client,contentName:this.props.linkMetadata.name,onCancel:e,onDeleteLink:t,url:this.props.linkMetadata.url})}}),x=n.createClass({displayName:"SharedLinkSettingsModalContents",propTypes:{canSubmit:n.PropTypes.bool.isRequired,isFile:n.PropTypes.bool.isRequired,isSubmitting:n.PropTypes.bool.isRequired,linkMetadata:n.PropTypes.instanceOf(T).isRequired,onCancel:n.PropTypes.func,onSubmit:n.PropTypes.func,onPolicyUpdate:n.PropTypes.func,onDeleteLink:n.PropTypes.func,renderedPolicy:n.PropTypes.instanceOf(N).isRequired,showUpgradeToBiz:n.PropTypes.bool.isRequired,showUpgradeMessage:n.PropTypes.bool.isRequired,isTeam:n.PropTypes.bool},getInitialState:function(){return{selectedExpiry:null!=this.props.renderedPolicy.expires?this.props.linkMetadata.link_permissions.can_set_expiry?"custom":"read-only":"no-expiry"}},render:function(){return B.div({className:"shared-link-settings-modal__contents"},this._renderHeader(),this._renderPolicies(),this._renderButtons())},_renderHeader:function(){var e,t;return this.props.showUpgradeToBiz?B.div({className:"shared-link-settings-modal__upgrade-to-biz-banner"},B.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-text"},D("Did you know %(trademark_business)s lets you add passwords and expiration dates to shared links?").format({trademark_business:L})),B.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-cta"},B.a({className:"c-btn c-btn--secondary shared-link-settings-modal__upgrade-to-biz-banner-cta-button",href:"/business?tk=teams&camp=sharing_link_modal",target:"_blank"},D("Learn More")))):this.props.showUpgradeMessage?(this.props.isTeam?(e="/team/upgrade",t=D("Upgrade to %(trademark_business)s to enable permission settings").format({trademark_business:L})):(e="/upgrade?oqa=sfp",t=D("Upgrade to Dropbox %(trademark_plus)s to enable permission settings.").format({trademark_plus:R})),B.div({className:"shared-link-settings-modal__upgrade-to-pro-banner"},B.a({href:e,target:"_blank"},t))):void 0},_renderPolicies:function(){return B.div({},this._renderVisibilityPolicies(),this._renderExpiryPolicy(),this._renderDownloadPolicy(),this._renderCommentsPolicy())},_renderVisibilityPolicies:function(){var e,t;return t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.allowed||e.disallowed_reason===O.user_account_type}),e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,this._renderFieldset(D("Who can view this link?"),e===O.permission_denied&&0===t.length?this._renderNonPermissionVisibility():t.length<2?this._renderRestrictedBySharedFolderVisibility():t.map(this._renderVisibilityOption))},_renderNonPermissionVisibility:function(){var e;return e=this.props.linkMetadata.link_permissions.resolved_visibility,B.span({},B.span({className:"shared-link-settings-modal__visibility-text"},e===A.shared_folder_only?D("Only invited members can view this link."):K(e))," ",B.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},D("You don’t have permission to change the visibility.")))},_renderRestrictedBySharedFolderVisibility:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.resolved_visibility,e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,B.span({},B.span({className:"shared-link-settings-modal__visibility-text"},function(){if(t===A.shared_folder_only)return n=this.props.linkMetadata.link_permissions.restricting_shared_folder_path,n=i.em_snippet(n,_.SNIPPET_SIZES.FILENAME),D("Only members of the shared folder “%(shared_folder_name)s” can view this link.").format({shared_folder_name:n});if(t===A.only_you)return D("Only you can view this link.");throw"Unexpected visibility "+t}.call(this))," ",B.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},(function(){if(e===O.restricted_by_shared_folder)return D("To change who can access the link, go to the shared folder options.");if(e===O.delete_and_recreate)return D("To change who can access the link, delete this link and create a new one.");throw"Unexpected disallowed reason "+e})()))},_renderVisibilityOption:function(t){var n,s;return n=t.disallowed_reason===O.user_account_type,[B.label({className:e({"u-font-meta":!t.allowed}),key:"visibility-label"},B.input({checked:t.policy===this.props.renderedPolicy.requested_visibility,className:e((s={"shared-link-settings-modal__audience":!0},s["shared-link-settings-modal__audience-"+t.policy]=!0,s)),disabled:n,name:k.policy_name,onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),type:"radio",value:t.policy}),this._renderVisibilityLabelText(t)),t.policy===k.password&&this.props.renderedPolicy.requested_visibility===k.password?B.div({key:"password-input"},this._renderPasswordInput(n)):void 0]},_renderVisibilityLabelText:function(t){var n;return B.span({className:e((n={"shared-link-settings-modal__audience":!0},n["shared-link-settings-modal__audience-"+t.policy+"-label"]=!0,n))},K(t.resolved_policy))},_renderPasswordInput:function(e){var t,n;return n=null==this.props.renderedPolicy.link_password,B.div({className:"shared-link-settings-modal__password-container u-mar-left-m u-mar-right-xl u-mar-top-xs"},B.input({className:"shared-link-settings-modal__password-input c-input",disabled:e||n,name:"link_password",onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),placeholder:D("Set password"),value:null!=(t=this.props.renderedPolicy.link_password)?t:"123456",type:"password"}),n&&!e?B.button({className:"shared-link-settings-modal__password-change button-as-link",onClick:(function(e){return function(){return e.props.onPolicyUpdate("link_password","")}})(this)},D("Change",{comment:"A link to change the password for the shared link"})):void 0)},_renderExpiryPolicy:function(){return this._renderFieldset(D("Add an expiry date to this link?"),B.div({},B.label({className:e({"shared-link-settings-modal__expiry-label-yes":!0,"u-font-meta":!this.props.linkMetadata.link_permissions.can_set_expiry})},B.input({checked:"no-expiry"!==this.state.selectedExpiry,className:"shared-link-settings-modal__expiry-option-yes",disabled:!this.props.linkMetadata.link_permissions.can_set_expiry,onChange:(function(e){return function(){if("no-expiry"===e.state.selectedExpiry)return e._handleExpirySelectChange(30)}})(this),type:"radio"}),this._renderYesExpiryText()),"custom"===this.state.selectedExpiry?this._renderExpiryCustom():void 0,B.label({className:e({"u-font-meta":!this.props.linkMetadata.link_permissions.can_remove_expiry})},B.input({checked:null==this.props.renderedPolicy.expires,className:"shared-link-settings-modal__expiry-option-no",disabled:!this.props.linkMetadata.link_permissions.can_remove_expiry,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate&&t.onPolicyUpdate("expires",null),e.setState({selectedExpiry:"no-expiry"})}})(this),type:"radio"}),D("No"))))},_renderYesExpiryText:function(){var e,t;if(7===(e=this.state.selectedExpiry)||30===e)return B.span({className:"shared-link-settings-modal__expiry-text-yes"},D("Yes, expires in",{comment:'Label followed by a date range e.g. "Yes, expires in 7 days"'})," ",this._renderExpirySelect());if("custom"===(t=this.state.selectedExpiry)||"read-only"===t)return B.span({className:"shared-link-settings-modal__expiry-text-yes"},D("Yes, expires on",{comment:'Label followed by a date. e.g. "Yes, expires on 5/10/2017"'})," ","read-only"===this.state.selectedExpiry?z(this.props.linkMetadata.expires,j):void 0);if("no-expiry"===this.state.selectedExpiry)return B.span({className:"shared-link-settings-modal__expiry-text-yes"},D("Yes"));throw"Expiry policy is in an unknown state"},_renderExpirySelect:function(){var e;return q(C,{position:C.POSITIONS.BOTTOM,targetFixed:!0,items:function(){var t,n,s,r;for(s=[7,30,"custom"],r=[],t=0,n=s.length;t<n;t++)e=s[t],r.push(q(E,{onClick:(function(e){return function(t){return function(){return e._handleExpirySelectChange(t)}}})(this)(e)},this._renderExpirySelectLabel(e)));return r}.call(this),targetButton:B.button({className:"shared-link-settings-modal__selected-expiry button-as-link"},this._renderExpirySelectLabel(this.state.selectedExpiry)," ",B.img({alt:"",className:"sprite sprite_web s_web_arrow-down-gray",src:X("/static/images/icons/icon_spacer-vflN3BYt2.gif")}))})},_renderExpirySelectLabel:function(e){if(7===e)return D("7 days",{comment:'as in "This link expires in 7 days"'});if(30===e)return D("30 days",{comment:'as in "This link expires in 30 days"'});if("custom"===e)return D("Custom date...",{comment:"Dropdown option for expiry date on a link. The user can choose 7 days, 30 days, or a custom expiry"});throw"Unknown selected expiry"},_handleExpirySelectChange:function(e){var t;return this.setState({selectedExpiry:e}),"custom"===e&&(e=30),"function"==typeof(t=this.props).onPolicyUpdate?t.onPolicyUpdate("expires",H(e)):void 0},_renderExpiryCustom:function(){var e;return B.span({className:"shared-link-settings-modal__calendar-input"},q(P,{alignAtLeft:!1,onDateChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).onPolicyUpdate?n.onPolicyUpdate("expires",t):void 0}})(this),initDate:null!=(e=this.props.linkMetadata.expires)?e:H(30),firstDay:H(1),lastDay:H(365)}))},_renderDownloadPolicy:function(){var t,n,s;if(s=this.props.linkMetadata.link_permissions.can_disallow_download,n=this.props.linkMetadata.link_permissions.can_allow_download,t=this.props.linkMetadata.link_permissions.allow_download,null!=s&&null!=n&&null!=t&&(s!==!1||t!==!0))return this._renderFieldset(D("Allow people to download this?"),B.div({},B.label({className:e({"u-font-meta":!n})},B.input({checked:this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-yes",disabled:!n,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!0):void 0}})(this),type:"radio"}),D("Yes")),B.label({className:e({"u-font-meta":!s})},B.input({checked:!this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-no",disabled:!s,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!1):void 0}})(this),type:"radio"}),D("No"))),this._renderNoPreviewFileWarning())},_renderNoPreviewFileWarning:function(){var e,t,n,s;if(this.props.isFile&&(e=G(this.props.linkMetadata.name),t=e.toUpperCase(),!(null!=(null!=(s=this.props.linkMetadata)?s.preview_type:void 0)&&(n=this.props.linkMetadata.preview_type,indexOf.call(v.VALID_PREVIEW_TYPES,n)>=0))))return this.props.renderedPolicy.allow_download===!1?B.div({className:"shared-link-settings-modal__preview-warning c-banner c-banner--warning"},B.div({className:"o-flag"},B.div({className:"o-flag-fix"},q(u,{alt:"",group:"web",name:"page_white_32"})),B.div({className:"o-flag__flex u-pad-left-xs"},D("People can’t view this %(file_extension)s file if they can’t download it.",{comment:'as in "People can’t view this .PDF file'}).format({file_extension:"."+t})))):void 0},_renderCommentsPolicy:function(){if(!this.props.linkMetadata.link_permissions.team_restricts_comments)return this._renderFieldset(D("Who can comment?"),B.div({},B.div({className:"shared-link-settings-modal__commenting-policy"},W(this.props.linkMetadata.link_permissions.allow_comments,this._getResolvedVisibility(this.props.renderedPolicy.requested_visibility),this.props.linkMetadata.link_permissions.restricting_shared_folder_path)),B.div({className:"shared-link-settings-modal__commenting-advice"},this.props.linkMetadata.link_permissions.allow_comments?B.a({href:"/help/9016/#comments",target:"_blank"},D("Learn how to disable comments")):B.a({href:"/help/9016/#comments",target:"_blank"},D("Learn how to enable comments")))))},_getResolvedVisibility:function(e){var t;if(t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(t){return t.policy===e}),1!==t.length)throw"Logic error: "+t.length+" should be 1.";return t[0].resolved_policy},_renderFieldset:function(e,t,n){return null==n&&(n=null),B.fieldset({className:"settings-form-entry"},B.legend({className:"settings-form-entry__explanation u-trim-margin"},e),B.div({className:"settings-form-entry__options"},t),B.div({className:"u-mar-top-m"},n))},_renderButtons:function(){return B.div({className:"u-mar-top-m clearfix"},this.props.linkMetadata.link_permissions.can_revoke?B.div({className:"u-l-fl"},B.button({className:"button-as-link delete-link",onClick:this.props.onDeleteLink,style:{lineHeight:"32px"},type:"button"},D("Delete link"))):void 0,B.div({className:"u-l-fr"},B.button({className:"c-btn c-btn--primary confirm-button",disabled:this.props.isSubmitting||!this.props.canSubmit,onClick:this.props.onSubmit},D(this.props.isSubmitting?"Saving...":"Save settings")),B.button({className:"c-btn c-btn--secondary u-mar-left-xs cancel-button",onClick:this.props.onCancel},D("Cancel"))))}}),Q=function(e){return _.SHARING_EXPERIMENTS.SHOW_UPGRADE_TO_BIZ_BANNER[e]},{SharedLinkSettingsModal:c(U,["/static/css/sharing/share_modal-vflEotmBn.css"]),SharedLinkSettingsModalContents:x,showUpgradeToBizBanner:Q}}),define("modules/clean/sharing/parent_folder_access_modal",["external/classnames","external/react","modules/clean/em_string","modules/clean/react/flag","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d){var c,p,u,h,m,_,f,g,y,b,v;return h=r.Modal,u=i.MemberAccessLevelResult,c=a.ACCESS_LEVEL,_=a.SNIPPET_SIZES,p=l.ContentInfo,g=t.createElement,y=t.DOM,b=d.i18n_default_project("sharing"),f=b._,v=b.ungettext,m=t.createClass({displayName:"ParentFolderAccessModal",propTypes:{contentInfo:t.PropTypes.instanceOf(p).isRequired,memberAccessLevelResult:t.PropTypes.instanceOf(u).isRequired,memberDisplayName:t.PropTypes.string.isRequired,originalAction:t.PropTypes.oneOf(["remove","update"]).isRequired,isInContentManager:t.PropTypes.bool,onClose:t.PropTypes.func,onParentFolderClicked:t.PropTypes.func},_dismissModal:function(){return h.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_handleNavigateToParentFolder:function(e){var t;return h.close(),"function"==typeof(t=this.props).onParentFolderClicked?t.onParentFolderClicked(e.path,this._arePermissionsAllowed(e.permissions)):void 0},_arePermissionsAllowed:function(e){return e.some(function(e){return null!=e?e.allow:void 0})},_memberCanEdit:function(){var e;return(e=this.props.memberAccessLevelResult.access_level)===c.OWNER||e===c.WRITER},_renderParentFolderContent:function(){var e;return e="remove"===this.props.originalAction?this.props.contentInfo.isFolder()?v("As a member of the parent folder listed below, %(member_name)s can still access the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):v("As a member of the parent folder listed below, %(member_name)s can still access “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):"update"===this.props.originalAction?this.props.contentInfo.isFolder()?this._memberCanEdit()?v("As a member of the parent folder listed below, %(member_name)s can still edit the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):v("As a member of the parent folder listed below, %(member_name)s can still view the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):this._memberCanEdit()?v("As a member of the parent folder listed below, %(member_name)s can still edit “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):v("As a member of the parent folder listed below, %(member_name)s can still view “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):void 0,y.div({},e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME),content_name:n.em_snippet(this.props.contentInfo.name(),_.FILENAME)}),y.div({className:"parent-folder-access-modal__folder-list u-mar-top-s"},y.ul({className:"o-list-ui o-list-ui--dividers"},this.props.memberAccessLevelResult.parentFolders.map(this._renderParentFolder))))},_renderParentFolder:function(e){var t;return t=g(o,{group:"web",name:"folder_user_32",className:"u-pad-right-xs",alt:""}),y.li({},y.div({className:"parent-folder-access-modal__parent-folder u-pad-vertical-xs u-pad-horizontal-s",onClick:this._handleNavigateToParentFolder.bind(null,e)},g(s.Flag,{leftAttachment:t,rightAttachment:this._renderFolderLink(e)},y.span({className:"parent-folder-access-modal__folder-name"},n.em_snippet(e.name,_.FILENAME)))))},_renderFolderLink:function(e){return y.button({className:"button-as-link",onClick:this._handleNavigateToParentFolder.bind(null,e),type:"button"},f(this._arePermissionsAllowed(e.permissions)?"Manage membership":"View folder"))},_renderSimpleContent:function(){return y.div({},y.span({className:"parent-folder-access-modal__warning"},this.props.memberAccessLevelResult.warning),y.div({className:"u-mar-top-m clearfix"},y.div({className:"u-l-fr"},y.button({className:"c-btn c-btn--primary confirm-button",onClick:this._dismissModal},f("OK")))))},render:function(){var e;return e="remove"===this.props.originalAction?f(this.props.contentInfo.isFolder()?"%(member_name)s can still access this folder":"%(member_name)s can still access this file"):"update"===this.props.originalAction?f(this.props.contentInfo.isFolder()?this._memberCanEdit()?"%(member_name)s can still edit this folder":"%(member_name)s can still view this folder":this._memberCanEdit()?"%(member_name)s can still edit this file":"%(member_name)s can still view this file"):void 0,g(h,{autoClose:!1,className:"parent-folder-access-modal",buttonComponent:y.span(),onDismissCompleted:this._handleDismissed,title:e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME)})},y.div({className:"parent-folder-access-modal__contents"},null==this.props.memberAccessLevelResult.parentFolders||this.props.isInContentManager?this._renderSimpleContent():this._renderParentFolderContent()))}}),{ParentFolderAccessModal:m}});var extend=function(e,t){function n(){this.constructor=e}for(var s in t)hasProp.call(t,s)&&(e[s]=t[s]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;define("modules/clean/sharing/role_selector_modal",["jquery","modules/clean/dbmodal","modules/clean/multiaccount_login","modules/clean/viewer"],function(e,t,n,s){var r;return r=t.DBModal,(function(t){function r(e){this.onSelectRole=e,r.__super__.constructor.call(this,{element_id:"select-role-modal-sync"})}return extend(r,t),r.prototype.on_show=function(){return e(".role-options li").click((function(t){return function(r){var o;return o=e(r.target).closest("li").data("role"),t.hide(),s.get_viewer().is_role_signed_in(o)?t.onSelectRole(o):n.show_modal({role:o,on_success:function(){return t.onSelectRole(o)}})}})(this))},r})(r)}),define("modules/clean/sharing/set_confidential_modal",["external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/modal","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,i){var a,l,d,c,p,u,h,m;return h=n.filename,m=n.parent_dir,a=s.Modal,l=o.SNIPPET_SIZES,p=e.createElement,u=e.DOM,c=i.i18n_default_project("sharing")._,d=e.createClass({displayName:"SetConfidentialModal",propTypes:{client:e.PropTypes.instanceOf(r).isRequired,folderId:e.PropTypes.string.isRequired,folderName:e.PropTypes.string.isRequired,folderPath:e.PropTypes.string.isRequired,initialIsConfidentialFolder:e.PropTypes.bool.isRequired,onCancel:e.PropTypes.func,onUpdateConfidentiality:e.PropTypes.func},getInitialState:function(){return{isAccepting:!1,setConfidential:this.props.initialIsConfidentialFolder}},render:function(){return p(a,{autoClose:!1,buttonComponent:u.span(),onDismissCompleted:this._handleDismiss,title:c("“%(folder_name)s” access").format({folder_name:t.em_snippet(this.props.folderName,l.FILENAME)})},this._renderContent(),this._renderButtons())},_renderContent:function(){var e;return e=t.em_snippet(h(m(this.props.folderPath)),l.FILENAME),u.div({className:"set-confidential-content"},u.div({className:"set-confidential-content__info"},c("Should members of the parent folder “%(parent_folder)s” automatically get access to the folder “%(folder_name)s”?").format({folder_name:t.em_snippet(this.props.folderName,l.FILENAME),parent_folder:e})),u.div({className:"set-confidential-content__options u-pad-top-s"},u.label({className:"u-l-b",key:"inherit"},u.input({checked:!this.state.setConfidential,name:"inherit",onChange:this._handleSetConfidentialValueUpdate,type:"radio",value:!1}),c("Yes, allow members of “%(parent_folder)s” to access").format({parent_folder:e})),u.label({className:"u-l-b",key:"confidential"},u.input({checked:this.state.setConfidential,name:"confidential",onChange:this._handleSetConfidentialValueUpdate,type:"radio",value:!0}),c("No, make this folder invite only"))))},_renderButtons:function(){return u.div({className:"u-l-fr"},u.button({className:"c-btn c-btn--primary",disabled:this.state.isAccepting||this.state.setConfidential===this.props.initialIsConfidentialFolder,onClick:this._handleAcceptClick},c(this.props.isAccepting?"Saving...":"Save")),u.button({className:"c-btn c-btn--secondary u-mar-left-xs",onClick:this._handleDismiss},c("Cancel")))},_handleSetConfidentialValueUpdate:function(e){return this.setState({setConfidential:"true"===e.target.value})},_handleAcceptClick:function(){return this.setState({isAccepting:!0}),this.props.folderId?this.props.client.setConfidentiality({contentId:this.props.folderId,confidential:this.state.setConfidential}).then((function(e){return function(t){var n;return"function"==typeof(n=e.props).onUpdateConfidentiality?n.onUpdateConfidentiality(t):void 0}})(this)):this.props.client.shareInternal({fqPath:this.props.folderPath,confidential:this.state.setConfidential}).then((function(e){return function(t){var n;return"function"==typeof(n=e.props).onUpdateConfidentiality?n.onUpdateConfidentiality(t):void 0}})(this))},_handleDismiss:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0}}),{SetConfidentialModal:d}}),define("modules/clean/sharing/settings_modal_components",["external/classnames","external/react","modules/clean/react/css","modules/core/i18n"],function(e,t,n,s){var r,o,i,a,l;return l=t.DOM,i=s.i18n_default_project("sharing")._,r=t.createClass({displayName:"SettingsModalButtons",propTypes:{disableSave:t.PropTypes.bool,isAccepting:t.PropTypes.bool,onAccept:t.PropTypes.func,onDismiss:t.PropTypes.func},render:function(){return l.div({className:"u-l-fr"},l.button({className:"confirm-button c-btn c-btn--primary",disabled:this.props.disableSave||this.props.isAccepting,onClick:this.props.onAccept},i(this.props.isAccepting?"Saving...":"Save")),l.button({className:"cancel-button c-btn c-btn--secondary u-mar-left-xs",onClick:this.props.onDismiss},i("Cancel")))}}),a=t.createClass({displayName:"SinglePolicyControl",propTypes:{canChange:t.PropTypes.bool,currentValue:t.PropTypes.string,handleOptionChange:t.PropTypes.func,options:t.PropTypes.array,policyDescription:t.PropTypes.string,policyName:t.PropTypes.string},getDefaultProps:function(){return{canChange:!0}},render:function(){var t;return l.fieldset({className:e({"settings-form-entry":!0,"settings-form-entry--no-permissions":!this.props.canChange})},l.legend({className:"settings-form-entry__explanation u-trim-margin"},this.props.policyDescription),l.div({className:"settings-form-entry__options"},function(){var e,n,s,r;for(s=this.props.options,r=[],e=0,n=s.length;e<n;e++)t=s[e],r.push(l.label({key:t.value},l.input({checked:t.value===this.props.currentValue,className:"settings-form-entry-option-"+this.props.policyName+"__"+t.value,disabled:!this.props.canChange,name:this.props.policyName,onChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).handleOptionChange?n.handleOptionChange(t.target.name,t.target.value):void 0}})(this),type:"radio",value:t.value}),t.label));return r}.call(this)))}}),o=n(a,["/static/css/sharing/share_modal-vflEotmBn.css"]),{SettingsModalButtons:r,SinglePolicyControl:o}}),define("modules/clean/sharing/share_modal",["require","exports","tslib","external/immutable","external/react","modules/clean/flux/dispatcher","modules/clean/flux/store_listener","modules/clean/growth/experiments/manage_shared_folders_modal","modules/clean/growth/experiments/sharing_paywall_info_modal","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/sharing/constants","modules/clean/sharing/api/util/types","modules/clean/sharing/file_settings_modal","modules/clean/sharing/folder_settings_modal","modules/clean/sharing/set_confidential_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/modal_content","modules/clean/sharing/views/viewer_list_modal","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E){"use strict";var P=r.createElement,T=C.i18n_default_project("sharing").ungettext,N=function(e){var t=e.actionHandler.getSharingInfo(),r=e.actionHandler.getPassInfo(),o=r[0],i=r[1],a=r[2],l=r[3],d={actionHandler:e.actionHandler,areMembersFullyLoaded:t.areMembersFullyLoaded(),areSharingPrefsLoaded:t.areSharingPrefsLoaded(),banner:t.banner(),canChangeOptions:t.canChangeOptions(),canInviteEditor:t.canInviteEditor(),canInviteViewer:t.canInviteViewer(),canInviteViewerNoComment:t.canInviteViewerNoComment(),canMakeViewerNoComment:t.canMakeViewerNoComment(),canRelinquishMembership:t.canRelinquishMembership(),canShareLink:t.canShareLink(),canUnshareFile:t.canUnshareFile(),canUnshareFolder:t.canUnshareFolder(),canUpdateConfidentiality:t.canUpdateConfidentiality(),contactsError:t.contactsError(),contentInfo:t.contentInfo(),contentNameMessage:t.contentNameMessage(),contentNameMessageLevel:t.contentNameMessageLevel(),filePolicy:t.filePolicy(),folderPolicy:t.folderPolicy(),groupSeenStateInfo:i,hasDisplayableMembers:t.hasDisplayableMembers(),
hasNonOwnerMembers:t.hasNonOwnerMembers(),hasParentSharedFolder:t.hasParentSharedFolder(),icon:t.icon(),initialRecipientRawInput:t.initialRecipientRawInput(),initialRecipientTokens:t.initialRecipientTokens(),isAddMessageAsCommentChecked:t.isAddMessageAsCommentChecked(),isAddMessageAsCommentHelpShown:t.isAddMessageAsCommentHelpShown(),isConfidentialFolder:t.isConfidentialFolder(),isContentNameFocused:t.isContentNameFocused(),isFolderInsideTeamFolderTree:t.isFolderInsideTeamFolderTree(),isLinkMetadataLoaded:t.isLinkMetadataLoaded(),isMetadataLoaded:t.isMetadataLoaded(),isNoCommentEnabledForFolders:t.isNoCommentEnabledForFolders(),isNoCommentEnabledForLinks:t.isNoCommentEnabledForLinks(),isOwner:t.isOwner(),isSharingPaywallInfoLoaded:t.isSharingPaywallInfoLoaded(),isTeamPolicyLoaded:t.isTeamPolicyLoaded(),isTeamSharedFolder:t.isTeamSharedFolder(),isTokenizerEmpty:t.isTokenizerEmpty(),isUserOnOwnerTeam:t.isUserOnOwnerTeam(),linkMetadata:t.linkMetadata(),linkOnlyReason:t.linkOnlyReason(),linkSeenStateInfo:o,memberCounts:t.memberCounts(),memberCountWithRecipients:t.memberCountWithRecipients(),members:t.members(),metadata:t.metadata(),ownerTeam:t.ownerTeam(),passFetchingStatus:l,pendingMemberAction:t.pendingMemberAction(),permissions:t.permissions(),presentAccountIds:s.Set(a),recipientAccess:t.recipientAccess(),recipientMessage:t.recipientMessage(),recipientTokens:t.recipientTokens(),shareFolderPromise:t.shareFolderPromise(),sharingPaywallInfo:{foldersToUnshare:t.foldersToUnshare(),isInExperiment:t.isPaywallOn(),maxOwned:t.paywallMax(),numOwned:t.paywallNumOwned(),grandfatherModal:t.paywallGrandfatherModal()},shouldBlockMemberListOnPassLoad:t.shouldBlockMemberListOnPassLoad(),teamPolicy:t.teamPolicy(),uiMode:t.uiMode(),expSubgrowthProOverquotaCreateSharedLink:t.expSubgrowthProOverquotaCreateSharedLink()};return n.__assign({},t.getInitialProps(),d)},M=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleLinkViewersClick=function(){p.Modal.showInstance(r.createElement(I.ViewerListModal,{contentInfo:n.props.contentInfo,seenStateInfo:n.props.linkSeenStateInfo,onCancel:n.props.actionHandler.openShareModal,presentAccountIds:n.props.presentAccountIds,user:n.props.user})),v.logTiburonEvent(n.props.contentInfo,n.props.user.id,"OPEN_SHARED_LINK_VIEWER_LIST_MODAL")},n.handleManageSharedFoldersClick=function(){var e=function(e,t){if(e&&e.size>0){n.props.actionHandler.onUnshareFromPaywall({foldersToUnshare:e,keepACopy:t});var s=T("%(num_folders)s folder will be unshared","%(num_folders)s folders will be unshared",e.size).format({num_folders:e.size});E.success(s)}n.props.sharingPaywallInfo&&n.props.sharingPaywallInfo.grandfatherModal&&n.props.sharingPaywallInfo.grandfatherModal.show&&n.props.actionHandler.paywallGrandfatherModalDismiss(),n.props.actionHandler.openShareModal()};p.Modal.showInstance(r.createElement(a.ManageSharedFoldersModal,{maxOwned:n.props.sharingPaywallInfo.maxOwned,numOwned:n.props.sharingPaywallInfo.numOwned,user:n.props.user,onUnshare:e}))},n.handleUpgradeClick=function(){return n.props.actionHandler.redirectToUpgrade()},n.handleSettingsClick=function(){n.props.contentInfo.isFolder()?n.handleFolderSettingsClick():n.handleFileSettingsClick()},n.handleSetConfidentialClick=function(){var e=function(e){e&&(n.props.actionHandler.handleGetMetadataSuccess(e),n.props.actionHandler.listMembers(e.shared_folder_id)),n.props.actionHandler.openShareModal()};p.Modal.showInstance(r.createElement(g.SetConfidentialModal,{client:n.client,folderId:n.props.contentInfo.isSharedFolder()?n.props.contentInfo.sharedFolderId().toString():void 0,folderName:n.props.contentInfo.name(),folderPath:n.props.contentInfo.displayPath(),initialIsConfidentialFolder:n.props.isConfidentialFolder,onCancel:e.bind(n,null),onUpdateConfidentiality:e}))},n.client=n.props.client,n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){var e=this.getTokenizer();this.props.actionHandler.onShareModalUnmount(e)},t.prototype.render=function(){var e=this,t=d.is_pass_ga_receive_enabled(this.props.user)&&u.getPassPermissions(this.props.contentInfo.id)&&u.getPassPermissions(this.props.contentInfo.id).canReadPresence,s={headerId:"unified-share-modal-title",areCheckboxSettingsLoaded:this.props.areSharingPrefsLoaded,isLimitedTeam:this.props.viewer.team_is_limited,isPassEnabled:d.is_pass_enabled(this.props.user)||t,isInContentManager:this.props.isInContentManager,onSettingsClick:this.handleSettingsClick,onLinkViewersClick:this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length?this.handleLinkViewersClick:void 0,onSetConfidentialClick:this.handleSetConfidentialClick,mode:this.props.uiMode,ref:"content",showContentManagerBridge:this.shouldRenderContentManagerBridge(),showPassFileSettings:this.showFileSettings(),sharingPaywallInfo:{foldersToUnshare:this.props.sharingPaywallInfo.foldersToUnshare,isFolderOwner:this.props.isOwner,isInExperiment:this.props.sharingPaywallInfo.isInExperiment,maxOwned:this.props.sharingPaywallInfo.maxOwned,numOwned:this.props.sharingPaywallInfo.numOwned,onLearnMoreClick:function(){return e.props.actionHandler.paywallGrandfatherModalLearnMore()},onManageSharedFoldersClick:this.handleManageSharedFoldersClick,onUpgradeClick:this.handleUpgradeClick},suppressLinkUI:this.shouldSuppressLinkUI()};return s=n.__assign({},this.props,s),this.shouldShowGrandfatherModal()?this.renderSharingPaywallGrandfatherModal():r.createElement(p.Modal,{style:"bare",acceptButtonText:null,dismissButtonText:null,headerId:"unified-share-modal-title",ref:"modal"},P(S.ShareModalContent,s))},t.prototype.shouldSuppressLinkUI=function(){return this.props.isInContentManager&&!h.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.shouldShowGrandfatherModal=function(){return this.props.sharingPaywallInfo&&this.props.sharingPaywallInfo.grandfatherModal&&this.props.sharingPaywallInfo.grandfatherModal.show&&this.props.isOwner&&this.props.sharingPaywallInfo.isInExperiment&&this.props.contentInfo&&this.props.contentInfo.isFolder()},t.prototype.renderSharingPaywallGrandfatherModal=function(){var e=this,t=function(){e.props.actionHandler.paywallGrandfatherModalDismiss()};return r.createElement(l.SharingPaywallInfoModal,{actionHandler:this.props.actionHandler,onDismiss:t,onManage:this.handleManageSharedFoldersClick,sharedFolderCount:this.props.sharingPaywallInfo.numOwned,grandfather:!this.props.sharingPaywallInfo.grandfatherModal.learnMore})},t.prototype.showFileSettings=function(){return v.showFileSettings(this.props.user,this.props.contentInfo.id)},t.prototype.refreshSharedWithColumnLinkData=function(){o.dispatch({type:c.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.props.contentInfo.displayPath()]}})},t.prototype.handleFolderPolicySuccess=function(e,t){o.dispatch({type:y.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS,user:this.props.user,metadata:t,folderPolicy:e})},t.prototype.getTokenizer=function(){return this.refs.content&&this.refs.content.getWrappedComponent()&&this.refs.content.getWrappedComponent().refs.tokenizer},t.prototype.handleFileSettingsClick=function(){var e=this,t=h.TRUELINK.TRUELINK_UI[this.props.user.id]?m.getCombinedPolicy(this.props.filePolicy,this.props.linkMetadata):this.props.filePolicy,n=function(n){null!=n&&e.props.actionHandler.handleUpdateFilePolicy(n,t),e.props.actionHandler.openShareModal()};p.Modal.showInstance(r.createElement(_.FileSettingsModal,{fileName:this.props.contentInfo.name(),contentId:this.props.contentInfo.id,canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,initialPolicy:t,isInContentManager:this.props.isInContentManager,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,updateLinkSettings:this.props.actionHandler.updateLinkSettings,user:this.props.user})),v.logTiburonEvent(this.props.contentInfo,this.props.user.id,"OPEN_FILE_SETTINGS_MODAL")},t.prototype.handleFolderSettingsClick=function(){var e=this,t=h.TRUELINK.TRUELINK_UI[this.props.user.id]?m.getCombinedPolicy(this.props.folderPolicy,this.props.linkMetadata):this.props.folderPolicy,n=function(t,n){null!=n&&(e.props.actionHandler.handleUpdateSharingSettings(n),e.handleFolderPolicySuccess(t,n),e.props.onSuccessSharing&&e.props.onSuccessSharing(),n.policy.shared_link_policy!==e.props.folderPolicy.shared_link_policy&&(e.props.actionHandler.fetchLinkMetadata(),e.refreshSharedWithColumnLinkData())),e.props.actionHandler.openShareModal()},s=null,o=null;this.props.contentInfo.extras&&this.props.contentInfo.extras.nsId&&(s=this.props.contentInfo.extras.nsId,o=this.props.contentInfo.extras.nsPath),p.Modal.showInstance(r.createElement(f.SharedFolderSettingsModal,{actionHandler:this.props.actionHandler,folderName:this.props.contentInfo.name(),folderId:this.props.metadata.shared_folder_id,folderPath:this.props.contentInfo.displayPath(),nsId:s,nsPath:o,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.props.hasParentSharedFolder,initialHasParentSharedFolder:this.props.hasParentSharedFolder,initialMetadata:this.props.metadata,initialOwnerTeam:this.props.ownerTeam,initialPermissions:this.props.permissions,initialPolicy:t,isInContentManager:this.props.isInContentManager,isSharedFolder:this.props.contentInfo.isSharedFolder(),initialIsTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isLimitedTeam:this.props.viewer.team_is_limited,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,showContentManagerBridge:this.shouldRenderContentManagerBridge(!0),teamPolicy:this.props.teamPolicy,updateLinkSettings:this.props.actionHandler.updateLinkSettings,user:this.props.user}))},t.prototype.shouldRenderContentManagerBridge=function(e){return void 0===e&&(e=!1),v.GoldenGate.hasContentManager(this.props.user.id)&&this.props.user.is_team_admin&&!this.props.isInContentManager&&(this.props.isTeamSharedFolder||e&&this.props.isFolderInsideTeamFolderTree)},t})(r.Component);M.displayName="ShareModal",M.defaultProps={viewer:w.get_viewer()},t.ShareModal=i.listenToStores(M,{sharingInfoStore:b.sharingInfoStore,passStore:u},N)}),define("modules/clean/sharing/share_modal_util",["external/react","external/underscore","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_folder_settings_modal","modules/clean/react/teams/modals/limited_team_share_folder_modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/content_info","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/user","modules/clean/viewer","modules/core/uri"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w){var C,E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z;return N=n.EmailVerification,P=r.Contact,E=a.BrowseLogger,A=l.FileTypes,C=d.BrowseContext,M=d.File,c.Modal,L=m.SharingApi,k=_.FileShareApiClient,F=_.FolderShareApiClient,T=f.ContentInfo,H=g.makePublicFolderLink,K=g.showPublicFolderLinkModal,x=y.ShareModal,D=v.getNewFolderPathFromContentName,B=v.logTiburonEvent,e.createElement,O=function(){return Math.random()},q=function(e,n,s){var r,o,i;null==s&&(s={}),e.id||(e=I.get_viewer().get_user_by_id(e)),null==s.userHomeNs&&(s.userHomeNs=e.home_ns_id),i=U(n),t.extend(i,s),i.modalSessionId||(i.modalSessionId=O()),E.logViewShareModel({uid:e.id,modal_session_id:i.modalSessionId});try{o=T.createFromParams(i)}catch(e){o=null}return r=n instanceof C?n:i.browseContext,{browseContext:r,contentInfo:o,shareModalInfo:i,user:e}},Y=function(e,t,n){var r,o,i,a,l,d,c,p,u,m,_,f;return null==n&&(n={}),m=q(e,t,n),o=m.browseContext,a=m.contentInfo,f=m.shareModalInfo,e=m.user,null!=a&&(B(a,e.id,"BEGIN_SHARE_FLOW"),!!V(e,f,o)||(!f.skipPublicFolderCheck&&a&&o&&(p=H(e.id,o.config,a.displayPath(),a.isFolder()))?(K(p),!0):(c=(null!=o?o.isNonUserRelativeContext:void 0)||f.isNonUserRelativeContext,u=void 0,"PREVIEW_PAGE"===f.origin&&(u=s.SHARE_FILEVIEWER),N.get_for_user(e).verified_or_show(u)?(_=a.isFolder()?F:k,i=new _({userId:e.id,isNonUserRelativeContext:c}),r=new h(i,e,x),l=f.inLinksPage,d=f.prefillContacts,r.initializeShareModal({contentInfo:a,initialRecipientTokens:d,inLinksPage:l},{client:i,user:e,onDeleteLink:f.onDeleteLink,teamGroupInfo:a.teamGroupInfo(),isInContentManager:c,onSuccessSharing:f.onSuccessSharing}),r.openShareModal()):B(a,e.id,"SHARE_MODAL_EMAIL_UNVERIFIED"),!0)))},V=function(e,t,n){var s;if(t.isTeamSharedFolder&&I.get_viewer().team_is_limited)return!e.is_team_admin||"BROWSE_SHARED_FOLDER_BANNER"!==(s=t.origin)&&"BROWSE_GLOBAL_ACTIONS"!==s?u.showModalInstance({fqPath:t.fqPath}):p.showWithProps({folderId:t.targetNsId.toString(),folderName:n.getNameOfTargetFolder(),user:e}),!0},U=function(e){var t,n;return e instanceof M?(t=(n=e.type)===A.FILE||n===A.PACKAGE,{beaconContext:e.beacon_context,exists:!e.isDeleted,fileId:e.file_id,fqPath:e.fq_path,isFolder:!t,isTeamSharedFolder:e.type===A.TEAM_SHARED_FOLDER,sjid:e.sjid,nsId:e.ns_id,nsPath:e.ns_path,targetNsId:e.target_ns}):e instanceof C?R(e):e},R=function(e){return e.isInsideDeletedFolder||e.isInsideDeletedSharedFolder?null:e.isInFolderMode?e.isInsideSharedFolder?e.currentNSPath?{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentMountPoint,isFolder:!0,nsId:null,nsPath:e.currentMountPoint,targetNsId:e.currentNSID,isTeamSharedFolder:e.isInsideAutoTeamFolder}:{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentFQPath,isFolder:!1,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}},G=function(e,t,n){var s;return null==t&&(t=null),null==n&&(n=null),t||(t=O()),s=function(){var e,t,s;for(e="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=1;t<=100;++t)e+=s.charAt(Math.floor(Math.random()*s.length));return D(e,n)},Y(e,{fqPath:s(),isFolder:!0,exists:!1,origin:"WIZARD",modalSessionId:t})},z=function(e,t){var n,s;return n=new L(e),s=function(e){var n;return n=JSON.parse(e.responseText),b.showSharedContentSyncModal(n,t)},n.get_sync_vars_for_ns_id(t.ns_id,t.ns_path,s)},W=function(e){var t,n,s,r,i;return i=e.user,r=e.sharePrefillEmail,t=e.content,r?(n="GRANT_ACCESS",s=[new P({type:o.EMAIL,email:r})]):(n="DESKTOP_CLIENT",s=[]),Y(i,t,{origin:n,prefillContacts:s})},{generateModalSessionId:O,getShareModalInfo:U,getSharingInfo:q,showFastrakShareModalIfAllowed:V,showNewFolderShareModal:G,showSharedContentLinkSyncModal:z,showShareModal:Y,showPrefilledShareModal:W}}),define("modules/clean/sharing/shared_content_link_sync_modal",["external/classnames","external/react","modules/clean/ajax","modules/clean/avatar/triple_avatars","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/faceholder","modules/clean/avatar/size","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/react/button","modules/clean/react/browse/models","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/teams","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","require"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T,N){var M,k,A,F,x,L,R,O,D,U,q;return x=s.TripleAvatars,F=r.ShareTibEventLogger,M=a.AVATAR_DIMENSION_BY_SIZE,R=p.button,k=u.File,A=m.Modal,U=f.reactFormat,q=b.static_url,w.TRADEMARK_BUSINESS,L=E.i18n_default_project("sharing")._,D=t.DOM,O=t.createElement,t.createClass({statics:{showInstance:function(e){return A.showInstance(e)}},displayName:"SharedContentLinkSyncModal",ASK:"ask",ASKING:"asking",propTypes:{accessLevel:t.PropTypes.string.isRequired,folderName:t.PropTypes.string.isRequired,folderSize:t.PropTypes.string.isRequired,onMountSharedFolder:t.PropTypes.func.isRequired,canRequestToJoin:t.PropTypes.bool,previewCallback:t.PropTypes.func,previewUrl:t.PropTypes.string,outOfQuotaQP:t.PropTypes.string,ownerName:t.PropTypes.string,senderName:t.PropTypes.string,usageRemaining:t.PropTypes.string,usageNeeded:t.PropTypes.string,targetFile:t.PropTypes.instanceOf(k),syncNSId:t.PropTypes.string,expProSharingOverquotaModal:t.PropTypes.string,ownerProfilePhotoUrl:t.PropTypes.string},getDefaultProps:function(){return{canRequestToJoin:!1}},getInitialState:function(){return{state:this.ASK,ownerTeam:null}},componentWillMount:function(){var e,t,n,s;return s=S.start_time(),e=(new Date).getTime(),this.userId=v.get_viewer().get_users()[0].id,n=g.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,t=this.props.targetFile?"UNMOUNTED_SEARCH_MODAL_RENDER":"SYNC_MODAL_RENDER",F.log(this.userId,t,n,{timing:e-s,ns_id:this.props.syncNSId})},_closeSyncModal:function(){return c.remove_query_param("sm"),this.refs.modal.close()},_renderTopPanelIcon:function(){return this.props.targetFile?O(_,{alt:"",group:"web",name:this.props.targetFile.icon}):O(_,{alt:"",group:"web",name:"folder_user_32"})},_renderTopPanelTitle:function(){return this.props.targetFile?l.em_snippet(d.filename(this.props.targetFile.fq_path,15)):l.em_snippet(this.props.folderName,15)},_renderTopPanelSubtitle:function(){return this.props.targetFile?null!=this.props.ownerName?L("Owned by %(name)s").format({name:this.props.ownerName}):L("Not currently owned"):this.props.folderSize},_renderAccessText:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?D.div({},D.div({className:"content-link-sync-modal__access-text u-mar-top-m"},O(x,{contacts:this.state.ownerTeam.contacts,count:this.state.ownerTeam.count})),D.div({className:"content-link-sync-modal__access-text"},L("Your Dropbox is full—join the %(team_name)s Dropbox?").format({team_name:this.state.ownerTeam.name}))):D.div({}):D.div({className:"content-link-sync-modal__access-text"},L("Not enough space")):D.div({className:"content-link-sync-modal__access-text"},null!=this.props.senderName?"can_view"===this.props.accessLevel?L("%(name)s gave you access to view this folder").format({name:this.props.senderName}):L("%(name)s gave you access to edit this folder").format({name:this.props.senderName}):L("can_view"===this.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},_renderSharedFolderInfo:function(){var e;return D.div({className:"content-link-sync-modal__shared-folder-info"},D.div({className:"content-link-sync-modal__shared-folder-text"},L((null!=(e=this.props.targetFile)?e.is_dir:void 0)?"This folder is part of a shared folder:":"This file is part of a shared folder:")),D.div({},O(_,{alt:"",group:"web",name:"folder_user_32"})),D.p({className:"u-font-meta"},this.props.folderName,D.br({}),this.props.folderSize))},_renderTipBody:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?this.state.ownerTeam.contacts.length>0?L("Join %(name)s and your coworkers and get more space to work together.").format({name:this.state.ownerTeam.contacts[0].display_name}):void 0:D.img({className:"content-link-sync-modal__loader",src:q("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:L("Loading")}):this.props.usageRemaining?L("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):L("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:this.props.usageNeeded}):this.state.state===this.ASKING?D.img({src:q("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:L("Loading")}):L("can_view"===this.props.accessLevel?this.props.targetFile?"For easy access to this file in the future, add the folder to your Dropbox.":"For easy access to this folder in the future, add it to your Dropbox.":this.props.targetFile?"To start working on this file, you need to add the folder to your Dropbox first.":"To start working on this folder, you need to add it to your Dropbox first.")},_renderPreviewLink:function(){if("can_view"===this.props.accessLevel)return D.div({},D.span({className:"content-link-sync-modal__or"},L("Or")),D.button({className:"content-link-sync-modal__not-now-label button-as-link",onClick:this.onPreviewButtonClicked},L(!this.props.targetFile||this.props.targetFile.is_dir?"preview this folder":"preview this file")))},render:function(){var t,n,s,r,o;return s="V1"===(r=this.props.expProSharingOverquotaModal)||"V2"===r||"V3"===r,n=e({"content-link-sync-modal":!0,"exp-subgrowth-biz-upsell":this.props.canRequestToJoin,"content-link-sync-modal--pro-variant":s}),this.props.outOfQuotaQP&&s?(o=this.renderVariant(),t=this.renderButtonsVariant()):(o=this.renderControl(),t=this.renderButtons()),O(A,{autoClose:!1,buttonComponent:t,className:n,clickOutToClose:!1,ref:"modal",showX:!1,title:""},o)},renderControl:function(){return D.div({className:"content-link-sync-modal__content u-mar-bottom-xs"},D.div({className:"content-link-sync-modal__top-panel u-pad-s"},D.div({className:"content-link-sync-modal__icon"},this._renderTopPanelIcon()),D.div({className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},D.h3({className:"u-font-strong"},this._renderTopPanelTitle()),D.h4({className:"u-trim-margin u-font-meta"},this._renderTopPanelSubtitle())),D.div({className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},O(y,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)}))),D.div({className:"content-link-sync-modal__tip-panel"},this.props.targetFile?this._renderSharedFolderInfo():this._renderAccessText(),D.div({className:"content-link-sync-modal__tip-body"},this._renderTipBody())))},renderVariant:function(){var e,t,n;return n=this.props.usageRemaining>0?U(L("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have <span>%(remaining)s</span> of space left."),{strong:D.strong(),span:D.span({className:"content-link-sync-modal__alert"}),remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):U(L("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have no space left."),{strong:D.strong(),needed:this.props.usageNeeded}),t=null!=this.props.ownerName,D.div({className:"content-link-sync-modal--pro-variant__content u-mar-bottom-xs"},D.div({className:"content-link-sync-modal--pro-variant__close u-pad-xs u-font-right"},O(y,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)})),D.div({className:"content-link-sync-modal--pro-variant__container"},D.div({className:"content-link-sync-modal--pro-variant__left-container"},"V1"===this.props.expProSharingOverquotaModal?O(h,{src:q("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):"V2"===this.props.expProSharingOverquotaModal?D.div({className:"content-link-sync-modal--pro-variant__folder-container"},O(h,{src:q("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}),t?D.div({className:"avatar-img"},O(o,{dimension:M.MEDIUM,photoUrl:this.props.ownerProfilePhotoUrl,shape:"CIRCLE",defaultAvatar:O(i,{dimension:M.MEDIUM})})):void 0):"V3"===this.props.expProSharingOverquotaModal?O(h,{src:q("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")}):"V4"===this.props.expProSharingOverquotaModal?O(h,{src:q("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):void 0,D.div({className:"content-link-sync-modal--pro-variant__content"},D.div({className:"content-link-sync-modal--pro-variant__folder-name"},l.em_snippet(this.props.folderName,g.OUT_OF_QUOTA_FOLDER_NAME)),"V1"!==(e=this.props.expProSharingOverquotaModal)&&"V2"!==e&&"V3"!==e||!t?void 0:D.div({className:"content-link-sync-modal--pro-variant__owner-name"},l.em_snippet(this.props.ownerName,g.DISPLAY_NAME)))),D.div({className:"content-link-sync-modal--pro-variant__right-container"},D.div({className:"content-link-sync-modal--pro-variant__tip-title"},L("Not enough space")),D.div({className:"content-link-sync-modal--pro-variant__tip-body"},n))))},renderButtons:function(){return this.props.canRequestToJoin&&this.props.outOfQuotaQP?this.state.ownerTeam?D.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},this.props.outOfQuotaQP?D.div({},O(R,{importance:"primary",className:"content-link-sync-modal__request-to-join-button",disabled:this.state.state===this.ASKING,onClick:this.onRequestButtonClicked},L(this.state.ownerTeam.is_limited?"Join the team":"Request to join")),O(R,{importance:"tertiary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},L("Upgrade to add folder")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0):void 0):D.div({}):D.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},O(R,{importance:"primary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},L(this.props.outOfQuotaQP?"Upgrade to add folder":this.props.targetFile?"Add folder to Dropbox":"Add to Dropbox")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0)},renderButtonsVariant:function(){return D.div({className:"content-link-sync-modal--pro-variant__buttons"},O(R,{importance:"primary",className:"content-link-sync-modal--pro-variant__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onUpgradeButtonClicked},L("Upgrade to add folder")))},requestCallback:function(){return this.props.outOfQuotaQP?C.redirect(T({path:"/pro/buy"}).updateQuery({oqa:this.props.outOfQuotaQP})):(this.props.targetFile&&F.log(this.userId,"UNMOUNTED_SEARCH_SYNC","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.onMountSharedFolder())},onSyncButtonClicked:function(){return this.setState({state:this.ASKING}),!this.props.outOfQuotaQP&&this.props.canRequestToJoin?this.activateRequestModal():this.requestCallback()},onPreviewButtonClicked:function(){var e;return null!=this.props.previewCallback?(F.log(this.userId,"UNMOUNTED_SEARCH_PREVIEW","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.previewCallback()):(e=null!=this.props.previewUrl?T.parse(this.props.previewUrl):C.get_uri().removeQuery("sm"),e.updateQuery({from_sync_modal:!0}),C.redirect(e))},onRequestButtonClicked:function(){return this.setState({state:this.ASKING}),N(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){return t.sendTeamRequest(e.state.ownerTeam.id,function(){return A.close()})}})(this))},activateRequestModal:function(){if(this.props.canRequestToJoin)return N(["modules/clean/teams/membership_request_modal"],(function(e){return function(t){var n;return n=t.MembershipRequestModal,A.showInstance(O(n,{senderName:e.props.senderName,team:e.state.ownerTeam,folderName:l.em_snippet(e.props.folderName,15),requestCallback:e.requestCallback}))}})(this))},componentDidMount:function(){if(this.props.canRequestToJoin)return N(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){var n;return n=t.getDiscoverableTeamForFolder,e.setState({state:e.ASKING}),n(e.props.syncNSId,function(t){return e.setState({state:e.ASK,ownerTeam:t})})}})(this))}})}),define("modules/clean/sharing/shared_content_link_sync_utils",["external/react","modules/clean/ajax","modules/clean/api_v2/root_aware_client","modules/clean/browse_interface","modules/clean/multiaccount_login","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/role_selector_modal","modules/clean/sharing/shared_content_link_sync_modal","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h){var m,_,f,g,y,b,assert;return y=t.WebRequest,_=n.ApiV2RootAwareClient,f=o.FolderShareApiClient,m=i.ACCESS_LEVEL,assert=p.assert,b=u.i18n_default_project("sharing")._,g={mountSharedFolder:function(e,t,n,o,i,l){var p,u,m,_,v,S;if(null==o&&(o=!1),null==i&&(i=null),null==l&&(l=!1),t){if(!d.get_viewer().is_role_signed_in(t))return void r.show_modal({role:t,on_success:function(){return g.mountSharedFolder(e,t,n)}})}else if(d.get_viewer().is_paired)return u=function(t){return n="PREVIEW_PAGE",g.mountSharedFolder(e,t,n)},void new a(u).show();return S=d.get_viewer(),t?v=S.get_uid_by_role(t):(assert(!S.is_paired,"role can not be unspecified for paired viewer"),v=S.get_user_ids()[0]),m=b("Adding to your Dropbox..."),S.is_paired&&(S.get_user_by_id(v).is_team?(m=b("Adding to your %(team_name)s Dropbox..."),m=m.format({team_name:S.team_name})):m=b("Adding to your personal Dropbox...")),h.success(m),_=function(e){var t,n,r;return n=e,null!=i&&(n+=i.ns_path),t=d.get_viewer().get_user_by_id(v),r=s.browse_uri_for_fq_path(t,n),r.updateQuery({from_scl_sync_modal:o}),c.redirect(r)},l?y({url:"/share_action/rejoin",subject_user:v,data:{ns_id:e},success:_,error:function(){return h.error(b("We were unable to complete your request."))}}):(p=new f({userId:v}),p.mount({contentId:e,origin:n}).then(function(e){return _(e.path_lower)}).catch(function(e){return h.error(b("We were unable to complete your request."))}))},showSharedContentSyncModal:function(t,n){var s,r,o,i;if(null!=t?t.sync_ns_id:void 0)return s=!1,t.can_request_to_join&&(s=t.can_request_to_join),o="SYNC_MODAL",i=t.sync_owner_name||t.ownerName,r=g.mountSharedFolder.bind(null,t.sync_ns_id,t.sync_role,o,!0,n),l.showInstance(e.createElement(l,{accessLevel:t.access_level,canRequestToJoin:s,folderName:t.sync_folder_name,folderSize:t.sync_folder_size,outOfQuotaQP:t.sync_out_of_quota_qp,usageRemaining:t.sync_usage_remaining,usageNeeded:t.sync_usage_needed,senderName:t.sync_sender_name,ownerName:i,targetFile:n,previewCallback:null!=n?c.redirect.bind(c,t.sync_preview_url):void 0,previewUrl:t.sync_preview_url,onMountSharedFolder:r,syncNSId:t.sync_ns_id,expProSharingOverquotaModal:t.expProSharingOverquotaModal,ownerProfilePhotoUrl:t.ownerProfilePhotoUrl}))},proSharingOverquotaModalExperiment:function(e,t,n,s){var r,o;return t.expProSharingOverquotaModal=s,"V1"===s||"V2"===s||"V3"===s?(r=new f({userId:n,client:new _}),o=t.nsId||t.sync_ns_id,r.listMembers({contentId:o}).then(function(e){var n,s,r,o,i;if(s=e.users.filter(function(e){return e.access_type===m.OWNER}),1===(null!=s?s.size:void 0))return r=s.entries().next().value,r[0],n=r[1],t.ownerName=null!=n&&null!=(o=n.account)?o.display_name:void 0,t.ownerProfilePhotoUrl=null!=n&&null!=(i=n.account)?i.profile_photo_url:void 0}).finally(function(){return e(t)})):e(t)}}}),define("modules/clean/sharing/sharing_settings_constants",["require","exports"],function(e,t){"use strict";t.MEMBER_POLICY="member_policy",t.ACL_UPDATE_POLICY="acl_update_policy",t.DOWNLOAD_POLICY="download_policy",t.PASS_POLICY="pass_policy",t.AUDIENCE_POLICY="audience",t.ACCESS_LEVEL_POLICY="access_level",t.FOLDER_LINK_AUDIENCE_POLICY="shared_link_policy",t.PASSWORD_POLICY="password",t.EXPIRY_POLICY="expiry",t.DROPDOWN="dropdown",t.TOGGLE="toggle",t.PASSWORD_INPUT="password_input",t.EXPIRY_INPUT="expiry_input",t.FILE_SETTINGS="file_settings",t.FOLDER_SETTINGS="folder_settings",t.LINK_SETTINGS="link_settings"}),
define("modules/clean/sharing/sharing_settings_dropdown",["require","exports","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite"],function(e,t,n,s,r){"use strict";function o(e){var t=e.customButton||n.createElement("button",{className:"c-btn c-btn--secondary sharing-settings-dropdown__button"},n.createElement("span",{className:"sharing-settings-dropdown__button-label"},e.optionsDict[e.currentValue].label),n.createElement(r,{alt:"",className:"u-l-fr",group:"web",name:"arrow-down-gray"})),o=e.valuesList.map(function(t){var o=n.createElement("span",null);return t===e.currentValue&&(o=n.createElement(r,{alt:"",group:"web",name:"check_gray"})),n.createElement(s.BubbleMenuItem,{checked:t===e.currentValue,key:t,onClick:function(){return e.onValueSelected(t)}},n.createElement("div",{className:"sharing-settings-dropdown-item"},n.createElement("div",{className:"sharing-settings-dropdown-item__left-margin"},o),n.createElement("div",{className:"sharing-settings-dropdown-item__label"},n.createElement("div",{className:"sharing-settings-dropdown-item__title"},e.optionsDict[t].label),n.createElement("div",{className:"sharing-settings-dropdown-item__description u-font-meta"},e.optionsDict[t].description))))});return n.createElement(s.BubbleMenu,{targetButton:t,targetFixed:!0,position:e.openUp?s.BubbleMenu.POSITIONS.TOP_ALIGN_RIGHT:s.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-settings-dropdown",items:o,shouldShowArrow:!1})}t.SettingDropdown=o}),define("modules/clean/sharing/sharing_settings_modal",["require","exports","tslib","external/classnames","external/react","external/underscore","modules/clean/datetime","modules/clean/em_string","modules/clean/previews/util","modules/clean/react/calendar","modules/clean/react_format","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/tabs/tab_nav","modules/clean/react/tabs/tab_util","modules/clean/sharing/components/button_group","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/ui_util","modules/clean/previews/util","modules/constants/python","modules/core/i18n","modules/clean/sharing/api/types/metadata","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_util"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T){"use strict";var N=w.i18n_default_project("sharing")._,M=r.createElement,k=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleTogglePasswordPolicy=function(e){n.props.onOptionChange(P.PASSWORD_POLICY,{status:e}),n.setState({passwordInputDisabled:"on"===n.props.currentPolicy.get(P.PASSWORD_POLICY).status})},n.handleChangePasswordClick=function(){n.setState({passwordInputDisabled:!1}),n.props.onOptionChange(P.PASSWORD_POLICY,{status:"on",value:""})},n.state={passwordInputDisabled:!0},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=o.extend({},this.props);return t=o.extend(t,{currentTab:this.state.currentTab,onChangePasswordClick:this.handleChangePasswordClick,onTabSelected:function(t){e.setState({currentTab:t})},onTogglePasswordPolicy:this.handleTogglePasswordPolicy,passwordInputDisabled:this.state.passwordInputDisabled}),M(F,t)},t})(r.Component);t.SharingSettingsModal=k;var A=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDefaultProps=function(){return{hasDisplayableMembers:!1,hasNonOwnerMembers:!1}},t.prototype.render=function(){var e;return e=this.props.isLoading?r.createElement("div",{className:"sharing-settings-modal__loading-text"},N("Loading...")):r.createElement("div",{className:"sharing-settings-modal"},this.renderHeader(),this.renderTabs(),this.renderTabContent(),r.createElement("div",{className:"sharing-settings-modal__footer"},this.renderButtons())),r.createElement(u.Modal,{altAction:this.props.altAction,style:"bare"},e)},t.prototype.renderHeader=function(){var e,t={folder_name:a.em_snippet(this.props.folderName,y.SNIPPET_SIZES.FILENAME)};return e=N("Sharing settings for “%(folder_name)s”").format(t),r.createElement("div",{className:"sharing-settings-modal__header"},r.createElement("div",{className:"sharing-settings-modal__title-row"},r.createElement("div",{className:"u-l-fr"},r.createElement(g,{onClick:function(){return u.Modal.close()}})),r.createElement("div",{className:"u-l-b"},e)))},t.prototype.renderTabs=function(){return r.createElement(m,{tabs:this.getTabs(),onChange:this.props.onTabSelected,defaultSelectedIndex:0,variant:_.variants.UNDERLINE})},t.prototype.getTabs=function(){var e=this,t={value:P.FILE_SETTINGS,label:N("File settings")},n={value:P.FOLDER_SETTINGS,label:N("Folder settings")},s={value:P.LINK_SETTINGS,label:N("Link settings")},r=this.props.isFolder?[n]:[t];return!this.props.isTeamSharedFolder&&this.props.linkMetadata&&r.push(s),r.filter(function(t){return e.getTabInfo(t.value).policies.length>0})},t.prototype.getCurrentTab=function(){return this.props.currentTab||this.getTabs()[0].value},t.prototype.renderTabContent=function(){var e=this,t=this.getTabInfo(this.getCurrentTab()),n=r.createElement("div",null);return t.bannerContent&&(n=r.createElement("div",{className:"sharing-settings-modal__banner u-font-center"},t.bannerContent)),r.createElement("div",null,n,r.createElement("div",{className:"sharing-settings-modal__tab-content"},r.createElement("div",{className:"tab-content-header"},r.createElement("div",{className:"tab-content-header__title"},t.title),r.createElement("div",{className:"tab-content-header__description u-font-meta"},t.description)),r.createElement("div",null,t.policies.map(function(t){var n=e.getPolicyDict(t);return e.renderPolicy(t,n)}))))},t.prototype.getLinkSettingsBannerContent=function(){return this.props.linkMetadata.link_permissions.some(function(e){return e.allow})?this.props.linkMetadata.link_permissions.set_password.reason===C.VisibilityDisallowedReason.user_account_type?this.props.user.is_team?r.createElement("a",{href:"/team/upgrade",target:"_blank"},N("Upgrade to %(trademark_business)s to enable expiration and password settings").format({trademark_business:I.TRADEMARK_BUSINESS})):r.createElement("a",{href:"/upgrade?oqa=sfp",target:"_blank"},N("Upgrade to Dropbox %(trademark_plus)s to enable expiration and password settings.").format({trademark_plus:I.TRADEMARK_PLUS})):void 0:N("You don’t have permission to modify these link settings")},t.prototype.getFolderSettingsBannerContent=function(){if(!this.props.shouldHideHeader&&this.props.isFolder){var e=N("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName});if(this.props.isInContentManager)return e;if(this.props.showContentManagerBridge){var t=v.genContentManagerBridgeUri(this.props.isLimitedTeam,this.props.folderPath);return r.createElement("div",null,e,r.createElement("div",null,N("You can change these settings in the Admin Console.")+" ",r.createElement("a",{href:t.toString(),target:"_blank"},N("Open in new tab."))))}return this.isTeamFolderTree()?r.createElement("div",null,e,r.createElement("div",null,r.createElement("a",{href:"/team",target:"_blank"},N("To edit, ask your admin.")))):this.props.permissions.change_options.allow?void 0:N("You don’t have permission to change the settings on this folder.")}},t.prototype.isTeamFolderTree=function(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree},t.prototype.getMemberPolicyQuestion=function(){return N(this.isTeamFolderTree()?"Who can be added to folders?":"Who can be invited to this folder?")},t.prototype.getAclUpdatePolicyQuestion=function(){return N(this.isTeamFolderTree()?"Who can manage access to folders?":"Who can manage access to this folder?")},t.prototype.getDownloadsPolicyDescription=function(){return N(this.isTeamFolderTree()?"Lets people download the folders. People with edit access can always download.":this.props.isFolder?"Lets people download this folder. People with edit access can always download.":"Lets people download this file. People with edit access can always download.")},t.prototype.getPassPolicyDescription=function(){return N(this.props.isFolder?"Shows who viewed the files.":"Shows who viewed the file.")},t.prototype.getFolderSettingPolicies=function(){var e=[];return Boolean(this.props.ownerTeam)&&(e.push(P.MEMBER_POLICY),e.push(P.FOLDER_LINK_AUDIENCE_POLICY)),e.push(P.ACL_UPDATE_POLICY),this.canChangePolicy(P.DOWNLOAD_POLICY)&&e.push(P.DOWNLOAD_POLICY),y.PASS_CONTROL_AVAILABILITY.SHOW_FOLDER_SETTINGS&&e.push(P.PASS_POLICY),e},t.prototype.getLinkSettingPolicies=function(){return S.is_user_no_comment_enabled(this.props.user)?[P.AUDIENCE_POLICY,P.ACCESS_LEVEL_POLICY,P.EXPIRY_POLICY,P.PASSWORD_POLICY]:[P.AUDIENCE_POLICY,P.EXPIRY_POLICY,P.PASSWORD_POLICY]},t.prototype.getFileSettingPolicies=function(){var e=[];this.canChangePolicy(P.DOWNLOAD_POLICY)&&e.push(P.DOWNLOAD_POLICY);var t=h.getPassPermissions(this.props.contentId),n=l.is_pass_ga_receive_enabled(this.props.user)&&null!=t&&h.getPassPermissions(this.props.contentId).canReadPresence;return(l.is_pass_enabled(this.props.user)||n)&&e.push(P.PASS_POLICY),e},t.prototype.canChangePolicy=function(e){return this.props.getEffectivePolicyValue(e,this.props.policyUpdate)[1]},t.prototype.getMemberPolicyTeamLabel=function(){return N("Only people at %(team_name)s").format({team_name:a.em_snippet(this.props.ownerTeam.name,8)})},t.prototype.getAclUpdatePolicyEditorsDescription=function(){return this.props.ownerTeam?N("Anyone at %(team_name)s with edit access can add new members and change link settings.").format({team_name:a.em_snippet(this.props.ownerTeam.name,12)}):N("Anyone with edit access can add new members and change link settings.")},t.prototype.getPolicyDict=function(e){var t=this;switch(e){case P.MEMBER_POLICY:return{title:N("Members"),description:this.getMemberPolicyQuestion(),optionsDict:{team:{label:this.getMemberPolicyTeamLabel()},anyone:{label:N("Anyone")}},optionsList:["team","anyone"],type:P.DROPDOWN};case P.ACL_UPDATE_POLICY:return{title:N("Management"),description:this.getAclUpdatePolicyQuestion(),optionsDict:{owner:{label:N(this.isTeamFolderTree()?"Only Team Admins":"Only me"),description:N(this.isTeamFolderTree()?"Only Team Admins can add new members and change link settings.":"Only you (the owner) can add new members and change link settings.")},editors:{label:N("Anyone with edit access"),description:this.getAclUpdatePolicyEditorsDescription()}},optionsList:["owner","editors"],type:P.DROPDOWN};case P.DOWNLOAD_POLICY:return{title:N("Downloads"),description:this.getDownloadsPolicyDescription(),optionsDict:{allow:{label:N("On")},disallow:{label:N("Off")}},optionsList:["allow","disallow"],type:P.TOGGLE};case P.PASS_POLICY:return{title:N("Viewer info"),description:this.getPassPolicyDescription(),optionsDict:{enabled:{label:N("On")},disabled:{label:N("Off")}},optionsList:["enabled","disabled"],type:P.TOGGLE};case P.AUDIENCE_POLICY:return{title:N("Link access"),description:N("Who can open the shared link?"),optionsDict:T.getAudienceOptionsDict(this.props.isFolder,this.props.ownerTeam&&this.props.ownerTeam.name,this.props.hasNonOwnerMembers,this.props.hasDisplayableMembers),optionsList:this.props.linkMetadata.audience_options.valueSeq().toArray(),type:P.DROPDOWN,extras:function(e){return t.renderAudiencePolicyExtras(e)}};case P.ACCESS_LEVEL_POLICY:return{title:N("Link permission"),description:N("What can users with links do?"),optionsDict:{viewer:{label:N("Can comment"),description:N("Lets them view and comment, but not edit.")},viewer_no_comment:{label:N("Can view"),description:N("Lets them view only. They can’t see comments.")}},optionsList:["viewer","viewer_no_comment"],type:P.DROPDOWN};case P.FOLDER_LINK_AUDIENCE_POLICY:if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return{title:N("Link restrictions"),description:N("Limits who can access this folder via a link."),optionsDict:{anyone:{label:N("No restrictions"),description:N("Show all access options for links.")},team:{label:N("Team and invite-only"),description:N("Show “Only people at %(team_name)s” and “Only                               invited members.”").format({team_name:a.em_snippet(this.props.ownerTeam.name,12)})},members:{label:N("Invite-only"),description:N("Show “Only invited members” only.")}},optionsList:["anyone","team","members"],type:P.DROPDOWN};case P.PASSWORD_POLICY:return{title:N("Password protection"),description:N("Add a password to the shared link"),optionsDict:{on:{label:N("On")},off:{label:N("Off")}},optionsList:["on","off"],type:P.PASSWORD_INPUT};case P.EXPIRY_POLICY:return{title:N("Expiration"),description:N("Disables the shared link on a specific date"),optionsDict:{on:{label:N("On")},off:{label:N("Off")}},optionsList:["on","off"],type:P.EXPIRY_INPUT};default:throw new Error("Policy name not found")}},t.prototype.getFolderSettingsDescription=function(){return N(this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(P.ACL_UPDATE_POLICY)?"Only you (the owner) can change these settings":"Only the owner can change these settings")},t.prototype.getLinkSettingsDescription=function(){return N("owner"===this.props.currentPolicy.get(P.ACL_UPDATE_POLICY)?this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(P.AUDIENCE_POLICY)?"Only you (the owner) can change these settings":"Only the owner can change these settings":"Only editors can change these settings")},t.prototype.getTabInfo=function(e){switch(e){case P.FILE_SETTINGS:return{title:N("File settings"),bannerContent:void 0,description:"",policies:this.getFileSettingPolicies()};case P.FOLDER_SETTINGS:return{title:N("Folder settings"),bannerContent:this.getFolderSettingsBannerContent(),description:this.getFolderSettingsDescription(),policies:this.getFolderSettingPolicies()};case P.LINK_SETTINGS:return{title:N("Link settings"),bannerContent:this.getLinkSettingsBannerContent(),description:this.getLinkSettingsDescription(),policies:this.getLinkSettingPolicies()};default:throw new Error("tabName not found")}},t.prototype.renderPolicy=function(e,t){var n,o,i=this,a=t.title,l=t.description,d=t.optionsDict,c=t.optionsList,p=t.type,u=t.extras,h=void 0===u?null:u;g=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),n=g[0],o=g[1];var m;if(p===P.DROPDOWN)m=r.createElement(E.SettingDropdown,{currentValue:n,valuesList:c,optionsDict:d,onValueSelected:function(t){return i.props.onOptionChange(e,t)}});else if(p===P.TOGGLE)m=r.createElement(f.ButtonGroup,{options:this.getButtonGroupOptions(c,d),value:n,onSelectValue:function(t){return i.props.onOptionChange(e,t)}});else if(p===P.PASSWORD_INPUT)m=this.renderPasswordInput(e,n,d,c);else{if(p!==P.EXPIRY_INPUT)throw new Error("Selector type not found");m=this.renderExpiryInput(e,n,d,c)}var _=r.createElement("div",null);return h&&(_=h(n)),r.createElement("div",{className:s({policy:!0,"policy--no-permissions":!o})},r.createElement("div",{className:"policy__left"},r.createElement("div",{className:"policy__title"},a),r.createElement("div",{className:"policy__description u-font-meta"},l)),r.createElement("div",{className:"policy__selector"},m),r.createElement("div",{className:"policy__extras"},_));var g},t.prototype.renderAudiencePolicyExtras=function(e){var t=this.props.linkMetadata,n=r.createElement("div",null);if(t.audience_restricting_shared_folder&&t.audience_restricting_shared_folder.audience===e){var s=void 0,o=t.audience_restricting_shared_folder.name;s=1===t.audience_options.size?c.reactFormat(N("This setting is applied via a parent folder.              To change access, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:r.createElement("strong",null)}):c.reactFormat(N("This setting is limited via a parent folder.              To see more options, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:r.createElement("strong",null)}),n=r.createElement("div",{className:"policy__graybox"},s)}else this.props.isFolder&&e!==C.LinkAudience.members&&(n=r.createElement("div",{className:"policy__audience-extras"},N("Applies to all items in this folder")));return n},t.prototype.renderPasswordInput=function(e,t,n,s){var o=this,i=t,a=r.createElement("div",null);if("on"===i.status){var l=r.createElement("div",null);this.props.passwordInputDisabled&&this.props.linkMetadata.link_permissions.set_password.allow&&(l=r.createElement("button",{className:"password-input__change-button button-as-link",onClick:this.props.onChangePasswordClick},"Change")),a=r.createElement("div",{className:"password-input u-pad-top-s"},r.createElement("label",{htmlFor:"password-input"},"Password:"),r.createElement("br",null),r.createElement("input",{className:"c-input password-input__input",disabled:this.props.passwordInputDisabled,onChange:function(t){o.props.onOptionChange(e,{status:"on",value:t.target.value})},id:"password-input",placeholder:N("Enter a new password"),value:this.props.passwordInputDisabled?123456:i.value||"",type:"password"}),l)}return r.createElement("div",null,r.createElement(f.ButtonGroup,{options:this.getButtonGroupOptions(s,n),value:i.status,onSelectValue:this.props.onTogglePasswordPolicy}),a)},t.prototype.renderExpiryInput=function(e,t,n,s){var o=this,a=t,l=r.createElement("div",null),c=i.daysAfterToday(30);return"on"===a.status&&(l=r.createElement("div",{className:"u-pad-top-s"},r.createElement("div",null,N("Link deactivates on:")),r.createElement(d.Calendar,{alignAtLeft:!1,disabled:!this.props.linkMetadata.link_permissions.set_expiry.allow,firstDay:i.daysAfterToday(1),initDate:a.value?new Date(a.value):c,lastDay:i.daysAfterToday(365),onDateChange:function(t){return o.props.onOptionChange(e,{status:"on",value:t})}}))),r.createElement("div",null,r.createElement(f.ButtonGroup,{options:this.getButtonGroupOptions(s,n),value:a.status,onSelectValue:function(t){o.props.onOptionChange(e,{status:t,value:a.value||c})}}),l)},t.prototype.getButtonGroupOptions=function(e,t){return e.map(function(e){return{value:e,label:t[e].label}})},t.prototype.allowSaveSettings=function(){return!(!this.props.policyUpdate||0===o.keys(this.props.policyUpdate).length)&&!(this.props.policyUpdate.password&&"on"===this.props.policyUpdate.password.status&&!this.props.passwordInputDisabled&&(!this.props.policyUpdate.password.value||""===this.props.policyUpdate.password.value))},t.prototype.renderButtons=function(){var e;if(this.props.permissions.unshare.allow&&(this.props.isSharedFolder||!this.props.isFolder)){var t=void 0;t=N(this.props.isFolder?this.props.isFolderInsideTeamFolderTree?"Reset membership":"Unshare folder":"Unshare file"),e=r.createElement("div",{className:"u-l-fl"},r.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},t))}return r.createElement("div",{className:"clearfix sharing-settings-modal__buttons"},e,r.createElement(b.SettingsModalButtons,{disableSave:!this.allowSaveSettings(),isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss}))},t})(r.Component);t.SharingSettingsModalContentsView=A;var F=p(A,["/static/css/sharing/share_modal-vflEotmBn.css"])}),define("modules/clean/sharing/sharing_settings_util",["require","exports","modules/clean/em_string","modules/clean/sharing/sharing_settings_constants","modules/core/i18n"],function(e,t,n,s,r){"use strict";var o=r.i18n_default_project("sharing")._;t.canChangePolicy=function(e,t,n,r,o,i){switch(e){case s.AUDIENCE_POLICY:return r&&r.link_permissions.change_audience.allow&&r.audience_options.size>1;case s.PASSWORD_POLICY:return r&&"members"!==n.get(s.AUDIENCE_POLICY)&&(r.link_permissions.set_password.allow||r.link_permissions.remove_password.allow&&"off"!==t.get(s.PASSWORD_POLICY).status);case s.EXPIRY_POLICY:return r&&"members"!==n.get(s.AUDIENCE_POLICY)&&(r.link_permissions.set_expiry.allow||r.link_permissions.remove_expiry.allow&&"off"!==t.get(s.EXPIRY_POLICY).status);case s.DOWNLOAD_POLICY:return!(!o||i)&&("allow"===t.get(s.DOWNLOAD_POLICY)?o.set_download_policy&&o.set_download_policy.allow:o.remove_download_policy&&o.remove_download_policy.allow);case s.PASS_POLICY:return!(!o||i)&&("enabled"===t.get(s.PASS_POLICY)?o.disable_pass&&o.disable_pass.allow:o.enable_pass&&o.enable_pass.allow);default:throw new Error("Link policy not found")}},t.isCommonSharingSettingsPolicy=function(e){return[s.AUDIENCE_POLICY,s.DOWNLOAD_POLICY,s.EXPIRY_POLICY,s.PASS_POLICY,s.PASSWORD_POLICY].indexOf(e)!==-1},t.getAudienceOptionsDict=function(e,t,s,r){var i=r&&!s;return{public:{label:o("Anyone with the link"),description:o(e?"Anyone who has the link can access this folder.":"Anyone who has the link can access this file.")},team:{label:o("Only people at %(team_name)s").format({team_name:n.em_snippet(t||"",8)}),description:o("Only people in your company can use the link.")},members:{label:o(i?"Only you":"Only invited members"),description:o(i?"Only you can use the link":"Only invited members can use the link.")}}}}),define("modules/clean/sharing/strings",["modules/clean/sharing/constants","modules/core/i18n"],function(e,t){var n,s,r,o,i,a,l,d,c,p,u,h,m,_,f;return n=e.ACCESS_LEVEL,o=e.MEMBER_ACTION,c=t.i18n_default_project("sharing")._,p={},p[""+n.OWNER]=c("Owner"),p[""+n.WRITER]=c("Can edit"),p[""+n.READER]=c("Can view"),p[""+n.READER_NO_COMMENT]=c("View-only"),s=p,u={},u[""+n.OWNER]=c("Owner"),u[""+n.WRITER]=c("Can edit"),u[""+n.READER]=c("Can comment"),u[""+n.READER_NO_COMMENT]=c("Can view"),r=u,h={},h[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the file to their Dropbox"),h[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),h[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the files"),l=h,m={},m[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the files to their Dropbox"),m[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),m[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the file"),i=m,_={},_[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),_[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),_[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),d=_,f={},f[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),f[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),f[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),a=f,{ACCESS_NAME:s,ACCESS_NAME_NO_COMMENT:r,MEMBER_ACTION_FOLDER:l,MEMBER_ACTION_FILE:i,MEMBER_ACTION_FOLDER_NO_COMMENT:d,MEMBER_ACTION_FILE_NO_COMMENT:a}}),define("modules/clean/sharing/views/comments_help",["external/classnames","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o,i){var a,l,d,c,p;return p=o.static_url,l=i._,d=t.createElement,c=t.DOM,a=t.createClass({displayName:"ShareModalCommentsHelp",mixins:[t.addons.PureRenderMixin],propTypes:{onClose:t.PropTypes.func.isRequired,onButtonClick:t.PropTypes.func.isRequired,isFeedbackRequest:t.PropTypes.bool},renderText:function(){return this.props.isFeedbackRequest?[c.h1({key:"heading"},l("Get feedback on your work")),c.p({key:"content"},l("This will ask recipients to leave comments on your file and post your message as a comment."))]:c.p({},l("New! You can now post your message as a comment on the file. Anyone who views this file can see this comment."))},render:function(){return c.div({className:e(["bubble-dropdown","right-bottom","u-font-center","u-pad-m","u-l-b","comments-help-dialog"])},c.div({className:"close-button u-font-right"},d(r,{onClick:this.props.onClose})),d(s,{src:p("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:p("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),this.renderText(),c.button({className:"c-btn c-btn--primary",onClick:this.props.onButtonClick},l("Try it out")),c.div({className:"bubble-arrow-border"}),c.div({className:"bubble-arrow"}))}}),a=n(a,["/static/css/components/bubble_dropdown-vflTPbDJ3.css"])}),define("modules/clean/sharing/views/exp_share_link_upsell",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/core/i18n","modules/clean/react_format","modules/clean/static_urls","modules/constants/python"],function(e,t,n,s,r,o,i,a,l,d){"use strict";var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return s.createElement("div",{className:"share-link-upgrade__content"},s.createElement(o,{className:"unified-share-modal__illo",src:l.static_url("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:l.static_url("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),s.createElement("div",{className:"share-link-upgrade__footer"},s.createElement("div",{className:"share-link-upgrade__footer-content"},s.createElement("p",{className:"u-mar-top-s share-link-upgrade__copy"},a.reactFormat(i._("Get %(trademark_plus)s to add more shared content to your Dropbox."),{trademark_plus:d.TRADEMARK_PLUS})),s.createElement("a",{className:"c-btn c-btn--primary",href:"/pro/out-of-space?oqa=sf_sloq"},i._("Upgrade")))))},t})(s.Component);t.ExpShareLinkUpsellV1=r(c,["/static/css/sharing/exp_oq_shared_link_upsellV1-vflBUzAf2.css"]),t.ExpShareLinkUpsellV2=r(c,["/static/css/sharing/exp_oq_shared_link_upsellV2-vflFsqt8O.css"])}),define("modules/clean/sharing/views/member_list",["external/immutable","external/react","external/underscore","modules/clean/react/modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/content_info","modules/clean/sharing/views/member_list_item","modules/clean/sharing/views/modal_viewers_line","modules/clean/sharing/views/viewer_info","modules/clean/sharing/views/viewer_list_modal","modules/clean/sharing/ui_util","modules/clean/user","modules/clean/viewer","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m){var _,f,g,y,b,v,S,I,w,C,E,P,T;return g=s.Modal,v=o.SharingMembership,_=i.ContentInfo,b=a.SharingMemberListItem,y=l.ModalViewersLine,S=d.ViewerInfo,I=c.ViewerListModal,f=p.GoldenGate,P=p.logTiburonEvent,T=p.makeMemberSortCmp,w=m.i18n_default_project("sharing")._,C=t.createElement,E=t.DOM,t.createClass({displayName:"SharingMemberList",propTypes:{actionHandler:t.PropTypes.instanceOf(r),areMembersFullyLoaded:t.PropTypes.bool,canInviteMembers:t.PropTypes.bool,canMakeViewerNoComment:t.PropTypes.bool,canRelinquishMembership:t.PropTypes.bool,canUpdateConfidentiality:t.PropTypes.bool,contentInfo:t.PropTypes.instanceOf(_).isRequired,disabled:t.PropTypes.bool,groupSeenStateInfo:t.PropTypes.object,membership:t.PropTypes.instanceOf(v).isRequired,onSetConfidentialClick:t.PropTypes.func,pendingMemberAction:t.PropTypes.instanceOf(e.Set).isRequired,presentAccountIds:t.PropTypes.instanceOf(e.Set),shouldShowPassUI:t.PropTypes.bool,user:t.PropTypes.instanceOf(u).isRequired},getDefaultProps:function(){return{disabled:!1,groupSeenStateInfo:{},presentAccountIds:new e.Set}},render:function(){var e,t,n,s,r,o;return n=T(this.props.user,this.props.presentAccountIds,this.props.shouldShowPassUI),s=this._membersByInheritance(),e=null!=(r=s.get(!1))?r.sort(n):void 0,t=null!=(o=s.get(!0))?o.sort(n):void 0,E.div({className:"sharing-member-list"},(null!=e?e.count():void 0)>0?E.ul({className:"o-list-ui u-trim-margin u-pad-horizontal-m"},e.map(this._renderMembersListItem).toArray()):void 0,(null!=t?t.count():void 0)>0?[E.h5({className:"sharing-member-list__inherited-separator u-pad-vertical-xs u-pad-horizontal-s u-font-meta u-font-strong",key:"separator"},[w("Can access via parent folders"),this.props.canUpdateConfidentiality?E.button({className:"button-as-link u-l-fr",onClick:this.props.onSetConfidentialClick},w("Manage access")):void 0]),E.ul({className:"o-list-ui u-trim-margin u-pad-horizontal-m u-pad-top-xs",key:"inherited-members"},t.map(this._renderMembersListItem).toArray())]:void 0,this.props.areMembersFullyLoaded?void 0:E.div({className:"sharing-member-list__loading c-loader u-mar-horizontal-auto u-l-b"},w("Loading more members...")))},_renderMembersListItem:function(e){var t,n;return n=e.memberKey(),t=e.memberId()in this.props.groupSeenStateInfo?this._renderGroupViewersLine(e):null,C(b,{actionHandler:this.props.actionHandler,canInviteMembers:this.props.canInviteMembers,canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,contentInfo:this.props.contentInfo,disabled:this.props.disabled,groupViewersLine:t,hasGroupSeenStateInfo:null!=t,isMemberActionPending:this.props.pendingMemberAction.has(n),isPresent:this.props.shouldShowPassUI&&this._isMemberCurrentlyViewing(e),key:n,member:e,user:this.props.user})},_isMemberCurrentlyViewing:function(e){return!this._memberIsAssumed(e)&&this.props.presentAccountIds.has(e.account_id)},_memberIsAssumed:function(e){return e.account_id===this.props.user.account_id&&h.get_viewer().is_assume_user_session},_membersByInheritance:function(){return null==this.props.membership?e.Map():this.props.membership.groups.valueSeq().concat(this.props.membership.invitees.valueSeq()).concat(this.props.membership.users.valueSeq()).groupBy((function(e){return function(t){return e._shouldSortByInherited()&&t.is_inherited}})(this))},_shouldSortByInherited:function(){return f.canSetFolderConfidential(this.props.user.id)||!f.canActOnInheritedMembers(this.props.user.id)},_renderGroupViewersLine:function(e){var t,n;return t=this.props.groupSeenStateInfo[e.memberId()],n=t.map(function(e){return new S(e)}).filter((function(e){return function(t){return null!=t.time_last_seen||e.props.presentAccountIds.has(t.account_id)}})(this)),0===n.length?null:E.span({className:"sharing-member-info__group-seen-state",onClick:(function(n){return function(){return g.showInstance(C(I,{contentInfo:n.props.contentInfo,groupName:e.displayName(),onCancel:n.props.actionHandler.openShareModal,presentAccountIds:n.props.presentAccountIds,seenStateInfo:t,user:n.props.user})),P(n.props.contentInfo,n.props.user.id,"OPEN_GROUP_VIEWER_LIST_MODAL",{group_id:e.memberId()})}})(this)},C(y,{currentUserAccountId:this.props.user.account_id,presentAccountIds:this.props.presentAccountIds,viewers:n}))}})}),define("modules/clean/sharing/views/member_list_item",["external/classnames","external/react","external/underscore","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/datetime","modules/clean/em_string","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/sharing/views/viewer_info","modules/clean/static_urls","modules/clean/user","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g){var y,b,v,S,I,w,C,E,P,T,N,M,k,A,F,x,L,R,O,D;return b=o.AVATAR_DIMENSION_BY_SIZE,F=i.ago,w=d.GroupMembershipInfo,I=d.GroupManagementType,C=d.InviteeMembershipInfo,d.MemberPermissions,E=d.PermissionSetting,M=d.UserMembershipInfo,y=c.ACCESS_VALUES,P=c.SNIPPET_SIZES,v=p.ContentInfo,T=u.SharingBubbleMenu,k=h.ViewerInfo,O=m.static_url,R=f.i18n_default_project("sharing"),A=R._,D=R.ungettext,x=t.createElement,L=t.DOM,S={FIRST_LINE:"FIRST_LINE",SECOND_LINE:"SECOND_LINE"},N=t.createClass({displayName:"SharingMemberListItem",propTypes:{actionHandler:t.PropTypes.instanceOf(l),canInviteMembers:t.PropTypes.bool,canMakeViewerNoComment:t.PropTypes.bool,canRelinquishMembership:t.PropTypes.bool,disabled:t.PropTypes.bool,isMemberActionPending:t.PropTypes.bool,isPresent:t.PropTypes.bool,isViewOnly:t.PropTypes.bool,
member:t.PropTypes.oneOfType([t.PropTypes.instanceOf(w),t.PropTypes.instanceOf(C),t.PropTypes.instanceOf(M),t.PropTypes.instanceOf(k)]).isRequired,contentInfo:t.PropTypes.instanceOf(v).isRequired,groupViewersLine:t.PropTypes.element,onMemberAccessChange:t.PropTypes.func,pendingAccessChange:t.PropTypes.oneOf(y),user:t.PropTypes.instanceOf(_).isRequired},getDefaultProps:function(){return{canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,disabled:!1,isPendingRemoval:!1,isPresent:!1,isViewOnly:!1,groupViewersLine:null,onMemberAccessChange:null}},_shouldLinkMemberName:function(e){return"group"===e&&this.props.member.same_team&&(this.props.user.is_team_admin||this.props.member.is_member&&this.props.member.group_management_type!==I.system_managed)},render:function(){var t,n,o,i,l,d,c,p,u,h,m,_,f,y,v,I,C,N,R,U,q,B;if(_=null,this.props.member instanceof M){if(B=this.props.member.account,y="user",null==B)return null;C=B.profile_photo_url,_=this.props.member.time_last_seen}else this.props.member instanceof w?(B=null,y="group",C="team"===this.props.member.group_type?O("/static/images/icons/team_24@2x-vflR8kGKs.png"):void 0):this.props.member instanceof k?(B={email:this.props.member.email,email_verified:null!=this.props.member.email},y="user",C=this.props.member.photo_circle_url,_=this.props.member.time_last_seen):(B=null,y="invitee");return R=this.props.isPresent?A("Currently viewing"):_?A("Viewed %(time_str)s").format({time_str:F(_,!1)}):"",n=(null!=B?B.disabled:void 0)?A("Deleted"):"",p="group"===y&&this.props.member.member_count?D("%(member_num)s member","%(member_num)s members",this.props.member.member_count).format({member_num:this.props.member.member_count}):"",h=p?null!=this.props.groupViewersLine?S.FIRST_LINE:S.SECOND_LINE:null,v=n||R||!this.props.user.is_team||this.props.member.same_team?"":A("Outside of your Dropbox team"),i=this.props.member.displayName(),m=this.props.member.initials||g.getInitials(i),q="group"===y?"SQUARE":"CIRCLE",L.li({className:"sharing-member-list__item o-flag"},L.div({className:"o-flag__flex"},L.div({className:e(["sharing-member-info","o-flag",this.props.isViewOnly?null:"u-pad-right-m"])},L.div({className:"o-flag__fix"},x(s,{dimension:b.MEDIUM,photoUrl:C,shape:q,defaultAvatar:x(r,{dimension:b.MEDIUM,shape:q,initials:m,name:i})})),L.div({className:"sharing-member-info__contact o-flag__flex"},L.div({className:e([this.props.isMemberActionPending?"u-font-meta":null,"u-font-strong","u-ellip"])},i?(U=R?a("  ·  "+R).length:0,o=n?a("  ·  "+n).length:0,u=h===S.FIRST_LINE?a("  ·  "+p).length:0,I=v?a("  ·  "+v).length:0,l=P.DISPLAY_NAME-U-o-u-I,d=a.em_snippet(i,l),c=d!==i?i:null,this._shouldLinkMemberName(y)?L.a({href:"/team#groups/"+this.props.member.group_id,target:"_blank",className:"sharing-member-info__group-name-link sharing-member-info__display-name",title:c},d):L.span({className:"sharing-member-info__display-name",title:c},d)):void 0,n?[L.span({className:"u-font-meta dot"},"·"),L.span({className:"u-font-danger"},n)]:void 0,R?[L.span({className:"u-font-meta dot"},"·"),L.span({className:"u-font-meta sharing-member-info__last-seen-text"},R)]:void 0,h===S.FIRST_LINE?[L.span({className:"u-font-meta dot"},"·"),L.span({className:"u-font-meta sharing-member-info__group-count-text"},p)]:void 0,v?[L.span({className:"u-font-meta dot"},"·"),L.span({className:"u-font-meta"},v)]:void 0),L.div({className:"u-font-meta u-ellip sharing-member-info__details"},"group"===y?null!=this.props.groupViewersLine?this.props.groupViewersLine:h===S.SECOND_LINE?p:void 0:(null!=B?B.email:void 0)&&(null!=B?B.email_verified:void 0)?a.em_snippet(B.email,P.EMAIL):void 0)))),L.div({className:"o-flag__fix"},this.props.isMemberActionPending?L.img({src:O("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:A("Changing access")}):this.props.isViewOnly?L.span({}):(t=(null!=(N=this.props.member.permissions.get("make_viewer_no_comment"))?N.allow:void 0)&&this.props.canMakeViewerNoComment,f=this.props.member.permissions.set("make_viewer_no_comment",new E({allow:t})),x(T,{allowRelinquishMembership:this.props.member.memberId()===this.props.user.account_id&&this.props.canRelinquishMembership,canInviteMembers:this.props.canInviteMembers,canMakeViewerNoComment:t,contentInfo:this.props.contentInfo,currentAccess:this.props.member.access_type,disabled:this.props.disabled,isInherited:this.props.member.is_inherited,memberPermissions:f,onAccessChange:(function(e){return function(t){var n;return null!=(n=e.props.actionHandler)?n.handleMemberAccessChange(e.props.member,t):void 0}})(this),pendingAccessChange:this.props.pendingAccessChange}))))}}),{SharingMemberListItem:N}}),define("modules/clean/sharing/views/modal_content",["external/classnames","external/immutable","external/react","external/react-dom","external/underscore","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/contacts/util","modules/clean/em_string","modules/clean/growth/experiments/shared_folder_paywall_view","modules/clean/react/css","modules/clean/react/image","modules/clean/react/pass/constants","modules/clean/react/sprite","modules/clean/react/bubble","modules/clean/react/tooltip","modules/clean/react_format","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/comments_help","modules/clean/sharing/views/exp_share_link_upsell","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/views/member_list","modules/clean/sharing/views/modal_link_info","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/static_urls","modules/clean/user","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C,E,P,T,N,M,k,A){var F,x,L,R,O,D,U,q,B,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne,se,re,oe,ie,ae,le,de,ce,pe,ue,he,me,_e,fe,ge,ye;return U=o.ContactsTokenizer,u.PASS_FETCHING_STATUS,pe=u.fetchingStatusIsSuccessful,ce=u.fetchingStatusIsComplete,re=_.Tooltip,oe=_.TooltipPosition,he=f.reactFormat,V=y.FolderPolicy,K=y.LinkMetadata,j=y.MemberCounts,Q=y.MemberPermissions,J=y.PermissionSetting,ee=y.SharedContentLinkMetadata,ne=y.SharingMembership,F=b.ACCESS_VALUES,b.COMMENTING,Z=b.SNIPPET_SIZES,se=b.TRUELINK,q=v.ContentInfo,R=S.CONTACT_ERROR_LEVEL,ue=S.genContentManagerBridgeUri,G=S.GoldenGate,_e=S.shouldEnforceMemberLimits,ye=S.validateContact,Y=I.MODES,z=I.MODE_VALUES,x=I.BANNERS,L=I.BANNER_VALUES,O=I.CONTENT_NAME_MESSAGE_LEVELS,D=I.CONTENT_NAME_MESSAGE_LEVEL_VALUES,W=I.LINK_ONLY_REASON,B=C.ExpShareLinkUpsellV1,H=C.ExpShareLinkUpsellV2,X=T.ModalLinkInfo,te=N.SharingBubbleMenu,fe=M.static_url,le=n.createElement,de=n.DOM,me=A.i18n_default_project("sharing"),ie=me._,ge=me.ungettext,ae=n.createClass({displayName:"ShareModalContent",statics:{MODES:Y},propTypes:{actionHandler:n.PropTypes.instanceOf(g).isRequired,areMembersFullyLoaded:n.PropTypes.bool,banner:n.PropTypes.oneOf(L),canInviteEditor:n.PropTypes.bool.isRequired,canInviteViewer:n.PropTypes.bool.isRequired,canInviteViewerNoComment:n.PropTypes.bool.isRequired,canMakeViewerNoComment:n.PropTypes.bool.isRequired,canRelinquishMembership:n.PropTypes.bool,canShareLink:n.PropTypes.bool.isRequired,canUpdateConfidentiality:n.PropTypes.bool,contactsError:n.PropTypes.shape({level:n.PropTypes.string,message:n.PropTypes.oneOfType([n.PropTypes.string,n.PropTypes.array])}),contentInfo:n.PropTypes.instanceOf(q).isRequired,contentNameMessage:n.PropTypes.string,contentNameMessageLevel:n.PropTypes.oneOf(D),displayContentNameTooltip:n.PropTypes.bool,displayContentNameBanner:n.PropTypes.bool,folderPolicy:n.PropTypes.instanceOf(V),groupSeenStateInfo:n.PropTypes.object,hasDisplayableMembers:n.PropTypes.bool.isRequired,hasNonOwnerMembers:n.PropTypes.bool.isRequired,headerId:n.PropTypes.string,icon:n.PropTypes.string,initialRecipientRawInput:n.PropTypes.string,initialRecipientTokens:n.PropTypes.array,isAddMessageAsCommentChecked:n.PropTypes.bool,isAddMessageAsCommentHelpShown:n.PropTypes.bool,isConfidentialFolder:n.PropTypes.bool,isContentNameFocused:n.PropTypes.bool,isFolderInsideTeamFolderTree:n.PropTypes.bool,isInContentManager:n.PropTypes.bool,isLimitedTeam:n.PropTypes.bool,isLinkMetadataLoaded:n.PropTypes.bool.isRequired,isMetadataLoaded:n.PropTypes.bool.isRequired,isPassEnabled:n.PropTypes.bool,isTeamSharedFolder:n.PropTypes.bool,isTokenizerEmpty:n.PropTypes.bool.isRequired,linkMetadata:n.PropTypes.oneOfType([n.PropTypes.instanceOf(K),n.PropTypes.instanceOf(ee)]),linkOnlyReason:n.PropTypes.oneOf(r.values(W)),linkSeenStateInfo:n.PropTypes.array,memberCounts:n.PropTypes.instanceOf(j),memberCountWithRecipients:n.PropTypes.number,members:n.PropTypes.instanceOf(ne),mode:n.PropTypes.oneOf(z),name:n.PropTypes.string,onSettingsClick:n.PropTypes.func,onLinkViewersClick:n.PropTypes.func,onSetConfidentialClick:n.PropTypes.func,ownerTeam:n.PropTypes.shape({id:n.PropTypes.string.isRequired,name:n.PropTypes.string.isRequired}),passFetchingStatus:n.PropTypes.number,pendingMemberAction:n.PropTypes.instanceOf(t.Set).isRequired,presentAccountIds:n.PropTypes.instanceOf(t.Set),recipientAccess:n.PropTypes.oneOf(F).isRequired,recipientMessage:n.PropTypes.string.isRequired,recipientTokens:n.PropTypes.array,shareFolderPromise:n.PropTypes.instanceOf(Promise),sharingPaywallInfo:n.PropTypes.shape({foldersToUnshare:n.PropTypes.object,isFolderOwner:n.PropTypes.bool,isInExperiment:n.PropTypes.bool,maxOwned:n.PropTypes.number,numOwned:n.PropTypes.number,onLearnMoreClick:n.PropTypes.func,onManageSharedFoldersClick:n.PropTypes.func,onUpgradeClick:n.PropTypes.func}),shouldBlockMemberListOnPassLoad:n.PropTypes.bool,showContentManagerBridge:n.PropTypes.bool,showPassFileSettings:n.PropTypes.bool,suppressLinkUI:n.PropTypes.bool,teamGroupInfo:n.PropTypes.shape({id:n.PropTypes.string,name:n.PropTypes.string}),user:n.PropTypes.instanceOf(k).isRequired,expSubgrowthProOverquotaCreateSharedLink:n.PropTypes.string},getDefaultProps:function(){return{contactsError:{level:null,message:null},headerId:"unified-share-modal-title",linkMetadata:null,members:null,initialRecipientRawInput:"",initialRecipientTokens:[],isTeamSharedFolder:!1,mode:Y.MEMBERSHIP,onFolderSettingsClick:null,onLinkViewersClick:null}},componentDidMount:function(){if(this.logTTI(),this.refs.contentNameInput)return s.findDOMNode(this.refs.contentNameInput).focus()},componentDidUpdate:function(e,t){return this.logTTI()},logTTI:function(){return this.props.mode===Y.LINK_ONLY&&this.props.isLinkMetadataLoaded?this.props.actionHandler.logIfHaventBefore("VIEW_LINK_ONLY_MODAL"):this.props.isMetadataLoaded&&(this.props.actionHandler.logIfHaventBefore("VIEW_SHARE_MODAL"),!this._shouldRenderMainLoading())?this.props.actionHandler.logIfHaventBefore("MEMBER_LIST_LOADED",{member_count:this._getMemberNum()}):void 0},render:function(){return de.div({className:"unified-share-modal unified-share-modal--"+this.props.mode},this._renderHeaderSection(),this._renderToSection(),this._renderErrorMessageSection(),this._renderConfidentialFolderSection(),this._renderMainSection(),this._renderPaywallSection(),this._renderFooterSection())},_renderHeaderSection:function(){var t,n,s,r,o;return n=this._getMemberNum(),s=this.props.user.is_team&&(null!=(r=this.props.memberCounts)?r.users_outside_team:void 0)>0&&null!=this.props.ownerTeam?ge("%(outside_team_count)s outside your Dropbox team","%(outside_team_count)s outside your Dropbox team",this.props.memberCounts.users_outside_team).format({outside_team_count:this.props.memberCounts.users_outside_team}):void 0,t=n?s?ge("%(member_num)s member (%(outside_team_string)s)","%(member_num)s members (%(outside_team_string)s)",n,{comment:'Description of the count of total folder members and count of outside-of-team folder members, like "10 members (3 outside of your Dropbox team)"'}):ge("%(member_num)s member","%(member_num)s members",n):"",t=t.format({member_num:n+((null!=(o=this.props.memberCounts)?o.exceeds_count:void 0)?"+":""),outside_team_string:s}),de.div({className:"unified-share-modal__section"},de.div({className:"unified-share-modal__close u-l-fr o-flag__fix"},le(E,{className:"u-mar-left-s u-mar-top-xs",onClick:(function(e){return function(){return e.props.actionHandler.onClickX(e.refs.tokenizer)}})(this)})),de.div({className:"unified-share-modal__header o-flag"},de.span({className:"o-flag__fix"},le(h,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:this.props.icon})),de.div({className:e("unified-share-modal__title","o-flag__flex",n?"unified-share-modal__title--member-count":void 0)},this.props.contentInfo.pathExists()?de.h3({className:"u-font-strong",id:this.props.headerId},l.em_snippet(this.props.contentInfo.name(),Z.FILENAME)):this._renderContentNameInput(),n?de.h4({className:"u-trim-margin u-font-meta"},t):void 0),se.TRUELINK_UI[this.props.user.id]?de.span({className:"u-l-fr o-flag__fix"},this._renderContentSettings()):void 0))},_renderContentNameInput:function(){return de.div({className:"unified-share-modal__content-name"},null==this.props.contentNameMessage||!this.props.isContentNameFocused&&this.props.contentNameMessageLevel!==O.ERROR?void 0:le(m,{arrow:m.ARROW.TOP,className:e({"unified-share-modal__content-name__tooltip":!0,"unified-share-modal__content-name__tooltip-error":this.props.contentNameMessageLevel===O.ERROR,"u-font-strong":!0})},de.div({className:e(["u-pad-top-xxs","u-pad-bottom-xxs","u-pad-left-xs","u-pad-right-xs"])},this.props.contentNameMessage)),de.input({className:e(["u-trim-padding","u-trim-margin","u-l-ib","u-font-strong"]),id:this.props.headerId,ref:"contentNameInput",onChange:(function(e){return function(t){return e.props.actionHandler.handleContentNameChange(t.target.value)}})(this),onFocus:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!0)}})(this),onBlur:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!1)}})(this),onKeyUp:(function(e){return function(t){var n,r;if((null!=(n=e.refs.tokenizer)&&null!=(r=n.refs.tokenizer)?r.refs.input:void 0)&&13===t.keyCode)return s.findDOMNode(e.refs.tokenizer.refs.tokenizer.refs.input).focus()}})(this),placeholder:this.props.isContentNameFocused?void 0:ie("Folder name")}))},_renderToSection:function(){var t,n;return this._shouldRenderPaywallBlocker()?null:this.props.linkOnlyReason===W.LINKS_PAGE?null:this.props.mode===Y.LINK_ONLY?this._renderNoPermissionSection():this.props.isMetadataLoaded?this.props.showContentManagerBridge?this._renderContentManagerBridge():this.props.canInviteEditor||this.props.canInviteViewer?_e(this.props.user,this.props.isTeamSharedFolder,this.props.isFolderInsideTeamFolderTree)&&(null!=(t=this.props.memberCounts)?t.total_unique_users:void 0)>=G.SHARING_TOTAL_LIMIT?this._renderOverLimitSection():(n=this.props.contentInfo.isFile()&&!this.props.canInviteEditor&&!this.props.canInviteViewerNoComment,de.div({className:"unified-share-modal__section unified-share-modal__section--to"},de.div({className:"o-flag"},de.label({className:"o-flag__fix u-font-strong",htmlFor:"unified-share-modal-contacts-tokenizer"},this.props.isTeamSharedFolder?ie("Add groups:",{comment:"Label for with whom to share"}):ie("To:",{comment:"Label for with whom to share"})),de.div({className:"unified-share-modal__to-input-box o-flag__flex"},le(U,{ref:"tokenizer",context:"tiburon",customContactFilter:this.props.isTeamSharedFolder?function(e){return e.type!==i.FB&&e.group_id}:this.props.isInContentManager?function(e){return e.type!==i.FB}:(function(e){return function(t){return t.type!==i.FB&&t.email!==e.props.user.email}})(this),focusOnMount:this.props.contentInfo.pathExists(),id:"unified-share-modal-contacts-tokenizer",onContentsChange:this.props.actionHandler.recipientsChange,populatedInputData:{tokens:this.props.initialRecipientTokens,value:this.props.initialRecipientRawInput},customContactValidator:(function(e){return function(t){return ye(t,e.props.user,e.props.ownerTeam,e.props.folderPolicy,e.props.isTeamSharedFolder,e.props.isFolderInsideTeamFolderTree,e.props.memberCountWithRecipients)}})(this),placeholder:ie(this.props.isTeamSharedFolder?"Group names":this.props.user.is_team?"Email, name, or group":"Email or name"),shouldLogContactSearch:!0,showContactImport:!this.props.isTeamSharedFolder,teamGroupInfo:this.props.isTeamSharedFolder?this.props.teamGroupInfo:null,user:this.props.user})),de.div({className:e({"o-flag__fix":!0})},n?le(re,{position:oe.BOTTOM,tooltip_contents:ie("Only folders can be shared with edit access"),tooltip_classname:"sharing-access-menu__tooltip"},de.span({className:"ax-visually-hidden"},ie("Only folders can be shared with edit access")),this._renderToSectionAccessDropdown()):this._renderToSectionAccessDropdown())))):this._renderNoPermissionSection():de.div({className:"unified-share-modal__section unified-share-modal__section--to"},de.div({className:"unified-share-modal__to-placeholder"}," "))},_renderToSectionAccessDropdown:function(){return le(te,{asButton:!0,canMakeViewerNoComment:this.props.canMakeViewerNoComment,contentInfo:this.props.contentInfo,currentAccess:this.props.recipientAccess,disabled:this.props.showContentManagerBridge,memberPermissions:new Q({make_editor:new J({allow:this.props.canInviteEditor}),make_viewer:new J({allow:this.props.canInviteViewer}),make_viewer_no_comment:new J({allow:this.props.canInviteViewerNoComment})}),onAccessChange:this.props.actionHandler.changeRecipientAccess})},_shouldRenderContentSettingsShareButton:function(){var e;return this.props.isMetadataLoaded&&this.props.mode!==Y.LINK_ONLY&&(this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings||(e=this.props.mode)===Y.SHARE||e===Y.SHARE_SENDING)&&!this._shouldRenderPaywallBlocker()},_shouldRenderFooterSection:function(){return this._renderLinkRowInFooter()?this._shouldRenderLinkRow():this._shouldRenderContentSettingsShareButton()},_renderFooterSection:function(){if(this._shouldRenderFooterSection())return de.div({className:"unified-share-modal__section unified-share-modal__section--footer clearfix"},this._renderLinkRowInFooter()?this._renderLinkRowContent():this._renderContentSettingsShareButton())},_renderContentSettingsShareButton:function(){if(this._shouldRenderContentSettingsShareButton())return de.div({},se.TRUELINK_UI[this.props.user.id]?void 0:de.div({className:"u-l-fl"},this._renderContentSettings()),de.div({className:"u-l-fr"},function(){switch(this.props.mode){case Y.SHARE:case Y.SHARE_SENDING:return de.button({className:"unified-share-modal__share-send c-btn c-btn--primary",disabled:this.props.mode===Y.SHARE_SENDING||this.props.isTokenizerEmpty||this.props.contactsError.level===R.ERROR||null!=this.props.contentNameMessage,onClick:(function(e){return function(){return e.props.actionHandler.sendShare(e.refs.tokenizer,e.refs.contentNameInput)}})(this)},ie(this.props.mode===Y.SHARE_SENDING?this.props.isTeamSharedFolder?"Adding...":"Sharing...":this.props.isTeamSharedFolder?"Add":"Share"));default:return null}}.call(this)))},_renderContentSettings:function(){var e;if(this.props.isMetadataLoaded)return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings?de.button({"aria-label":ie("Settings"),className:"unified-share-modal__settings u-font-meta c-borderless-button",disabled:this.props.mode===Y.SHARE_SENDING,onClick:(function(e){return function(){return e.props.onSettingsClick()}})(this)},le(h,{alt:"",className:"u-mar-right-xs u-l-ib u-l-ib--m",group:"web",name:"settings"}),se.TRUELINK_UI[this.props.user.id]?void 0:ie(this.props.contentInfo.isFile()?"File settings":"Folder settings")):!this.props.contentInfo.isFolder()&&(this._canSendFeedbackRequest()||(null!=(e=this.props.recipientMessage)?e.length:void 0)>0)?this._renderFeedbackCheckbox():void 0},_renderErrorMessageSection:function(){return this.props.contactsError.message?de.div({className:e(["unified-share-modal__section","unified-share-modal__error-message","u-font-center",this.props.contactsError.level===R.WARN?"unified-share-modal__warn":void 0,this.props.contactsError.level===R.ERROR?"unified-share-modal__error":void 0])},this.props.contactsError.message):null},_shouldRenderMainLoading:function(){var e,t,n,s;return n=this.props.isMetadataLoaded,t=this.props.hasNonOwnerMembers||this.props.areMembersFullyLoaded,s=!this.props.isPassEnabled||this._isPassInfoLoaded(),e=this.props.shouldBlockMemberListOnPassLoad&&!s,!n||!t||e},_renderMainSection:function(){if(this.props.mode===Y.LINK_ONLY)return this._renderMainLinkOnly();if(this._shouldRenderMainLoading())return this._renderMainLoading();switch(this.props.mode){case Y.MEMBERSHIP:return this._renderMainMembership();case Y.SHARE:case Y.SHARE_SENDING:return this._renderMainShare();default:return null}},_shouldRenderPaywallBlocker:function(){var e,t,n;return null!==this.props.sharingPaywallInfo&&(!((null!=(n=this.props.sharingPaywallInfo.foldersToUnshare)?n.size:void 0)>0)&&(e=this.props.contentInfo.isFolder()&&!this.props.contentInfo.isSharedFolder(),t=this.props.sharingPaywallInfo.numOwned>=this.props.sharingPaywallInfo.maxOwned,this.props.sharingPaywallInfo.isInExperiment&&e&&t))},_shouldRenderPaywallBanner:function(){var e,t,n,s;return null!==this.props.sharingPaywallInfo&&((null!=(s=this.props.sharingPaywallInfo.foldersToUnshare)?s.size:void 0)>0||(t=this.props.sharingPaywallInfo.isFolderOwner,n=this.props.sharingPaywallInfo.numOwned<this.props.sharingPaywallInfo.maxOwned,e=this.props.contentInfo.isFolder()&&!this.props.contentInfo.isSharedFolder(),this.props.sharingPaywallInfo.isInExperiment&&(this.props.contentInfo.isSharedFolder()&&t||e&&n)))},_renderPaywallSection:function(){var t;return this.props.isMetadataLoaded&&this._shouldRenderPaywallBanner()?(this.props.actionHandler.logPaywallEvent("show_sharing_paywall_banner_in_share_modal"),t=0===this.props.sharingPaywallInfo.numOwned?ge("You can own %(max)s shared folder.","You can own %(max)s shared folders.",this.props.sharingPaywallInfo.maxOwned).format({max:this.props.sharingPaywallInfo.maxOwned}):ge("You own %(num)s shared folder (max is %(max)s).","You own %(num)s shared folders (max is %(max)s).",this.props.sharingPaywallInfo.numOwned).format({num:this.props.sharingPaywallInfo.numOwned,max:this.props.sharingPaywallInfo.maxOwned}),de.div({className:e(["paywall-banner","unified-share-modal__section","unified-share-modal__no-permission","u-font-center"])},t," ",de.button({className:"button-as-link",onClick:this.props.sharingPaywallInfo.onLearnMoreClick},ie("Learn more")))):null},_renderNoPermissionSection:function(){var e;return de.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},this.props.mode===Y.LINK_ONLY?this.props.contentInfo.isOSXPackage()?ie(se.TRUELINK_UI[this.props.user.id]?"Package files can’t be shared.":"This package file can only be shared as a link."):this.props.linkOnlyReason===W.INSIDE_SHARED_FOLDER?se.TRUELINK_UI[this.props.user.id]?ie("You don’t have permission to share this folder."):de.span({},ie("This folder can only be shared as a link because it’s in a shared folder.")+" ",de.a({href:"/help/1931",target:"_blank"},ie("Learn more"))):se.TRUELINK_UI[this.props.user.id]?ie("This folder can’t be shared"):this.props.linkOnlyReason===W.CONTAINS_SHARED_FOLDER?de.span({},ie("This folder can only be shared as a link because it contains a shared folder.")+" ",de.a({href:"/help/1931",target:"_blank"},ie("Learn more"))):ie("This folder can only be shared as a link."):this.props.isTeamSharedFolder&&this._shouldRenderTeamFolderNoPermissionMessage(this.props.members)?ie("This folder is automatically shared with all members of %(team_name)s").format({team_name:this.props.ownerTeam.name}):this.props.isTeamSharedFolder?he(ie("Only <admin_link>admins</admin_link> and <group_link>group managers</group_link> can change team folder membership."),{admin_link:de.a({href:"/team?_tk=left_nav_team",target:"_blank"}),group_link:de.a({href:"/help/7232#transfer",target:"_blank"})}):ie(this.props.contentInfo.isFolder()?se.TRUELINK_UI[this.props.user.id]&&(null!=(e=this.props.permissions)?e.change_options.allow:void 0)?"To add new members, you’ll need to add them to the parent folder.":"You don’t have permission to manage membership of this folder":"You don’t have permission to manage membership of this file"))},_renderConfidentialFolderSection:function(){if(this.props.isConfidentialFolder)return de.div({className:"unified-share-modal__section unified-share-modal__confidential-folder u-font-center"},de.span({},he(ie("<b>Invite only.</b> Members of parent folders can’t access."),{b:de.b()})," ",this.props.canUpdateConfidentiality?de.a({onClick:this.props.onSetConfidentialClick},ie("Settings")):void 0))},_renderContentManagerBridge:function(){var e;return e=ue(this.props.isLimitedTeam,this.props.contentInfo.displayPath()),de.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},de.span({},ie("You can manage folder membership in the Admin Console. "),de.a({href:e.toString(),target:"_blank"},ie("Open in new tab."))))},_renderOverLimitSection:function(){return de.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},de.div({},ie("This folder is over its %(member_limit)s-member limit.",{comment:"member limit is a number greater than 200"}).format({member_limit:G.SHARING_TOTAL_LIMIT})),de.div({},ie("Please remove some members.")," ",de.a({href:"/help/9292",target:"_blank"},ie("Learn more."))))},_shouldRenderTeamFolderNoPermissionMessage:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){var n,s;return"team"===e.group_type&&(null!=(n=e.permissions.make_editor)?n.allow:void 0)&&(null!=(s=e.permissions.make_viewer)?s.allow:void 0)})},_isOwnerOfAtLeastOneGroup:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){return e.is_owner})},_renderMainLoading:function(){return de.div({className:e(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer"])},this._renderLinkRow(),de.div({className:"u-font-center u-font-meta u-pad-top-xl"},de.div({className:"c-loader"},ie("Loading..."))))},_renderMainLinkOnly:function(){return se.TRUELINK_UI[this.props.user.id]&&this.props.linkOnlyReason!==W.LINKS_PAGE?null:de.div({className:e(["unified-share-modal__main","unified-share-modal__main--link-only","unified-share-modal__section",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow())},_renderMainMembership:function(){var t;return de.div({className:e(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer",this._shouldRenderPaywallBlocker()?"unified-share-modal__main--paywall":void 0,this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow(),this._shouldRenderPaywallBlocker()?(this.props.actionHandler.logPaywallEvent("view_shared_folder_paywall"),le(d,{actionHandler:this.props.actionHandler,maxOwned:this.props.sharingPaywallInfo.maxOwned,numOwned:this.props.sharingPaywallInfo.numOwned,onLearnMoreClick:this.props.sharingPaywallInfo.onLearnMoreClick,onUpgradeClick:this.props.sharingPaywallInfo.onUpgradeClick,onManageClick:this.props.sharingPaywallInfo.onManageSharedFoldersClick})):this.props.hasNonOwnerMembers?le(P,{actionHandler:this.props.actionHandler,areMembersFullyLoaded:this.props.areMembersFullyLoaded,canInviteMembers:this.props.canInviteEditor||this.props.canInviteViewer,canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,disabled:this.props.showContentManagerBridge,groupSeenStateInfo:this.props.groupSeenStateInfo,membership:this.props.members,onSetConfidentialClick:this.props.onSetConfidentialClick,pendingMemberAction:this.props.pendingMemberAction,presentAccountIds:this.props.presentAccountIds,shouldShowPassUI:this.props.isPassEnabled&&pe(this.props.passFetchingStatus),user:this.props.user,viewer:this.props.viewer}):this.props.banner===x.INPUT_CONTENT_NAME?de.div({className:e(["unified-share-modal__input-content-name-banner","u-font-center","u-font-meta","u-mar-top-xs"])},le(p,{src:fe("/static/images/sharing/illo-name-folder-vfl38PzAv.png"),srcHiRes:fe("/static/images/sharing/illo-name-folder@2x-vflzK0uJv.png")}),de.h3({className:e(["u-font-strong","u-mar-top-xs"])},ie("Name your shared folder")),de.p({className:e(["u-pad-left-xxl","u-pad-right-xxl"])},ie("Shared folders are for collaborting on projects, client works, and organizing departments"))):de.div({className:e(["unified-share-modal__no-members-banner","u-font-center","u-font-meta","u-font-center","u-font-meta"])},this.props.isTeamSharedFolder?null!=this.props.teamGroupInfo?[de.p({className:"u-mar-top-xxl"},de.a({onClick:this._addEveryoneGroup},ie("Add everyone at %(team_name)s").format({team_name:this.props.ownerTeam.name}))),de.p({},ie("Or, add groups to this team folder.")+" ",de.a({href:"/team#groups/newgroup"},ie("Create a group")))]:de.p({className:"u-mar-top-xxl"},ie("Add groups to this team folder.")+" ",de.a({href:"/team#groups/newgroup"},ie("Create a group"))):(t=se.TRUELINK_UI[this.props.user.id],t||"V1"!==this.props.expSubgrowthProOverquotaCreateSharedLink?t||"V2"!==this.props.expSubgrowthProOverquotaCreateSharedLink?de.div({},le(p,{className:"unified-share-modal__illo",src:fe("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:fe("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),de.p({className:"u-mar-top-s"},ie("Add people you want to share with"))):le(H):le(B))))},_renderMainShare:function(){return de.div({className:"unified-share-modal__main unified-share-modal__section u-pad-horizontal-m"},this.props.isTeamSharedFolder?void 0:de.textarea({placeholder:ie("Add a message (optional)"),onChange:(function(e){return function(t){return e.props.actionHandler.changeRecipientMessage(t.target.value)}})(this),value:this.props.recipientMessage}))},_renderLinkRow:function(){if(!this._renderLinkRowInFooter())return this._renderLinkRowContent()},_renderLinkRowContent:function(){var e,t;if(this._shouldRenderLinkRow())return t=!this.props.contentInfo.isMounted()&&this.props.isPassEnabled&&this._isPassInfoLoaded()&&this.props.isMetadataLoaded,t||this.props.isLinkMetadataLoaded&&(this.props.isMetadataLoaded||this.props.mode===Y.LINK_ONLY)?de.div({className:"unified-share-modal__link-info"},le(X,{actionHandler:this.props.actionHandler,canShareLink:this.props.canShareLink||this.props.mode===Y.LINK_ONLY,contentInfo:this.props.contentInfo,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isLimitedTeam:this.props.isLimitedTeam,linkMetadata:this.props.linkMetadata,linkSeenStateInfo:this.props.linkSeenStateInfo,mode:this.props.mode,onLinkViewersClick:this.props.onLinkViewersClick,shareFolderPromise:this.props.shareFolderPromise,teamName:null!=(e=this.props.ownerTeam)?e.name:void 0,presentAccountIds:this.props.presentAccountIds,user:this.props.user})):this.props.mode===Y.LINK_ONLY?de.div({className:"unified-share-modal__link-info--loading"},de.div({className:"c-loader c-loader--spinner--blue u-l-b u-mar-horizontal-auto"},ie("Loading…"))):this.props.contentInfo.isTeamSharedFolder()?void 0:de.div({className:"unified-share-modal__link-info--filler"})},_renderFeedbackCheckbox:function(){var e,t;return t=this._canSendFeedbackRequest(),e=ie(t?"I want feedback on this file":"Post this message as a comment"),de.div({className:"u-pad-top-xs"},de.div({className:"unified-share-modal__add-message-as-comment-checkbox-container"},de.input({type:"checkbox",id:"add_message_as_comment",
name:"add_message_as_comment",checked:this.props.isAddMessageAsCommentChecked,onChange:this._handleAddMessageAsCommentChange}),this.props.isAddMessageAsCommentHelpShown?le(w,{onClose:this._commentsHelpClosed,onButtonClick:this._commentsHelpButtonClicked,isFeedbackRequest:t}):void 0),de.label({htmlFor:"add_message_as_comment"},e))},_getMemberNum:function(){var e;return null!=this.props.memberCounts?this.props.memberCounts.total_unique_users:null!=(e=this.props.members)?e.getMemberCount():void 0},_isPassInfoLoaded:function(){return ce(this.props.passFetchingStatus)},_handleAddMessageAsCommentChange:function(e){return this.props.actionHandler.setAddMessageAsCommentChecked(e.target.checked)},_commentsHelpClosed:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed()},_commentsHelpButtonClicked:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed(),this.props.actionHandler.setAddMessageAsCommentChecked(!0)},_canSendFeedbackRequest:function(){return!this._renderLinkRowInFooter()},_addEveryoneGroup:function(){var e;return null!=(e=this.refs.tokenizer)?e.addExternalContacts([a.teamGroupInfoToContact(this.props.teamGroupInfo)]):void 0},_renderLinkRowInFooter:function(){return this.props.mode!==Y.LINK_ONLY&&(this.props.mode!==Y.SHARE&&this.props.mode!==Y.SHARE_SENDING&&(!!this.props.isMetadataLoaded&&se.TRUELINK_UI[this.props.user.id]))},_shouldRenderLinkRow:function(){return!(se.TRUELINK_UI[this.props.user.id]&&this.props.isLinkMetadataLoaded&&!this.props.linkMetadata)&&(!this.props.suppressLinkUI&&this.props.canShareLink)}}),$=c(ae,["/static/css/react/contacts_tokenizer-vflR5K70C.css","/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/sharing/share_modal-vflEotmBn.css"]),{ShareModalContent:$,MODES:Y}}),define("modules/clean/sharing/views/modal_link_info",["jquery","external/classnames","external/immutable","external/react","external/react-dom","modules/clean/clipboard_v2","modules/clean/em_string","modules/clean/react_format","modules/clean/react/sprite","modules/clean/react/util","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/link_description","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/modal_viewers_line","modules/clean/sharing/views/viewer_info","modules/clean/user","modules/constants/python","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,w,C){var E,P,T,N,M,k,A,F,x,L,R,O,D,U,q,B,H,V,G,W,K;return F=n.Set,G=a.reactFormat,K=d.setStatePromise,p.CombinedPolicy,P=p.LinkAudience,T=p.LinkMetadata,L=p.SharedContentLinkMetadata,E=h.ContentInfo,q=m.formatLinkDescription,B=m.formatSharedContentLinkExpiry,x=_.SettingDropdown,H=f.getAudienceOptionsDict,V=g.logTiburonEvent,N=y.MODES,M=y.MODE_VALUES,A=b.ModalViewersLine,R=v.ViewerInfo,I.TRADEMARK_BUSINESS,W=w.i18n_default_project("sharing"),O=W._,W.ungettext,D=s.createElement,U=s.DOM,k=s.createClass({displayName:"ModalLinkInfo",propTypes:{actionHandler:s.PropTypes.instanceOf(c),canShareLink:s.PropTypes.bool.isRequired,contentInfo:s.PropTypes.instanceOf(E).isRequired,hasDisplayableMembers:s.PropTypes.bool,hasNonOwnerMembers:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,linkMetadata:s.PropTypes.oneOfType([s.PropTypes.instanceOf(T),s.PropTypes.instanceOf(L)]),linkSeenStateInfo:s.PropTypes.array,mode:s.PropTypes.oneOf(M),onLinkViewersClick:s.PropTypes.func,presentAccountIds:s.PropTypes.instanceOf(F),shareFolderPromise:s.PropTypes.instanceOf(Promise),teamName:s.PropTypes.string,user:s.PropTypes.instanceOf(S).isRequired},getInitialState:function(){return{showingUrl:!1}},componentWillMount:function(){var e;return this.clipboard=new o(null!=(e=this.props.linkMetadata)?e.url:void 0,function(){return C.success(O("Link copied to clipboard"))},function(){return C.error(O("Unable to copy the link, please copy manually"))},this._handleCopyLinkClicked)},componentDidMount:function(){return this.setupCopy()},componentDidUpdate:function(){return this.setupCopy()},setupCopy:function(){var t;if(t=e(".copy-link-button"),t.length)return this.clipboard.setupCopy(t,e(".copy-link-container"))},render:function(){return null!=this.props.linkMetadata||this._isSharedContentLink()?this._renderLink():this.props.contentInfo.isMounted()?this.props.canShareLink?this._renderNoLink():null:this._renderUnmountedLinkInfo()},_renderLink:function(){var e,n;return U.div({className:t(["unified-share-modal-link-info","o-flag"])},U.div({className:"o-flag__fix"},this._renderLinkIcon()),U.div({className:this._detailsClassName()},function(){var n;if(this.state.showingUrl)return U.span({},this.props.linkMetadata instanceof L?this._renderSharedContentLinkInfo():void 0,U.span({},U.label({className:"ax-visually-hidden",htmlFor:"unified-share-modal-link-url",key:"link-label"},O("Shared link URL")),U.input({className:"unified-share-modal-link-info__url",id:"unified-share-modal-link-url",key:"link-url-input",onClick:this._handleUrlClick,readOnly:!0,ref:"urlField",type:"text",value:this.props.linkMetadata.url})));if(e=null,this.props.linkMetadata instanceof T)e=q(this.props.linkMetadata);else{if(!(this.props.linkMetadata instanceof L))throw Error("Unsupported link metadata type "+(null!=(n=this.props.linkMetadata)?n.name:void 0));e=this._renderSharedContentLinkInfo()}return U.span({},null!=e?U.span({className:t(["unified-share-modal-link-info__description",this._isSharedContentLink()?"unified-share-modal-link-info__description--content-link":void 0])},e):void 0,this._renderLinkViewers())}.call(this)),U.ul({className:"unified-share-modal-link-info__actions o-flag__fix"},this._isSharedContentLink()?(null!=(n=this.props.linkMetadata)?n.url:void 0)?this._renderCopyLink():this._isSharingFolder()?void 0:this._renderGetLink():U.span({},this._renderLinkSettings(),this._renderDivider(),this._renderCopyLink())))},_renderLinkSettings:function(){if(!this.state.showingUrl)return U.li({className:"u-l-ib"},U.button({className:"button-as-link",onClick:this.props.actionHandler.handleLinkSettingsClick},O("Link settings")))},_renderDivider:function(){if(!this.state.showingUrl)return U.span({className:"u-l-ib u-mar-left-xs u-mar-right-xs"},"•")},_renderCopyLink:function(){return U.li({className:"u-l-ib"},U.button({className:"button-as-link copy-link-container",onClick:this._handleCopyLinkClicked},this.state.showingUrl?O("Hide link"):o.is_supported()?U.span({className:"copy-link-button"},O("Copy link")):O("Show link")))},_renderGetLink:function(){return U.li({className:"u-l-ib"},U.button({className:"button-as-link",onClick:(function(e){return function(){return e.props.actionHandler.turnLinkOnIfQualified().then(function(){return e.props.actionHandler.shareIfFileFolder()})}})(this)},O("Get link")))},_renderUnmountedLinkInfo:function(){var e;return e=this._renderLinkViewers(),U.div({className:t(["unified-share-modal-link-info","o-flag",this._isSharedContentLink()?void 0:"u-mar-horizontal-s","u-mar-bottom-s","u-pad-top-s"])},U.div({className:"o-flag__fix"},this._renderLinkIcon()),U.div({className:this._detailsClassName()},null!=e?e:O("No one else has viewed the link")))},_detailsClassName:function(){var e;return e=["unified-share-modal-link-info__details","o-flag__flex"],t(e)},_renderNoLink:function(){var e,n;return e=(null!=(n=this.props.linkSeenStateInfo)?n.length:void 0)?U.span({},O("You haven’t created a link yet"),this._renderLinkViewers()):O("No link created yet"),U.div({className:t(["unified-share-modal-link-info","unified-share-modal-link-info--no-link","o-flag"])},U.div({className:"o-flag__fix"},U.div({className:"unified-share-modal-link-info__icon"},D(l,{alt:"",group:"web",name:"shared_link_gray"}))),U.div({className:this._detailsClassName()},e),U.div({className:"unified-share-modal-link-info__actions o-flag__fix"},U.button({className:"button-as-link",onClick:this._handleCreateLinkClicked},O("Create a link"))))},_handleCreateLinkClicked:function(){if(this._isSharedContentLink())throw Error("Should not display this for shared content link");return this.props.actionHandler.createSharedLink()},_handleCopyLinkClicked:function(){return this.state.showingUrl||(V(this.props.contentInfo,this.props.user.id,"CLICK_TIB_COPY_LINK"),this.props.actionHandler.turnLinkOnIfQualified()),K(this,{showingUrl:!this.state.showingUrl}).then((function(e){return function(){var t;if(null!=e.refs.urlField)return t=r.findDOMNode(e.refs.urlField),t.focus(),t.select(),e.clipboard.do_copy()}})(this))},_handleUrlClick:function(e){return e.target.select()},_renderLinkViewers:function(){var e,t;return(null!=(e=this.props.linkSeenStateInfo)?e.length:void 0)?(t=this.props.linkSeenStateInfo.map(function(e){return new R(e)}),U.button({className:"unified-share-modal-link-info__viewers button-as-link",onClick:this.props.onLinkViewersClick},D(A,{currentUserAccountId:this.props.user.account_id,presentAccountIds:this.props.presentAccountIds,viewers:t}))):null},_isSharedContentLink:function(){return u.TRUELINK.TRUELINK_UI[this.props.user.id]},_renderLinkIcon:function(){return U.div({className:"unified-share-modal-link-info__icon"},D(l,{alt:"",group:"web",name:"shared_link_white"}))},_isSharingFolder:function(){return Boolean(this.props.shareFolderPromise)},_renderSharedContentLinkInfo:function(){var e,t,n,s,r;return this._isSharingFolder()||this.props.linkMetadata.current_audience===P.default_on?U.div({},O("Updating link"),U.div({className:"c-loader"})):(t=this.props.linkMetadata.audience_options.size>1,n=this.props.linkMetadata.current_audience===P.members?this.props.hasDisplayableMembers&&!this.props.hasNonOwnerMembers?G(O("<strong>Only you</strong> can use the link"),{strong:U.strong()}):G(O("<strong>Only invited members</strong> with the link can view"),{strong:U.strong()}):this.props.linkMetadata.current_audience===P.team?G(O("<strong>Only people at %(team_name)s</strong> with the link can view"),{strong:U.strong(),team_name:i.em_snippet(this.props.teamName,10)}):this.props.linkMetadata.current_audience===P.public?G(O("<strong>Anyone</strong> with the link can view"),{strong:U.strong()}):void 0,U.div({},U.div({},t?(e=U.button({className:"c-borderless-button change-audience-button"},n,D(l,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"})),x({currentValue:this.props.linkMetadata.current_audience,valuesList:this.props.linkMetadata.audience_options.valueSeq().toArray(),optionsDict:H(this.props.contentInfo.isFolder(),this.props.teamName,this.props.hasNonOwnerMembers,this.props.hasDisplayableMembers),onValueSelected:this.props.actionHandler.handleSelectLinkAudience,customButton:e,openUp:this.props.mode!==N.LINK_ONLY})):n),U.div({},this.props.linkMetadata.expiry?B(this.props.linkMetadata,!0):void 0,this.props.linkMetadata.password_protected&&this.props.linkMetadata.expiry?this._renderDivider():void 0,this.props.linkMetadata.password_protected?O("Password protected"):void 0),(null!=(s=this.props.linkMetadata.audience_restricting_shared_folder)?s.audience:void 0)===this.props.linkMetadata.current_audience?O("Applied via %(folder_name)s").format({folder_name:null!=(r=this.props.linkMetadata.audience_restricting_shared_folder)?r.name:void 0}):this.props.contentInfo.isFolder()&&this.props.linkMetadata.current_audience!==P.members?O("Applies to all items in this folder"):void 0))}}),{ModalLinkInfo:k}}),define("modules/clean/sharing/views/modal_viewers_line",["require","exports","tslib","external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/react/title_bubble","modules/clean/sharing/constants","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l,d){"use strict";var c=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>%(first_user)s</NameSpan> is viewing now").format({first_user:e})},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>%(first_user)s</NameSpan> and <NameSpan>%(second_user)s</NameSpan> are viewing").format({first_user:e,second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other are viewing</PositioningTarget>","<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others are viewing</PositioningTarget>",n).format({first_user:e,second_user:t,in_bubble_count:n})},e})(),p=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>You</NameSpan> are viewing now")},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>You</NameSpan> and <NameSpan>%(second_user)s</NameSpan> are viewing now").format({second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other are viewing</PositioningTarget>","<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others are viewing</PositioningTarget>",n).format({second_user:t,in_bubble_count:n})},e})(),u=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>%(first_user)s</NameSpan> viewed").format({first_user:e})},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>%(first_user)s</NameSpan> and <NameSpan>%(second_user)s</NameSpan> viewed").format({first_user:e,second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other viewed</PositioningTarget>","<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others viewed</PositioningTarget>",n).format({first_user:e,second_user:t,in_bubble_count:n})},e})(),h=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>You</NameSpan> viewed")},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>You</NameSpan> and <NameSpan>%(second_user)s</NameSpan> viewed").format({second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other viewed</PositioningTarget>","<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others viewed</PositioningTarget>",n).format({second_user:t,in_bubble_count:n})},e})(),m=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){for(var e=null,t=[],n=[],s=!0,r=0,o=this.props.viewers;r<o.length;r++){var i=o[r],a=this.props.presentAccountIds.has(i.account_id);i.account_id===this.props.currentUserAccountId?e=i:a?t.push(i):n.push(i),a||(s=!1)}var l;l=e?s?new p:new h:s?new c:new u;var d=e?[e]:[];return d.push.apply(d,t.concat(n)),this.buildViewerComponent(d,l)},t.prototype.buildViewerComponent=function(e,t){var n,r=function(e){return o.reactFormat(e,{NameSpan:s.createElement("span",null)})};switch(e.length){case 0:return s.createElement("span",null);case 1:n=r(t.formatOne(this.getName(e,0,!1)));break;case 2:n=r(t.formatTwo(this.getName(e,0),this.getName(e,1)));break;default:n=this.buildComplexTooltip(e,t)}return s.createElement("div",{className:"viewer-list-line"},n)},t.prototype.getName=function(e,t,n){void 0===n&&(n=!0);var s=e[t].display_name;return n&&(s=d.getShortName(s)),r.em_snippet(s,a.SNIPPET_SIZES.DISPLAY_NAME)},t.prototype.buildComplexTooltip=function(e,t){for(var n=e.length,r=n-2,a=[this.getName(e,2,!1)],d=Math.min(10,n),c=3;c<d;c++)a.push(s.createElement("br",null),this.getName(e,c,!1));var p=n-d;if(p){var u=l.ungettext("and %(num_additional)d more…","and %(num_additional)d more…",p,{comment:"text in a list of members, indicates there are also num_additional members not shown"}).format({num_additional:p});a.push(s.createElement("br",null),u)}var h=t.formatMulti(this.getName(e,0),this.getName(e,1),r),m=o.reactFormat(h,{NameSpan:s.createElement("span",null),PositioningTarget:s.createElement("span",{className:i.POSITIONING_TARGET_CLASS})});return s.createElement(i,{content:s.createElement("div",null,a),children:s.createElement("span",null,m),position:i.POSITIONS.BOTTOM,isTargetPositionFixed:!0})},t})(s.Component);t.ModalViewersLine=m}),define("modules/clean/sharing/views/sharing_bubble_menu",["require","exports","tslib","external/classnames","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite","modules/clean/sharing/constants","modules/clean/sharing/strings","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d){"use strict";var c=d.i18n_default_project("sharing")._,p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMemberActionInfo=function(){var e=l.ACCESS_NAME;this.props.canMakeViewerNoComment&&(e=l.ACCESS_NAME_NO_COMMENT);var t=l.MEMBER_ACTION_FOLDER;this.props.canMakeViewerNoComment&&(t=l.MEMBER_ACTION_FOLDER_NO_COMMENT);var n=l.MEMBER_ACTION_FILE;this.props.canMakeViewerNoComment&&(n=l.MEMBER_ACTION_FILE_NO_COMMENT);var s=c("Remove");return this.props.allowRelinquishMembership&&(s=c("Remove my access")),[[a.MEMBER_ACTION.MAKE_EDITOR,{value:a.ACCESS_LEVEL.WRITER,title:e[a.ACCESS_LEVEL.WRITER],folder_description:t[a.MEMBER_ACTION.MAKE_EDITOR],file_description:n[a.MEMBER_ACTION.MAKE_EDITOR]}],[a.MEMBER_ACTION.MAKE_VIEWER,{value:a.ACCESS_LEVEL.READER,title:e[a.ACCESS_LEVEL.READER],folder_description:t[a.MEMBER_ACTION.MAKE_VIEWER],file_description:n[a.MEMBER_ACTION.MAKE_VIEWER]}],[a.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT,{value:a.ACCESS_LEVEL.READER_NO_COMMENT,title:e[a.ACCESS_LEVEL.READER_NO_COMMENT],folder_description:t[a.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT],file_description:n[a.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]}],[a.MEMBER_ACTION.MAKE_OWNER,{value:a.ACCESS_LEVEL.OWNER,title:c("Make owner")}],[a.MEMBER_ACTION.REMOVE,{value:"remove",title:r.createElement("div",{className:"u-font-danger"},s)}]]},t.prototype.renderMenuItem=function(e){var t=this,n=e.value,s=e.title,a=e.file_description,l=e.folder_description,d=null;d=this.props.contentInfo&&this.props.contentInfo.isFolder()?l:a;var c=null;n!==this.props.currentAccess&&(c=function(){return t.props.onAccessChange(n)});var p=null;return n===this.props.currentAccess&&(p=r.createElement(i,{alt:"",group:"web",name:"check_gray"})),r.createElement(o.BubbleMenuItem,{className:"sharing-access-menu-item",key:n,onClick:c},r.createElement("div",{className:"sharing-access-menu-item__left-margin u-l-ib u-l-ib--t"},p),r.createElement("div",{className:"sharing-access-menu-item__label u-l-ib u-l-ib--t"},r.createElement("div",{className:"u-font-nowrap u-font-black sharing-access-menu-item__title"},s),r.createElement("div",{className:"u-font-wrap u-font-meta sharing-access-menu-item__description"},d)))},t.prototype.renderCurrentAccessText=function(e){var t=s({"sharing-access-menu__current-access":!0,"u-font-nowrap":!0,"c-btn--disabled":e,"sharing-access-menu__current-access--button":this.props.asButton,"c-btn":this.props.asButton,"c-btn--secondary":this.props.asButton,"u-trim-margin":this.props.asButton,"c-borderless-button":!this.props.asButton,"change-access-button":!this.props.asButton&&!e}),n=l.ACCESS_NAME[this.props.currentAccess];this.props.canMakeViewerNoComment&&(n=l.ACCESS_NAME_NO_COMMENT[this.props.currentAccess]);var o=null;return e||(o=[r.createElement("div",{className:"gray-arrow",key:"gray"},r.createElement(i,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"})),r.createElement("div",{className:"blue-arrow",key:"blue"},r.createElement(i,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-blue"}))]),r.createElement("button",{className:t},n,o)},t.prototype.render=function(){for(var e=[],t=0,n=this.getMemberActionInfo();t<n.length;t++){var s=n[t],i=s[0],l=s[1];(l.value===this.props.currentAccess||this.props.memberPermissions&&this.props.memberPermissions.get(i)&&this.props.memberPermissions.get(i).allow||l.value===a.MEMBER_ACTION.REMOVE&&this.props.allowRelinquishMembership)&&e.push(this.renderMenuItem(l))}if(e.length<=1||this.props.pendingAccessChange)return this.renderCurrentAccessText(!0);var d=0;return this.props.asButton&&(d=-5),r.createElement(o.BubbleMenu,{targetButton:this.renderCurrentAccessText(this.props.disabled||!1),targetFixed:!0,position:o.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-access-menu o-list-ui o-list-ui--dividers",items:e,shouldShowArrow:!1,disabled:this.props.disabled,verticalDisplacement:d})},t})(r.Component);p.defaultProps={allowRelinquishMembership:!1,asButton:!1,canInviteMembers:!1,canMakeViewerNoComment:!1,disabled:!1,pendingAccessChange:void 0},t.SharingBubbleMenu=p}),define("modules/clean/sharing/views/viewer_info",["require","exports"],function(e,t){"use strict";var n=(function(){function e(e){e.when_last_seen&&(this.time_last_seen=new Date(1e3*e.when_last_seen));var t=e.seen_state_user;this.account_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.photo_circle_url=t.photo_circle_url,this.same_team=!0}return e.prototype.displayName=function(){return this.display_name},e.prototype.memberId=function(){return""},e})();t.ViewerInfo=n}),define("modules/clean/sharing/views/viewer_list_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/clean/sharing/views/member_list_item","modules/clean/sharing/ui_util","modules/clean/sharing/views/viewer_info","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l){"use strict";var d=s.createElement,c=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){return d(r.Modal,{autoclose:!1,className:"viewer-list-modal",buttonComponent:s.createElement("span",null),onDismissCompleted:this.props.onCancel,title:this._modalTitle()},this._createMemberList())},t.prototype._modalTitle=function(){return this.props.groupName?l._("Members of %(group_name)s who viewed").format({group_name:this.props.groupName}):l._("People who viewed this link")},t.prototype._createMemberList=function(){var e=this.props.seenStateInfo.map(function(e){return new a.ViewerInfo(e)}),t=i.makeMemberSortCmp(this.props.user,this.props.presentAccountIds,!0);return e.sort(t),s.createElement("div",{className:"sharing-member-list"},s.createElement("ul",{className:"o-list-ui u-trim-margin"},e.map(this._renderMemberListItem.bind(this))))},t.prototype._renderMemberListItem=function(e){return d(o.SharingMemberListItem,{canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,contentInfo:this.props.contentInfo,disabled:!1,isMemberActionPending:!1,isPendingRemoval:!1,isPresent:this.props.presentAccountIds.has(e.account_id),isViewOnly:!0,key:e.account_id,member:e,onMemberAccessChange:null,user:this.props.user})},t})(s.Component);t.ViewerListModal=c}),define("modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/flag","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/clean/react/tooltip","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u){"use strict";var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:u._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.handleSubmit},u._("Share anyway")),s.createElement("a",{className:"c-btn c-btn--primary u-mar-left-s",href:"/pro/out-of-space?oqa=sfcu"},u._("Add more space")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:e})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio(),this.renderFooter())},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("span",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},u._("I’d like to create and share a new folder"),this.renderWarningTooltip())),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},u._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:u._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.renderWarningTooltip=function(){var e=s.createElement(o,{src:p.static_url("/static/images/out-of-space-lp/error-vflis8APx.png"),srcHiRes:p.static_url("/static/images/out-of-space-lp/error@2x-vflgzXrb2.png")}),t=u._("If you create and share a new folder, your contents will not sync to your Dropbox");return s.createElement(c.Tooltip,{tooltip_classname:"exp-shared-folder-wizard__tooltip",position:c.TooltipPosition.TOP,tooltip_contents:t},e)},t.prototype.renderFooter=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__footer u-mar-top-s"},a.reactFormat(u._("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:s.createElement("span",{className:"exp-shared-folder-wizard__footer--warning"})}))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component);h.defaultProps={user:{},onSubmit:function(){},expProOQCreateSFVariant:"OFF"};var m=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:u._("Share a folder from your personal Dropbox"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},u._("Continue sharing")),s.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),s.createElement("a",{className:"c-btn c-btn--primary",href:"/pro/out-of-space?oqa=sfcu"},u._("Upgrade now")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:e})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderHeader(),this.renderRadio())},t.prototype.renderHeader=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__header"},u._("Your Dropbox is full. You currently have 0 MB of personal Dropbox space left.")," ",s.createElement("br",null),u._("What would you like to do?"))},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},u._("Create and share a new folder")),s.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},s.createElement("span",{className:"exp-shared-folder-wizard__option-subtext--warning"},u._("If you create and share a new folder, it will not sync to your Dropbox.")))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},u._("Share an existing folder")),s.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},u._("If you share an existing folder, you will only be able to view contents."))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:u._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component),_=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"existing-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:u._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderHeader(),this.renderContent())},t.prototype.getButtons=function(){var e=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},u._("Continue anyway")),s.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),s.createElement("a",{className:"c-btn c-btn--primary",href:"/pro/out-of-space?oqa=sfcu"},u._("Upgrade your plan")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:e})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio())},t.prototype.renderHeader=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__header"},a.reactFormat(u._("You have 0 MB of personal Dropbox space left. If you create and share a new folder, it will not sync to your Dropbox. <a>Upgrade your plan to sync more shared folders.</a>"),{a:s.createElement("a",{href:"/pro/out-of-space?oqa=sfcu","aria-label":u._("Link to upgrade page")})}))},t.prototype.renderRadio=function(){var e=s.createElement("div",{className:"c-radio-wrapper u-pad-m"},s.createElement("input",{disabled:!0,type:"radio",value:"new-folder",id:"radio-existing-folder-disabled","aria-checked":"false"}),s.createElement("label",{className:"c-radio-content",htmlFor:"radio-existing-folder-disabled"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--disabled u-l-ib u-pad-left-xs"},u._("I’d like to create and share a new folder")))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},u._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:u._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component);t.ExpShareAFolderWizardModalV3=r(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),
t.ExpShareAFolderWizardModalV4=r(m,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),t.ExpShareAFolderWizardModalV5=r(_,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"])});var extend=function(e,t){function n(){this.constructor=e}for(var s in t)hasProp.call(t,s)&&(e[s]=t[s]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;define("modules/clean/sharing/wizard/share_a_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/flag","modules/clean/react/image","modules/clean/react/input","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/core/i18n","modules/clean/user","modules/clean/static_urls","modules/clean/viewer"],function(e,t,n,s,r,o,i,a,l,d,c,p){var u,h,m,_,f,g,y,b,v,S,I,w;return r.text,I=o.reactFormat,m=i.Modal,_=a.RadioGroup,f=a.RadioItem,g=a.RadioItemVariant,w=c.static_url,v=e.createElement,S=e.DOM,b=l.i18n_default_project("sharing")._,y=e.createClass({displayName:"ShareAFolderWizardModal",propTypes:{onSubmit:e.PropTypes.func,user:e.PropTypes.instanceOf(d).isRequired},getInitialState:function(){return{option:"new-folder"}},render:function(){return v(m,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:S.span(),title:function(){switch(this.props.user.role){case"work":return b("Share a folder from your %(team_name)s Dropbox").format({team_name:p.get_viewer().team_name});case"personal":return b("Share a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return S.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderButtons())},_renderHeader:function(){return S.div({className:"shared-folder-wizard__header u-mar-bottom-s"},b("What would you like to do?"))},_renderRadio:function(){var e;return e={value:this.state.option,requestChange:this._handleChange},S.div({className:"radio-input"},v(_,{variant:g.Normal,legend:b("Share a Folder options"),displayLegend:!1,valueLink:e},this._renderRadioItems()))},_renderRadioItems:function(){var e,t;return t=v(f,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},S.div({className:"new-folder_title u-l-ib u-pad-left-xs"},b("I’d like to create and share a new folder"))),e=v(f,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},S.div({className:"existing-folder_title u-l-ib u-pad-left-xs"},b("I’d like to share an existing folder"))),[t,e]},_handleChange:function(e){return this.setState({option:e})},_renderButtons:function(){return S.div({className:"u-mar-top-m clearfix"},S.div({className:"u-l-fr"},S.button({className:"c-btn c-btn--primary",onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},b("Next"))))}}),u=(function(e){function t(e,n,s){t.__super__.constructor.call(this,e,n,s),this.state.showInterstitial=!0}return extend(t,e),t.prototype.render=function(){return this.state.showInterstitial?v(m,{autoClose:!1,className:"shared-folder-wizard-interstitial",buttonComponent:S.span(),title:b("Your Dropbox is full")},this._renderInterstitial()):t.__super__.render.call(this)},t.prototype._renderInterstitial=function(){return S.div({className:"shared-folder-wizard-interstitial"},S.div({className:"shared-folder-wizard-interstitial__content"},S.div({className:"shared-folder-wizard-interstitial__header"},I(b("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:S.span({className:"shared-folder-wizard-interstitial__header--warning"})})),S.div({className:"shared-folder-wizard-interstitial__body"},b("If you create and share a new folder, you can add contents, but it will not sync to your Dropbox."))),S.div({className:"shared-folder-wizard-interstitial__image"},v(s,{src:w("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),v(n.Flag,{spacing:"s",rightAttachment:S.div({className:"shared-folder-wizard-interstitial__buttons u-mar-top-l"},S.button({className:"c-btn c-btn--secondary",onClick:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.setState({showInterstitial:!1})}})(this)},b("Share anyway")),S.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},b("Add more space")))}))},t})(y),h=(function(e){function t(e,n,s){t.__super__.constructor.call(this,e,n,s)}return extend(t,e),t.prototype.render=function(){return v(m,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:S.span(),title:b("Share a folder from your personal Dropbox")},this._renderContentV2())},t.prototype._renderContentV2=function(){return S.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderUpsell())},t.prototype._renderUpsell=function(){return S.div({className:"shared-folder-wizard-upsell u-mar-top-l"},S.div({className:"shared-folder-wizard-upsell__content"},S.div({className:"shared-folder-wizard-upsell__header"},I(b("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:S.span({className:"shared-folder-wizard-upsell__header--warning"})})),S.div({className:"shared-folder-wizard-upsell__body"},"If you create and share a new folder, you can add contents, but it will not sync to your Dropbox.")),S.div({className:"shared-folder-wizard-upsell__image"},v(s,{src:w("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),v(n.Flag,{spacing:"s",rightAttachment:S.div({className:"shared-folder-wizard-upsell__buttons u-mar-top-l"},S.button({className:"c-btn c-btn--secondary"},b("Share anyway")),S.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},b("Add more space")))}))},t})(y),y=t(y,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),u=t(u,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),h=t(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),{ShareAFolderWizardModal:y,ExpShareAFolderWizardModalV1:u,ExpShareAFolderWizardModalV2:h}}),define("modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/input","modules/clean/react/modal","modules/clean/react/tree_view","modules/core/i18n","modules/clean/user","modules/clean/viewer"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u,h;return n.text,d=s.Modal,l=r.FolderTreeView,u=e.createElement,h=e.DOM,p=o.i18n_default_project("sharing")._,c=e.createClass({displayName:"ShareExistingFolderWizardModal",propTypes:{onBack:e.PropTypes.func,onSubmit:e.PropTypes.func,user:e.PropTypes.instanceOf(i).isRequired},getInitialState:function(){return{folderPath:null,errorMsg:null}},render:function(){return u(d,{autoClose:!1,className:"existing-shared-folder-wizard",buttonComponent:h.span(),onDismissCompleted:function(){return d.close()},title:function(){switch(this.props.user.role){case"work":return p("Choose a folder from your %(team_name)s Dropbox").format({team_name:a.get_viewer().team_name});case"personal":return p("Choose a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return h.form({className:"existing-shared-folder-wizard__contents",onSubmit:(function(e){return function(){return e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},this._renderError(),this._renderTreeView(),this._renderButtons())},_renderError:function(){var e;if(null!=this.state.folderPath&&(null!=(e=this.state.errorMsg)?e.length:void 0)>0)return h.div({className:"text-input-error-wrapper"},h.div({className:"text-input-error-text u-font-danger"},this.state.errorMsg))},_renderTreeView:function(){return h.div({className:"wizard-tree-view"},u(l,{user:this.props.user,onFolderSelected:this._setFolderPath,ref:"treeView"}))},_renderButtons:function(){return h.div({className:"u-mar-top-m clearfix"},h.div({className:"u-l-fr"},h.button({className:"c-btn c-btn--primary",disabled:!this._isValid(),onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},p("Next"))),h.div({className:"u-l-fl"},h.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:(function(e){return function(t){var n,s;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),d.close(),"function"==typeof(s=e.props).onBack?s.onBack():void 0}})(this)},p("Back"))))},_setFolderPath:function(e){return this.setState({folderPath:e,errorMsg:null})},_setError:function(e){var t;return this.setState({errorMsg:null!=e&&null!=(t=e.path)?t.message_text:void 0})},_isValid:function(){return null!=this.state.folderPath&&null==this.state.errorMsg}}),c=t(c,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),{ShareExistingFolderWizardModal:c}});var slice=[].slice;define("modules/clean/sharing/wizard/wizard_modals",["external/react","modules/core/notify","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/react/modal","modules/clean/sharing/api","modules/constants/browse","modules/clean/sharing/constants","modules/clean/sharing/share_modal_util","modules/clean/sharing/wizard/share_existing_folder_wizard_modal","modules/clean/sharing/wizard/share_a_folder_wizard_modal","modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,h){var m,_,f,g,y,b,v,S,I,w,C,E,P,T,N,M,k,A;return m=n.EmailVerification,C=r.SharingExperimentsLogger,v=i.Modal,w=a.SharingApi,E=d.TRUELINK,P=c.generateModalSessionId,N=c.showNewFolderShareModal,A=c.showShareModal,I=p.ShareExistingFolderWizardModal,S=u.ShareAFolderWizardModal,_=u.ExpShareAFolderWizardModalV1,f=u.ExpShareAFolderWizardModalV2,g=h.ExpShareAFolderWizardModalV3,y=h.ExpShareAFolderWizardModalV4,b=h.ExpShareAFolderWizardModalV5,T=function(e,n,s,r){var i,a,l;return l=function(){if(!A(e,{fqPath:n,isFolder:!0,exists:!0,origin:"WIZARD",shouldFetchNsId:!0,modalSessionId:null!=r?r:void 0}))throw new Error("Tiburon UI must be allowed")},i=function(e){var n;if(n=o.extract_errors(e.responseText),n!==!1)return"string"==typeof n?t.error(n):"function"==typeof s?s(n):void 0},E.TRUELINK_UI[e.id]?l():(a=new w(e),a.validate_shareable_existing_sf_path(n,l,i))},k=function(t,n,s){return null!=s&&C.log(t.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),v.showInstance(e.createElement(I,{user:t,onBack:n,onSubmit:function(e,n){var r;return r=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],null!=s&&C.log(t.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:s}),n.apply(null,e)},null!=s&&C.log(t.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),T(t,e,r)}}))},M=function(t){var n,r,o;if(m.get_for_user(t).verified_or_show(s.SHARE_FOLDER))return o=P(),C.log(t.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:o}),n=l.EXP_SUBGROWTH_PRO_OQ_CREATE_SF,r=(function(){switch(n){case"V1":return _;case"V2":return f;case"V3":return g;case"V4":return y;case"V5":return b;default:return S}})(),v.showInstance(e.createElement(r,{user:t,onSubmit:function(e){return null!=o&&C.log(t.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:e,modalSessionId:o}),"new-folder"===e?N(t,o,t.cdm_tmf_path):"existing-folder"===e?k(t,M.bind(this,t,o),o):void 0},expProOQCreateSFVariant:n}))},{shareExistingFolder:T,showShareAFolderWizardModal:M}}),define("modules/clean/teams/admin/api/admin_console_api_client",["require","exports","modules/clean/api_v2/client","modules/clean/filepath","modules/clean/viewer"],function(e,t,n,s,r){"use strict";var o=(function(){function e(e){void 0===e&&(e=!1);var t=r.get_viewer();t.work_user&&(this.teamMemberId=t.work_user.team_member_id),this.userId=t.get_uid_by_role("work"),this.rpcClient=new n.TeamActionsClient,this.isCMForCDM=e}return e.prototype.setPermanentDeletePolicy=function(e){var t={permanent_delete_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_permanent_delete_policy",t)},e.prototype.setMultipleAccountsPolicy=function(e){var t={multiple_accounts_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_multiple_accounts_policy",t)},e.prototype.setFileRequestPolicy=function(e){var t={file_request_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_file_request_policy",t)},e.prototype.setOfficeAddInPolicy=function(e){var t={office_addin_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_office_addin_policy",t)},e.prototype.setSharedLinkPolicy=function(e,t){var n={sharing_outside_enabled:e};1==e&&(n.default_visibility=t);return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_link_policy",n)},e.prototype.setSharedFolderSharingPolicy=function(e){var t={sharing_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_sharing_policy",t)},e.prototype.setSharedFolderJoiningPolicy=function(e){var t={joining_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_joining_policy",t)},e.prototype.setCommentingPolicy=function(e){var t={commenting_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_commenting_policy",t)},e.prototype.setPasswordStrength=function(e,t){var n="enabled"===e?t:"minimal_requirements",s={password_strength_policy:n};return this.rpcClient.rpc(this.userId,"team/set_password_requirements",s)},e.prototype.resetAllPasswords=function(){return this.rpcClient.rpc(this.userId,"team/reset_all_passwords")},e.prototype.setPaperPolicy=function(e,t,n,s){var r={paper_enabled:e};t&&(r.dropbox_terms="agree");var o={paper_deployment_type:n,enabled_members_update:{users_to_add:this.make_user_selector_list(s.users_to_add),users_to_remove:this.make_user_selector_list(s.users_to_remove)}};r.paper_deployment_mode=o;return this.rpcClient.rpc(this.userId,"team/paper/set_paper_policy",r)},e.prototype.setPaperSharingPolicy=function(e,t){var n={external_sharing_allowed:void 0===e||e,default_visibility:t};return this.rpcClient.rpc(this.userId,"team/paper/set_paper_sharing_policy",n)},e.prototype.setRequestMembershipPolicy=function(e){var t={request_membership:e};return this.rpcClient.rpc(this.userId,"team/set_request_membership_policy",t)},e.prototype.setSuggestMembersPolicy=function(e){var t={suggest_members_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_suggest_members_policy",t)},e.prototype.deviceManagementGetExcludedUsers=function(){return this.rpcClient.rpc(this.userId,"team/device_management/get_excluded_users",null)},e.prototype.deviceManagementUpdateExcludedUsers=function(e,t){var n={users_to_add:e,users_to_remove:t};return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",n)},e.prototype.deviceManagementConfigureSettings=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.mapValueToRolloutMethod=function(e){return 0===e?"unlink_all":1===e?"unlink_most_inactive":"add_member_to_exceptions"},e.prototype.deviceManagementConfigureSettingsForAcf=function(t,n,s,r,o){var i={is_enabled:!0,can_user_remove_device:n,rollout_method:{".tag":e.mapValueToRolloutMethod(o)},users_to_add:t.users_to_add,users_to_remove:t.users_to_remove};i.desktop_devices_limit=s==-1?{".tag":"unlimited"}:{limited:Number(s),".tag":"limited"},i.mobile_devices_limit=r==-1?{".tag":"unlimited"}:{limited:Number(r),".tag":"limited"};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",i)},e.prototype.deviceManagementExclusionList=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",e)},e.prototype.deviceManagementConfigureSettingsDisable=function(){var e={is_enabled:!1};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.prototype.deviceManagementRemoveDevice=function(e,t,n){var s={user_id:e,device_id:t,delete_data:n};return this.rpcClient.rpc(this.userId,"team/device_management/remove_device",s)},e.prototype.deviceManagementRemoveClient=function(e,t,n,s){var r={user_id:e,device_id:t,client_unique_identifier:n,delete_data:s};return this.rpcClient.rpc(this.userId,"team/device_management/remove_client",r)},e.prototype.webSessionManagementConfigureSettings=function(e,t){var n={remember_session_expires:e,idle_session_timeout:t};return this.rpcClient.rpc(this.userId,"team/web_session_management/configure_settings",n)},e.prototype.teamFolderArchive=function(e,t){void 0===t&&(t=!1);var n={team_folder_id:String(e),force_async_off:!t};return this.rpcClient.rpc(this.userId,"team/team_folder/archive",n)},e.prototype.teamFolderUnarchive=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/activate",t)},e.prototype.teamFolderCreate=function(e){var t={name:e};return this.rpcClient.rpc(this.userId,"team/team_folder/create",t)},e.prototype.teamFoldersList=function(e){void 0===e&&(e=1e3);var t={limit:e};return this.rpcClient.rpc(this.userId,"team/team_folder/list",t)},e.prototype.teamFolderRename=function(e,t){var n={team_folder_id:String(e),name:t};return this.rpcClient.rpc(this.userId,"team/team_folder/rename",n)},e.prototype.teamFolderPermanentlyDelete=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/permanently_delete",t)},e.prototype.setGroupsCreationPolicy=function(e){var t={group_creation:e};return this.rpcClient.rpc(this.userId,"team/groups/set_creation_policy",t)},e.prototype.setNTSBlockTrafficPolicy=function(e){var t={block_traffic_enabled:e};return this.rpcClient.rpc(this.userId,"team/nts/set_block_traffic_policy",t)},e.prototype.configureSso=function(e,t,n,s,r){var o={sso_policy:e,saml_cert:t,sign_in_url:n,sign_out_url:s,nameid_format:r};return this.rpcClient.rpc(this.userId,"team/configure_sso",o)},e.prototype.configureGoogleLoginPolicy=function(e){var t={google_login_enabled:e};return this.rpcClient.rpc(this.userId,"team/configure_google_login_policy",t)},e.prototype.setResellerSupportSetting=function(e){var t={reseller_support_enabled:e};return this.rpcClient.rpc(this.userId,"team/change_reseller_support",t)},e.prototype.folderCreate=function(e,t,n){"/"!=t&&(t+="/");var s="ns:"+e+t+n,r={path:s},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/create_folder",r,o)},e.prototype.confidentialFolderCreate=function(e,t,n){"/"!=t&&(t+="/");var s="ns:"+e+t+n,r={path:s,confidentiality:"confidential"},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/share_folder_internal",r,o)},e.prototype.bulkFileDelete=function(e){for(var t=[],n=null,s=0,r=e.length;s<r;s++)n=e[s],t.push({path:"ns:"+n.ns_id+n.ns_path});var o={entries:t},i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/delete_batch_with_changeset_sync",o,i)},e.prototype.fileRename=function(e,t,n){var s="ns:"+e+t,r=t.substring(0,t.lastIndexOf("/"))+"/"+n,o="ns:"+e+r,i={from_path:s,to_path:o,autorename:!0},a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move",i,a)},e.prototype.shareFolder=function(e,t,n){void 0===n&&(n=null);var s="ns:"+e+t,r={path:s};if(n)for(var o=0;o<n._keys.length;++o){var i=n._keys[o],a=n[i];"resolved_member_policy"!=i&&a&&(r[i]={".tag":a})}var l={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/share_folder",r,l)},e.prototype.validateFolderPath=function(e,t,n,s){var r="ns:"+e+t,o={path:r,actions:n,list_members_arg:s},i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/validate_folder_path",o,i)},e.prototype.restoreFile=function(e,t,n){var s="ns:"+e+t,r={path:s,rev:n},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/restore",r,o)},e.prototype.permanentDeleteFile=function(e,t){var n="ns:"+e+t,s={path:n},r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/permanently_delete",s,r)},e.prototype.listRevisions=function(e,t){var n="ns:"+e+t,s={path:n},r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/list_revisions",s,r)},e.prototype.setTSDWritePolicy=function(e){var t={is_writable:e};return this.rpcClient.rpc(this.userId,"team/team_folder/set_tsd_writable_setting",t)},e.prototype.setInfinitePolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_infinite_policy",t)},e.prototype.getTeamFolderNsPathForFile=function(e){return this.isCMForCDM?e.fq_path:"/"+e.fq_path.split("/").slice(2).join("/")},e.prototype.bulkFileMove=function(e,t,n){for(var r,o,i=[],a=null,l=0,d=t.length;l<d;l++)r=t[l],a=this.getTeamFolderNsPathForFile(r),o=s.filename(r.fq_path),i.push({from_path:"ns:"+e+a,to_path:"ns:"+e+n+"/"+o});var c={entries:i,autorename:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move_batch_sync",c,p)},e.prototype.bulkFileCopy=function(e,t,n){for(var r,o,i=[],a=null,l=0,d=t.length;l<d;l++)r=t[l],a=this.getTeamFolderNsPathForFile(r),o=s.filename(r.fq_path),i.push({from_path:"ns:"+e+a,to_path:"ns:"+e+n+"/"+o});var c={entries:i,autorename:!0,allow_shared_folder:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/copy_batch_sync",c,p)},e.prototype.setMemberSpaceLimits=function(e){var t={limit_level:e};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_default_limit",t)},e.prototype._create_user_selector_json=function(e){return{".tag":"email",email:e}},e.prototype.make_user_selector_list=function(e){return void 0===e&&(e=[]),e.map(this._create_user_selector_json)},e.prototype.memberSpaceLimitsUpdateExclusionList=function(e){var t=this.make_user_selector_list(e.users_to_add),n=this.make_user_selector_list(e.users_to_remove);return this.rpcClient.rpc(this.userId,"team/member_space_limits/update_excluded_users",{users_to_add:t,users_to_remove:n})},e.prototype.listAllMembers=function(e,t){void 0===t&&(t=null);var n={shared_folder_id:String(e)};t&&(n.path=t);var s={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/list_all_members",n,s)},e.prototype.teamFolderGetAccessPoints=function(e,t,n){var s={dropbox_id:e,team_folder_id:String(t),path:n};return this.rpcClient.rpc(this.userId,"team/team_folder/get_access_points",s)},e.prototype.teamFolderGetFileMetadata=function(e,t){void 0===t&&(t=null);var n={team_folder_id:String(e)};return t&&(n.path=t),this.rpcClient.rpc(this.userId,"team/team_folder/get_file_metadata",n)},e.prototype.getUserInfos=function(e){var t={account_ids:e},n={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"users/get_account_batch",t,n)},e.prototype.emmConfigureSettings=function(e,t){var n=this,s={};["users_to_add","users_to_remove"].forEach(function(e){return s[e]=n.make_user_selector_list(t[e])});var r={emm_policy:{".tag":e},exclusion_list:s};return this.rpcClient.rpc(this.userId,"team/emm/configure_settings",r)},e.prototype.emmRefreshToken=function(){return this.rpcClient.rpc(this.userId,"team/emm/refresh_token")},e.prototype.emmGenerateUsageReport=function(){var e={report_type:"mobile_app_usage"};return this.rpcClient.rpc(this.userId,"team/emm/generate_report",e)},e})();t.AdminConsoleApiClient=o,Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}),define("modules/clean/teams/membership_discovery_util",["modules/clean/ajax","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,s,r,o){var i,a,l,d,c,p,u,h,m;return i=t.TRADEMARK_BUSINESS,a=s._,m=s.ungettext,d=function(t,n){return e.WebRequest({url:"/team/discover/get_discoverable_team_for_folder",type:"POST",data:{ns_id:t},success:function(e){return e=JSON.parse(e),n(null!=e?e.team:void 0)},error:function(){return n()}})},u=function(t,s){return e.WebRequest({url:"/team/discover/join_ajax",data:{team_id:t,cont:"#"},success:function(e){switch(e=JSON.parse(e),null!=e?e.result:void 0){case"request_sent":r.success(a("Request to join sent."));break;case"can_join":n.redirect(e.url);break;case"max_team_size_achieved":r.error(a("This team has reached the maximum size. Please ask the admins of this team to upgrade to %(trademark_business)s, which allows teams to add as many members as possible.").format({trademark_business:i}));break;case"pending_approval":r.success(a("Your request to join is pending."));break;default:r.error(a("Invalid request"))}return"function"==typeof s?s(e):void 0},error:function(){return r.error(a("Error sending request.")),"function"==typeof s?s():void 0}})},p=function(t,n,s){return e.WebRequest({url:"/account/team/add_users",subject_user:n,data:{emails:t,team_id:s},success:function(e){var t;if(e=JSON.parse(e),e.num_invited)return t=m("Invitation sent.","Invitations sent.",e.num_invited),r.success(t)},error:function(){var e;return e=m("Error sending invitation.","Error sending invitations.",t.length),r.error(e)}})},c=function(t,s,i){return e.WebRequest({url:"/account/team/add_users",subject_user:s,data:{emails:t,team_id:i},success:function(e){var t;if(e=JSON.parse(e),e.num_invited)return t=m("Invitation sent.","Invitations sent.",e.num_invited),r.success(t)},error:function(){return h(t,function(){return n.redirect(new o({path:"/team/admin/requests",query:{invite_emails:t}}))})}})},h=function(t,n,s){return e.WebRequest({url:"/team/discover/suggest_ajax",data:{emails:JSON.stringify(t)},success:function(e){var s;return s=m("Suggestion sent.","Suggestions sent.",t.length),r.success(s),"function"==typeof n?n(e):void 0},error:function(){var e;return e=m("Error sending suggestion.","Error sending suggestions.",t.length),r.error(e),"function"==typeof s?s():void 0}})},l=function(t,n,s){return e.WebRequest({url:"/team/discover/filter_suggestable_ajax",type:"POST",data:{emails:JSON.stringify(t)},success:function(e){return e=JSON.parse(e),"function"==typeof n?n(e):void 0},error:function(){return"function"==typeof s?s():void 0}})},{getDiscoverableTeamForFolder:d,sendAdminTeamInvitations:c,sendTeamRequest:u,sendLimitedTeamInvitations:p,sendTeamSuggestions:h,filterSuggestableUsers:l}}),define("modules/clean/teams/modals/create_team_prompt_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/analytics","modules/clean/react/button","modules/clean/react/image","modules/clean/react/modal","modules/clean/static_urls","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,s,r,o,i,a,l,d,c,p,u){"use strict";var h;(function(e){e[e.CLICK_CREATE=0]="CLICK_CREATE",e[e.DISMISS=1]="DISMISS",e[e.CLICK_NEXT_TIME=2]="CLICK_NEXT_TIME"})(h||(h={}));var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCreate=function(){var e=t.props.invitedMembers.map(function(e){return e.email}).filter(function(e){return"string"==typeof e&&""!==e}),n=new u({path:"/team",query:{tk:"tib_upsell",invite_members:e.join(",")}});c.redirect(n.toString()),t.logClick(h.CLICK_CREATE)},t.onClickNextTime=function(){l.Modal.close(),t.logClick(h.CLICK_NEXT_TIME)},t.onDismiss=function(){r.WebRequest({url:"/team/stop_show_create_team_modal"}),t.logClick(h.DISMISS)},t}return n.__extends(t,e),t.prototype.logClick=function(e){o.TeamsWebActionsLogger.log("share_crt_team_modal",{num_shared:this.props.invitedMembers.length,clicked_create:e===h.CLICK_CREATE,clicked_nxt_time:e===h.CLICK_NEXT_TIME,dismissed:e===h.DISMISS})},t.prototype.renderButtons=function(){return s.createElement("div",{className:"db-modal-buttons"},s.createElement(i.Button,{className:"dbmodal-button",importance:"primary",onClick:this.onClickCreate},p._("Create free work Dropbox")),s.createElement(i.Button,{className:"dbmodal-button",importance:"tertiary",onClick:this.onClickNextTime},p._("Ask me next time")))},t.prototype.render=function(){for(var e=[],t=0,n=this.props.invitedMembers;t<n.length;t++){var r=n[t];r.name&&r.name!==r.email&&e.push(r.name)}var o=p._("Work with these people often?");return 2===e.length&&2===this.props.invitedMembers.length?o=p._("Work with %(firstname_1)s and %(firstname_2)s often?").format({firstname_1:e[0],firstname_2:e[1]}):3===e.length&&3===this.props.invitedMembers.length&&(o=p._("Work with %(firstname_1)s, %(firstname_2)s, and %(firstname_3)s often?").format({firstname_1:e[0],firstname_2:e[1],firstname_3:e[2]})),s.createElement(l.Modal,{style:"clean",className:"create-team-modal-after-sharing",buttonComponent:this.renderButtons(),onDismiss:this.onDismiss,clickOutToClose:!1,showX:!0,width:500},s.createElement("div",null,s.createElement(a,{className:"create-team-modal__team-illo u-mar-top-l",alt:p._("Work together"),src:d.static_url("/static/images/teams/modals/illo_how-create-vfl99WbqQ.png"),srcHiRes:d.static_url("/static/images/teams/modals/illo_how-create@2x-vflvsB25f.png")}),s.createElement("h1",{className:"create-team-modal__header u-mar-top-m u-mar-bottom-s"},o),s.createElement("div",{className:"create-team-modal__subheader"},p._("Get a free 2 GB work Dropbox to organize projects in one place,               collaborate from anywhere, and stay in sync."))))},t})(s.Component);t.CreateTeamPromptModal=m});
//# sourceMappingURL=pkg-maestro-sharing.min.js-vflzlTV6W.map