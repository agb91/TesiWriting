var bind=function(e,t){return function(){return e.apply(t,arguments)}};define(["jquery","modules/clean/comments/models/preview_types","external/eventemitter3","modules/clean/react/previews/frame_messenger_host"],function(e,t,n,r){var i;return i=r.PreviewFrameMessengerHost,(function(){function r(e,r,i){switch(this._handleMessageFromWindow=bind(this._handleMessageFromWindow,this),this._handleMessageFromChild=bind(this._handleMessageFromChild,this),this._prepareImageInterface=bind(this._prepareImageInterface,this),this._preparePdfJsInterface=bind(this._preparePdfJsInterface,this),this.dispatchEvent=bind(this.dispatchEvent,this),this._notifyEventsTriggered=bind(this._notifyEventsTriggered,this),this.registerEventsCallbacks=bind(this.registerEventsCallbacks,this),this._eventsHandler=null,this._eventEmitter=new n,this._previewType=r,this._previewSelector=i,this._previewType){case t.PDFJS:this._preparePdfJsInterface(e);break;case t.IMAGE:this._prepareImageInterface()}}return r.prototype.registerEventsCallbacks=function(e){return this._eventsHandler=e},r.prototype._notifyEventsTriggered=function(e,t){return"function"==typeof this._eventsHandler?this._eventsHandler(e,t):void 0},r.prototype.addListener=function(e,t){return this._eventEmitter.on(e,t)},r.prototype.removeListener=function(e,t){return this._eventEmitter.off(e,t)},r.prototype.once=function(e,t){return this._eventEmitter.once(e,t)},r.prototype.on=r.prototype.addListener,r.prototype.off=r.prototype.removeListener,r.prototype.dispatchEvent=function(e,n){switch(this._previewType){case t.PDFJS:return this._frameMessenger.postMessageToChildren(e,n);case t.IMAGE:return window.postMessage(JSON.stringify({action:e,parameters:n}),"*")}},r.prototype.destroy=function(){var e;switch(this._eventEmitter.removeAllListeners(),this._eventsHandler=null,this._previewType){case t.PDFJS:return null!=(e=this._frameMessenger)?e.stopListening():void 0;case t.IMAGE:return window.removeEventListener("message",this._handleMessageFromWindow)}},r.prototype._preparePdfJsInterface=function(t){return this._frameMessenger=new i,this._frameMessenger.configureChildMessaging(this._getIframeQuery(),e.proxy(this._handleMessageFromChild,this),["annotation-hidden","annotation-placed","annotation-start-drag","annotation-end-drag","annotation-ui-enter","annotation-ui-over","annotation-ui-leave","annotation-ui-click","annotation-enter","annotation-leave","page-rendered","scroll","scale-change","on-keydown","mouse-up"]),this._frameMessenger.startListening()},r.prototype._prepareImageInterface=function(){return window.addEventListener("message",this._handleMessageFromWindow)},r.prototype._getIframeQuery=function(){return"#pdf-embed-iframe"},r.prototype._handleMessageFromChild=function(e){return this._eventEmitter.emit(e.action,e.parameters),"function"==typeof this._notifyEventsTriggered?this._notifyEventsTriggered(e.action,e.parameters):void 0},r.prototype._handleMessageFromWindow=function(e){var t;try{t=JSON.parse(e.data)}catch(e){return void e}return this._eventEmitter.emit(t.action,t.parameters),"function"==typeof this._notifyEventsTriggered?this._notifyEventsTriggered(t.action,t.parameters):void 0},r})()});
//# sourceMappingURL=file_viewer_interface_controller.min.js-vfluNtUW_.map