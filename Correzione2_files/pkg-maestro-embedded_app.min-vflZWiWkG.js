define("modules/clean/appshell/pagelet_init_hooks",["require","exports","modules/core/notify","modules/clean/web_user_action_logger","modules/core/i18n"],function(e,t,r,s,n){"use strict";function o(){window.ensemble&&window.ensemble.switchedAccounts&&(r.success(n._("You have switched to your %(account_name)s account.").format({account_name:window.ensemble.viewer.getActiveUser().displayName})),s.WebUserActionLog.log(window.ensemble.viewer.getActiveUser().userId,s.WebUserActionLogEvents.SWITCH_ACCOUNT,{}))}t.initialize_module=o}),define("modules/clean/history",["external/underscore","modules/core/exception","modules/core/uri"],function(e,t,r){var assert;return assert=t.assert,(function(){var t,s,n,o,i,a,c,l,u,_,h,d,p,E,S,m,f;return t=new RegExp("#|;|\\?|:|@|&|=|\\+|\\$"),p=function(){var e,s;return void 0,e=window.location.pathname,s=window.location.search,e.search(t)!==-1&&(e=String(r({path:e}))),e+s},i=function(e,t){return String(r.parse(e).setQuery(t))},a=function(e){var t;return null==e&&(e=p()),t=e.split("?"),{url:e,path:t[0],qargs:r.parse(e).getQuery()}},c={},l={},E=p(),f=null,s="",d=function(e){return s+"/"+e.substring(s.length).split("/")[1]},m=function(e){return s=e},u=function(e){var t,r,s,n,o,i,c,l,u;if(u=E,l=a(u),o=d(l.path),o in e){for(n=l.path.substr(o.length+1),i=e[o],c=[],r=0,s=i.length;r<s;r++)t=i[r],c.push(t(n,l.qargs));return c}},_=function(){return u(c)},h=function(){return u(l)},S=function(e,t,r){var s;if(r[e])return s=r[e].indexOf(t),r[e].splice(s,1)},n=function(e,t){var r,s;if(s=d(e),r=d(t),s!==r)return h()},o=function(){var e;if(e=p(),e!==E)return n(E,e),E=e,_()},{init:function(){if(!f)return E=p(),f=setInterval(o,50)},_add_callback:function(e,t,r){return this.init(),assert("string"==typeof e,"DBHistory prefix is not a string"),assert(0===e.indexOf("/"),"DBHistory prefix must be absolute"),assert(e.substring(s.length).indexOf("/",1)===-1,"multi-component prefixes arent supported"),r[e]||(r[e]=[]),r[e].push(t)},add_callback:function(e,t,r){if(null==r&&(r=!1),this._add_callback(e,t,c),!r)return _()},remove_callback:function(e,t){return S(e,t,c)},remove_exit_callback:function(e,t){return S(e,t,l)},add_exit_callback:function(e,t){return this._add_callback(e,t,l)},fire_callbacks:function(){return _()},fire_exit_callbacks:function(){return h()},_build_url_for_state_change:function(e,t){return assert("string"==typeof e,"DBHistory path is not a string"),assert(0===e.indexOf("/"),"DBHistory path must be absolute"),assert(e.indexOf("//")===-1,"DBHistory path contains //"),i(e,t)},_pre_state_change:function(e){return e!==E&&(n(E,e),!0)},_post_state_change:function(e){if(null==e&&(e=!0),E=p(),e)return _()},replace_state:function(e,t){var r;if(r=this._build_url_for_state_change(e,t),this._pre_state_change(r)&&window.history.replaceState)return window.history.replaceState(null,null,r),this._post_state_change()},push_state:function(t,r,s){var n;if(null==s&&(s={}),s=e.defaults(s,{immediatelyRestoreState:!0}),assert(t.indexOf("?")===-1,"DBHistory path contains ?"),assert(t.indexOf("#")===-1,"DBHistory path contains #"),n=this._build_url_for_state_change(t,r),this._pre_state_change(n))return window.history.pushState(null,null,n),this._post_state_change(s.immediatelyRestoreState)},update_query_param:function(e,t){var r;return r=this.deconstruct_url(),r.qargs[e]=t,this.replace_state(r.path,r.qargs)},remove_query_param:function(e){var t;return t=this.deconstruct_url(),delete t.qargs[e],this.replace_state(t.path,t.qargs)},get_url:p,construct_url:i,deconstruct_url:a,set_base_prefix:m,URL_ESCAPE_REGEX:t}})()});var slice=[].slice,hasProp={}.hasOwnProperty;define("modules/clean/react/selectable_list",["jquery","external/underscore","external/react","external/react-dom","external/immutable","external/keymaster","modules/clean/keycode","modules/clean/react/outside_event","modules/core/browser","modules/core/exception","modules/clean/react/helpers"],function(e,t,r,s,n,o,i,a,c,l,u){var _,h,d,p,E,S,m,assert,f,g,T,R;return i.KeyCode,m=a.addOutsideEventHandling,assert=l.assert,R=u.shallowCompareStateAndProps,p="",S=n.Record({selected:new n.OrderedSet,anchor:null}),g=function(e,t){return null==e&&(e=[]),null==t&&(t=null),new S({selected:new n.OrderedSet(e),anchor:t||e[0]})},d="up",h="down",T=function(e){return c.mac&&e.metaKey||!c.mac&&e.ctrlKey},function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],function(){var r,s,n,o;for(o=[],s=0,n=e.length;s<n;s++)r=e[s],t.isFunction(r)&&o.push(r.apply(this,arguments));return o}},E={onMouseEnter:"handleMouseEnterRow",onMouseDown:"handleMouseDownInRow",onMouseUp:"handleMouseUpInRow",onToggleRowSelected:"handleToggleRowSelected",onFocus:"handleInitialTab"},_={onMouseDown:"handleMouseDownInCheckbox",onToggleRowSelected:"handleToggleRowSelected",onMouseEnter:"noop",onMouseUp:"noop"},function(){var e;return"INPUT"===(e=document.activeElement.tagName)||"TEXTAREA"===e||"SELECT"===e||"BUTTON"===e},f=function(i,a){var l,u;return u=null!=(l=(null!=a?a:{}).shouldComponentUpdate)?l:R,i=m(i,"mouseup","onMouseUp","onOutsideMouseUp"),r.createClass({displayName:"Selectable"+i.displayName,propTypes:{allItemIds:r.PropTypes.instanceOf(n.List),onSelectionChange:r.PropTypes.func,selection:r.PropTypes.instanceOf(S),defaultSelection:r.PropTypes.instanceOf(S),keyScope:r.PropTypes.string,linkedOutsideClasses:r.PropTypes.array,addTabbingClassWhenKeyboardNavigating:r.PropTypes.bool,isCheckboxes:r.PropTypes.bool},getDefaultProps:function(){return{onSelectionChange:t.noop,selection:null,defaultSelection:new S,keyScope:"SelectableList",linkedOutsideClasses:[],addTabbingClassWhenKeyboardNavigating:!0}},getInitialState:function(){return{selection:this.props.defaultSelection}},componentWillMount:function(){return this._focusedItem=null,this._handlerCache={},this._isFocused=!1,this._keepFocusOnToggle=!1,this._mostRecentMousedownTarget=null,this._isSelecting=!1},componentDidMount:function(){return this._setupKeyboardShortcuts(),this._focusItem(this._selection().anchor),e(s.findDOMNode(this)).on("focusin.SelectableList",this.getFocusHandler(!0)).on("focusout.SelectableList",this.getFocusHandler(!1))},shouldComponentUpdate:u,componentDidUpdate:function(e,t){var r,s;if((null!=(r=e.selection)?r.anchor:void 0)!==(null!=(s=this.props.selection)?s.anchor:void 0)&&this._selection().selected.size&&(this._focusedItem=this._selection().anchor),this._focusedItem)return this._focusItem(this._focusedItem),this._focusedItem=null},componentWillUnmount:function(){return this._handlerCache=null,p!==this.props.keyScope&&(o.clearScope(this.props.keyScope),o.setScope(p)),e(s.findDOMNode(this)).off(".SelectableList")},getFocusHandler:function(e){return(function(t){return function(){return t._isFocused=e,!0}})(this)},_setupKeyboardShortcuts:function(){var e,t,r,n,i,a,l,u,_;return p=o.getScope(),p!==this.props.keyScope&&o.setScope(this.props.keyScope),a=(function(e){return function(t){return e._isFocused&&"BUTTON"!==t.target.tagName}})(this),i=(function(e){return function(t){return!document.activeElement||document.activeElement===document.body||s.findDOMNode(e).contains(t.target)&&"INPUT"!==t.target.nodeName}})(this),n=function(e,t){return function(r){return e(r)?(r.preventDefault(),t(r)):null}},_=(function(e){return function(){return e._selectNeighboringItem({direction:d})}})(this),r=(function(e){return function(){return e._extendSelectionRange({direction:d})}})(this),u=(function(e){return function(){return e._selectNeighboringItem({direction:h})}})(this),t=(function(e){return function(){return e._extendSelectionRange({direction:h})}})(this),l=(function(e){return function(){return e._selectAllItems()}})(this),e=(function(e){return function(){return e._deselectAllItems()}})(this),o("up",this.props.keyScope,n(i,_)),o("shift+up",this.props.keyScope,n(i,r)),o("down",this.props.keyScope,n(i,u)),o("shift+down",this.props.keyScope,n(i,t)),o("escape",this.props.keyScope,n(i,e)),c.mac?o("command+a",this.props.keyScope,n(a,l)):o("ctrl+a",this.props.keyScope,n(a,l))},_focusItem:function(e){var t;if(t=this.refs[e],t&&!this._keepFocusOnToggle)return s.findDOMNode(t).focus()},_itemIds:function(){var e;return this.props.allItemIds?this.props.allItemIds:(e=[],r.Children.forEach(this.props.children,function(t){var r;return(null!=t&&null!=(r=t.props)?r.selectableListId:void 0)?e.push(t.props.selectableListId):(null!=t?t.key:void 0)?e.push(t.key):void 0}),n.List(e))},_selection:function(){return this.props.selection?this.props.selection:this.state.selection},_updateState:function(e,t){if(null==t&&(t=!1),this._keepFocusOnToggle=t,this.setState({isSelecting:!1}),!n.is(this._selection(),e))return this.props.selection||this.setState({selection:e}),this.props.onSelectionChange(e)},_selectAllItems:function(){return this.setSelectedItems({itemIds:this._itemIds().toArray()})},_deselectAllItems:function(){if(this.setSelectedItems({itemIds:[]}),s.findDOMNode(this).contains(document.activeElement))return document.activeElement.blur()},_toggleItemSelected:function(e){var t,r,s,n,o,i,a,c,l,u,_,h;if(s=e.itemId,a=e.keepFocusOnToggle,h=this._selection(),h.selected.has(s)){for(h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.delete(s)}})(this)),c=null,t=this._itemIds().indexOf(s),r=o=l=t+1,u=this._itemIds().count();l<=u?o<u:o>u;r=l<=u?++o:--o)if(n=this._itemIds().get(r),h.selected.has(n)){c=n;break}if(!c)for(r=i=_=t-1;_<=0?i<=0:i>=0;r=_<=0?++i:--i)if(n=this._itemIds().get(r),h.selected.has(n)){c=n;break}c||(c=this._itemIds().get(0)),h=h.set("anchor",c)}else h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.add(s)}})(this)).set("anchor",s);return this._updateState(h,a)},_selectItemsInRangeTo:function(e){var t,r,s,n,o,i,a,c,l,u,_,h,d;if(i=e.itemId,h=this._selection(),t=null!=(u=h.anchor)?u:this._itemIds().get(0))return r=this._itemIds().indexOf(t),l=this._itemIds().indexOf(i),_=this._rangeOfSelectedBlockSurrounding(t),d=_.startIndex,s=_.endIndex,a=function(){var e,t,r,i;for(r=this._itemIds().toArray(),i=[],o=e=0,t=r.length;e<t;o=++e)n=r[o],d<=o&&o<=s&&i.push(n);return i}.call(this),c=function(){var e,t,s,i;for(s=this._itemIds().toArray(),i=[],o=e=0,t=s.length;e<t;o=++e)n=s[o],(l<=o&&o<=r||r<=o&&o<=l)&&i.push(n);return i}.call(this),l<r&&c.reverse(),h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.subtract(a).union(c)}})(this)),this._updateState(h)},_selectNeighboringItem:function(t){var r,s,n,o;if(r=t.direction,n=this._itemIds().indexOf(this._selection().selected.last()),s=0,r===d?s=Math.max(0,n-1):r===h&&(s=Math.min(this._itemIds().count()-1,n+1)),o=this._itemIds().get(s),this._focusedItem=o,this.setSelectedItems({itemIds:[o]}),this.props.addTabbingClassWhenKeyboardNavigating)return e(document.body).addClass("tabbing")},_extendSelectionRange:function(t){var r,s,n,o,i,a,c,l,u;if(n=t.direction,l=i=this._selection(),r=null!=(a=l.anchor)?a:this._itemIds().get(0))return s=this._itemIds().indexOf(r),c=this._rangeOfSelectedBlockSurrounding(r),u=c.startIndex,o=c.endIndex,this.setState({isSelecting:!0}),n===d?s===o?u-1>=0&&(l=l.update("selected",(function(e){return function(t){return t.add(e._itemIds().get(u-1))}})(this))):l=l.update("selected",(function(e){return function(t){return t.delete(e._itemIds().get(o))}})(this)):n===h&&(s===u||s!==o?o+1<this._itemIds().count()&&(l=l.update("selected",(function(e){return function(t){return t.add(e._itemIds().get(o+1))}})(this))):l=l.update("selected",(function(e){return function(t){return t.delete(e._itemIds().get(u))}})(this))),l!==i&&(this._focusedItem=l.selected.last(),this._updateState(l)),this.props.addTabbingClassWhenKeyboardNavigating?e(document.body).addClass("tabbing"):void 0},_rangeOfSelectedBlockSurrounding:function(e){var t,r,s,n;for(r=this._itemIds().indexOf(e);;)if(n=r,r-=1,r<0||!this._selection().selected.has(this._itemIds().get(r)))break;for(r=n;;){if(s=this._itemIds().get(r),null==s||!this._selection().selected.has(s))break;t=r,r+=1}return{startIndex:n,endIndex:t}},setSelectedItems:function(e){var t,r,s;return r=e.itemIds,this.setState({isSelecting:!0}),s=this._selection().set("selected",n.OrderedSet(r)),t=r.length>0?r[0]:this._itemIds().get(0),this._updateState(s.set("anchor",t))},handleMouseEnterRow:function(e,t){if(this._isSelecting)return this._selectItemsInRangeTo({itemId:e})},handleMouseDownInRow:function(e,t){return 2===t.button?void(this._selection().selected.has(e)||this.setSelectedItems({itemIds:[e]})):t.shiftKey?void this._selectItemsInRangeTo({itemId:e}):T(t)?void this._toggleItemSelected({itemId:e}):(this._selection().selected.has(e)||(this.setSelectedItems({itemIds:[e]}),this._isSelecting=!0),this._mostRecentMousedownTarget=e)},handleMouseUpInRow:function(e,t,r){return e===this._mostRecentMousedownTarget&&this.setSelectedItems({itemIds:[e]}),this._isSelecting=!1},handleInitialTab:function(e){if(this._itemIds().first()===e&&!this._selection().selected.has(e)&&!this.state.isSelecting)return this.setSelectedItems({itemIds:[e]})},handleToggleRowSelected:function(e,t){return(null!=t?t.shiftKey:void 0)?void this._selectItemsInRangeTo({itemId:e}):this._toggleItemSelected({itemId:e,keepFocusOnToggle:!0})},handleOutsideMouseUp:function(t){var r;if(this._isSelecting=!1,this._mostRecentMousedownTarget=null,r=s.findDOMNode(this),!r.contains(t.target)&&!e(t.target).closest(this.props.linkedOutsideClasses.join()).length&&!this._mostRecentMousedownTarget)return this._deselectAllItems()},handleMouseDownInCheckbox:function(e,t){return t.shiftKey?void this._selectItemsInRangeTo({itemId:e}):this._toggleItemSelected({itemId:e})},noop:function(e,t){},render:function(){var e,s,n,o;return s=this._handlerCache,this._handlerCache={},e=r.Children.map(this.props.children,(function(e){return function(n){var o,i,a,c,l,u,h,d,p;if(!(null!=n&&null!=(h=n.props)?h.selectableListId:void 0)&&!(null!=n?n.key:void 0))return n;u=null!=(d=null!=n&&null!=(p=n.props)?p.selectableListId:void 0)?d:n.key,c={},l=e.props.isCheckboxes?_:E;for(a in l)hasProp.call(l,a)&&(i=l[a],assert(!n.props[a],"SelectableList does not support children having seperate "+a+" listeners"),o=a+u,c[a]=s[o]||e[i].bind(e,u),e._handlerCache[o]=c[a]);return r.cloneElement(n,t.extend(c,{ref:u,isSelected:e._selection().selected.has(u)}))}})(this)),n=Object.keys(this.constructor.propTypes),o=t.extend({},t.omit(this.props,n),{selection:this._selection(),onOutsideMouseUp:this.props.isCheckboxes?t.noop():this.handleOutsideMouseUp}),r.createElement(i,o,e)}})},{createSelectableList:f,createSelection:g}}),define("modules/clean/react/outside_event",["external/react","external/underscore","modules/clean/react/util"],function(e,t,r){var s,n,o,i,a;return a=r.mergeProps,i=e.createElement,e.DOM,o=function(r,s,n,o){var c,l,u;return c=null!=(u=r.displayName)?u:"UnnamedComponent",e.createClass({displayName:"Outside"+s+"Handled"+c,propTypes:(l={},l[""+n]=e.PropTypes.func,l[""+o]=e.PropTypes.func,l),componentDidMount:function(){return document.addEventListener(s,this._handleOutsideEvent,!1)},componentWillUnmount:function(){return document.removeEventListener(s,this._handleOutsideEvent,!1)},render:function(){var e,s;return s=a(t.omit(this.props,n,o,"children"),(e={},e[""+n]=this._handleInsideEvent,e)),i(r,s,this.props.children)},_handleOutsideEvent:function(e){var t;return"function"==typeof(t=this.props)[o]?t[o](e):void 0},_handleInsideEvent:function(e){var t,r;return e.stopPropagation(),"function"==typeof(t=e.nativeEvent).stopImmediatePropagation&&t.stopImmediatePropagation(),"function"==typeof(r=this.props)[n]?r[n](e):void 0}})},s=o("div","click","onClick","onOutsideClick"),n=o("div","mousedown","onMouseDown","onOutsideMouseDown"),{OutsideClickHandler:s,OutsideMouseDownHandler:n,addOutsideEventHandling:o}}),define("modules/clean/profiling",["jquery","external/react","modules/clean/ajax","modules/clean/web_timing_logger"],function(e,t,r,s){var n,o,i;return n=t.DOM,i=t.createClass({render:function(){return n.div({},"Hello!")},componentDidMount:function(){return s.mark_time_to_interactive()}}),o=function(){return r.WebRequest({url:"/profiling/ajax",success:function(t){return e("#profiling-container").text(t),s.mark_time_to_interactive()}})},{hello_component:i,get_profiling_ajax_content:o}}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,t){"use strict";(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.ACCOUNT_MENU=3]="ACCOUNT_MENU",e[e.MAIN_CONTENT=4]="MAIN_CONTENT",e[e.SIDE_BAR=5]="SIDE_BAR"})(t.LAYOUT_TAB_ORDER||(t.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/icon_definitions",["require","exports","external/react"],function(e,t,r){"use strict";t.ICONS={bell:{viewBox:"0 0 32 32",el:r.createElement("path",{d:"M17 9.056c2.64.308 4.16 1.872 4.725 4.247.218.913.268 1.652.272 2.918l.003.342c-.003.14.02.305.071.49.113.415.351.894.677 1.391a9.345 9.345 0 0 0 .847 1.1c.84 1.018.406 2.378-.805 2.67-.325.108-.923.258-1.789.405-.344.058-.702.11-1.076.156a4.001 4.001 0 0 1-7.85 0 24.283 24.283 0 0 1-1.083-.158c-.867-.146-1.467-.297-1.73-.386-1.271-.33-1.68-1.661-.819-2.73a9.335 9.335 0 0 0 .809-1.056c.326-.498.564-.976.677-1.392a1.83 1.83 0 0 0 .071-.526c.002-.075.002-.148.003-.309.005-1.266.055-2.003.272-2.915.566-2.375 2.086-3.94 4.725-4.247V8.009a1 1 0 1 1 2 0v1.047zM10.296 20.41s.408-.532.629-.869c.432-.658.758-1.315.934-1.963.097-.358.147-.708.14-1.05.002-.053.003-.13.004-.301.005-1.12.046-1.742.218-2.46.43-1.806 1.5-2.767 3.778-2.767 2.28 0 3.35.961 3.781 2.767.172.719.213 1.343.217 2.462l.003.334c-.006.308.044.658.142 1.016.176.647.502 1.303.933 1.962.377.575.648.893.648.893s-.65.144-1.055.213c-1.304.22-2.862.353-4.669.353-1.806 0-3.366-.133-4.673-.355l-1.03-.235zM17.732 23a2 2 0 0 1-3.464 0h3.464z",style:{fillRule:"evenodd"}})},search:{viewBox:"0 0 24 24",el:r.createElement("path",{d:"M11 16c-2.76 0-5-2.24-5-5s2.24-5 5-5a5.002 5.002 0 0 1 3.737 8.322l2.39 2.392a.99.99 0 0 1-.006 1.407.994.994 0 0 1-1.404.01l-2.598-2.6A4.98 4.98 0 0 1 11 16zm0-1.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z",style:{fillRule:"evenodd"}})}}}),define("modules/clean/react/maestro/svg_icon",["require","exports","external/react","modules/clean/react/maestro/icon_definitions"],function(e,t,r,s){"use strict";t.SvgIcon=function(e){var t=e.name,n=s.ICONS[t],o=n.el,i=n.viewBox;return r.createElement("span",{className:"svg-icon-wrapper"},r.createElement("svg",{className:"svg-icon svg-icon-"+t,viewBox:e.viewBox||i},o))}}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/underscore","external/react","modules/clean/react/maestro/header_base"],function(e,t,r,s,n,o){"use strict";t.MaestroHeaderTitle=o.MaestroHeaderTitle;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.onSelectUser=function(e,t){window.ensemble.switchAccount(t)},t.prototype.render=function(){var e=this.props;return e=s.extend({isPagelet:!0,onSelectUser:this.onSelectUser},e),n.createElement(o.MaestroHeaderBase,r.__assign({},e))},t})(n.Component);t.PageletMaestroHeader=i}),define("modules/clean/react/maestro/header_base",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/image","modules/clean/static_urls","modules/clean/react/maestro/a11y_constants"],function(e,t,r,s,n,o,i,a,c,l){"use strict";var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return s.createElement("header",{className:"maestro-header page-header__shadow"},s.createElement(n.VerticallyFixed,{className:"page-header"},s.createElement("div",{className:"page-header__title",tabIndex:l.LAYOUT_TAB_ORDER.TITLE},this.props.title),s.createElement(i.TopMenuContainer,{user:this.props.user,viewer:this.props.viewer,showSearchBar:this.props.showSearchBar,currentPath:this.props.currentPath,onSearch:this.props.onSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness,onSelectUser:this.props.onSelectUser,isPagelet:this.props.isPagelet})))},t})(s.Component);u.defaultProps={isPagelet:!1,showSearchBar:!0};var _=function(e){var t=e.children;return s.createElement("h1",{className:"page-header__heading"},t)};t.MaestroHeaderTitle=_;var h=function(){return s.createElement("a",{href:"/",className:"page-header__logo"},s.createElement(a,{src:c.static_url("/static/images/header_logo-vflzsBFzu.png"),srcHiRes:c.static_url("/static/images/header_logo@2x-vflt21Kis.png"),alt:"Dropbox"}))};t.MaestroHeaderLogo=h;var d=o(u,["/static/css/maestro_header-vfl-1yEEy.css"]);t.MaestroHeaderBase=d}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants"],function(e,t,r,s,n,o,i){"use strict";function a(e){var t=e.user,a=e.viewer,c=e.titleRegion,l=e.embeddedAppRegion,u=e.actionSidebarRegion,_=e.searchBarProps,h=null;return null!=u&&(h=s.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:i.LAYOUT_TAB_ORDER.SIDE_BAR},s.createElement(o.MaestroSecondarySidebar,null,u))),s.createElement("div",{className:"maestro-chrome"},s.createElement(n.PageletMaestroHeader,r.__assign({user:t,viewer:a,title:c},_||{})),s.createElement("main",{className:"maestro-app"},s.createElement("div",{className:"maestro-app-content",tabIndex:i.LAYOUT_TAB_ORDER.MAIN_CONTENT},l),h))}t.MaestroChrome=a}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/prompt/legacy_ha_wrapper"],function(e,t,r,s,n,o){"use strict";var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return s.createElement(n.VerticallyFixed,{className:"maestro-secondary-sidebar"},this.props.children,s.createElement(o.LegacyHAWrapper,null))},t})(s.Component);t.MaestroSecondarySidebar=i}),define("modules/clean/react/maestro/top_menu_container",["external/classnames","external/underscore","external/react","modules/clean/viewer","modules/clean/react/css","modules/clean/search/search_bar","modules/clean/search/search_helpers","modules/core/browser","modules/core/exception","modules/core/uri","modules/clean/react/browse/models"],function(e,t,r,s,n,o,i,a,c,l,u){var _,h,d,p,E,assert,S,m;return p=o.SearchBar,assert=c.assert,_=u.File,d=u.Paper,m=r.DOM,S=r.createElement,E=r.createClass({displayName:"TopMenuContainer",propTypes:{user:r.PropTypes.object.isRequired,viewer:r.PropTypes.object.isRequired,showSearchBar:r.PropTypes.bool,currentPath:r.PropTypes.string,onSearch:r.PropTypes.func,onCancelSearch:r.PropTypes.func,onFileOrFolderOpen:r.PropTypes.func,limitedTeamBannerUpsell:r.PropTypes.bool,trademarkBusiness:r.PropTypes.string,onSelectUser:r.PropTypes.func.isRequired,isPagelet:r.PropTypes.bool},getDefaultProps:function(){return{showSearchBar:!0,currentPath:"/",isPagelet:!1}},onSearch:function(e,t){var r;if(r=l({path:"/search/"+this.props.user.role}),e)return a.redirect(r.updateQuery({path:this.props.currentPath,query:e,qsid:t}))},onFileOrFolderOpen:function(e){var t,r;return e instanceof _?(i.logSearchAction(e,this.props.user,e.is_dir?"folder_open":"file_view","top-menu-dropdown-view"),e.is_dir?a.open_tab(e.href):(t=e.fq_path.substring(1),assert(this.props.user.role),r=l({path:"/"+this.props.user.role}).updateQuery({preview:t}),a.open_tab(r))):e instanceof d?(i.logPaperSearchAction(e,this.props.user,"paper_open","top-menu-dropdown-view"),a.open_tab(e.url)):void 0},render:function(){return m.div({className:e({"top-menu-container":!0})},this.props.showSearchBar?S(p,{user:this.props.user,currentPath:this.props.currentPath,isMaestroDesign:!0,isSearchActive:!1,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen||this.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness}):void 0,m.div({className:"top-menu-container--search-bar-empty-space"}))}}),E=n(E,["/static/css/pagelet-vflAggOj0.css"],[p],!0),h=r.createClass({displayName:"PageletTopMenuContainer",render:function(){return S(E,t.extend({onSelectUser:function(e,t){return ensemble.switchAccount(t)}},this.props))}}),{TopMenuContainer:E,PageletTopMenuContainer:h}}),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,s,n){"use strict";var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.emitUpdateEvent=function(){n.Emitter.emit(n.Events.REACT_HA_DID_UPDATE)},t.prototype.componentDidMount=function(){t.emitUpdateEvent()},t.prototype.componentDidUpdate=function(){t.emitUpdateEvent()},t.prototype.render=function(){return s.createElement("div",null)},t})(s.Component);o.displayName="LegacyHAWrapper",t.LegacyHAWrapper=o}),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";t.BrowseActionTypes={INITIALIZE_EVERYTHING:"INITIALIZE_EVERYTHING",LOAD_PATH:"LOAD_PATH",ADD_FILES:"ADD_FILES",ADD_FILES_AND_SET_LOADING_STATE:"ADD_FILES_AND_SET_LOADING_STATE",SET_PATH:"SET_PATH",SET_USER:"SET_USER",SET_URL_PREFIX:"SET_URL_PREFIX",SET_LOADING_STATE:"SET_LOADING_STATE",SET_MOUNT_POINTS:"SET_MOUNT_POINTS",SET_TEAM_FOLDERS:"SET_TEAM_FOLDERS",CHANGE_FILES:"CHANGE_FILES",SET_SELECTION:"SET_SELECTION",SELECT_FILES_BY_FQ_PATH:"SELECT_FILES_BY_FQ_PATH",SET_SHOULD_SHOW_DELETED_FILES:"SET_SHOULD_SHOW_DELETED_FILES",START_INTERNAL_DRAG:"START_INTERNAL_DRAG",STOP_INTERNAL_DRAG:"STOP_INTERNAL_DRAG",SET_DROP_TARGET:"SET_DROP_TARGET",SORT_FILES:"SORT_FILES",SET_COPY_MODE:"SET_COPY_MODE",COPY_SELECTED_FILES_TO_CLIPBOARD:"COPY_SELECTED_FILES_TO_CLIPBOARD",REQUEST_NEW_FILE_NAME:"REQUEST_NEW_FILE_NAME",CANCEL_FILE_RENAME:"CANCEL_FILE_RENAME",SET_FILE_RENAME_PENDING:"SET_FILE_RENAME_PENDING",SET_FILE_RENAME_COMPLETE:"SET_FILE_RENAME_COMPLETE",REQUEST_FOLDER_NAME:"REQUEST_FOLDER_NAME",CREATE_FOLDER_PENDING:"CREATE_FOLDER_PENDING",CREATE_FOLDER_COMPLETE:"CREATE_FOLDER_COMPLETE",CANCEL_CREATE_FOLDER:"CANCEL_CREATE_FOLDER",SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:"SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",TEAM_FOLDER_DOWNGRADE:"TEAM_FOLDER_DOWNGRADE",ADD_COMMENT_STATUS_BATCH:"ADD_COMMENT_STATUS_BATCH",ADD_FILE_JUMP_KEY_CODE:"ADD_FILE_JUMP_KEY_CODE",RESET_FILE_JUMP:"RESET_FILE_JUMP",SET_ACTIVE_TAB:"SET_ACTIVE_TAB",SET_CONTEXT_FILE:"SET_CONTEXT_FILE"},t.NewFolderCreationState={CREATE_FOLDER_INACTIVE:"CREATE_FOLDER_INACTIVE",PENDING_INPUT:"PENDING_INPUT",SAVING_INPUT:"SAVING_INPUT"},t.LoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_REMAINING_PAGES:"LOADING_REMAINING_PAGES"},t.Direction={UP:"UP",DOWN:"DOWN"};(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(t.FileTypes||(t.FileTypes={}));(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={})),t.REACT_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container",t.BrowseSortField={FILENAME:"FILENAME",MODIFIED:"MODIFIED",CATEGORY:"CATEGORY",EXTENSION:"EXTENSION",SIZE:"SIZE",SHARED_WITH:"SHARED_WITH"},t.DropTargetHighlightMode={NONE:"NONE",ALL_FOLDERS:"ALL_FOLDERS",NONSELECTED_FOLDERS:"NONSELECTED_FOLDERS",NONSELECTED_NONSHARED_FOLDERS:"NONSELECTED_NONSHARED_FOLDERS",NONSELECTED_NONSHARED_NONTEAM_FOLDERS:"NONSELECTED_NONSHARED_NONTEAM_FOLDERS"};var s={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};(function(e){e[e.ITEM_ROW_HEIGHT_PX=46]="ITEM_ROW_HEIGHT_PX",e[e.MAESTRO_ITEM_ROW_HEIGHT_PX=57]="MAESTRO_ITEM_ROW_HEIGHT_PX",e[e.SEARCH_ROW_HEIGHT_PX=53]="SEARCH_ROW_HEIGHT_PX",e[e.MAESTRO_SEARCH_ROW_HEIGHT_PX=66]="MAESTRO_SEARCH_ROW_HEIGHT_PX",e[e.DEFAULT_HEADER_HEIGHT_PX=142]="DEFAULT_HEADER_HEIGHT_PX",e[e.ITEM_BUFFER_SIZE=5]="ITEM_BUFFER_SIZE"})(t.CulledListConstants||(t.CulledListConstants={})),t.ItemTypes={CREATE_FOLDER_UI:"CreateFolderUI",LOADING_INDICATOR:"LoadingIndicator"},t.FileTypeCategoryTranslations={FILE:r._("File"),FOLDER:r._("Folder"),SHARED_FOLDER:r._("Shared folder"),TEAM_SHARED_FOLDER:r._("Team folder"),TEAM_MEMBER_FOLDER:r._("Member folder"),PUBLIC_FOLDER:r._("Folder"),IMAGE:r._("Image"),VIDEO:r._("Video"),AUDIO:r._("Audio"),DOCUMENT:r._("Document"),COMPRESSED_FILE:r._("Archive"),CODE:r._("Code"),DISK_IMAGE:r._("Disk image"),EXECUTABLE:r._("Executable"),SHORTCUT:r._("Shortcut"),LINK:r._("Link"),FONT:r._("Font"),SANDBOX:r._("App folder")},t.FileTypeCapitalizedCategoryTranslations={FILE:r._("FILE"),FOLDER:r._("FOLDER"),SHARED_FOLDER:r._("SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("MEMBER FOLDER"),PUBLIC_FOLDER:r._("FOLDER"),IMAGE:r._("IMAGE"),VIDEO:r._("VIDEO"),AUDIO:r._("AUDIO"),DOCUMENT:r._("DOCUMENT"),COMPRESSED_FILE:r._("ARCHIVE"),CODE:r._("CODE"),DISK_IMAGE:r._("DISK IMAGE"),EXECUTABLE:r._("EXECUTABLE"),SHORTCUT:r._("SHORTCUT"),LINK:r._("LINK"),FONT:r._("FONT"),SANDBOX:r._("APP FOLDER")},t.DeletedFileTypeCategoryTranslations={FILE:r._("Deleted file"),FOLDER:r._("Deleted folder"),SHARED_FOLDER:r._("Deleted shared folder"),TEAM_SHARED_FOLDER:r._("Deleted team folder"),TEAM_MEMBER_FOLDER:r._("Deleted member folder"),PUBLIC_FOLDER:r._("Deleted folder"),IMAGE:r._("Deleted image"),VIDEO:r._("Deleted video"),AUDIO:r._("Deleted audio"),DOCUMENT:r._("Deleted document"),COMPRESSED_FILE:r._("Deleted archive"),CODE:r._("Deleted code"),DISK_IMAGE:r._("Deleted disk image"),EXECUTABLE:r._("Deleted executable"),SHORTCUT:r._("Deleted shortcut"),LINK:r._("Deleted link"),FONT:r._("Deleted font"),SANDBOX:r._("Deleted app folder")},t.DeletedFileTypeCapitalizedCategoryTranslations={FILE:r._("DELETED FILE"),FOLDER:r._("DELETED FOLDER"),SHARED_FOLDER:r._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:r._("DELETED FOLDER"),IMAGE:r._("DELETED IMAGE"),VIDEO:r._("DELETED VIDEO"),AUDIO:r._("DELETED AUDIO"),DOCUMENT:r._("DELETED DOCUMENT"),COMPRESSED_FILE:r._("DELETED ARCHIVE"),CODE:r._("DELETED CODE"),DISK_IMAGE:r._("DELETED DISK IMAGE"),EXECUTABLE:r._("DELETED EXECUTABLE"),SHORTCUT:r._("DELETED SHORTCUT"),LINK:r._("DELETED LINK"),FONT:r._("DELETED FONT"),SANDBOX:r._("DELETED APP FOLDER")},t.ExtensionCategories={};for(var n=0,o=Object.keys(s);n<o.length;n++)for(var i=o[n],a=s[i],c=0,l=a;c<l.length;c++){var u=l[c];t.ExtensionCategories[u]=i}t.RenameStates={PENDING_INPUT:"pending-input",
SAVING_INPUT:"saving-input"};(function(e){e[e.NONE=-1]="NONE",e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(t.MouseEventButton||(t.MouseEventButton={}));(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(t.ShareFolderModalTypes||(t.ShareFolderModalTypes={})),t.SharedWithActionTypes={SET_SHARED_FOLDER_DATA:"SET_SHARED_FOLDER_DATA",SET_MEMBER_COUNTS_FOR_NS:"SET_MEMBER_COUNTS_FOR_NS",SET_SHARED_LINK_DATA:"SET_SHARED_LINK_DATA",SET_SHARED_FILE_DATA:"SET_SHARED_FILE_DATA",SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:"SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",CLEAR_SHARED_FOLDER_DATA_FOR_NS:"CLEAR_SHARED_FOLDER_DATA_FOR_NS",REMOVE_SHARED_LINK_DATA:"REMOVE_SHARED_LINK_DATA"},t.SEARCH_PREFIX="/search",t.ViewTypes={Grid:"GRID_VIEW",List:"LIST_VIEW"}}),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,t,r){"use strict";function s(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return E.call(e);for(var t=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e),s=0,n=r;s<n.length;s++){var o=n[s],i=Object.getOwnPropertyDescriptor(e,o);i&&(i.get||i.set)?(i.configurable=!0,Object.defineProperty(t,o,i)):t[o]=e[o]}return t}function n(e,t){var n=s(e);return t(n),r(n)}function o(e,t){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));return t.reduce(function(e,t){return null==e?null:e[t]},e)}function i(e,t,n){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[t]===n)return e;var o=s(e);return o[t]=n,r(o)}function a(e,t,r){return i(e,t,r(e[t]))}function c(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var s=t[0];return 1===t.length?a(e,s,r):i(e,s,c(e[s],t.slice(1),r))}function l(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var s=t[0];switch(t.length){case 1:return i(e,s,r);default:return i(e,s,l(e[s]||{},t.slice(1),r))}}function u(e,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");var n=Object.keys(t).reduce(function(r,s){return t[s]!==e[s]&&r.push(s),r},[]);if(n.length){for(var o=s(e),i=0,a=n;i<a.length;i++){var c=a[i];Object.defineProperty(o,c,Object.getOwnPropertyDescriptor(t,c))}return r(o)}return e}function _(e,t,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");return c(e,t,function(e){return u(e,r)})}function h(e,t,s){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var i=E.call(e);return i.splice.apply(i,[t,s].concat(n)),r(i)}function d(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var n=E.call(e);return n.unshift.apply(n,t),r(n)}function p(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var n=E.call(e);return n.push.apply(n,t),r(n)}var E=Array.prototype.slice;t.thaw=s,t.withMutations=n,t.getIn=o,t.set=i,t.update=a,t.updateIn=c,t.setIn=l,t.merge=u,t.mergeIn=_,t.splice=h,t.unshift=d,t.push=p}),define("modules/clean/react/browse/models",["require","exports","tslib","external/deep-freeze","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/react/browse/constants","modules/constants/legacy"],function(e,t,r,s,n,o,i,a){"use strict";var c=(function(){function e(e){this.ago=e.ago,this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.doc_preview_status=e.doc_preview_status,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_unmounted=e.is_unmounted,this.last_modified_fname=e.last_modified_fname,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.request_id=e.request_id,this.size=e.size,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_transcode_url=e.video_transcode_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.isDeleted=!!e.isDeleted,s(this)}return e.fromServerObject=function(t){return new e(r.__assign({},t,{_mount_access_perms:t.mount_access_perms,isDeleted:t.bytes===-1}))},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.merge=function(e){return n.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return o.file_extension(e.fq_path)},e.getCategoryDescription=function(t,r){void 0===r&&(r=!1);var s;if(t.is_dir)switch(s="FOLDER",t.type){case i.FileTypes.TEAM_SHARED_FOLDER:s="TEAM_SHARED_FOLDER";break;case i.FileTypes.SHARED_FOLDER:s="SHARED_FOLDER";break;case i.FileTypes.SANDBOX:s="SANDBOX";break;case i.FileTypes.TEAM_MEMBER_FOLDER:s="TEAM_MEMBER_FOLDER";break;default:t.target_ns&&(s="SHARED_FOLDER")}else s=i.ExtensionCategories[e.getExtension(t)]||"FILE";return t.isDeleted?r?i.DeletedFileTypeCapitalizedCategoryTranslations[s]:i.DeletedFileTypeCategoryTranslations[s]:r?i.FileTypeCapitalizedCategoryTranslations[s]:i.FileTypeCategoryTranslations[s]},e.isTeamSharedFolder=function(e){return e.type===i.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===i.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&t.indexOf("can_edit")<0},e.isNoAccessSharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&t.indexOf("can_view")<0},e.canViewFileMembers=function(e,t){var r=e._mount_access_perms;return!(r&&r.indexOf("can_view_members")<0)&&(!(t&&!t.canViewContainingNSMembers)||!!(r&&r.indexOf("can_view_members")>=0))},e.areEqual=function(e,t){return e.ns_id===t.ns_id&&e.sjid===t.sjid},e.revisionKey=function(e){return e.ns_id+":"+e.sjid},e})();t.File=c;var l=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(t){return new e({isPublicFolderEnabled:t.public_folder_enabled,publicFolderFqPath:t.public_folder_fq_path,publicAppToken:t.public_app_token})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();t.Config=l;var u=(function(){function e(e){var t=void 0===e?{}:e,r=t.canViewContainingNSMembers,n=t.currentNSID,o=t.currentFQPath,c=t.currentMountPoint,u=t.currentNSPath,_=t.currentSharedFolderPermissionRole,h=t.currentNSAllowsNesting,d=t.inactiveNSIDByFQPath,p=t.permanentDeletionDisabledStateByNSID,E=t.isInFolderMode,S=t.isCurrentlyInRoot,m=t.isInsideSharedFolder,f=t.isInsideAutoTeamFolder,g=t.isInsideArchivedTeamFolder,T=t.isInsideTeamFolderTree,R=t.isInsideDeletedFolder,I=t.isInsideDeletedSharedFolder,A=t.isInsideDeletedNestedSharedFolder,D=t.isNonUserRelativeContext,O=t.pathRoot,y=t.rootNSID,C=t.showSharedFolderCreateTeamPromo,v=t.showPinnedTeamFolder,N=t.teamFolderOwnerTeamApiId,L=t.blockHash,b=t.config;this.canViewContainingNSMembers=null==r||r,this.currentNSID=n||a.root_ns_id,this.currentFQPath=o||"",this.currentMountPoint=c,this.currentNSPath=u,this.currentSharedFolderPermissionRole=null!=_?_:i.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!h,this.inactiveNSIDByFQPath=d||{},this.permanentDeletionDisabledStateByNSID=p||{},this.isInFolderMode=null==E||E,this.isCurrentlyInRoot=!!S,this.isInsideSharedFolder=!!m,this.isInsideAutoTeamFolder=!!f,this.isInsideArchivedTeamFolder=!!g,this.isInsideTeamFolderTree=!!T,this.isInsideDeletedFolder=!!R,this.isInsideDeletedSharedFolder=!!I,this.isInsideDeletedNestedSharedFolder=!!A,this.isNonUserRelativeContext=!!D,this.pathRoot=O,this.rootNSID=y,this.showSharedFolderCreateTeamPromo=!!C,this.showPinnedTeamFolder=!!v,this.teamFolderOwnerTeamApiId=N,this.blockHash=L,this.config=b||new l,s(this)}return e.fromServerObject=function(t){var r=t.containing_fq_path||"";r.startsWith("/")||(r="/"+r);var s;t.inside_shared_folder&&(s=i.NameSpaceAccess.ACCESS_READER);var n,o,a=t.containing_ns_permissions||[];return o=a.indexOf("mount_shared_folders")>=0,t.inside_shared_folder&&(a.indexOf("edit_contents")>=0&&(s=i.NameSpaceAccess.ACCESS_WRITER),a.indexOf("change_folder_options")>=0&&(s=i.NameSpaceAccess.ACCESS_OWNER),a.indexOf("view_members")<0&&(n=!1)),new e({blockHash:t.block_hash,canViewContainingNSMembers:n,config:l.fromServerObject(t),currentFQPath:r,currentMountPoint:t.containing_mount_point,currentNSAllowsNesting:o,currentNSID:t.containing_ns_id,currentNSPath:t.containing_ns_path,currentSharedFolderPermissionRole:s,inactiveNSIDByFQPath:t.old_path_to_ns_id,isCurrentlyInRoot:t.in_root_dir,isInFolderMode:t.inside_dir,isInsideArchivedTeamFolder:t.inside_archived_team_folder,isInsideAutoTeamFolder:t.inside_auto_team_folder,isInsideDeletedFolder:t.inside_deleted_dir,isInsideDeletedNestedSharedFolder:t.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:t.inside_deleted_shared_folder,isInsideSharedFolder:t.inside_shared_folder,isInsideTeamFolderTree:t.inside_team_folder_tree,isNonUserRelativeContext:t.is_non_user_relative_context,pathRoot:t.path_root,permanentDeletionDisabledStateByNSID:t.permanent_delete_is_disabled_by_ns_id,rootNSID:t.root_ns_id,showPinnedTeamFolder:t.show_pinned_team_folder,showSharedFolderCreateTeamPromo:t.show_shared_folder_create_team_promo,teamFolderOwnerTeamApiId:t.team_folder_owner_team_dbtid})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,t=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||t===i.NameSpaceAccess.ACCESS_WRITER||t===i.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return o.filename(this.currentFQPath)},e})();t.BrowseContext=u;var _=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.creator_name=e.creator_name,this.last_modified_date=e.last_modified_date,this.request_id=e.request_id,this.sort_rank=e.sort_rank,s(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.Paper=_}),define("modules/clean/react/maestro/profiling_blank_embedded_app",["require","exports","tslib","external/react","modules/clean/react/maestro/layout","modules/clean/profiling","modules/clean/react/maestro/header","modules/clean/viewer","modules/clean/web_timing_logger"],function(e,t,r,s,n,o,i,a,c){"use strict";var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=a.get_viewer(),t=e.get_user_by_id(this.props.uid);return s.createElement(n.MaestroChrome,{user:t,viewer:a.get_viewer(),titleRegion:s.createElement(i.MaestroHeaderTitle,null,"Blank App"),embeddedAppRegion:s.createElement(o.hello_component,null)})},t.prototype.componentWillMount=function(){c.log_js_modules_application_code_start()},t})(s.Component);t.BlankEmbeddedApp=l}),define("modules/clean/search/actions",["require","exports","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/search/constants","modules/clean/react/browse/models","modules/clean/search/api","modules/clean/search/store"],function(e,t,r,s,n,o,i,a){"use strict";var c=(function(){function e(e,t){void 0===e&&(e=i.searchApiClient),void 0===t&&(t=a.searchStore),this._searchApi=e,this._searchStore=t}return e.prototype.focusSearchBar=function(){s.dispatch({type:n.FOCUS_SEARCH_BAR_ACTION})},e.prototype.blurSearchBar=function(){s.dispatch({type:n.BLUR_SEARCH_BAR_ACTION})},e.prototype.setSearchQuery=function(e){var t=this,r=e.nsid,o=e.path,i=e.query,a=e.user;i!==this._searchStore.rawQuery()&&(this._searchApi.abortPreviousLoading(),s.dispatch({type:n.SET_SEARCH_QUERY_ACTION,data:{query:i}}),this._searchStore.isSearchBarLoading()&&this._searchApi.loadSuggestions({user:a,nsid:r,path:o,query:this._searchStore.normalizedQuery(),onSuccess:function(e){var r=e.searchResults;i===t._searchStore.rawQuery()&&t.setSearchSuggestions({searchResults:r})}}))},e.prototype.setSearchSuggestions=function(e){var t=e.searchResults;s.dispatch({type:n.SET_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:t}})},e.prototype.setHighlightedRow=function(e){var t=e.index;s.dispatch({type:n.SET_HIGHLIGHTED_ROW_ACTION,data:{index:t}})},e.prototype.highlightPreviousRow=function(){s.dispatch({type:n.HIGHLIGHT_PREVIOUS_ROW_ACTION})},e.prototype.highlightNextRow=function(){s.dispatch({type:n.HIGHLIGHT_NEXT_ROW_ACTION})},e.prototype.runSearch=function(e){var t=this,r=e.user,o=e.path,i=e.query,a=e.qsid,c=e.logOnceFetchedDataRequiredForTTI;s.dispatch({type:n.START_SEARCH_ACTION,data:{query:i,qsid:a}}),this._searchApi.loadResults({user:r,path:o,query:i,loadDeleted:!1,start:0,onSuccess:function(e){var s=e.searchResults,n=e.context;"function"==typeof c&&c(),t._setSearchResults({searchResults:s,context:n}),t._loadDeletedResults({path:o,user:r})}})},e.prototype.loadMoreResults=function(e){var t,r=this,o=e.path,i=e.user;if(this._searchStore.loadingState()===n.SearchLoadingStates.LOADED){if(this._searchStore.hasMoreResults())t=!1;else{if(!this._searchStore.hasMoreResults(!0))return;t=!0}s.dispatch({type:n.CONTINUE_SEARCH_ACTION,data:{didLoadDeletedResults:t}}),this._searchApi.loadResults({user:i,path:o,query:this._searchStore.latestQuery(),loadDeleted:t,start:t?this._searchStore.numDeletedResults():this._searchStore.searchResults().size,onSuccess:function(e){var t=e.searchResults,s=e.context,n=e.deleted;r._appendSearchResults({searchResults:t,context:s,deleted:n}),r._loadDeletedResults({path:o,user:i})}})}},e.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context;s.dispatch({type:n.SET_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:r}})},e.prototype._appendSearchResults=function(e){var t=e.searchResults,r=e.context,o=e.deleted;s.dispatch({type:n.APPEND_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:r,deleted:o}})},e.prototype._loadDeletedResults=function(e){var t=e.path,r=e.user;this._searchStore.hasMoreResults()||this._searchStore.didLoadDeletedResults()||this.loadMoreResults({path:t,user:r})},e.prototype.setSearchSelection=function(e){var t=e.selection;s.dispatch({type:n.SET_SEARCH_SELECTION_ACTION,data:{selection:t}})},e.prototype.applyUpdatesFromNotserver=function(e){for(var t,i,a,c=e.payload,l=e.path,u=c.added,_=c.moved,h=c.removed,d=[],p=this._searchStore.searchResults(),E=function(e){if(!e.fq_path.startsWith(l))return"continue";i=p.find(function(t){return r.paths_are_equal(t.fq_path,e.fq_path)}),i&&i.isDeleted&&(t=i.filename_highlights,a=o.File.fromServerObject(e).set("filename_highlights",t),d.push({before:i.fq_path,after:a})),i||d.push({before:null,after:o.File.fromServerObject(e)})},S=0,m=u;S<m.length;S++){var f=m[S];E(f)}for(var g=function(e,s){if(!e.startsWith(l))return"continue";i=p.find(function(t){return r.paths_are_equal(t.fq_path,e)}),i&&(t=i.filename_highlights,a=o.File.fromServerObject(s).set("filename_highlights",t),d.push({before:i.fq_path,after:null}),d.push({before:null,after:a}))},T=0,R=_;T<R.length;T++){var I=R[T],A=I[0],f=I[1];g(A,f)}for(var D=function(e){if(!e.startsWith(l))return"continue";i=p.find(function(t){return r.paths_are_equal(t.fq_path,e)}),i&&!i.isDeleted&&(t=i.filename_highlights,a=i.set("isDeleted",!0).set("filename_highlights",t),d.push({before:i.fq_path,after:a}))},O=0,y=h;O<y.length;O++){D(y[O])}s.dispatch({type:n.CHANGE_FILES_ACTION,data:{fileDeltas:d}})},e.prototype.removeSearchResults=function(e){var t=e.fq_paths,r=t.map(function(e){return{before:e,after:null}}).toArray();s.dispatch({type:n.CHANGE_FILES_ACTION,data:{fileDeltas:r}})},e.prototype.clearSearch=function(){s.dispatch({type:n.CLEAR_SEARCH_ACTION})},e})();t.SearchActions=c,t.searchActions=new c}),define("modules/clean/search/api",["require","exports","modules/clean/ajax","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/constants","modules/clean/search/search_type","modules/clean/search/store","modules/constants/browse"],function(e,t,r,s,n,o,i,a,c){"use strict";var l=(function(){function e(){this._activeRequest=null}return e.prototype.loadSuggestions=function(e){var t=e.user,r=e.nsid,s=e.path,n=e.query,i=e.onSuccess,l=e.onError,u={query:n,fq_path:s,filename_only:!0,max_results:o.MaxResults.MAX_SEARCH_SUGGESTIONS,show_paper_results:c.SHOW_PAPER_SEARCH_RESULTS,show_unmounted_results:!0,ns_id:r,is_admin_console:a.searchStore.browseContext().isNonUserRelativeContext,is_dropdown:!0,start:0};this._fetchResults(u,t,!1,i,l)},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,s=e.query,n=e.loadDeleted,i=e.start,a=e.onSuccess,l=e.onError,u={query:s,fq_path:r,filename_only:!1,max_results:o.MaxResults.MAX_SEARCH_RESULTS,deleted:n,start:i,show_paper_results:c.SHOW_PAPER_SEARCH_RESULTS,show_unmounted_results:!0};this._fetchResults(u,t,n,a,l)},e.prototype.getUpdatesForResults=function(e){var t=e.query,s=e.namespaceToJournalIdMap,n=e.showDeleted,o=e.user,i=e.onSuccess,a={all_terms:t,ns_map:(function(){var e=[];for(var t in s)if(s.hasOwnProperty(t)){var r=s[t];e.push(t+"_"+r)}return e})().join(","),show_deleted:n};r.WebRequest({url:"/update/list_search",data:a,dataType:"json",subject_user:o,success:function(e){i(e)}})},e.prototype._extractBrowseContext=function(e){return new n.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,permanentDeletionDisabledStateByNSID:e.permanent_delete_is_disabled_by_ns_id})},e.prototype._getSearchType=function(e){return e.is_dropdown?i.SearchType.COMPLETION:e.deleted?i.SearchType.DELETED:i.SearchType.FULLTEXT},e.prototype._fetchResults=function(e,t,n,o,i){var c,l=this;null!=this._activeRequest&&this._activeRequest.abort();var u={firefly:!0,path_scoped:!1,search_type:this._getSearchType(e),query_string:e.query,infinite_scroll:e.start>0,search_session_id:a.searchStore.searchSessionID()};s.SearchClientActivityLogger.log("query_started",t.id,u);var _=(new Date).getTime();this._activeRequest=r.WebRequest({url:"/ajax_fulltext_search",data:e,dataType:"json",subject_user:t,success:function(r,i,h){var d=l._extractBrowseContext(r),p=r.search_results;c=h.getResponseHeader("x-dropbox-request-id");for(var E=!1,S=0,m=p;S<m.length;S++){var f=m[S];f.request_id=c,"FILE"===f.search_result_type&&f.used_spellcorrect===!0&&(E=!0)}o({context:d,searchResults:p,deleted:n}),u=s.SearchClientActivityLogger.create_completion_log_dict(u,E,c,_,e.query,!0,p.length,null,a.searchStore.searchSessionID()),s.SearchClientActivityLogger.log("query_completed",t.id,u)},error:function(e,r,n){"abort"!==r&&"function"==typeof i&&i(n),c=e.getResponseHeader("x-dropbox-request-id"),u=s.SearchClientActivityLogger.create_completion_log_dict(u,null,c,_,null,null,null,r,a.searchStore.searchSessionID()),s.SearchClientActivityLogger.log("query_failed",t.id,u)},complete:function(){this._activeRequest=null}})},e})();t.SearchApiClient=l,t.searchApiClient=new l}),define("modules/clean/search/constants",["require","exports"],function(e,t){"use strict";t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},t.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",t.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",t.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",t.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",t.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",t.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",t.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",t.START_SEARCH_ACTION="search__START_SEARCH",t.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",t.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",t.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",t.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",t.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",t.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",t.SearchLoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_ADDITIONAL_PAGE:"LOADING_ADDITIONAL_PAGE"}}),define("modules/clean/search/search_bar",["require","exports","tslib","external/classnames","external/mcl/icon","external/react","external/purify","jquery","modules/clean/analytics","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/keycode","modules/clean/react/button","modules/clean/react/css","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/svg_icon","modules/clean/react/sprite","modules/clean/react_format","modules/clean/search/actions","modules/clean/search/search_helpers","modules/clean/search/store","modules/constants/maestro","modules/core/accessible_announce","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,r,s,n,o,i,a,c,l,u,_,h,d,p,E,S,m,f,g,T,R,I,A,D,O){"use strict";var y=(function(e){function t(t){var r=e.call(this,t)||this;return r._onSearchStoreChanged=function(){r.setState(r._get_state_from_store())},r._handleInputChange=function(e){r._setSearchQuery(e.currentTarget.value)},r._handleCancelSearch=function(){r._setSearchQuery("")},r._handleInputKeydown=function(e){if(e.keyCode===_.KeyCode.ESC)return r._handleCancelSearch(),void r.props.onCancelSearch();e.stopPropagation(),e.keyCode===_.KeyCode.UP?(e.preventDefault(),f.searchActions.highlightPreviousRow()):e.keyCode===_.KeyCode.DOWN&&(e.preventDefault(),f.searchActions.highlightNextRow())},r._handleInputSubmit=function(e,t){e.preventDefault(),0===t?r.props.onSearch(r.state.normalizedQuery,T.searchStore.searchSessionID()):r.props.onFileOrFolderOpen(T.searchStore.searchSuggestions()[t-1])},r._handleHighlightDropdownItem=function(e){f.searchActions.setHighlightedRow({index:e})},r._setSearchBarRef=function(e){return r._searchBarView=e},r.state=r._get_state_from_store(),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){T.searchStore.add_change_listener(this._onSearchStoreChanged)},t.prototype.componentWillUnmount=function(){T.searchStore.remove_change_listener(this._onSearchStoreChanged)},t.prototype._get_state_from_store=function(){return{isFocused:T.searchStore.isSearchBarFocused(),isActive:T.searchStore.isSearchBarActive(),isSearchActive:!!T.searchStore.latestQuery(),rawQuery:T.searchStore.rawQuery(),normalizedQuery:T.searchStore.normalizedQuery(),suggestions:T.searchStore.searchSuggestions(),searchBarLoading:T.searchStore.isSearchBarLoading(),isAdminConsole:T.searchStore.browseContext().isNonUserRelativeContext}},t.prototype.getSearchBarView=function(){return this._searchBarView},t.prototype._setSearchQuery=function(e){f.searchActions.setSearchQuery({nsid:this.props.currentNSID,path:this.props.currentPath,query:e,user:this.props.user})},t.prototype.render=function(){return o.createElement(C,r.__assign({},this.props,this.state,{onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchBarFocus:f.searchActions.focusSearchBar,onSearchBarBlur:f.searchActions.blurSearchBar,onHighlightDropdownItem:this._handleHighlightDropdownItem,ref:this._setSearchBarRef,highlightedRow:T.searchStore.highlightedSearchRow()}))},t})(o.Component);y.defaultProps={onCancelSearch:function(){}},t.SearchBarComponent=y;var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleNavigation=function(){t._searchBarInput.blurSearchBarTextInput()},t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),A.redirect(new O({path:"/team/upgrade",query:{tk:"search_upsell_bar",camp:"web"}}).toString())},t._renderUpsellBar=function(){return t.props.limitedTeamBannerUpsell?o.createElement("div",{className:"search-bar__upsell"},o.createElement("div",{className:"search-bar__upsell__message"},D._("Search through file contents in addition to file names with %(trademark_business)s").format({trademark_business:t.props.trademarkBusiness})),o.createElement("div",{className:"search-bar__upsell__action"},o.createElement(h.button,{className:"search-bar__upsell__cta-button",onMouseDown:t._onMouseDown},D._("Upgrade")))):void 0},t._onFileOrFolderOpen=function(e){t.props.onFileOrFolderOpen(e),t._handleNavigation()},t._onSearch=function(e,r){t.props.onSearch(e,r),t._handleNavigation()},t._setSearchBarInputRef=function(e){return t._searchBarInput=e},t}return r.__extends(t,e),t.prototype.getSearchBarInput=function(){return this._searchBarInput},t.prototype.render=function(){var e={"search-bar":!0,"is-expanded":this.props.isSearchActive,"is-focused":this.props.isFocused,"is-active":this.props.isActive};return o.createElement("div",{className:"search-bar--container u-l-fr"},o.createElement("div",{className:s(e)},o.createElement(v,{isActive:this.props.isActive,isFocused:this.props.isFocused,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onInputChange:this.props.onInputChange,onInputKeydown:this.props.onInputKeydown,onInputSubmit:this.props.onInputSubmit,onSearchBarBlur:this.props.onSearchBarBlur,onSearchBarFocus:this.props.onSearchBarFocus,rawQuery:this.props.rawQuery,highlightedRow:this.props.highlightedRow,isAdminConsole:this.props.isAdminConsole,placeholder:this.props.placeholder,ref:this._setSearchBarInputRef}),this.props.normalizedQuery&&this.props.normalizedQuery.length&&o.createElement(N,{onFileOrFolderOpen:this._onFileOrFolderOpen,onSearch:this._onSearch,currentPath:this.props.currentPath,highlightedRow:this.props.highlightedRow,isOpen:this.props.isFocused,normalizedQuery:this.props.normalizedQuery,onHighlightDropdownItem:this.props.onHighlightDropdownItem,suggestions:this.props.suggestions,bottomBanner:this._renderUpsellBar(),searchBarLoading:this.props.searchBarLoading,isAdminConsole:this.props.isAdminConsole})))},t})(o.Component);C.defaultProps={rawQuery:"",normalizedQuery:"",isAdminConsole:!1};var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeydown=function(e){e.keyCode===_.KeyCode.ESC&&(t.blurSearchBarTextInput(),a(t._searchBarTextInput).val("")),t.props.onInputKeydown(e)},t._onSubmit=function(e){var r=T.searchStore.highlightedSearchRow();return t.props.isAdminConsole||t.blurSearchBarTextInput(),t.props.onInputSubmit(e,r)},t._setSearchBarTextInputRef=function(e){return t._searchBarTextInput=e},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){a(this._searchBarTextInput).on("keydown.SearchBarInput",this._onKeydown),a(this._searchBarTextInput).on("focusout.SearchBarInput",this.props.onSearchBarBlur)},t.prototype.componentWillUnmount=function(){a(this._searchBarTextInput).off(".SearchBarInput")},t.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},t.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur()},t.prototype.render=function(){return o.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},o.createElement("input",{"aria-activedescendant":"search-dropdown-suggestion"+this.props.highlightedRow,"aria-autocomplete":"list","aria-expanded":this.props.isFocused&&this.props.isActive,"aria-label":D._("Search"),"aria-owns":"search-bar__suggestions",className:"search-bar__text-input",onChange:this.props.onInputChange,onFocus:this.props.onSearchBarFocus,placeholder:this.props.placeholder?this.props.placeholder:D._("Search"),ref:this._setSearchBarTextInputRef,role:"combobox",defaultValue:this.props.rawQuery,tabIndex:p.LAYOUT_TAB_ORDER.SEARCH_BAR}),o.createElement("button",{"aria-label":D._("Search"),className:"search-bar__button",type:"submit"},R.MAESTRO_ICONS_ENABLED?o.createElement(n.Icon,{name:"global-search-small"}):o.createElement(E.SvgIcon,{name:"search"})))},t})(o.Component),N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._announceLoading=function(){I.AccessibleAnnounce.polite(D._("Loading search…"))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.searchBarLoading&&this._announceLoading()},t.prototype.componentDidUpdate=function(e){this.props.searchBarLoading&&!e.searchBarLoading&&this._announceLoading(),this.props.normalizedQuery&&e.searchBarLoading&&!this.props.searchBarLoading&&I.AccessibleAnnounce.polite(D.ungettext("Found %(num)s search result","Found %(num)s search results",this.props.suggestions.length).format({num:this.props.suggestions.length}))},t.prototype.render=function(){!this.props.searchBarLoading&&this.props.isOpen&&this.props.bottomBanner&&!this._banner_view_logged&&(this._banner_view_logged=!0,c.TeamsWebActionsLogger.log("banner_search_displayed",{location:"search_bar",item_count:this.props.suggestions.length}));for(var e=[],t=0;t<this.props.suggestions.length;t++){var r=this.props.suggestions[t];r instanceof u.File?e.push(o.createElement(F,{resultObject:r,key:r.fq_path,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onHighlightDropdownItem:this.props.onHighlightDropdownItem,rank:t,highlightedRow:this.props.highlightedRow})):r instanceof u.Paper&&e.push(o.createElement(b,{resultObject:r,key:r.pad_id,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onHighlightDropdownItem:this.props.onHighlightDropdownItem,rank:t,highlightedRow:this.props.highlightedRow}))}var n={"search-bar__dropdown":!0,"is-expanded":this.props.isOpen};return o.createElement("div",{className:s(n),"aria-hidden":!this.props.isOpen},o.createElement("div",{className:"search-bar__suggestions",id:"search-bar__suggestions"},o.createElement(L,{onSearch:this.props.onSearch,onHighlightDropdownItem:this.props.onHighlightDropdownItem,currentPath:this.props.currentPath,normalizedQuery:this.props.normalizedQuery,highlightedRow:this.props.highlightedRow}),e),this.props.searchBarLoading?o.createElement("div",{className:"search-bar__loading"},o.createElement("span",{className:"ax-visually-hidden"},D._("Loading search..."))):this.props.bottomBanner)},t})(o.Component);N.defaultProps={isAdminConsole:!1};var L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTitle=function(){return["/",""].includes(t.props.currentPath)?m.reactFormat(D._("View all results for <strong>%(query)s</strong>"),{query:t.props.normalizedQuery,strong:o.createElement("strong",null)}):m.reactFormat(D._("Search for ‘<strong>%(query)s</strong>’ in %(current_path)s"),{current_path:l.filename(t.props.currentPath),query:t.props.normalizedQuery,strong:o.createElement("strong",null)})},t._onMouseDown=function(){return t.props.onSearch(t.props.normalizedQuery,T.searchStore.searchSessionID())},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(0)},t}return r.__extends(t,e),t.prototype.render=function(){var e=0===this.props.highlightedRow,t={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":e,"search-bar__full_search_suggestion":!0};return o.createElement("div",{className:s(t),id:"search-dropdown-suggestion0",onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter,role:"option","aria-selected":e},o.createElement("div",{className:"search-bar__suggestion-icon--search"
}),o.createElement("div",{className:"search-bar__suggestion-first-row-name"},this._renderTitle()))},t})(o.Component),b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject;return o.createElement(w,r.__assign({},this.props,{icon:"paper_white_32",title:g.highlightMatchString(e.title,e.title_highlights),location:"Paper"}))},t})(o.Component),F=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject,t=l.filename(e.fq_path),s=l.parent_dir(e.fq_path),n="Dropbox",i=s.split("/");i.shift(),e.is_unmounted&&i.length>0&&(n=i.shift());var a=i[i.length-1];return i.length>=2&&(n+="/..."),a.length&&(n+="/"+a),o.createElement(w,r.__assign({},this.props,{icon:e.icon,title:g.highlightMatchString(t,e.filename_highlights),location:n,isUnmounted:e.is_unmounted}))},t})(o.Component),w=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onMouseDown=function(){return t.props.onFileOrFolderOpen(t.props.resultObject)},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(t._listIndex)},t}return r.__extends(t,e),t.prototype.render=function(){var e;this._listIndex=this.props.rank+1;var t=this._listIndex===this.props.highlightedRow,r={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":t};return e=this.props.isUnmounted?m.reactFormat(D._("not added yet, in <locationSpan>%(location)s</locationSpan>",{comment:"Describes the mountable directory of a file in a list of search results."}),{location:this.props.location,locationSpan:o.createElement("span",{title:this.props.location})}):m.reactFormat(D._("<locationSpan>in %(location)s</locationSpan>",{comment:"Describes the parent directory of a file in a list of search results."}),{location:this.props.location,locationSpan:o.createElement("span",{title:this.props.location})}),o.createElement("li",{className:s(r),id:"search-dropdown-suggestion"+this._listIndex,role:"option","aria-selected":t,onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter},o.createElement(S,{group:"web",name:this.props.icon,className:"search-bar__suggestion-icon",alt:""}),o.createElement("div",null,o.createElement("div",{className:"search-bar__suggestion-name"},o.createElement("span",{dangerouslySetInnerHTML:{__html:i.sanitize(this.props.title)}})),o.createElement("div",{className:"search-bar__suggestion-desc"},e)))},t})(o.Component);t.SearchBar=d(y,["/static/css/search/search_bar_react-vfl9NVUaJ.css"])}),define("modules/clean/search/search_helpers",["require","exports","jquery","modules/clean/analytics","modules/clean/search/store","modules/clean/history"],function(e,t,r,s,n,o){"use strict";function i(e,t,r){void 0===t&&(t=""),void 0===r&&(r="");var s=a(t,r);return o.construct_url("/search/"+e.role,s)}function a(e,t){return void 0===e&&(e=""),void 0===t&&(t=""),{query:e.toLowerCase().trim().replace(/\ +/g," "),query_unnormalized:e,last_fq_path:t}}function c(e,t,r,o){void 0===o&&(o="full-view");var i={file_nsid:e.ns_id,file_sjid:e.sjid,firefly:!0,match_type:e.match_type,position:e.sort_rank,request_id:e.request_id,viewport:o,action_type:r,search_session_id:n.searchStore.searchSessionID()};s.SearchClientActivityLogger.log("result_action",t.id,i)}function l(e,t,r,o){void 0===o&&(o="full-view");var i={firefly:!1,paper_pad_id:e.pad_id,position:e.sort_rank,request_id:e.request_id,viewport:o,action_type:r,search_session_id:n.searchStore.searchSessionID()};s.SearchClientActivityLogger.log("result_action",t.id,i)}function u(e,t){if(!t)return r("<span />").text(e);for(var s=0,n=0,o=r("<span />");s<e.length;){var i=void 0,a=void 0,c=t[n];n>=t.length?(a=!1,i=s+e.length):c.pos>s?(a=!1,i=c.pos):(a=!0,i=c.pos+c.len);var l=e.substring(s,i),u=r("<span/>").text(l);u.addClass(""),a&&(u.addClass("highlighted"),u.addClass("is-highlighted")),o.append(u),s=i,a&&n++}return o}function _(e,t){if(!t)return r("<span />").text(e);for(var s=r("<span />"),n=e,o=0,i=t;o<i.length;o++){var a=i[o],c=n.indexOf(a.string);if(!(c<0)){s.append(r("<span/>").text(n.substring(0,c)));var l=n.substring(c,c+a.string.length),u=r("<span/>").text(l);u.addClass("highlighted"),u.addClass("is-highlighted"),s.append(u),n=n.substring(c+a.string.length,n.length)}}return n&&s.append(r("<span/>").text(n)),s}function h(e,t){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)?_(e,t)[0].innerHTML:u(e,t)[0].innerHTML}t.buildSearchURL=i,t.queryParams=a,t.logSearchAction=c,t.logPaperSearchAction=l,t.highlightMatch=u,t.highlightMatchWithEmoji=_,t.highlightMatchString=h}),define("modules/clean/search/search_type",["require","exports"],function(e,t){"use strict";t.SearchType={COMPLETION:"completion",DELETED:"deleted",FULLTEXT:"full-text"}}),define("modules/clean/search/store",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/selectable_list","modules/clean/search/constants","modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t,r,s,n,o,i,a,c,l){"use strict";var u=(function(e){function t(t){var r=e.call(this,t)||this;return r._resetSearchBar(),r._resetSearchResults(),r}return r.__extends(t,e),t.prototype._resetSearchBar=function(){this._isSearchBarFocused=!1,this._isSearchBarLoading=!1,this._rawQuery="",this._normalizedQuery="",this._searchSessionID="",this._searchSuggestions=[],this._highlightedSearchRow=0},t.prototype._resetSearchResults=function(){this._browseContext=new l.BrowseContext,this._latestQuery="",this._loadingState="LOADED",this._searchResults=s.List.of(),this._selection=i.createSelection(),this._hasMoreLiveResults=!0,this._numDeletedResults=0,this._hasMoreDeletedResults=!0,this._didLoadDeletedResults=!1},t.prototype.isSearchBarFocused=function(){return this._isSearchBarFocused},t.prototype.isSearchBarActive=function(){return!!this._rawQuery},t.prototype.isSearchBarLoading=function(){return this._isSearchBarLoading},t.prototype.rawQuery=function(){return this._rawQuery},t.prototype.normalizedQuery=function(){return this._normalize(this._rawQuery)},t.prototype.searchSuggestions=function(){return this._searchSuggestions},t.prototype.highlightedSearchRow=function(){return this._highlightedSearchRow},t.prototype.searchSessionID=function(){return this._searchSessionID},t.prototype.browseContext=function(){return this._browseContext},t.prototype.latestQuery=function(){return this._latestQuery},t.prototype.loadingState=function(){return this._loadingState},t.prototype.searchResults=function(){return this._searchResults},t.prototype.hasMoreResults=function(e){return void 0===e&&(e=!1),this._hasMoreLiveResults||e&&this._hasMoreDeletedResults},t.prototype.numDeletedResults=function(){return this._numDeletedResults},t.prototype.didLoadDeletedResults=function(){return this._didLoadDeletedResults},t.prototype.selection=function(){return this._selection},t.prototype.selectedFiles=function(){var e=this,t=this._searchResults.filter(function(t){return e._selection.selected.has(t.fq_path)});return s.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},t.prototype._focusSearchBar=function(){this._isSearchBarFocused=!0,this._highlightedSearchRow=0,this.emit_change()},t.prototype._blurSearchBar=function(){this._isSearchBarFocused=!1,this._highlightedSearchRow=0,this.emit_change()},t.prototype._normalize=function(e){return e.trim().replace(/\ +/g," ")},t.prototype._isBlank=function(e){return!this._normalize(e)},t.prototype._shouldStartNewSearchSession=function(e,t){return!(!this._isBlank(e)||this._isBlank(t))||e.length>=3&&1===t.length},t.prototype._generateRandomID=function(){for(var e="",t=0;t<32;t++){var r=Math.floor(10*Math.random());e+=String(r)}return e},t.prototype._setRawQuery=function(e,t){t?this._searchSessionID=t:this._shouldStartNewSearchSession(this._rawQuery,e)&&(this._searchSessionID=this._generateRandomID()),this._rawQuery=e},t.prototype._setSearchQuery=function(e){var t=e.query;this._setRawQuery(t),this._searchSuggestions=[],this._highlightedSearchRow=0,this._isSearchBarLoading=!!this.normalizedQuery(),this.emit_change()},t.prototype._parseSearchResultsToList=function(e){for(var t=e.searchResults,r=[],s=0,n=t;s<n.length;s++){var o=n[s];switch(o.search_result_type){case"FILE":r.push(l.File.fromServerObject(o));break;case"PAPER":r.push(l.Paper.fromServerObject(o))}}return r},t.prototype._setSearchSuggestions=function(e){var t=e.searchResults;this._isSearchBarLoading=!1,this._searchSuggestions=this._parseSearchResultsToList({searchResults:t}),this.emit_change()},t.prototype._setHighlightedSearchRow=function(e){var t=e.index;this._highlightedSearchRow=t,this.emit_change()},t.prototype._highlightPreviousSearchRow=function(){this._highlightedSearchRow=Math.max(0,this._highlightedSearchRow-1),this.emit_change()},t.prototype._highlightNextSearchRow=function(){this._highlightedSearchRow=Math.min(this._searchSuggestions.length,this._highlightedSearchRow+1),this.emit_change()},t.prototype._startSearch=function(e){var t=e.query,r=e.qsid;this._resetSearchResults(),this._setRawQuery(t,r),this._latestQuery=this.normalizedQuery(),this._loadingState="LOADING_FIRST_PAGE",this.emit_change()},t.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context;this._setSearchResultsInternal(this._parseSearchResultsToList({searchResults:t})),this._loadingState="LOADED",this._browseContext=r,this._updateMoreResults(t),this.emit_change()},t.prototype._setSearchResultsInternal=function(e){this._searchResults=s.List(e)},t.prototype._continueSearch=function(e){e.didLoadDeletedResults&&(this._didLoadDeletedResults=!0),this._loadingState="LOADING_ADDITIONAL_PAGE",this.emit_change()},t.prototype._appendSearchResults=function(e){var t=e.deleted,r=e.searchResults,s=e.context;t&&(this._numDeletedResults+=r.length),this._searchResults=this._searchResults.concat(this._parseSearchResultsToList({searchResults:r})),this._loadingState="LOADED",this._browseContext=s,this._updateMoreResults(r),this.emit_change()},t.prototype._clearSearch=function(){this._resetSearchBar(),this._resetSearchResults(),this.emit_change()},t.prototype._updateMoreResults=function(e){var t=e.length===a.MaxResults.MAX_SEARCH_RESULTS;this._hasMoreLiveResults?this._hasMoreLiveResults=t:this._hasMoreDeletedResults&&(this._hasMoreDeletedResults=t)},t.prototype._setSearchSelection=function(e){var t=e.selection;this._selection=t,this.emit_change()},t.prototype._applyFileDeltas=function(e){var t=e.fileDeltas;if(t){for(var r=function(e,t){var r=void 0;!e&&t?s._searchResults=s._searchResults.push(t):e&&!t?(r=s._searchResults.findIndex(function(t){return n.paths_are_equal(t.fq_path,e)}),s._searchResults=s._searchResults.delete(r)):e&&t&&(r=s._searchResults.findIndex(function(t){return n.paths_are_equal(t.fq_path,e)}),s._searchResults=r>-1?s._searchResults.set(r,t):s._searchResults.push(t))},s=this,o=0,i=t;o<i.length;o++){var a=i[o];r(a.before,a.after)}this.emit_change()}},t.prototype._updateContext=function(e){this._browseContext=e.context},t.prototype._new_payload=function(e){switch(e.action.type){case a.FOCUS_SEARCH_BAR_ACTION:this._focusSearchBar();break;case a.BLUR_SEARCH_BAR_ACTION:this._blurSearchBar();break;case a.SET_SEARCH_QUERY_ACTION:this._setSearchQuery(e.action.data);break;case a.SET_SEARCH_SUGGESTIONS_ACTION:this._setSearchSuggestions(e.action.data);break;case a.SET_HIGHLIGHTED_ROW_ACTION:this._setHighlightedSearchRow(e.action.data);break;case a.HIGHLIGHT_PREVIOUS_ROW_ACTION:this._highlightPreviousSearchRow();break;case a.HIGHLIGHT_NEXT_ROW_ACTION:this._highlightNextSearchRow();break;case a.START_SEARCH_ACTION:this._startSearch(e.action.data);break;case a.SET_SEARCH_RESULTS_ACTION:this._setSearchResults(e.action.data);break;case a.CONTINUE_SEARCH_ACTION:this._continueSearch(e.action.data);break;case a.APPEND_SEARCH_RESULTS_ACTION:this._appendSearchResults(e.action.data);break;case a.SET_SEARCH_SELECTION_ACTION:this._setSearchSelection(e.action.data);break;case a.CHANGE_FILES_ACTION:this._applyFileDeltas(e.action.data);break;case a.CLEAR_SEARCH_ACTION:this._clearSearch();break;case c.BrowseActionTypes.SET_URL_PREFIX:this._clearSearch();break;case c.BrowseActionTypes.LOAD_PATH:this._updateContext(e.action.data)}},t})(o);t.SearchStore=u,t.searchStore=new u}),define("modules/clean/web_user_action_logger",["modules/clean/ajax"],function(e){var t,r,s,n;return n={DOWNLOAD:"download",MOVE:"move",OPEN_MOVE_MODAL:"open_move_modal",RENAME:"rename",ADD_COMMENT:"add_comment",OPEN_COPY_MODAL:"open_copy_modal",COPY:"copy",DELETE:"delete",PERMANENT_DELETE:"permanent_delete",VERSIONS:"versions",SORT_RECORDS:"sort_records",SELECT_ROW:"select_row",OPEN_ROW:"open_row",UPLOAD_FILE:"upload_file",CREATE_FOLDER:"create_folder",VIEW_SHARE_MODEL:"view_share_model",TOGGLE_DELETED_FILES:"toggle_deleted_files",NAV_NEW_PAGE:"nav_new_page",SWITCH_ACCOUNT:"switch_account",SWITCH_TO_GRID_VIEW:"switch_to_grid_view",SWITCH_TO_LIST_VIEW:"switch_to_list_view"},r=3,t=6e5,s=(function(){function s(){}return s.prototype.error_count=0,s.prototype.last_error=Date.now(),s.prototype.should_report=!0,s.prototype.log=function(s,n,o){if(this.should_report&&(this.error_count<r||Date.now()-this.last_error>t))return e.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:s,event_type:n,extra_params:JSON.stringify(o)},error:(function(e){return function(t){return 429===t.status?e.error_count=r:e.error_count+=1,e.last_error=Date.now()}})(this),success:(function(e){return function(t){var r,s;try{return r=JSON.parse(t),(null!=r?r.continue_sending:void 0)||(e.should_report=!1),e.error_count=0}catch(t){throw s=t,e.error_count+=1,e.last_error=Date.now(),s}}})(this)})},s})(),{WebUserActionLog:new s,WebUserActionLogEvents:n,WebUserActionLogClass:s,MAX_ERRORS:r}});
//# sourceMappingURL=pkg-maestro-embedded_app.min.js-vflRGuRM9.map