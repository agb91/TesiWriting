define("modules/clean/base64",[],function(){var e,t,r;return r=function(e){var t,r,o,s,n,i;for(i=[],n=0,t=0,r=0,o=0,s=0,e+="";n<e.length;)r=e.charCodeAt(n),r<128?(i[t++]=String.fromCharCode(r),n++):r>191&&r<224?(o=e.charCodeAt(n+1),i[t++]=String.fromCharCode((31&r)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),s=e.charCodeAt(n+2),i[t++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&s),n+=3);return i.join("")},t=function(e){var t,r,o,s,n,i,a,l,u,c,p,d,h,m;if(r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=void 0,p=void 0,d=void 0,n=void 0,i=void 0,a=void 0,l=void 0,o=void 0,u=0,t=0,s="",m=[],!e)return e;for(;;)if(c=e.charCodeAt(u++),p=e.charCodeAt(u++),d=e.charCodeAt(u++),o=c<<16|p<<8|d,n=o>>18&63,i=o>>12&63,a=o>>6&63,l=63&o,m[t++]=r.charAt(n)+r.charAt(i)+r.charAt(a)+r.charAt(l),!(u<e.length))break;return s=m.join(""),h=e.length%3,(h?s.slice(0,h-3):s)+"===".slice(h||3)},e=function(e,t){var o,s,n,i,a,l,u,c,p,d,h,m,f,_,g;if(h=function(e){return e},a=t?h:r,"function"==typeof window.atob)return a(window.atob(e));if(s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,o=0,g=[],!e)return e;for(e+="";;)if(l=s.indexOf(e.charAt(d++)),u=s.indexOf(e.charAt(d++)),c=s.indexOf(e.charAt(d++)),p=s.indexOf(e.charAt(d++)),n=l<<18|u<<12|c<<6|p,m=n>>16&255,f=n>>8&255,_=255&n,g[o++]=64===c?String.fromCharCode(m):64===p?String.fromCharCode(m,f):String.fromCharCode(m,f,_),!(d<e.length))break;return i=g.join(""),i=a(i)},{encode:t,decode:e}}),define("modules/clean/react/columnheader",["jquery","external/classnames","external/react","external/underscore","modules/clean/react/sprite","modules/core/i18n","modules/clean/css","modules/clean/react/css","modules/clean/react_logger"],function(e,t,r,o,s,n,i,a,l){var u,c,p,d,h,m,f,_,g,b,S,T,w;return f=n._,d=l.ReactLogger,w=r.DOM,T=r.createElement,h={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},p={STATIC:"STATIC",SINGLE:"SINGLE",MULTI:"MULTI"},m=r.PropTypes.shape({label:r.PropTypes.string.isRequired,sortField:r.PropTypes.string,headerClassName:r.PropTypes.string,labelClassName:r.PropTypes.string}),c=r.PropTypes.shape({type:r.PropTypes.oneOf([p.STATIC,p.SINGLE,p.MULTI]).isRequired,label:r.PropTypes.string,headerClassName:r.PropTypes.string,labelClassName:r.PropTypes.string,sortField:r.PropTypes.string,content:r.PropTypes.node,columns:r.PropTypes.arrayOf(m)}).isRequired,S=function(e,t){var r,o,s,n;for(s=0,n=t.length;s<n;s++){if(r=t[s],r.sortField===e)return r;if(r.type===p.MULTI&&(o=S(e,r.columns)))return o}return null},u=r.createClass({displayName:"ColumnHeader",propTypes:{columns:r.PropTypes.arrayOf(c).isRequired,className:r.PropTypes.string,css:r.PropTypes.string,tabbable:r.PropTypes.bool,disabled:r.PropTypes.bool,activeSortField:r.PropTypes.string,activeSortDirection:r.PropTypes.oneOf([h.ASCENDING,h.DESCENDING]),initialMultiColumnSortField:r.PropTypes.string,onSortChange:r.PropTypes.func,onMultiColumnChange:r.PropTypes.func,isMaestroDesign:r.PropTypes.bool},getDefaultProps:function(){return{tabbable:!0,disabled:!1,activeSortField:void 0,activeSortDirection:h.ASCENDING,onSortChange:o.noop,onMultiColumnChange:o.noop,isMaestroDesign:!1}},getInitialState:function(){return{cssLoaded:!1}},componentWillMount:function(){return d.start(this.constructor.displayName),this.props.css?i.require_css(this.props.css,(function(e){return function(){return e.setState({cssLoaded:!0})}})(this)):this.setState({cssLoaded:!0})},componentDidMount:function(){return d.end(this.constructor.displayName)},_didChangeSort:function(e,t){var r,o;return o=e!==this.props.activeSortField,r=t!==this.props.activeSortDirection,o||r},handleSingleColumnClick:function(e){var t,r,o;if(o=e.sortField,t=this.props.activeSortField===e.sortField,r=t?this.props.activeSortDirection===h.ASCENDING?h.DESCENDING:h.ASCENDING:this.props.activeSortDirection,this._didChangeSort(o,r))return this.props.onSortChange(o,r)},handleSubColumnChange:function(e){var t,r;return r=e.sortField,t=h.ASCENDING,this._didChangeSort(r,t)&&this.props.onSortChange(r,t),this.props.onMultiColumnChange(e)},renderStaticColumnHeader:function(e){return T(b,{key:e.label,label:e.label,labelClassName:e.labelClassName||"",className:e.headerClassName||"",content:e.content,role:e.role})},renderSingleColumnHeader:function(e){return T(_,{key:e.label,label:e.label,isActive:this.props.activeSortField===e.sortField,onClick:(function(t){return function(){return t.handleSingleColumnClick(e)}})(this),sortDirection:this.props.activeSortDirection,canTriggerSortDirection:!0,className:e.headerClassName||"",tabbable:this.props.tabbable,disabled:this.props.disabled,isMaestroDesign:this.props.isMaestroDesign})},renderMultiColumnHeader:function(e){return T(g,{key:e.columns[0].label,columns:e.columns,activeSortField:this.props.activeSortField,initialSortField:this.props.initialMultiColumnSortField,onSubColumnChange:this.handleSubColumnChange,tabbable:this.props.tabbable,disabled:this.props.disabled,isMaestroDesign:this.props.isMaestroDesign})},render:function(){var e,t,r,o,s,n;if(this.state.cssLoaded){for(t=[],n=this.props.columns,r=0,s=n.length;r<s;r++)o=n[r],o.type===p.STATIC?t.push(this.renderStaticColumnHeader(o)):o.type===p.SINGLE?t.push(this.renderSingleColumnHeader(o)):o.type===p.MULTI&&t.push(this.renderMultiColumnHeader(o));return e="c-column-header "+this.props.className,w.ul({role:"row",className:e},t)}return w.ul(null)}}),b=r.createClass({displayName:"_StaticColumnHeader",propTypes:{label:r.PropTypes.string.isRequired,labelClassName:r.PropTypes.string,className:r.PropTypes.string.isRequired,content:r.PropTypes.node,role:r.PropTypes.string},getDefaultProps:function(){return{role:"columnheader"}},render:function(){return w.li({role:this.props.role,className:"c-column-header__header u-pad-vertical-xs "+this.props.className},null!=this.props.content?this.props.content:void 0,w.span({className:"col-header-contents "+this.props.labelClassName},this.props.label))}}),_=r.createClass({displayName:"_ColumnHeaderView",propTypes:{label:r.PropTypes.string.isRequired,className:r.PropTypes.string,isActive:r.PropTypes.bool,canTriggerSortDirection:r.PropTypes.bool,nextColumnLabel:r.PropTypes.string,tabbable:r.PropTypes.bool,disabled:r.PropTypes.bool,sortDirection:r.PropTypes.oneOf([h.ASCENDING,h.DESCENDING]),onClick:r.PropTypes.func,isMaestroDesign:r.PropTypes.bool},getDefaultProps:function(){return{className:null,isActive:!1,canTriggerSortDirection:!1,nextColumnLabel:void 0,tabbable:!0,disabled:!1,sortDirection:h.DESCENDING,onClick:o.noop}},renderColumnHeaderLabel:function(){var e,r,o;return this.props.isActive&&this.props.canTriggerSortDirection?(this.props.isMaestroDesign?(r=this.props.sortDirection===h.ASCENDING,e=w.span({key:"icon-element",className:t({"c-column-header__sort-arrow":!0,"c-column-header__sort-arrow--up":r,"c-column-header__sort-arrow--down":!r})})):(this.props.sortDirection===h.ASCENDING?(o="arrow-up-gray","ascending"):(o="arrow-down-gray","descending"),e=T(s,{group:"web",name:o,alt:"",key:"icon-element",className:"c-column-header__sort-icon u-mar-left-xxs u-l-ib--m"})),[w.span({key:"label"},this.props.label),e]):[w.span({key:"label"},this.props.label)]},getActionDescription:function(){var e;return this.props.nextColumnLabel?(e=f("Swap column to %(nextlabel)s",{comment:"nextlabel is the name of the column that the current column will be replaced with when this button is clicked."}),e.format({nextlabel:this.props.nextColumnLabel})):this.props.sortDirection===h.DESCENDING?f("Sort in ascending order"):this.props.sortDirection===h.ASCENDING?f(this.props.isActive?"Sort in descending order":"Sort in ascending order"):null},getAriaDirectionName:function(){if(this.props.isActive){if(this.props.sortDirection===h.ASCENDING)return"ascending";if(this.props.sortDirection===h.DESCENDING)return"descending"}return""},render:function(){var e;return e=t("c-column-header__button u-trim-margin u-trim-padding",{"u-font-strong":this.props.isActive}),w.li({role:"columnheader","aria-sort":this.getAriaDirectionName(),className:"c-column-header__header u-pad-vertical-xs "+this.props.className},w.button({className:e,onClick:this.props.onClick,ref:"columnButton",title:this.getActionDescription(),tabIndex:this.props.tabbable?0:-1,disabled:this.props.disabled},this.renderColumnHeaderLabel()))}}),g=r.createClass({displayName:"_MultiColumnHeader",propTypes:{columns:r.PropTypes.arrayOf(m).isRequired,tabbable:r.PropTypes.bool,disabled:r.PropTypes.bool,activeSortField:r.PropTypes.string,initialSortField:r.PropTypes.string,onSubColumnChange:r.PropTypes.func,isMaestroDesign:r.PropTypes.bool},getDefaultProps:function(){return{tabbable:!0,disabled:!1,activeSortField:void 0,onSubColumnChange:o.noop}},getInitialState:function(){var e,t;return this.props.initialSortField&&(t=S(this.props.initialSortField,this.props.columns),t&&(e=this.props.columns.indexOf(t))),{currentColumnIndex:e||0}},componentWillMount:function(){return this.updateCurrentColumnIndex(this.props.activeSortField)},componentWillReceiveProps:function(e){if(e.activeSortField!==this.props.activeSortField)return this.updateCurrentColumnIndex(e.activeSortField)},updateCurrentColumnIndex:function(e){var t,r;if(r=S(e,this.props.columns))return t=this.props.columns.indexOf(r),t!==this.state.currentColumnIndex&&this.props.onSubColumnChange(r),this.setState({currentColumnIndex:t})},switchToColumn:function(e){return this.props.onSubColumnChange(e)},render:function(){var e,t,r,o;return e=this.props.columns[this.state.currentColumnIndex],r=this.props.activeSortField&&this.props.activeSortField===e.sortField,t=(this.state.currentColumnIndex+1)%this.props.columns.length,o=this.props.columns[t],T(_,{ref:"singleColumn",key:e.label,className:e.headerClassName||"",canTriggerSortDirection:!1,label:e.label,nextColumnLabel:o.label,tabbable:this.props.tabbable,disabled:this.props.disabled,isActive:r,onClick:(function(e){return function(){return e.switchToColumn(o)}})(this),isMaestroDesign:this.props.isMaestroDesign})}}),{ColumnHeader:a(u,["/static/css/components/column-headers-vflwQf9xT.css","/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]),SortDirections:h,ColumnTypes:p}}),define("modules/clean/react/tooltip",["external/react","external/react-dom","external/underscore","jquery"],function(e,t,r,o){var s,n,i,a,l,u,c,p,d,h,m;return c={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},h=e.DOM,i="tooltip-holder",s=7,a=1e4,n="data-event-id",d=function(){var e,t;return e=i,t=o("#"+e),t.length||(t=o("<div />").attr({id:e,style:"z-index: "+a}).prependTo("body")),t[0]},p=function(e){var t,r,o;return r=e.offset(),o=e.outerWidth(),t=e.outerHeight(),{left_x:r.left,right_x:r.left+o,top_y:r.top,bottom_y:r.top+t,width:o,height:t}},u=e.createClass({displayName:"TooltipBubble",propTypes:{position:e.PropTypes.oneOf((function(){var e;e=[];for(m in c)e.push(c[m]);return e})()),contents:e.PropTypes.oneOfType([e.PropTypes.element,e.PropTypes.string]),className:e.PropTypes.string,mouse_move_cb:e.PropTypes.func,mouse_out_cb:e.PropTypes.func,targetElementDimensions:e.PropTypes.shape({left_x:e.PropTypes.number,right_x:e.PropTypes.number,top_y:e.PropTypes.number,bottom_y:e.PropTypes.number,width:e.PropTypes.number,height:e.PropTypes.number})},render:function(){var e,t,r,n,i;return t=this.props.targetElementDimensions,r=o(window),i=o(window).scrollTop(),n=o(window).scrollLeft(),e=function(){switch(this.props.position){case c.TOP:return{bottom:r.height()-t.top_y+s+i};case c.BOTTOM:return{top:t.bottom_y+s-i};case c.LEFT:return{right:r.width()-t.left_x+s+n};case c.RIGHT:return{left:t.right_x+s-n}}}.call(this),h.div({className:"tooltip-bubble "+(this.props.className||""),ref:"tooltip",style:e,onMouseMove:this.props.mouse_move_cb?this.props.mouse_move_cb:void 0,onMouseLeave:this.props.mouse_out_cb?this.props.mouse_out_cb:void 0},h.div({className:"tooltip-inner"},this.props.contents))},componentDidMount:function(){return this._centerAndShow()},componentDidUpdate:function(){return this._centerAndShow()},_centerAndShow:function(){var e,r,n,i,a,l,u,d,h,m,f;return e=o(t.findDOMNode(this.refs.tooltip)),u=this.props.targetElementDimensions,d=p(e),l=o(window).scrollTop(),a=o(window).scrollLeft(),(n=this.props.position)===c.TOP||n===c.BOTTOM?(f=o(window).width(),r=u.left_x+u.width/2-d.width/2-a,r<0?r=0:r+d.width>f&&(r=f-d.width-s),e.css("left",r+"px")):(i=this.props.position)!==c.LEFT&&i!==c.RIGHT||(m=o(window).height(),h=u.top_y+u.height/2-d.height/2-l,h<0?h=0:h+d.height>m&&(h=m-d.height-s),e.css("top",h+"px")),e.show()}}),l=e.createClass({displayName:"Tooltip",propTypes:{position:e.PropTypes.oneOf((function(){var e;e=[];for(m in c)e.push(c[m]);return e})()),tooltip_contents:e.PropTypes.oneOfType([e.PropTypes.element,e.PropTypes.string]),tooltip_classname:e.PropTypes.string,hide_delay:e.PropTypes.number,interaction_enabled:e.PropTypes.bool,is_focusable:e.PropTypes.bool},render:function(){return h.div({className:"tooltip-target",onMouseMove:(function(e){return function(t){return e._show(t)}})(this),onFocus:(function(e){return function(t){return e._show(t)}})(this),onMouseLeave:this._on_mouse_leave(),onBlur:this._on_mouse_leave(),id:this.state.tooltip_id,ref:"tooltipTarget",tabIndex:this.props.is_focusable?0:void 0},this.props.children)},componentDidMount:function(){return o(document).bind("scroll."+this.state.event_id,(function(e){return function(t){return e._hide(t)}})(this))},componentDidUpdate:function(){if(this.state.visible)return this._render_tooltip()},componentWillUnmount:function(){var e;return o(document).unbind("scroll."+this.state.event_id),e=d(),t.unmountComponentAtNode(e)},_on_mouse_leave:function(e){return(function(e){return function(t){return e.props.hide_delay>0?e._scheduleHide(e.props.hide_delay):e._hide(t)}})(this)},_render_tooltip:function(){var r,s;return s=d(),o("#"+i).css("position","fixed"),o("#"+i).css("left","0"),o("#"+i).css("right","0"),this.props.hide_delay>0&&o("#"+i).attr(n,this.state.event_id),this.props.position===c.TOP?(o("#"+i).css("top","auto"),o("#"+i).css("bottom","0")):(o("#"+i).css("top","0"),o("#"+i).css("bottom","auto")),r=e.createElement(u,{position:this.props.position,contents:this.props.tooltip_contents,className:this.props.tooltip_classname,mouse_move_cb:this.props.interaction_enabled?this._clear_timeout:void 0,mouse_out_cb:this.props.interaction_enabled?this._on_mouse_leave():void 0,targetElementDimensions:p(o(t.findDOMNode(this.refs.tooltipTarget)))}),t.unmountComponentAtNode(s),t.render(r,s)},_show:function(){if(!this.state.visible||this._last_timeout)return this._render_tooltip(),this.setState({visible:!0}),this._clear_timeout()},_hide:function(){var e,r;if(this.state.visible)return r=d(),this._last_timeout?(e=o(r).attr(n),e===this.state.event_id&&(t.unmountComponentAtNode(r),this._clear_timeout())):t.unmountComponentAtNode(r),this.setState({visible:!1})},_scheduleHide:function(e){if(this.state.visible)return this._last_timeout=setTimeout(this._hide,e)},_clear_timeout:function(){if(this._last_timeout)return clearTimeout(this._last_timeout),this._last_timeout=null},getInitialState:function(){return{visible:!1,event_id:r.uniqueId()}},getDefaultProps:function(){return{interaction_enabled:!1,hide_delay:0}}}),{Tooltip:l,TooltipPosition:c}}),define("modules/clean/photos/thumb_loading/generic_thumb_store",["modules/core/exception","modules/clean/photos/thumb_loading/http2_thumb_loader"],function(e,t){var assert;return assert=e.assert,(function(){function e(e,r){this._loader_batches=null!=r&&r,this._thumb_url_to_data={},this._callbacks_by_request_id={},this.thumb_loader=null!=e?e:new t}return e.prototype.is_batching=function(){return this._loader_batches},e.prototype.bind_url=function(e,t){var r,o,s,n,i,a,l,u;return s=t.onSuccess,r=t.onError,o=t.onRequest,assert(s,"missing onSuccess handler"),e in this._thumb_url_to_data?("function"==typeof o&&o(!0),s(!0),null):(l=this._get_request_id(),this._callbacks_by_request_id[l]={onSuccess:s,onError:r,onRequest:o},i=(function(e){return function(){var t;return null!=(t=e._callbacks_by_request_id[l])&&"function"==typeof t.onRequest?t.onRequest(!1):void 0}})(this),a=(function(t){return function(r){var o;return t._thumb_url_to_data[e]=r,null!=(o=t._callbacks_by_request_id[l])?o.onSuccess(!1):void 0}})(this),n=(function(e){return function(){var t;return null!=(t=e._callbacks_by_request_id[l])&&"function"==typeof t.onError?t.onError():void 0}})(this),u=(function(e){return function(){return l in e._callbacks_by_request_id}})(this),this.thumb_loader.load_image(e,l,i,a,n,u),l)},e.prototype._get_request_id=function(){return this.thumb_loader.get_request_id()},e.prototype.unbind_url=function(e){if(null!=e)return delete this._callbacks_by_request_id[e],this.thumb_loader.cancel_thumb(e)},e.prototype.get_thumb=function(e){return e in this._thumb_url_to_data?this._thumb_url_to_data[e]:null},e})()}),define("modules/clean/photos/thumb_loading/http2_thumb_loader",["modules/clean/photos/thumb_loading/utils"],function(e){var t;return t=e.load_individual_image,(function(){function e(){this._http2_request_id=0}return e.prototype.get_request_id=function(){var e;return e=this._http2_request_id,this._http2_request_id+=1,e},e.prototype.load_image=function(e,r,o,s,n,i){return o(),t(e,1,s,n,i)},e.prototype.cancel_thumb=function(e){},e})()}),define("modules/clean/photos/thumb_loading/utils",[],function(){var e;return e=function(e,t,r,o,s){var n;return n=new Image,n.onload=function(){return r(e)},n.onerror=function(){return t>0&&s()?(t-=1,n.src=e):o()},n.src=e},{load_individual_image:e}});var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},slice=[].slice;define("modules/clean/notserver",["jquery","external/underscore","modules/constants/notserver","modules/core/exception","modules/core/uri","modules/clean/viewer"],function(e,t,r,o,s,n){var i,a,l,u,assert,c,p,d,h;assert=o.assert,i={},a=!1,u="/subscribe",l=(function(){function r(){}return r.prototype.add_notclient=function(e,t){return this.new_notclient(e),setTimeout(function(){return i[e].init(t)},2e3)},r.prototype.new_notclient=function(r){var o,n,l,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D,N,C,I,R,M,A,O,x,L,U,k,B,G,V,H,q,W,j,z,K,Y;return assert(indexOf.call(i,r)<0,"cannot create more than one notclient per user"),P=function(e){return t.isNumber(e)&&e%1===0&&e>0},F=function(e){return t.isNumber(e)&&e%1===0&&e>=0},assert(P(r),"user_id must be a positive integer"),D=function(){var e;if(e=1<=arguments.length?slice.call(arguments,0):[],a)return console.log.apply(console,e)},o=9e4,c=8096,d="user",p="list",y=!1,n=1e3,l=3e5,A=0,W=function(){var e;return e=0===S?0:Math.min(n*Math.pow(2,S-1),l),Math.max(e,A)},R=null,O={},w={},I=1,v=!1,E=!1,Y=null,f=!1,U=!1,z=[],q=null,b=null,N=null,C={},x=!1,S=0,j=0,K=function(e,t){var r,o,s;o=[];for(r in t)s=t[r],r=parseInt(r,10),assert(P(r),"ns_ids must be positive integers: "+r),assert(F(s),"sjids must be nonnegative integers: "+s),null!=e[r]?o.push(e[r]=Math.min(e[r],s)):o.push(e[r]=s);return o},_=function(){var e,o,n,i;return assert(!t.isEmpty(O),"expected ns_map"),n={host_int:0,trace:window.location.pathname},e=t.pluck(t.values(w),"type"),indexOf.call(e,d)>=0&&(assert(null!=R,"expected nid"),n.user_id=r,n.nid=null!=R?R.replace(/^0+(.)/,"$1"):void 0),indexOf.call(e,p)>=0&&(n.ns_map=(function(){var e;e=[];for(o in O)i=O[o],e.push(o+"_"+i);return e})().join(",")),s.parse(u).updateQuery(n).toString().length>c&&delete n.ns_map,n},g=function(){var e;if(y)return e=W(),e>0?b=window.setTimeout(h,e):U?void 0:h()},h=function(){var r;return assert(!v&&!E,"connect: invalid state"),assert(R>=0||!t.isEmpty(O),"notclient: called connect with nothing to subscribe to"),D("###########################"),r=_(),null!=r.nid||r.ns_map?(D("connecting to notserver..."),v=!0,j+=1,Y=e.ajax(u,{data:r,dataType:"json",error:function(){return f?void(f=!1):(S+=1,D("error connecting to notserver. bad rounds="+S+"."),v=!1,g())},success:function(e){return D("notserver connection closed. response:",e),v=!1,null!=e.chillout?(A=1e3*parseInt(e.chillout,10),D("notserver told us to chill for "+A+"ms")):A>0&&(D("setting notserver chillout back to 0ms"),A=0),"punt"===e.ret?g():(assert("new"===e.ret,"unknown notserver ret: "+e.ret),assert("refresh"in e,"expected notserver ret:new to have refresh keyword"),H(e.refresh))}})):void D("nothing to subscribe to. skipping notserver connection.")},m=function(){if(null!=Y)return f=!0,Y.abort(),Y=null},L=function(){return U=!0,m()},V=function(){return L=!1,g()},k=function(){return A=0,v=!1,E=!1,m(),z=[],window.clearTimeout(q),window.clearTimeout(b),q=null,b=null,N=null,C={},x=!1,S=0,g()},G=function(){return y=!1,A=0,R=null,O={},w={},0,I=1,v=!1,E=!1,Y=null,f=!1,z=[],window.clearTimeout(q),window.clearTimeout(b),q=null,b=null,N=null,C={},x=!1,S=0,j=0},H=function(e){var r,s,n,i,a,l,u,c;for(assert(!E&&!v,"run_handlers: invalid state"),assert(null===N,"run_handlers: new_nid must start at null"),assert(t.isEqual(C,{}),"run_handlers: new_ns_map must start at {}"),assert(!x,"expected one_or_more_handler_failures=false"),E=!0,D("running handlers..."),u=t.filter(t.values(w),function(t){var r;return r=t.type,indexOf.call(e,r)>=0}),assert(!t.isEmpty(u),"notserver sent a ping for unsubscribed activity"),z=t.pluck(u,"handler_id"),n=0,i=u.length;n<i;n++)l=u[n],r=l.handler,s=l.handler_id,a=l.name,c=l.type,D("running id="+s+", name="+a+", type="+c),r();return t.isEmpty(z)?D("all handlers already finished running. no need for a slacker timeout."):(D("all handlers running. slacker timeout set."),q=window.setTimeout(B,o))},B=function(){var e,r,o,s;for(assert(E&&!v,"called report_slackers in an invalid state."),assert(!t.isEmpty(z,"report_slackers called w/ nothing slackin'")),D("found some slackers"),x=!0,s=[],r=0,o=z.length;r<o;r++)e=z[r],s.push(T(e));return s},T=function(e){if(!(indexOf.call(z,e)<0))return D("done handling: "+e),z=t.without(z,e),t.isEmpty(z)?(D("all handlers are done running."),E=!1,window.clearTimeout(q),null!=N&&(D("new nid: "+N),R=N),t.isEmpty(C)||(D("new ns_map:",C),O=C),x?(S+=1,D("one or more handler errors. bad_rounds="+S)):S=0,N=null,C={},x=!1,g()):void 0},M={get_user_id:function(){return r},get_nid:function(){return R},get_ns_map:function(){return t.clone(O)},get_consecutive_bad_rounds:function(){return S},get_total_rounds:function(){return j},get_notserver_chillout_ms:function(){return A},get_sleep_ms:W,subscribe_user:function(e){var r,o,s,n,i,a,l;for(assert(!E,"adding new handlers from inside handlers is not currently supported"),l=["name","handler","nid"],s=0,n=l.length;s<n;s++)a=l[s],assert(e[a],"subscribe_user requires this param be non-falsey: "+a+", "+e[a]);return assert(t.isFunction(e.handler),"handler must be a function"),D("adding user handler "+e.name),o=t.pluck(t.values(w),"type"),i=indexOf.call(o,d)<0,r=I++,w[r]={handler_id:r,handler:e.handler,name:e.name,type:d},(null==R||e.nid<R)&&(R=e.nid,i=!0),i&&(D("first user handler added, reconnecting"),k()),r},subscribe_sfj:function(e){var r,o,s,n,i,a,l;for(assert(!E,"adding new handlers from inside handlers is not currently supported"),l=["name","handler"],s=0,n=l.length;s<n;s++)a=l[s],assert(e[a],"subscribe_sfj requires this param be non-falsey: "+a);return assert(t.isFunction(e.handler),"handler must be a function"),D("adding sfj handler "+e.name),o=t.pluck(t.values(w),"type"),i=indexOf.call(o,p)<0,r=I++,w[r]={handler_id:r,handler:e.handler,name:e.name,type:p},i&&(D("first sfj handler added, reconnecting"),k()),r},unsubscribe:function(e){if(assert(!E,"removing handlers from inside handlers is not supported"),assert(e in w,"no subscribed handler with the given id"),delete w[e],t.isEmpty(w))return m()},handler_success:function(e,t){var r;if(!(indexOf.call(z,e)<0))return r=w[e].type,r===p?(assert("ns_map"in t,"ns_map required param is missing"),assert(!("nid"in t),"nid is disallowed from SFJ handlers"),K(C,t.ns_map)):(assert(r===d,"unknown handler type: "+r),assert("nid"in t,"nid required param is missing"),assert(!("ns_map"in t),"ns_map is disallowed from user handlers"),(null==N||t.nid<N)&&(N=t.nid)),T(e)},handler_failure:function(e){if(D("handler failed. handler_id="+e),!(indexOf.call(z,e)<0))return x=!0,T(e)},handle_visibility_change:function(){return window.document.hidden?m():k()},init:function(e){return assert(!y,"error: init() has been called twice."),K(O,e),y=!0,null==window.document.visibilityState?g():(document.addEventListener("visibilitychange",this.handle_visibility_change),window.document.hidden?void 0:g())},reset:G,abort:m,pause:L,resume:V,reconnect:k},i[r]=M,M},r})(),l=new l,d=n.get_viewer().get_users();for(c=0,p=d.length;c<p;c++)h=d[c],l.add_notclient(h.id,r.NS_MAP[h.id]);return{NotServer:l,NotClients:i}}),define("modules/clean/file_operations/notifications",["external/underscore","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,n,i,a,l){var u,c,p,d,h,m,f,_,g,b,S;return u=a._,S=a.ungettext,b=function(e,t,r,o,i){var a;return a=function(){return s.rollbackChangeSets({changesets:r,userId:t.id,progressText:u("Undoing…"),rollbackHints:o,onSuccess:function(){return l.success(u("Undo complete.")),"function"==typeof i?i():void 0}})},n.notifyWithUndo(e,r,a)},c=function(s,n){var i,a,l;return a=t.browse_uri_for_fq_path(n,s),l=40,i=r.em_snippet(o.filename(s),l),{href:a,text:e.escape(i)}},p=function(e,t,r,o,s,n){var a,l,u;return null==o&&(o=null),o?(a=c(o,t),u=S('Copied %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Copied %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e),l=u.format({num_items:e,dest_href:a.href,dest_name:a.text}),l=new i(l)):(l=S("Copied %(num_items)d item.","Copied %(num_items)d items.",e),l=l.format({num_items:e})),b(l,t,r,s,n)},m=function(e,t,r,o,s,n){var a,l,u;return l=null,o?(a=c(o,t),u=S('Moved %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Moved %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e),l=u.format({num_items:e,dest_href:a.href,dest_name:a.text}),l=new i(l)):(u=S("Moved %(num_items)d item.","Moved %(num_items)d items.",e),l=u.format({num_items:e})),b(l,t,r,s,n)},d=function(e,t,r,o,s){var n,a;return a=S("Deleted %(num_items)d item.","Deleted %(num_items)d items.",e),n=a.format({num_items:e}),n=new i(n),b(n,t,r,o,s)},_=function(e,t,r,o){var s;return s=u("Rename complete."),s=new i(s),b(s,e,t,r,o)},h=function(e,t,r){var o,s;return s=u("Created folder %(folder_name)s."),o=s.format({folder_name:e}),o=new i(o),b(o,t,r)},f=function(e){var t,r;return r=S("Permanently deleted %(num)s item.","Permanently deleted %(num)s items.",e),t=r.format({num:e}),l.success(t)},g=function(t){var r,s,n,a;return r=t.length,1===r?(s=o.filename(t[0].fq_path),s=e.escape(s),a=u("Restored <strong>%(filename)s</strong>."),n=a.format({filename:s}),n=new i(n)):(a=S("Restored %(num)s file.","Restored %(num)s files.",r),n=a.format({num:r})),l.success(n)},{notifyCopySuccess:p,notifyMoveSuccess:m,notifyDeleteSuccess:d,notifyRestoreSuccess:g,notifyPurgeSuccess:f,notifyFolderCreationSuccess:h,notifyRenameSuccess:_}}),define("modules/clean/pagination_manager",["modules/clean/ajax","modules/core/notify","modules/core/i18n"],function(e,t,r){var o;return o=r._,(function(){function r(){}var s,n;return s=(function(){function e(e,t){this.userRole=e,this.hasMoreItems=t}return e.prototype.areAllItemsReady=function(e){return null==e&&(e=this.userRole),"both"===e?!(this.hasMoreItems.personal||this.hasMoreItems.work):!this.hasMoreItems[e]},e.prototype.invalidateHasMore=function(){var e,t;e=[];for(t in this.hasMoreItems)e.push(this.hasMoreItems[t]=!0);return e},e.prototype.addDataToAjax=function(e){return e.role=this.areAllItemsReady()?"both":this.userRole},e})(),n=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){return this.hasMoreItems=!0},e.prototype.addDataToAjax=function(){},e})(),r.prototype.initialize=function(e,t,r,o,s){return this.ajaxURL=r,this.newDataCallback=s,this.autoFetching=!1,this.mode=new n(e.has_more_items),this.keyName=t,this.items={},this.pages=[],this.nextRequestVoucher=e.next_request_voucher,this.userID=o,this._addPage(e.items)},r.prototype.areAllItemsReady=function(e){return this.mode.areAllItemsReady(e)},r.prototype._addPage=function(e){var r,s,n,i,a,l;for(l=[],a=[],r=0,i=e.length;r<i;r++){if(s=e[r],n=s[this.keyName],null==n)return void t.warning(o("Invalid server response"));null==this.items[n]&&(this.items[n]=s,a.push(s),l.push(n))}return this.pages.push(l),this.newDataCallback(this,a)},r.prototype.startAutoFetching=function(){return this.autoFetching=!0,this.fetchNext()},r.prototype.stopAutoFetching=function(){return this.autoFetching=!1},r.prototype.setUserRole=function(e){return this.mode=new s(e,this.mode.hasMoreItems)},r.prototype.reSync=function(e){var t;if(null==e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]),t=this.autoFetching&&this.mode.areAllItemsReady("both"),this.mode.invalidateHasMore(),t)return this.startAutoFetching()},r.prototype.fetchNext=function(){var r;if(!this.mode.areAllItemsReady("both"))return r={},this.nextRequestVoucher&&(r.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(r),e.WebRequest({url:this.ajaxURL,data:r,subject_user:this.userID,success:(function(e){return function(t){return t=JSON.parse(t),e.nextRequestVoucher=t.next_request_voucher,e.mode.hasMoreItems=t.has_more_items,e.autoFetching&&e.fetchNext(),e._addPage(t.items)}})(this),error:function(){return t.error(o("There was a problem completing this request."))}})},r.prototype.loadedPageCount=function(){return this.pages.length},r.prototype.getLoadedPage=function(e){var t,r,o,s,n;if(s=[],n=this.pages[e],null==n)return null;for(t=0,o=n.length;t<o;t++)r=n[t],s.push(this.items[r]);return s},r.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},r})()}),define("modules/clean/react/flag",["external/classnames","external/underscore","external/react","modules/clean/react/css"],function(e,t,r,o){var s,n,i;return i=r.DOM,n=r.createClass({displayName:"Flag",propTypes:{alignment:r.PropTypes.oneOf(["top","middle","bottom"]),leftAttachment:r.PropTypes.oneOfType([r.PropTypes.element,r.PropTypes.node]),rightAttachment:r.PropTypes.oneOfType([r.PropTypes.element,r.PropTypes.node]),spacing:r.PropTypes.oneOf(["xs","s","m","l","xl"]),children:r.PropTypes.oneOfType([r.PropTypes.element,r.PropTypes.node])},getDefaultProps:function(){return{alignment:"middle"}},render:function(){var t,r,o,s,n,a;return s={"o-flag":!0},s["o-flag--"+this.props.alignment]=this.props.alignment,t=s,n={"o-flag__flex":!0},n["u-pad-left-"+this.props.spacing]=this.props.spacing&&this.props.leftAttachment,n["u-pad-right-"+this.props.spacing]=this.props.spacing&&this.props.rightAttachment,r=n,o=this.props.leftAttachment?i.div({className:"o-flag__fix"},this.props.leftAttachment):void 0,a=this.props.rightAttachment?i.div({className:"o-flag__fix"},this.props.rightAttachment):void 0,i.div({className:e(t)},o,i.div({className:e(r)},this.props.children),a)}}),s=o(n,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]),{Flag:s,FlagWithoutCss:n}}),define("modules/clean/payments/pro_trial_onboarding_tour",["jquery","modules/clean/react/pro/pro_onboarding_tour_modal"],function(e,t){var r,o;return r=t.ProOnboardingTourModal,o=(function(){function e(e,t,o,s,n){this.$container=e,this.modal_autoshow=t,this.modal_id=o,this.modal_paths=s,this.modal_content=n,this.tourProps={modalId:this.modal_id,onboardingPaths:this.modal_paths,contentSource:this.modal_content},this.modal_autoshow&&r.renderWithProps(this.tourProps),this._listen()}return e.prototype._listen=function(){return this.$container.find(".start-tour").on("click",(function(e){return function(t){return t.preventDefault(),r.renderWithProps(e.tourProps)}})(this))},e})(),{ProTrialOnboardingTourHeaderLink:o}}),
define("modules/clean/previews/util",["require","exports","modules/core/browser","modules/clean/analytics","modules/clean/datetime","modules/clean/filepath","modules/clean/react/previews/constants","modules/constants/file_viewer","modules/clean/sharing/constants","modules/constants/static","modules/core/uri"],function(e,t,r,o,s,n,i,a,l,u,c){"use strict";function p(){return".react-file-viewer__preview iframe"}function d(e){return void 0===e&&(e=""),g(e)&&a.DOCPREVIEW_EXCEL2}function h(e){return a.FILE_VIEWER_PASS_ENABLED&&!!(null!=e?e.is_team:void 0)}function m(e){return null!=e&&a.FILE_VIEWER_PASS_GA_RECEIVE_ENABLED}function f(e){return l.TRUELINK.NO_COMMENT_ENABLED&&!!(null!=e?l.TRUELINK.NO_COMMENT_ENABLED[e.id]:void 0)}function _(){return a.FILE_VIEWER_VIDEO_USE_HLS}function g(e){return["xls","csv","ods"].indexOf(e.substring(0,3))>-1}function b(e){return n.file_extension(e.fq_path||e.filename)}function S(e){return n.filename(e.fq_path||e.filename)}function T(e){if("indd"===e)return e;var t=e.substring(0,3);switch(t){case"rtf":case"odt":return"doc";case"pps":case"odp":return"ppt";case"csv":case"ods":return"xls";default:return t}}function w(e,t){var r,o=T(e),s=c.parse(t);return"xls"!==o||d(o)||(r="xls/preview"),null!=r&&(s.setPath(s.getPath().replace("/pri/get/","/get/")),s.setPath(s.getPath().replace("/get/","/"+r+"/"))),s=s.updateQuery({get_preview:"1"})}function y(e){return d(e)?c.parse(u.static_url_pdfjs_excel):c.parse(u.static_url_pdfjs_viewer)}function v(e){return s.getActingTime(1e3*e.ts)}function E(e){return e=e.updateQuery({annotation_highlight:"1"}),e=e.updateQuery({annotation_region:"1"})}function F(e,t){var r={};return r._subject_uid=String(t),e.updateQuery(r)}function P(e,t){return F(new c({path:"/history"+e.fq_path}),t.id)}function D(e,t){o.UserActivityLogger.log("web","view_version_history");var s=P(e,t);r.redirect(s.toString())}function N(e){return t.VALID_PREVIEW_TYPES.indexOf(e.preview_type)>-1}function C(e){var t=b(e),r=e.bytes,o=Number.MAX_VALUE;return"pdf"===t?o=Number(83886080):"text"===e.preview_type?o=Number(4194304):"linkfile"===e.preview_type?o=Number(10240):r=0,r<o}function I(e){return 0===e.bytes}function R(e){return N(e)&&C(e)}function M(e){var t=b(e);return R(e)&&A(t)}function A(e){var t=T(e);return["doc","ppt","xls","key","eps","ai","indd"].indexOf(t)>-1}function O(e){return["excel","text","doc"].indexOf(e)>-1}function x(e){var t=i.ErrorTypes.LOAD_ERROR;return e===i.RivieraPreviewResponseTypes.UNSUPPORTED_FORMAT?t=i.ErrorTypes.EXTENSION_ERROR:e===i.RivieraPreviewResponseTypes.TOO_BIG?t=i.ErrorTypes.FILE_SIZE_ERROR:e===i.RivieraPreviewResponseTypes.PASSWORD_PROTECTED&&(t=i.ErrorTypes.PASSWORD_PROTECTED_ERROR),t}t.getIframeQuery=p,t.use_excel2_for_extension=d,t.is_pass_enabled=h,t.is_pass_ga_receive_enabled=m,t.is_user_no_comment_enabled=f,t.use_hls_video=_,t.is_excel2_file=g,t.get_extension=b,t.get_filename=S,t.normalize_extension=T,t.get_progressive_url=w,t.get_pdf_js_url=y,t.getModifierString=v,t.update_url_for_annotation=E,t.update_url_with_user_id=F,t.getVersionHistoryUrl=P,t.redirectToVersionHistory=D,t.VALID_PREVIEW_TYPES=["photo","video","linkfile","adobecs","doc","excel","html","text","audio","archive"],t.extensionSupported=N,t.filesizeSupported=C,t.isEmptyFile=I,t.isPreviewable=R,t.canGeneratePreview=M,t.extCanGeneratePreview=A,t.usesFrameMessenger=O,t.mapRivieraStatusToErrorType=x,t.extractLastNumberFromVariant=function(e){var t=e.lastIndexOf("_");return t>=0?parseInt(e.substr(t+1),10)||null:null}}),define("modules/clean/react/async_file_modal_controller",["require","exports"],function(e,t){"use strict";function r(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showCopy.apply(r,t)})}function o(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showMove.apply(r,t)})}function s(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showOverquota.apply(r,t)})}function n(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showRestore.apply(r,t)})}function i(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showPermanentlyDelete.apply(r,t)})}function a(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showDelete.apply(r,t)})}function l(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/react/file_modal_controller"],function(e){var r=e.FileModalController;r.showNoAccess.apply(r,t)})}t.showCopy=r,t.showMove=o,t.showOverquota=s,t.showRestore=n,t.showPermanentlyDelete=i,t.showDelete=a,t.showNoAccess=l}),define("modules/clean/react/browse/action_logger",["modules/clean/web_user_action_logger","modules/clean/react/browse/store"],function(e,t){var r,o,s,n,i;return n=e.WebUserActionLog,i=e.WebUserActionLogEvents,s=t.BrowseStore,r={MAESTRO_RIGHT_SIDEBAR:"MAESTRO_RIGHT_SIDEBAR",LEGACY_CONTEXT_MENU:"LEGACY_CONTEXT_MENU",LEGACY_HEADER_ACTIONS:"LEGACY_HEADER_ACTIONS",DRAG:"DRAG"},o=(function(){function e(){}return e.prototype._countFilesAndFolders=function(){var e,t,r;return r=s.selectedFiles().toArray(),e=r.filter(function(e){return e.is_dir}).length,t=r.filter(function(e){return!e.is_dir}).length,{num_files:t,num_dirs:e}},e.prototype._logGeneralAction=function(e,t,r,o,s){var i,a,l;return l=this._countFilesAndFolders(),a=l.num_files,i=l.num_dirs,n.log(e,s,{num_files_selected:a,num_folders_selected:i,source:o})},e.prototype.logSelectRow=function(e){var t,r;return r=e.uid,t=e.entity_type,n.log(r,i.SELECT_ROW,{entity_type:t})},e.prototype.logOpenRow=function(e){var t,r,o;return o=e.uid,t=e.entity_type,r=e.source,n.log(o,i.OPEN_ROW,{entity_type:t,source:r})},e.prototype.logUploadFile=function(e){var t,r,o,s,a;return o=e.uid,r=e.num_files,t=e.num_dirs,a=e.uploader_type,s=e.upload_method,n.log(o,i.UPLOAD_FILE,{num_files:r,num_dirs:t,uploader_type:a,upload_method:s})},e.prototype.logCreateFolder=function(e){var t;return t=e.uid,n.log(t,i.CREATE_FOLDER,{})},e.prototype.logViewShareModel=function(e){var t,r;return r=e.uid,t=e.modal_session_id,n.log(r,i.VIEW_SHARE_MODEL,{modal_session_id:t})},e.prototype.logToggleDeletedFiles=function(e){var t,r;return r=e.uid,t=e.show_deleted_files,n.log(r,i.TOGGLE_DELETED_FILES,{show_deleted_files:t})},e.prototype.logSortRecords=function(e){var t,r,o;return o=e.uid,t=e.sort_by,r=e.sort_direction,n.log(o,i.SORT_RECORDS,{sort_by:t,sort_direction:r})},e.prototype.logSwitchToGridView=function(e){var t;return t=e.uid,n.log(t,i.SWITCH_TO_GRID_VIEW,{})},e.prototype.logSwitchToListView=function(e){var t;return t=e.uid,n.log(t,i.SWITCH_TO_LIST_VIEW,{})},e.prototype.logVersions=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.VERSIONS)},e.prototype.logOpenMoveModal=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.OPEN_MOVE_MODAL)},e.prototype.logMoveFiles=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,e.newPath,o=e.source,this._logGeneralAction(s,r,t,o,i.MOVE)},e.prototype.logRenameFiles=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.RENAME)},e.prototype.logAddComment=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.ADD_COMMENT)},e.prototype.logDownload=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.DOWNLOAD)},e.prototype.logOpenCopyModal=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.OPEN_COPY_MODAL)},e.prototype.logCopyFiles=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.COPY)},e.prototype.logDeleteFiles=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.DELETE)},e.prototype.logPermanentDeleteFiles=function(e){var t,r,o,s;return s=e.uid,r=e.path,t=e.files,o=e.source,this._logGeneralAction(s,r,t,o,i.PERMANENT_DELETE)},e})(),{BrowseLogger:new o,BrowseLogEventSources:r}});var bind=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/react/browse/actions",["jquery","external/underscore","modules/clean/browse_interface","modules/clean/downloads","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/clean/react/previews/constants","modules/clean/sharing/browse_exports","modules/constants/python","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri","require"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v){var E,F,P,D,N,C,I,R,M,A,O;return E=p.BrowseActionTypes,N=p.REACT_FILE_VIEWER_ELEMENT_ID,P=d.File,F=m.BrowseStore,f.PreviewSourceContext,f.PreviewSourceAction,D=_.GoldenGate,C=T._,O=T.ungettext,I=[".maestro-chrome","#maestro-nav","#page-footer","#page-header","#page-sidebar","#browse-box",".growth-onboarding-progress-bar__container",".team-progress-bar-experience","#flash-upload-container"].join(),R=function(){return v("modules/clean/react/file_viewer/controller")},M=function(){return v.defined("modules/clean/react/file_viewer/controller")},A=function(t){var r,o,s,n,i,a,l,u,c,p,d,h;return o=t.files,s=t.indexOfPreviewFile,h=t.user,p=t.shouldFocusComment,d=null==(a=t.updateBrowserLocation)||a,n=null!=(l=t.onCloseViewer)?l:function(){return{}},i=null!=(u=t.onViewerUnmount)?u:function(){return{}},r=null!=(c=t.fileViewAction)?c:g.FileViewActionType.CLICK,v(["modules/clean/react/file_viewer/controller"],function(t){return t.open(o,s,h,N,{fileViewTarget:g.FileViewTargetType.PRIVATE,fileViewOrigin:g.FileViewOriginType.BROWSE,fileViewAction:r,shouldFocusCommentInput:p,disableRouting:!d,onCloseViewer:n,onComponentDidMount:function(){return e(I).hide()},onComponentWillUnmount:function(){return e(I).show(),i()}})})},new((function(){function e(){this.computeAndApplyDeltasFromNotServer=bind(this.computeAndApplyDeltasFromNotServer,this),this.pasteClipboardFilesToCurrentPath=bind(this.pasteClipboardFilesToCurrentPath,this)}return e.prototype.initializeEverything=function(e){var t,r,o,s,n,a,l,u,c,p;return p=e.user,a=e.path,r=e.files,c=e.urlPrefix,t=e.context,n=e.mountPoints,l=e.shouldShowDeletedFiles,o=e.fqPathsToSelect,s=e.loadingState,u=e.teamFolders,i.dispatch({type:E.INITIALIZE_EVERYTHING,data:{user:p,path:a,files:r,urlPrefix:c,context:t,mountPoints:n,shouldShowDeletedFiles:l,fqPathsToSelect:o,loadingState:s,teamFolders:u}})},e.prototype._dataApi=c,e.prototype.load=function(e){var t,r,o;return o=e.path,r=e.files,t=e.context,h.load({path:o,files:r,context:t})},e.prototype.add=function(e){var t,r;return r=e.path,t=e.files,h.add({path:r,files:t})},e.prototype.setContextFile=function(e){var t;return t=e.file,i.dispatch({type:E.SET_CONTEXT_FILE,data:{file:t}})},e.prototype.setLoadingState=function(e){var t,r;return t=e.loadingState,r=e.path,h.setLoadingState({loadingState:t,path:r})},e.prototype.addFilesAndSetLoadingState=function(e){var t,r,o;return o=e.path,r=e.loadingState,t=e.files,i.dispatch({type:E.ADD_FILES_AND_SET_LOADING_STATE,data:{path:o,loadingState:r,files:t}})},e.prototype.setMountPoints=function(e){var t;return t=e.mountPoints,h.setMountPoints({mountPoints:t})},e.prototype.setTeamFolders=function(e){var t;return t=e.teamFolders,h.setTeamFolders({teamFolders:t})},e.prototype.setPath=function(e){var t,r,o,s,n;return s=e.path,o=e.onPathLoaded,r=e.nsId,t=null!=(n=e.logFetchedDataRequiredForTTI)&&n,h.setPath({path:s,onPathLoaded:o,nsId:r,logFetchedDataRequiredForTTI:t})},e.prototype.reloadCurrentPath=function(){return this.setPath({path:F.path()})},e.prototype.setUser=function(e){var t;return t=e.user,i.dispatch({type:E.SET_USER,data:{user:t}})},e.prototype.updatePreview=function(e){var t;if(t=e.files,M())return R().updateFiles(t)},e.prototype.closeFileViewer=function(){if(M())return R().close()},e.prototype.setUrlPrefix=function(e){var t;return t=e.prefix,h.setUrlPrefix({prefix:t})},e.prototype.setUrl=function(e){var t,r,o;return t=e.path,r=e.prefix,o=e.qargs,h.setUrl({path:t,prefix:r,qargs:o})},e.prototype.copySelectedFilesToClipboard=function(){var e,t;if(e=F.selectedFiles(),e&&e.size)return e.some(function(e){return e.isDeleted})?(w.error(C("Deleted files cannot be added to the clipboard")),!1):D.canDeepNest(F.user().id)&&e.some(function(e){return P.isTeamSharedFolder(e)})?void w.error(C("Team Folders can’t be copied.")):(t=O("Added %(num_items)s item to clipboard","Added %(num_items)s items to clipboard",e.size).format({num_items:e.size}),w.success(t),i.dispatch({type:E.COPY_SELECTED_FILES_TO_CLIPBOARD}))},e.prototype.pasteClipboardFilesToCurrentPath=function(){return this.copyFiles({files:F.clipboardFiles().toArray(),newPath:F.path()})},e.prototype.selectRowsFromNotServer=function(e){return null==e&&(e=[]),this.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:e.map(function(e){return e.fq_path})})},e.prototype.setFilePathsToSelectOnNextUpdate=function(e){var t;return t=e.fqPathsToSelect,i.dispatch({type:E.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,data:{fqPathsToSelect:t}})},e.prototype.copyFiles=function(e){var t,r,o;return t=e.files,r=e.newPath,o=F.user(),this._dataApi.copyFiles({files:t,newPath:r,userId:o.id,onSuccess:(function(e){return function(n){var i,a;return a=n.files,i=n.changesets,s.notifyCopySuccess(t.length,o,i,r,function(){return e.selectRowsFromNotServer(t)}),e.selectRowsFromNotServer(a)}})(this)})},e.prototype.moveFiles=function(e){var t,r,o,n;return o=e.path,t=e.files,r=e.newPath,n=F.user(),this._dataApi.moveFiles({path:o,files:t,newPath:r,userId:n.id,onSuccess:(function(e){return function(o){var i;return o.path,o.fileDeltas,i=o.changesets,s.notifyMoveSuccess(t.length,n,i,r,function(){return e.selectRowsFromNotServer(t)})}})(this)})},e.prototype.showFileRename=function(e){var t;return t=e.file,i.dispatch({type:E.REQUEST_NEW_FILE_NAME,data:{file:t}})},e.prototype.cancelFileRename=function(e){var t;return t=e.file,i.dispatch({type:E.CANCEL_FILE_RENAME,data:{file:t}})},e.prototype.renameFile=function(e){var t,r,o;return t=e.file,r=e.newName,i.dispatch({type:E.SET_FILE_RENAME_PENDING,data:{file:t}}),o=F.user(),this._dataApi.renameFile({file:t,newName:r,userId:o.id,onSuccess:(function(e){return function(r){var n,i,a;return i=r.renamedFile,n=r.changesets,a=r.rollbackHints,s.notifyRenameSuccess(o,n,a,function(){return e.selectRowsFromNotServer([t])}),e.selectRowsFromNotServer([i])}})(this),onError:(function(e){return function(r,o,s){return e.cancelFileRename({file:t})}})(this)})},e.prototype.applyFileDeltas=function(e){var t,r;return r=e.path,t=e.fileDeltas,i.dispatch({type:E.CHANGE_FILES,data:{path:r,fileDeltas:t}})},e.prototype._getMountPointUpdateForCurrentPath=function(e){var r,o,s,n,i,a,l,u;return s=F.path(),r=(null!=(u=F.mountPoints())?u.toJS():void 0)||{},n=(function(e){return function(e){return e===s}})(this),o=parseInt(t.findKey(r,n),10),o?(a=e[o]||null,l=r[o]||null):(l=null,i=Boolean(t.findKey(e,n)),a=i?s:null),[l,a]},e.prototype._getPathForNewMountPoint=function(e,t){return e&&!t?F.path():e&&t?n.paths_are_equal(e,t)?null:t:!e&&t?F.path():null},e.prototype._showUserNotificationForPathChange=function(e,o){var s,i,a,l,u,c,p,d,h;return c=o.old_fq_path,h=r.get_browse_root(e)+o.new_fq_path,s=function(e){return t.escape(n.filename(e))},a=function(e){return w.success(new S(e))},i=function(e){return w.error(new S(e))},u=!o.is_changing_view,l=null!=(d=o.change_type)?d.toLowerCase():void 0,"moved"===l?u?a(C("This folder has been moved")):(p=C('The folder ‘%(folder_name)s’ has been moved. <a href="%(href)s">View</a>'),p=p.format({folder_name:s(c),href:t.escape(h)}),i(p)):"renamed"===l?u?(p=C("This folder has been renamed to ‘%(folder_name)s’"),p=p.format({folder_name:s(o.change_to_fq_path)}),a(p)):(p=C('The folder ‘%(folder_name)s’ has been renamed. <a href="%(href)s">View</a>'),p=p.format({folder_name:s(c),href:t.escape(h)}),i(p)):"deleted"===l?(p=C("The folder ‘%(folder_name)s’ has been deleted"),p=p.format({folder_name:s(c)}),i(p)):void 0},e.prototype.computeAndApplyDeltasFromNotServer=function(e){var t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,y,v,E,D,N,I,R;if(T=e.path,y=e.payload,n=e.currentNSId,t=y.added,_=y.moved,N=y.removed,f=y.mount_points,S=y.parent_changes,null!=(null!=S?S.change_to_fq_path:void 0))return R=F.user(),this._showUserNotificationForPathChange(R,S),void this.setUrl({path:S.change_to_fq_path});if(E=this._getMountPointUpdateForCurrentPath(f),s=E[0],g=E[1],s&&!g&&w.success(C("The folder was unshared.")),I=this._getPathForNewMountPoint(s,g))return void this.setPath({path:I,nsId:n});for(this.setMountPoints({mountPoints:f}),i=F.filesMap(),a=[],u=0,d=t.length;u<d;u++)b=t[u],o=null,r=P.fromServerObject(b),a.push({before:o,after:r});for(c=0,h=_.length;c<h;c++)D=_[c],v=D[0],b=D[1],o=i.get(v,null),r=P.fromServerObject(b),a.push({before:o,after:r});for(p=0,m=N.length;p<m;p++)l=N[p],o=i.get(l,null),r=null,a.push({before:o,after:r});return this.applyFileDeltas({path:T,fileDeltas:a})},e.prototype.setSelection=function(e){var t;return t=e.selection,i.dispatch({type:E.SET_SELECTION,data:{selection:t}})},e.prototype.selectFilesByFqPath=function(e){var t;return t=e.fqPathsToSelect,i.dispatch({type:E.SELECT_FILES_BY_FQ_PATH,data:{fqPathsToSelect:t}})},e.prototype.setActiveTab=function(e){var t;return t=e.tabName,i.dispatch({type:E.SET_ACTIVE_TAB,data:{tabName:t}})},e.prototype.navigateToFileOrFolder=function(e){var t,r,o,s,n,i,a,l,c;if(t=e.file,c=null!=(i=e.shouldFocusComment)&&i,n=e.onFileViewerUnmount,o=null!=(a=e.fileViewAction)?a:g.FileViewActionType.CLICK,!F.context().isNonUserRelativeContext||t.is_dir)return t.is_dir?P.isNoAccessSharedFolder(t)?u.showNoAccess(F.user(),t,F.context()):this.setUrl({path:t.fq_path}):(r=F.getIndexOfFile(t),r>-1?s=null!=(l=F.files())?l.toJS():void 0:(r=0,s=[t]),t.isDeleted?u.showRestore(F.user(),[t]):"download"===t.preview_type?b.unsafe_open_tab(t.href):A({files:s,indexOfPreviewFile:r,shouldFocusComment:c,user:F.user(),onViewerUnmount:n,fileViewAction:o}))},e.prototype.openPreviewForFile=function(e){var t,r;return t=e.file,r=e.onCloseViewer,A({files:[t],indexOfPreviewFile:0,user:F.user(),updateBrowserLocation:!1,onCloseViewer:function(){return"function"==typeof r?r():void 0}})},e.prototype.navigateToParentFolder=function(){var e;return e=n.parent_dir(F.path()),this.setUrl({path:e})},e.prototype.setShouldShowDeletedFiles=function(e){var t,r,o;if(o=e.shouldShowDeletedFiles,r=null==(t=e.shouldReloadFolder)||t,o?a.update_query_param("d","1"):a.remove_query_param("d"),i.dispatch({type:E.SET_SHOULD_SHOW_DELETED_FILES,data:{shouldShowDeletedFiles:o}}),r)return F.context().isNonUserRelativeContext?this.setPath({path:F.path(),nsId:F.context().rootNSID}):this.reloadCurrentPath()},e.prototype.sortFiles=function(e){var t,r;return r=e.sortField,t=e.sortDirection,i.dispatch({type:E.SORT_FILES,data:{sortField:r,sortDirection:t}})},e.prototype.setCopyMode=function(e){var t;return t=e.copyMode,i.dispatch({type:E.SET_COPY_MODE,data:{copyMode:t}})},e.prototype.downloadFiles=function(e){var t,r,s,i,a,l,u,c,p,d;return a=e.files,r=e.context,d=e.user,1!==a.count()||a.first().is_dir?!!r.blockHash&&(r.isNonUserRelativeContext?o.zip_batch_by_ns_id({parent_ns_id:r.rootNSID,parent_ns_path:r.currentFQPath,files:a.toArray(),subject_uid:d.id,block_hash:r.blockHash}):(p=r.currentFQPath,l=(function(){var e,t,r,o;for(r=a.toArray(),o=[],e=0,t=r.length;e<t;e++)s=r[e],o.push(s.fq_path);return o})(),o.get_zip({fq_paths:l,subject_uid:d.id,block_hash:r.blockHash,parent_path:p}))):void(r.isNonUserRelativeContext?(s=a.first(),t=s.direct_blockserver_link,u=r.rootNSID,i=n.filename(s.fq_path),c="/"===r.currentFQPath?"/"+i:r.currentFQPath+"/"+i,o.get_blockserver_link({url:t,ns_id:u,ns_path:c})):o.get_blockserver_link({url:a.first().direct_blockserver_link}))},e.prototype.nameNewFolder=function(){return i.dispatch({type:E.REQUEST_FOLDER_NAME})},e.prototype.createFolder=function(e){var t,r,o,n,a;return o=e.pathName,t=e.folderName,r=null!=(n=e.nsId)?n:null,i.dispatch({type:E.CREATE_FOLDER_PENDING}),a=F.user(),this._dataApi.createNewFolder({pathName:o,folderName:t,nsId:r,userId:a.id,onSuccess:(function(e){return function(r){var o,n;return o=r.changesets,n=r.createdFolder,i.dispatch({type:E.CREATE_FOLDER_COMPLETE}),s.notifyFolderCreationSuccess(t,a,o),e.selectRowsFromNotServer([n])}})(this),onError:function(){return i.dispatch({type:E.CANCEL_CREATE_FOLDER})}})},e.prototype.cancelCreateFolder=function(){return i.dispatch({type:E.CANCEL_CREATE_FOLDER})},e.prototype.addCommentStatusBatch=function(e){var t;return t=e.commentStatusByFqPath,i.dispatch({type:E.ADD_COMMENT_STATUS_BATCH,data:{commentStatusByFqPath:t}})},e.prototype.setDropTarget=function(e){var t;return t=e.target,i.dispatch({type:E.SET_DROP_TARGET,data:{target:t}})},e.prototype.setDataApi=function(e){return this._dataApi=e,h.setDataApi(e)},e})())}),define("modules/clean/react/browse/api",["require","exports","tslib","external/underscore","modules/clean/ajax","modules/clean/filepath","modules/clean/history","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,r,o,s,n,i,a,l,u,c,p){"use strict";function d(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function h(e){var t=e.path,r=e.userId,o=e.onSuccess,n=e.includeDeletedFiles,i=void 0!==n&&n,a=e.sortFoldersFirst,l=void 0===a||a,u=e.onError;return s.WebRequest({data:{show_deleted:i||"",sort_folders_first:l,path2:t},url:"/browse",subject_user:r,success:function(e){var r=d(e);r&&o({path:t,data:r})},error:function(e,t,r){u&&u(e,t,r)}})}function m(e){var t=e.files,r=e.newPath,n=e.userId,i=e.onSuccess,l=t.map(function(e){return e.fq_path});return l.includes(r)?(c.error(u._("You can’t copy a folder into itself.")),null):s.WebProgressRequest({url:"/cmd/copy",data:{files:l,to_path:r},subject_user:n,progress_text:u._("Copying files..."),success:function(e){try{var t=o.isString(e)?JSON.parse(e):e;i({files:t.new_browse_files.map(a.File.fromServerObject),destinationPath:r,changesets:t.changesets,rollbackHints:t.rollback_hints})}catch(e){}}})}function f(e){var t=e.files,r=e.userId,n=e.onSuccess,i=t.map(function(e){return e.fq_path});return s.WebProgressRequest({url:"/cmd/delete",data:{files:i},subject_user:r,progress_text:u._("Deleting files..."),success:function(e){try{var r=o.isString(e)?JSON.parse(e):e;n({fileDeltas:t.map(function(e){return{before:e,after:null}}),changesets:r.changesets,rollbackHints:r.rollback_hints})}catch(e){}}})}function _(e){var t=e.path,r=e.files,i=e.newPath,p=e.userId,d=e.onSuccess;if(t===i)return c.error(u._("Those files already exist in that folder.")),null;var h=r.map(function(e){return e.fq_path});return h.includes(i)?(c.error(u._("You can’t move a folder into itself.")),null):s.WebProgressRequest({url:"/cmd/move",data:{files:h,to_path:i},subject_user:p,progress_text:u._("Moving files..."),success:function(e){try{var r=o.isString(e)?JSON.parse(e):e,s=l.BrowseStore.filesMap();d({path:t,destinationPath:i,fileDeltas:r.new_browse_files.map(function(e){return{before:s.get(o.find(h,function(t){return n.filename(t)===n.filename(e.fq_path)}),null),after:a.File.fromServerObject(e)}}),changesets:r.changesets,rollbackHints:r.rollback_hints})}catch(e){}}})}function g(e){var t=e.file,r=e.newName,o=e.userId,n=e.onSuccess,i=e.onError;return s.WebRequest({url:new p({path:"/cmd/rename"+t.fq_path}).toString(),subject_user:o,data:{to_path:r},success:function(e,t,r){var o=d(e);if(o){var s=a.File.fromServerObject(o.new_browse_files[0]);n({changesets:o.changesets,renamedFile:s,rollbackHints:o.rollback_hints})}else i&&i()},error:i})}function b(e){var t=e.fqPath,r=e.userId,o=(s={prev:p.parse(i.get_url()).setFragment("").toString()},s._subject_uid=String(r),s);return t=t.replace(/^[/]/,""),new p({path:"/restore/"+t}).updateQuery(o).toString();var s}function S(e,t){var o=e.fqPath,s=e.userId,n=r.__assign({},null==t?{}:t,(i={undelete:"1"},i._subject_uid=String(s),i));o=o.replace(/^[/]/,"");return new p({path:"/history/"+o}).updateQuery(n).toString();var i}function T(e){var t=e.files,r=e.userId,o=e.onSuccess;return s.WebProgressRequest({url:"/cmd/restore",data:{files:t.map(function(e){return e.fq_path})},subject_user:r,dataType:"json",progress_text:u._("Restoring…"),success:function(){o()}})}function w(e){var t=e.files,r=e.userId,o=e.onSuccess,n=e.progressText,i=void 0===n?u._("Deleting…"):n;return s.WebProgressRequest({url:"/cmd/purge",data:{files:t.map(function(e){return e.fq_path})},subject_user:r,dataType:"text",progress_text:i,success:function(e){var t=d(e);t&&"success"===t.status&&o()}})}function y(e){var t=e.userId,r=e.changesets,o=void 0===r?null:r,n=e.progressText,i=e.rollbackHints,a=void 0===i?{}:i,l=e.onSuccess;return s.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(o),rollback_hints:JSON.stringify(a)},subject_user:t,progress_text:n,success:function(){l()}})}function v(e){var t=e.pathName,r=e.folderName,o=e.userId,n=e.onSuccess,i=e.onError;return s.WebProgressRequest({url:new p({path:"/cmd/new"+t}).toString(),data:{to_path:r,folder:"yes"},subject_user:o,success:function(e){var t=d(e);if(t){var r=a.File.fromServerObject(t.new_browse_files[0]);n({changesets:t.changesets,createdFolder:r})}},error:function(){i()}})}function E(e){var t=e.path,r=e.userId,n=e.namespaceToJournalIdMap,i=e.includeDeletedFiles,a=e.onSuccess,l="/"===t?"":t,u={fq_dir:l,ns_map:o.map(n,function(e,t){return t+"_"+e}).join(","),show_deleted:!!i};return s.WebRequest({url:"/update/list_dir",subject_user:r,data:u,dataType:"text",success:function(e){var t=d(e);t&&a(t)}})}t.loadPath=h,t.copyFiles=m,t.deleteFiles=f,t.moveFiles=_,t.renameFile=g,t.getRestoreFileUrl=b,t.getFileHistoryUrl=S,t.restoreFiles=T,t.purgeFiles=w,t.rollbackChangeSets=y,t.createNewFolder=v,t.getChangesForDirectory=E});var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/browse",["external/immutable","external/react","external/react-dom","external/underscore","external/classnames","modules/clean/browse_interface","modules/clean/em_string","modules/clean/flux/store_mixin","modules/clean/history","modules/clean/js_client_stopwatch","modules/clean/notserver","modules/clean/pagination_manager","modules/clean/react/async_file_modal_controller","modules/clean/react/app_actions_view","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/file_actions","modules/clean/react/browse/file_list_team_folder_description","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/browse/util","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/store","modules/clean/react/maestro/layout","modules/clean/react_logger","modules/clean/previews/util","modules/clean/search/actions","modules/clean/search/search_bar","modules/clean/search/search_helpers","modules/clean/search/store","modules/clean/sharing/browse_exports","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/maestro","modules/constants/python","modules/core/browser","modules/core/cookies","modules/core/framework_args","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/react/browse/actions","modules/clean/react/browse/browse_location","modules/clean/react/browse/context_menu","modules/clean/react/browse/global_actions","modules/clean/react/browse/item_list","modules/clean/react/browse/selection_actions","modules/clean/react/browse/pinned_team_folder","modules/clean/search/search_results","modules/constants/subgrowth_experiments","modules/pagelet_config","require"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D,N,C,I,R,M,A,O,x,L,U,k,B,G,V,H,q,W,j,z,K,Y,Q,J,X,Z,$,ee,te){var re,oe,se,ne,ie,ae,le,ue,ce,pe,de,he,me,fe,_e,ge,be,Se,Te,we,ye,ve,Ee,Fe,Pe,De,Ne,Ce,Ie,Re,Me,Ae,Oe,xe,Le,Ue,ke,Be,Ge,Ve,He,qe,We;return Se=u.JSStopwatch,ve=c.NotClients,Pe=f.REACT_FILE_VIEWER_ELEMENT_ID,pe=f.DropTargetHighlightMode,me=f.FileTypes,Te=f.LoadingStates,ye=f.NameSpaceAccess,le=f.BrowseSortField,xe=f.ViewTypes,Re=g.TeamFolderDescription,ie=b.BrowseLogger,ne=b.BrowseLogEventSources,he=S.File,oe=S.BrowseContext,Ee=S.Paper,ue=T.BrowseStore,He=w.getSelectedFilesText,Ae=y.UploadErrorType,fe=v.FileUploaderController,Oe=E.UploaderStore,we=F.MaestroChrome,Ne=P.ReactLogger,qe=N.searchActions,C.SearchBar,We=R.searchStore,Ue=M.asyncShowPrefilledShareModal,ke=M.asyncShowSharedContentLinkSyncModal,ge=M.GoldenGate,Ie=A.StormcrowExposureLogger,Me=O.UEClient,U.MAESTRO_ICONS_ENABLED,de=V.FRAMEWORK_ARGS,Le=H._,H.ungettext,se=K.BrowseContextMenu,_e=Y.GlobalActions,Ve=Y.getGlobalActions,be=Q.ItemListController,ae=J.BrowseSelectionMenu,Fe=X.PinnedTeamFolder,Ce=Z.SearchResultsController,De=ee.REQUIREJS_CONFIG,Ge=t.DOM,Be=t.createElement,re=t.createClass({displayName:"BrowseAppController",mixins:[a(ue,Oe,We)],propTypes:{"init-data":t.PropTypes.object,"limited-team-banner-upsell":t.PropTypes.bool,"notify-path-does-not-exist":t.PropTypes.string,"notify-path-is-deleted":t.PropTypes.string,"share-link":t.PropTypes.bool,"share-prefill-email":t.PropTypes.string,"trademark-business":t.PropTypes.string,"email-just-verified":t.PropTypes.bool,"email-just-verified-and-changed":t.PropTypes.bool,"send-verification-email":t.PropTypes.bool,"show-qualitative-feedback-form":t.PropTypes.bool,"is-pagelet":t.PropTypes.bool,"account-photo-url":t.PropTypes.string,"exp-pro-out-of-quota-drag-drop-variant":t.PropTypes.string,"exp-biz-team-folder-min-onboarding":t.PropTypes.string,"exp-biz-team-folder-onboarding-variant":t.PropTypes.string,"exp-oq-file-delete-upsell-variant":t.PropTypes.string,"exp-subgrowth-biz-web-client-oq-delete":t.PropTypes.bool,"exp-subgrowth-pro-upload-form-nearquota":t.PropTypes.string,"maestro-single-file-experience-variant":t.PropTypes.string,"maestro-grid-view-variant":t.PropTypes.string,"maestro-list-view-full-row-select":t.PropTypes.bool,"maestro-grid-view-prewarm-variant":t.PropTypes.string,"subgrowth-pro-oq-upload-modal":t.PropTypes.string,"exp-overquota-file-action-variant":t.PropTypes.string,"maestro-browse-mcl-component-migration":t.PropTypes.bool,"is-no-comment":t.PropTypes.bool},getInitialState:function(){return this.actionHandlers={onDelete:this.handleDelete,onRestoreMulti:this.handleRestoreMulti,onPermanentDelete:this.handlePermanentDelete},this.contextFileActionHandlers={onDelete:this.handleContextFileDelete,onRestoreMulti:this.handleContextFileRestore,onPermanentDelete:this.handleContextFilePermanentDelete},{}},_get_state_from_stores:function(){var t;return t=ue.path(),{context:ue.context(),contextFile:ue.contextFile(),files:ue.files(),filesWithoutTeamFolders:"/"===t?ue.filesWithoutTeamFolders():e.List(),teamFolders:ue.teamFolders(),loadingState:ue.loadingState(),path:t,selection:ue.selection(),selectedFiles:ue.selectedFiles(),fileRename:ue.fileRename(),user:ue.user(),shouldShowDeletedFiles:ue.shouldShowDeletedFiles(),
isDraggingInternalFiles:fe.isDraggingInternalFiles(),isDraggingExternalFiles:fe.isDraggingExternalFiles(),activeDropTarget:ue.activeDropTarget(),isUploadModalOpen:fe.isUploadModalOpen(),isTextSelectable:!!ue.fileRename(),inCopyMode:ue.inCopyMode(),createNewFolderState:ue.newFolderCreationState(),isSearchMode:!!We.latestQuery(),currentSort:ue.currentSort()}},componentWillMount:function(){var e,t,r,s,i,a,u,c,d,h,m,f,_,g,b,S,T,w,y;return Ne.start(this.constructor.displayName),L.log_js_modules_application_code_start(),this.logOnceFetchedDataRequiredForTTI=o.once(L.log_js_modules_fetched_data_required_for_tti.bind(L)),this.previousHistoryCallbackPath=null,this.hasLoadedFilesForTheVeryFirstTime=!1,e=this.props["search-query"]?["ItemListController"]:this.props["is-pagelet"]?["ItemListController","AppActionsView"]:["ItemListController","BrowseSelectionMenu"],y=this._getCurrentViewTypeCookie(),this.state.viewType!==y&&this.setState({viewType:y}),r={view_type:y.toLowerCase()},ue.initBrowseLogger(e,r),w=x.get_viewer().get_user_by_id(this.props["user-id"]),T=n.get_browse_root(w),_=this.props["init-fq-path"]?this.props["init-fq-path"]:"/",g=Boolean(this.props["should-show-deleted-files"]),a=this.props["init-data"],a?(L.log_js_modules_fetched_data_required_for_tti(),t=oe.fromServerObject(a),c=Boolean(a.paginated)?Te.LOADING_REMAINING_PAGES:Te.LOADED,u=c===Te.LOADING_REMAINING_PAGES,s=u?[]:a.file_info,d=a.ns_id_to_mount_point,i=this.props["select-fq-paths"],S=a.team_folders_js_info,j.initializeEverything({user:w,path:_,files:s,urlPrefix:T,context:t,mountPoints:d,fqPathsToSelect:i,loadingState:c,shouldShowDeletedFiles:g,teamFolders:S}),u&&(m=new p,h=function(e,t){var r;return r={path:_,files:t,loadingState:Te.LOADED},e.areAllItemsReady()?(j.addFilesAndSetLoadingState(r),e.stopAutoFetching()):j.add({path:_,files:t})},m.initialize(a.first_page,"sjid","/browse_get_next",w.id,h),"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||m.startAutoFetching())):(j.setUrlPrefix({prefix:T}),j.setUser({user:w}),j.setShouldShowDeletedFiles({shouldShowDeletedFiles:g,shouldReloadFolder:!1}),i=this.props["select-fq-paths"],j.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:i}),this.hasTTVBeenLogged=!1,this.props["search-query"]||(f={path:_,logFetchedDataRequiredForTTI:!0},this.navigateToPath(f))),b=!this.props["search-query"],l.add_callback(T,this.handleFileLocationChange,!0),l.add_callback("/search",this.handleSearchLocationChange,b),l.add_exit_callback("/search",qe.clearSearch),this.setState(this._get_state_from_stores())},componentDidMount:function(){var e,t,o,s,n,a,u,c,p,d,h,m;return c=l.deconstruct_url().qargs,s=c,n=this.props["init-fq-path"]||"/",s.from_scl_sync_modal&&q.success(Le("%(file_name)s added to your Dropbox.").format({file_name:n.split("/").pop()})),this.props["search-query"]||(o=this.props["share-link"],t=Boolean(this.props["preview-file-info"]),o||t||(m=this._getUrlForFQPath(n),this._sanitizeBrowserLocation(m))),Se.create_stopwatch_if_not_exist("maestro_tracing"),Se.recordTrace("new_markPageletRendered",{stopwatchName:"maestro_tracing",traceTime:L.time_since_start()}),window.ensemble&&(window.ensemble.markPageletRenderedByDOMNode?window.ensemble.markPageletRenderedByDOMNode(r.findDOMNode(this)):window.ensemble.markPageletRendered&&window.ensemble.markPageletRendered(De.context)),this.props["init-data"]&&(this.hasTTVBeenLogged||(L.mark_time_to_view(),this.hasTTVBeenLogged=!0)),this._mountFileViewerTarget(),h=this.props["show-share-modal"],d=this.props["share-prefill-email"],u=this.props["preview-file-info"],Boolean(this.props["loaded-with-explicit-preview"])&&!u&&(p=l.deconstruct_url(),n=p.path,c=p.qargs,delete c.preview,l.replace_state(n,c)),L.waitForTTI().then((function(e){return function(){return e.props["search-query"]||e._setupFileEventListener(e.state.user.id),te(["modules/clean/react/file_viewer/controller","modules/clean/react/file_viewer/seen_state_facepile_controller","modules/clean/react/browse/shared_with","modules/clean/react/starred/browse_exports","modules/clean/react/browse/preview_sf_members","modules/clean/react/file_modal_controller","modules/clean/react/pass/store","modules/clean/sharing/share_modal_util","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/sharing/wizard/wizard_modals","modules/clean/contacts/bloodhound_contacts_v2","modules/clean/react/browse/comment_status","modules/clean/account/email","modules/clean/unity_browse_interface","modules/clean/unity/features","modules/clean/unity/check_file_cache"],function(t,r,o,n,i,a,l,u,c,p,d,h,m,f,_,g,b){var S,T,w,y;if(w=o.SharedWithStore,y=n.StarredStore,i.PreviewSFMembersPanel,S=h.BloodhoundContactsV2,T=f.EmailVerification,e.isMounted())return w.initializeWith({path:ue.path(),files:ue.files().toArray()}),y.updateStateFromBrowse(),e.removeStarredStoreListener=y.addListener(function(){return e.setState({starredState:y.getLoadingStates()})}),S.getOrCreateForUser(e.state.user),m.setup(),e.setState({isSeenStateFacepileLoaded:!0,isSharedWithLoaded:!0,isStarredLoaded:!0,isPreviewSFMembersLoaded:!0,isUnityLoaded:!0}),s.email_just_verified?T.getForRole(e.state.user.role).show_verified_modal():s.email_just_verified_and_changed?T.getForRole(e.state.user.role).show_verified_and_changed_modal():e.props["send-verification-email"]?T.getForRole(e.state.user.role).show_sent_modal():void 0})}})(this)),u?(a=he.fromServerObject(u),j.openPreviewForFile({file:a,onCloseViewer:(function(e){return function(){var t,r,o,s;return null!=(t=e.refs.browseView)&&null!=(r=t.refs.itemListController)&&null!=(o=r.refs.browseTileGrid)&&null!=(s=o.refs.tileGrid)&&s.getAndUpdateTileLayout(),e._restoreUrlAfterFileViewClose()}})(this)}),h&&L.waitForTTI().then((function(e){return function(){if(e.isMounted())return Ue({user:e.state.user,sharePrefillEmail:d,content:a})}})(this))):h&&L.waitForTTI().then((function(e){return function(){if(e.isMounted())return Ue({user:e.state.user,sharePrefillEmail:d,content:{fqPath:e.props["init-fq-path"],isFolder:!0,nsId:e.props["ns-id"]&&e.props["ns-path"]?e.props["ns-id"]:null,targetNsId:e.props["ns-id"]&&!e.props["ns-path"]?e.props["ns-id"]:null}})}})(this)),null!=this.props["notify-path-is-deleted"]?(e=Le("The folder ‘%(folder_name)s’ is deleted.").format({folder_name:i.em_snippet(this.props["notify-path-is-deleted"],15)}),q.error(e)):null!=this.props["notify-path-does-not-exist"]&&(e=Le("The folder ‘%(folder_name)s’ doesn’t exist.").format({folder_name:i.em_snippet(this.props["notify-path-does-not-exist"],15)}),q.error(e)),Ne.end(this.constructor.displayName),Se.create_stopwatch_if_not_exist("maestro_tracing"),Se.recordTrace("old_markPageletRendered",{stopwatchName:"maestro_tracing",traceTime:L.time_since_start()})},handleComponentTTI:function(e){return ue.componentReadyForTTI(e)},componentWillUpdate:function(e,t){if(t.isSearchMode&&!this.state.isSearchMode?ve[this.state.user.id].unsubscribe(this.handlerId):!t.isSearchMode&&this.state.isSearchMode&&this._setupFileEventListener(this.state.user.id),!t.files.equals(this.state.files))return setTimeout((function(e){return function(){return e.handleFileListUpdated()}})(this),0)},componentWillUnmount:function(){return te.defined("modules/clean/react/browse/comment_status")&&te("modules/clean/react/browse/comment_status").teardown(),"function"==typeof this.removeStarredStoreListener?this.removeStarredStoreListener():void 0},_getCurrentViewTypeCookie:function(){var e;return"GALLERY_PERSIST"!==this.props["maestro-grid-view-variant"]?xe.List:(e=G.read("browse_view_type"),indexOf.call(o.values(xe),e)>=0||(e=xe.List),e)},_restoreUrlAfterFileViewClose:function(){var e,t;return t=this._getUrlForFQPath(this.state.path),Boolean(this.props["loaded-with-explicit-preview"])?(e=l.deconstruct_url().qargs,e=o.omit(e,"preview","select")):e={},l.replace_state(t,e)},_getUrlForFQPath:function(e){var t;return t="/"===e?"":W.encode_parts(e),ue.urlPrefix()+t},_sanitizeBrowserLocation:function(e){var t,r;return t=l.deconstruct_url().qargs,r=o.pick.apply(o,[t,"d","select","preview"].concat(de)),l.replace_state(e,r)},_mountFileViewerTarget:function(){var e;if(e=document.getElementById(Pe),!e)return e=document.createElement("div"),e.id=Pe,document.body.insertBefore(e,document.body.children[0])},_setupFileEventListener:function(e){var t,r;return t=ve[e],t.handler_failure(this.handlerId),null!=(r=this.getChangesRequest)&&r.abort(),this.handlerId=t.subscribe_sfj({name:"BrowseEventDispatcher",handler:(function(r){return function(){var o;return o=r.state.path,r.getChangesRequest=m.getChangesForDirectory({path:o,userId:e,namespaceToJournalIdMap:t.get_ns_map(),includeDeletedFiles:r.state.shouldShowDeletedFiles,onSuccess:function(e){return r.getChangesRequest=null,j.computeAndApplyDeltasFromNotServer({payload:e,path:o}),t.handler_success(r.handlerId,{ns_map:e.ns_map})}})}})(this)})},_fileViewerIsShown:function(){return("undefined"==typeof RUNNING_IN_REACTSERVER||null===RUNNING_IN_REACTSERVER)&&(!!te.defined("modules/clean/react/file_viewer/controller")&&te("modules/clean/react/file_viewer/controller").isShown())},_ensureFileViewerClosedIfNotPreviewing:function(e){var t;if(null==e&&(e={}),t=this._fileViewerIsShown(),!e.preview&&t)return j.closeFileViewer()},_ensureFileViewerIsOpenedOrClosedIfNeeded:function(e){var t,r;if(null==e&&(e={}),t=this._fileViewerIsShown(),e.preview&&!t){if(r=ue.getFileByFilename(e.preview))return j.navigateToFileOrFolder({file:r})}else if(t&&!e.preview)return j.closeFileViewer()},handleFileLocationChange:function(e,t){if(e="undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER?this.props["init-fq-path"]||"/":"/"+W.decode(e),this._ensureFileViewerIsOpenedOrClosedIfNeeded(t),e!==this.previousHistoryCallbackPath)return this.previousHistoryCallbackPath=e,ue.isPathEqualsTo(e)?void 0:this.navigateToPath({path:e})},handleSearchLocationChange:function(e,t){var r,o,s,n;if(t&&(o=t.query||t.query_unnormalized,e=t.path||t.last_fq_path||"/",r=t.qsid,o&&(e!==this.state.path||o!==We.latestQuery())))return n=null!=(s=this.state.user)?s:x.get_viewer().get_user_by_id(this.props["user-id"]),this.previousHistoryCallbackPath=e,ue.isPathEqualsTo(e)||j.setPath({path:e}),qe.runSearch({user:n,path:e,query:o,qsid:r,logOnceFetchedDataRequiredForTTI:this.logOnceFetchedDataRequiredForTTI})},navigateToPath:function(e){var t,r,o,s;return o=e.path,r=null!=(s=e.logFetchedDataRequiredForTTI)&&s,t=(function(e){return function(){if(!e.hasTTVBeenLogged)return L.mark_time_to_view(),e.hasTTIBeenLogged=!0}})(this),j.setPath({path:o,onPathLoaded:t,logFetchedDataRequiredForTTI:r})},handleFileListUpdated:function(){var e,t;return this._fileViewerIsShown()?this.state.files.isEmpty()?j.closeFileViewer():j.updatePreview({files:this.state.files.toJS()}):(e=null!=(t=l.deconstruct_url())?t.qargs:void 0,this._ensureFileViewerIsOpenedOrClosedIfNeeded(e))},handleDelete:function(){var e,t;if(!this.state.selectedFiles.isEmpty())return e=ge.canDeepNest(this.state.user.id)&&this.state.selectedFiles.toArray().some(function(e){return he.isTeamSharedFolder(e)}),this.state.context.isCurrentPathWriteable()&&!e?(t=this.state.selectedFiles.toArray(),d.showDelete(this.state.user,t,this.state.context,function(){return j.selectRowsFromNotServer(t)},this.props["exp-oq-file-delete-upsell-variant"],this.props["exp-subgrowth-biz-web-client-oq-delete"])):e?q.error(Le("Team folders can’t be deleted.")):q.warning(Le("You don’t have permission to delete files in this folder."))},handleContextFileDelete:function(){var e;return e=ge.canDeepNest(this.state.user.id)&&he.isTeamSharedFolder(this.state.contextFile),this.state.context.isCurrentPathWriteable()&&!e?d.showDelete(this.state.user,[this.state.contextFile],this.state.context,(function(e){return function(){return j.selectRowsFromNotServer([e.state.contextFile])}})(this),this.props["exp-oq-file-delete-upsell-variant"]):e?q.error(Le("Team folders can’t be deleted.")):q.warning(Le("You don’t have permission to delete files in this folder."))},handleContextFileRestore:function(){return d.showRestore(this.state.user,[this.state.contextFile])},handleContextFilePermanentDelete:function(){var e;return e=function(){return j.reloadCurrentPath()},d.showPermanentlyDelete(this.state.user,[this.state.contextFile],e)},handleRestoreMulti:function(){return d.showRestore(this.state.user,this.state.selectedFiles.toArray())},handlePermanentDelete:function(){var e;return e=function(){return j.reloadCurrentPath()},d.showPermanentlyDelete(this.state.user,this.state.selectedFiles.toArray(),e)},_setCurrentViewTypeCookie:function(e){if("GALLERY_PERSIST"===this.props["maestro-grid-view-variant"]){if(!(indexOf.call(o.values(xe),e)>=0))throw new Error("View type cookie value must be a valid ViewType");return G.delete("browse_view_type"),G.create("browse_view_type",e,1095)}},handleSwitchViewType:function(){var e;return e=xe.List,this.state.viewType===xe.List?(e=xe.Grid,ie.logSwitchToGridView({uid:this.state.user.id})):ie.logSwitchToListView({uid:this.state.user.id}),this._setCurrentViewTypeCookie(e),this.setState({viewType:e})},render:function(){var e,t,r,s;return r=this.state.loadingState===Te.LOADED?this.state.files.size:(null!=(e=this.props["init-data"])&&null!=(t=e.first_page)?t.total_num_items:void 0)||this.state.files.size,s=o.extend({},{ref:"browseView",isSharedWithLoaded:this.state.isSharedWithLoaded,isSeenStateFacepileLoaded:this.state.isSeenStateFacepileLoaded,isStarredLoaded:this.state.isStarredLoaded,isPreviewSFMembersLoaded:this.state.isPreviewSFMembersLoaded,isUnityLoaded:this.state.isUnityLoaded,isMaestroDesignAndMcl:this.props["maestro-browse-mcl-component-migration"],isMaestroDesign:this.props["is-pagelet"],limitedTeamBannerUpsell:this.props["limited-team-banner-upsell"],trademarkBusiness:this.props["trademark-business"],shouldOpenUploadModal:this.props["should-open-upload-modal"],actionHandlers:this.actionHandlers,contextFileActionHandlers:this.contextFileActionHandlers,handleComponentTTI:this.handleComponentTTI,isFileViewerShown:this._fileViewerIsShown,ensureFileViewerClosedIfNotPreviewing:this._ensureFileViewerClosedIfNotPreviewing,expProDragDropOverquotaModal:this.props["exp-pro-out-of-quota-drag-drop-variant"],expBizTeamFolderMinOnboarding:this.props["exp-biz-team-folder-min-onboarding"],expBizTeamFolderOnboardingVariant:this.props["exp-biz-team-folder-onboarding-variant"],expProOqUploadModal:this.props["exp-oq-upload-modal"],expOverquotaFileActionVariant:this.props["exp-overquota-file-action-variant"],expProNearquotaModal:this.props["exp-subgrowth-pro-upload-form-nearquota"],maestroGridViewVariant:this.props["maestro-grid-view-variant"],maestroListViewFullRowSelect:this.props["maestro-list-view-full-row-select"],maestroGridViewPrewarmVariant:this.props["maestro-grid-view-prewarm-variant"],starredState:this.state.starredState,totalNumItems:r,isNoComment:this.props["is-no-comment"],onSwitchViewType:this.handleSwitchViewType},this.state),Be(ce,s)}}),ce=t.createClass({displayName:"BrowseView",mixins:[t.addons.PureRenderMixin],propTypes:{context:t.PropTypes.instanceOf(oe).isRequired,files:t.PropTypes.instanceOf(e.List).isRequired,filesWithoutTeamFolder:t.PropTypes.instanceOf(e.List),teamFolders:t.PropTypes.object,path:t.PropTypes.string.isRequired,shouldShowDeletedFiles:t.PropTypes.bool.isRequired,isUploadModalOpen:t.PropTypes.bool.isRequired,isTextSelectable:t.PropTypes.bool.isRequired,inCopyMode:t.PropTypes.bool.isRequired,user:t.PropTypes.object.isRequired,selection:t.PropTypes.object,loadingState:t.PropTypes.oneOf(o.values(Te)),selectedFiles:t.PropTypes.instanceOf(e.OrderedMap),starredState:t.PropTypes.object,isDraggingInternalFiles:t.PropTypes.bool,isDraggingExternalFiles:t.PropTypes.bool,activeDropTarget:t.PropTypes.instanceOf(he),isSearchMode:t.PropTypes.bool,isMaestroDesignAndMcl:t.PropTypes.bool,isMaestroDesign:t.PropTypes.bool,isFileViewerShown:t.PropTypes.func,ensureFileViewerClosedIfNotPreviewing:t.PropTypes.func,isSharedWithLoaded:t.PropTypes.bool,isSeenStateFacepileLoaded:t.PropTypes.bool,isStarredLoaded:t.PropTypes.bool,isPreviewSFMembersLoaded:t.PropTypes.bool,isUnityLoaded:t.PropTypes.bool,limitedTeamBannerUpsell:t.PropTypes.bool,trademarkBusiness:t.PropTypes.string,actionHandlers:t.PropTypes.object,contextFileActionHandlers:t.PropTypes.object,handleComponentTTI:t.PropTypes.func,expProDragDropOverquotaModal:t.PropTypes.string,expBizTeamFolderMinOnboarding:t.PropTypes.string,expBizTeamFolderOnboardingVariant:t.PropTypes.string,expProNearquotaModal:t.PropTypes.string,maestroGridViewVariant:t.PropTypes.string,maestroListViewFullRowSelect:t.PropTypes.bool,maestroGridViewPrewarmVariant:t.PropTypes.string,expProOqUploadModal:t.PropTypes.string,expOverquotaFileActionVariant:t.PropTypes.string,totalNumItems:t.PropTypes.number,viewType:t.PropTypes.oneOf(o.values(xe))},getDefaultProps:function(){return{selectedFiles:e.OrderedMap(),selection:void 0,viewType:xe.List}},getInitialState:function(){return{currentMultiColumnSortField:le.SHARED_WITH}},componentWillMount:function(){return Ne.start(this.constructor.displayName),this.stormcrowExposureLogger=new Ie,this.setState({appActionsProps:this._getCurrentAppActionsProps(this.props,this.state.viewType)})},componentWillReceiveProps:function(e){if(e.selectedFiles!==this.props.selectedFiles||e.context!==this.props.context||e.user!==this.props.user||e.shouldShowDeletedFiles!==this.props.shouldShowDeletedFiles||e.isNoComment!==this.props.isNoComment||e.isSharedWithLoaded!==this.props.isSharedWithLoaded||e.isSeenStateFacepileLoaded!==this.props.isSeenStateFacepileLoaded||e.viewType!==this.props.viewType||e.starredState!==this.props.starredState)return this.setState({appActionsProps:this._getCurrentAppActionsProps(e,e.viewType)})},componentDidMount:function(){return L.waitForTTI().then((function(e){return function(){return e._defineFileUploader(),e._maybeOpenUploaderOnMount()}})(this)),Me.sendEvent(this.constructor.displayName,"componentDidMount",this.props.context.toJSON()),Ne.end(this.constructor.displayName)},componentDidUpdate:function(){if(this.props.isMaestroDesign&&this.props.loadingState===Te.LOADED)return Me.sendEvent(this.constructor.displayName,"componentDidUpdate",this.props.context.toJSON())},componentWillUnmount:function(){return this._unmountFileViewerTarget()},_maybeOpenUploaderOnMount:function(){if(this.props.shouldOpenUploadModal)return this.showFileUploader()},_unmountFileViewerTarget:function(){var e;if(e=document.getElementById(Pe))return document.body.removeChild(e)},_getCurrentDropTargetHighlightMode:function(){var e;return!this.props.context.isInsideSharedFolder||(e=this.props.context.currentSharedFolderPermissionRole)!==ye.ACCESS_NO_ACCESS&&e!==ye.ACCESS_READER&&e!==ye.ACCESS_READER_NO_COMMENT?this.props.isDraggingInternalFiles?this.props.selectedFiles.count(function(e){return e.isDeleted})?pe.NONE:this.props.selectedFiles.count(function(e){return e.type===me.TEAM_SHARED_FOLDER})?pe.NONE:this.props.selectedFiles.count(function(e){return e.type===me.SHARED_FOLDER})?this.props.context.currentNSAllowsNesting?pe.NONSELECTED_FOLDERS:pe.NONSELECTED_NONSHARED_FOLDERS:pe.NONSELECTED_FOLDERS:this.props.isDraggingExternalFiles&&!this.props.isUploadModalOpen?pe.ALL_FOLDERS:pe.NONE:pe.NONE},_getCurrentAppActionsProps:function(e,t){var r,o,s,n,i,a,l;return"ON"!==(l=e.maestroGridViewVariant)&&"GALLERY"!==l&&"GALLERY_PERSIST"!==l&&void 0,a=He(e.selectedFiles,e.context),i=e.selectedFiles.count(),n=Ge.div({}),i>0?(o=_.getActionsForFileCollection({files:e.selectedFiles,context:e.context,user:e.user,skipSharing:!1,actionHandlers:e.actionHandlers,isMaestroDesign:!0,source:ne.MAESTRO_RIGHT_SIDEBAR,isUnityLoaded:e.isUnityLoaded}),1===i&&(n=this._renderSingleSelectionAudienceBox(e))):(o=Ve({context:e.context,user:e.user,showDeletedFiles:e.shouldShowDeletedFiles,onFileUpload:this.showFileUploader,isMaestroDesign:!0,isContextMenu:!1,isNoComment:this.props.isNoComment}),ge.hasAudienceBox(e.user.id)&&e.isSharedWithLoaded&&(r=te("modules/clean/react/browse/shared_with").SharedWithController,n=Be(r,{browseContext:e.context,tabIndex:-1,isInAudienceBox:!0,isMaestroDesign:!0}))),s=o.map(function(e,t){var r;return r={displayName:e.label,handleClick:e.performAction,disabled:e.disabled},t>0&&(r.iconName=e.spriteName,r.mclIconName=e.iconName),r}),e.isNoComment&&(n=Ge.div({})),{key:"maestro-app-actions",ref:"appActionsView",headerText:a,primaryMenuItem:s[0],primarySubnode:n,secondaryMenuItems:s.slice(1),handleComponentTTI:e.handleComponentTTI,isMaestroDesignAndMcl:e.isMaestroDesignAndMcl}},showFileUploader:function(){return this.props.isMaestroDesign||this.refs.contextMenu.closeMenu(),fe.setPath(ue.path()),fe.showModal()},openContextMenuAtPosition:function(e,t,r){if(null==r&&(r=null),!this.props.isMaestroDesign)return this.refs.contextMenu.openMenuAtPosition(e,t,r)},handleSelectionChange:function(e){var t;return t=ue.getFileByFullPath(e.selected.first()),t&&ie.logSelectRow({uid:this.props.user.id,entity_type:t.is_dir?"folder":"file"}),j.setSelection({selection:e})},handleFileListSortChange:function(e,t){return ie.logSortRecords({uid:this.props.user.id,sort_by:e,sort_direction:t}),j.sortFiles({sortField:e,sortDirection:t})},_handleSearch:function(e,t){return e?j.setUrl({prefix:"/search",qargs:{path:ue.path(),query:e,qsid:t}}):this._handleCancelSearch()},_handleCancelSearch:function(){return j.setUrl({path:ue.path()})},_handleSearchSuggestionOpen:function(e){return e instanceof he?e.is_unmounted?ke(this.props.user,e):(I.logSearchAction(e,this.props.user,e.is_dir?"folder_open":"file_view","dropdown-view"),j.navigateToFileOrFolder({file:e,fileViewAction:k.FileViewActionType.SEARCH})):e instanceof Ee?(I.logPaperSearchAction(e,this.props.user,"paper_open","dropdown-view"),B.open_tab(e.url)):void 0},_shouldShowPinnedTeamFolder:function(){var e;return!(this._isSubgrowthPinnedExp()&&(!this.props.isMaestroDesign||"/"!==this.props.path||this.props.viewType!==xe.List))&&(e=this.props.loadingState===Te.LOADED,this.props.context.showPinnedTeamFolder&&null!=this.props.teamFolders.first()&&e)},_isSubgrowthPinnedExp:function(){var e;return"ON"===$.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP1||"V1"===(e=$.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP2)||"V2"===e},_shouldShowTeamFolderDescription:function(){var e;return e=this.props.files.toArray().length>0&&this.props.files.toArray().length<=5,!(!this.props.context.isInsideTeamFolderTree||!e)&&(this.stormcrowExposureLogger.logExposuresOnce({subgrowth_biz_team_folder_min_onboarding:this.props.expBizTeamFolderMinOnboarding}),"V1"===this.props.expBizTeamFolderMinOnboarding)},_renderSearchResults:function(){return Be(Ce,{path:this.props.path,user:this.props.user,viewer:x.get_viewer(),limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness,setFileUploaderPath:fe.setPathAndPermissions,onFullSearch:this._handleFullSearch,showFileUploaderModal:this.showFileUploader,handleComponentTTI:this.props.handleComponentTTI,ensureFileViewerClosedIfNotPreviewing:this.props.ensureFileViewerClosedIfNotPreviewing,isFileViewerShown:this.props.isFileViewerShown})},_handleFullSearch:function(e){var t;return e.preventDefault(),t={path:"/",query:We.latestQuery()},j.setUrl({prefix:"/search",qargs:t})},_handleAllFileUploadsComplete:function(e){var t,r;if(t=e.find(function(e){return e.errorType===Ae.OVER_QUOTA_ERROR}),("V1"===(r=this.props.expProDragDropOverquotaModal)||"V2"===r||"V3"===r||"V4"===r||"V5"===r)&&t)return fe.showModal("out-of-quota")},_renderPinnedTeamFolder:function(){return Be(Fe,{teamFolders:this.props.teamFolders,context:this.props.context,user:this.props.user,selection:this.props.selection,loadingState:this.props.loadingState,activeDropTarget:this.props.activeDropTarget,dropTargetHighlightMode:this._getCurrentDropTargetHighlightMode(),isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isTextSelectable:this.props.isTextSelectable,isMaestroDesign:this.props.isMaestroDesign,setFileUploaderPath:fe.setPathAndPermissions})},_renderBrowseItemList:function(){var e,t,r,o;return o=this._shouldShowPinnedTeamFolder(),Be(be,{ref:"itemListController",items:o?this.props.filesWithoutTeamFolders:this.props.files,selection:this.props.selection,selectedFiles:this.props.selectedFiles,onSelectionChange:this.handleSelectionChange,fileRename:this.props.fileRename,user:this.props.user,path:this.props.path,context:this.props.context,loadingState:this.props.loadingState,isTextSelectable:this.props.isTextSelectable,shouldShowDeletedFiles:this.props.shouldShowDeletedFiles,showFileUploaderModal:this.showFileUploader,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isMaestroDesign:this.props.isMaestroDesign,activeDropTarget:this.props.activeDropTarget,dropTargetHighlightMode:this._getCurrentDropTargetHighlightMode(),createNewFolderState:this.props.createNewFolderState,openContextMenuAtPosition:this.openContextMenuAtPosition,activeSortField:null!=(e=this.props.currentSort)?e.sortField:void 0,activeSortDirection:null!=(t=this.props.currentSort)?t.sortDirection:void 0,onSortChange:this.handleFileListSortChange,setFileUploaderPath:fe.setPathAndPermissions,initialMultiColumnSortField:this.state.currentMultiColumnSortField,actionHandlers:this.props.actionHandlers,contextFileActionHandlers:this.props.contextFileActionHandlers,handleComponentTTI:this.props.handleComponentTTI,ensureFileViewerClosedIfNotPreviewing:this.props.ensureFileViewerClosedIfNotPreviewing,isFileViewerShown:this.props.isFileViewerShown,isSharedWithLoaded:this.props.isSharedWithLoaded,isStarredLoaded:this.props.isStarredLoaded,isUnityLoaded:this.props.isUnityLoaded,expBizTeamFolderOnboardingVariant:this.props.expBizTeamFolderOnboardingVariant,viewType:this.props.viewType,onSwitchViewType:this.props.onSwitchViewType,totalNumItems:this.props.totalNumItems,isMaestroDesignAndMcl:this.props.isMaestroDesignAndMcl,maestroGridViewVariant:this.props.maestroGridViewVariant,maestroListViewFullRowSelect:this.props.isMaestroDesign&&this.props.maestroListViewFullRowSelect,maestroGridViewPrewarmVariant:this.props.maestroGridViewPrewarmVariant,isSubgrowthPinnedExp:this._isSubgrowthPinnedExp()&&o,numTeamFolders:null!=(r=this.props.teamFolders)?r.size:void 0})},_hasLoadedContext:function(){return null!=this.props.context.currentFQPath},_defineFileUploader:function(){return null!=fe?fe.loadCoreComponent():void 0},_maybeRenderBrowseFileUploader:function(){if(this.props.user&&this._hasLoadedContext())return[Be(fe,{key:"file-uploader-controller",ref:"fileUploader",loadOnRender:!1,needToSetStoreValues:!1,expProDragDropOverquotaModal:this.props.expProDragDropOverquotaModal,expProNearquotaModal:this.props.expProNearquotaModal,onAllFileUploadsComplete:this._handleAllFileUploadsComplete,expProOqUploadModal:this.props.expProOqUploadModal})]},_renderSingleSelectionAudienceBox:function(e){var t,r,o,s;if(s=e.selectedFiles.toArray()[0],s.is_dir||!D.is_pass_enabled(e.user)&&!D.is_pass_ga_receive_enabled(e.user)){if(ge.hasAudienceBox(e.user.id)&&e.isSharedWithLoaded)return this._renderGoldenGateAudienceBox(e,s)}else{if(!e.isSeenStateFacepileLoaded)return Ge.div();if(D.is_pass_enabled(e.user))return this._renderSeenStateFacepile(e,s);if(D.is_pass_ga_receive_enabled(e.user)){if(o=te("modules/clean/react/pass/store"),r=o.getPassPermissions(s.file_id),t=o.isPassPermissionsPending(s.file_id),null==r||t||r.canReadPresence||r.canReadSeenState)return this._renderSeenStateFacepile(e,s);if(ge.hasAudienceBox(e.user.id)&&e.isSharedWithLoaded)return this._renderGoldenGateAudienceBox(e,s)}}},_renderSeenStateFacepile:function(e,t){var r;return r=te("modules/clean/react/file_viewer/seen_state_facepile_controller").SeenStateFacepileController,Be(r,{file:t,user:e.user,fromBrowse:!0})},_renderGoldenGateAudienceBox:function(e,t){var r;return r=te("modules/clean/react/browse/shared_with").SharedWithController,Be(r,{file:t,browseContext:e.context,tabIndex:-1,isInAudienceBox:!0,isMaestroDesign:!0})},_renderBrowseActionMenu:function(){return Be(h,this.state.appActionsProps)},_renderBrowseLocation:function(){var e,t;return this.props.isMaestroDesign&&this.props.path&&(e=this.props.path.split("/"),t=e.length,"/"!==this.props.path?document.title=Le("%(folder_name)s - Dropbox").format({folder_name:this.props.path.split("/")[t-1]}):window.document.title=Le("Files - Dropbox")),Be(z,{path:this.props.path,user:this.props.user,selectedFiles:this.props.selectedFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,setFileUploaderPath:fe.setPathAndPermissions,shouldHighlightDropTargets:this.props.isDraggingInternalFiles||this.props.isDraggingExternalFiles&&!this.props.isUploadModalOpen,isMaestroDesign:this.props.isMaestroDesign})},_renderMaestroSideBar:function(){return Ge.div({className:"maestro-browse-action-sidebar"},this._maybeRenderBrowseFileUploader(),this._renderBrowseActionMenu())},_checkAndRenderTeamFolderDescription:function(){if(this._shouldShowTeamFolderDescription())return Be(Re,{showFileUploaderModal:this.showFileUploader})},_renderMaestroAppContent:function(){return Ge.div({className:"maestro-browse-app-content"},this._shouldShowPinnedTeamFolder()?this._renderPinnedTeamFolder():void 0,this._renderBrowseItemList(),this._checkAndRenderTeamFolderDescription())},_renderMaestroBrowse:function(){var e,t;return e=this.props.user,t=x.get_viewer(),Be(we,{user:e,viewer:t,titleRegion:this._renderBrowseLocation(),embeddedAppRegion:this._renderMaestroAppContent(),actionSidebarRegion:this._renderMaestroSideBar(),searchBarProps:this._getMaestroSearchBarProps()})},_renderMaestroSearchResults:function(){var e,t,r,o,s,n;return r=this.props,t=r.path,s=r.user,e=r.limitedTeamBannerUpsell,o=r.trademarkBusiness,n=x.get_viewer(),Be(Ce,{path:t,user:s,viewer:n,trademarkBusiness:o,limitedTeamBannerUpsell:e,maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,onFullSearch:this._handleFullSearch,setFileUploaderPath:fe.setPathAndPermissions,maestroSearchBarProps:this._getMaestroSearchBarProps(),showFileUploaderModal:this.showFileUploader,handleComponentTTI:this.props.handleComponentTTI,ensureFileViewerClosedIfNotPreviewing:this.props.ensureFileViewerClosedIfNotPreviewing,isFileViewerShown:this.props.isFileViewerShown,contextFileActionHandlers:this.props.contextFileActionHandlers})},_getMaestroSearchBarProps:function(){var e,t,r,o;return r=this.props,t=r.path,e=r.limitedTeamBannerUpsell,o=r.trademarkBusiness,{showSearchBar:!0,currentPath:t,onSearch:this._handleSearch,onCancelSearch:this._handleCancelSearch,onFileOrFolderOpen:this._handleSearchSuggestionOpen,limitedTeamBannerUpsell:e,trademarkBusiness:o}},render:function(){var e,t,r,o,n,i,a,l,u,c;return this.props.isMaestroDesign?this.props.isSearchMode?this._renderMaestroSearchResults():this._renderMaestroBrowse():this.props.isSearchMode?this._renderSearchResults():(u=this.props.loadingState!==Te.LOADING_FIRST_PAGE&&!this.props.context.isInsideDeletedFolder,r=u&&this.props.context.isInFolderMode&&this.props.context.isInsideSharedFolder,t=u&&this.props.context.isInFolderMode&&"/"!==this.props.context.currentFQPath,a=r&&!ge.hasNewMembershipUI(this.props.user.id),i=t&&ge.hasNewMembershipUI(this.props.user.id),l=a||i,n=this.props.context.showSharedFolderCreateTeamPromo,o={"browse-box":!0,list_view:!0,"file-browse":!0,"has-preview-sf-members":a,"has-preview-sf-members--golden-gate":i,"has-preview-sf-members--with-team-promo":r&&n,"has-pinned-team-folder":this._shouldShowPinnedTeamFolder()},Ge.div({id:"browse-box",className:s(o)},Ge.header({},Ge.div({id:"browse-header",className:"browse-header"},Ge.div({id:"browse-global-actions-bar",className:"browse__global-actions clearfix u-mar-bottom-m"},this._renderBrowseLocation(),Ge.div({id:"browse-rightmenu",className:"u-l-fr"},this._maybeRenderBrowseFileUploader(),this.props.user&&this._hasLoadedContext()?[Be(_e,{
shouldShowDeletedFiles:this.props.shouldShowDeletedFiles,isActionsBarDisabled:this.props.loadingState===Te.LOADING_FIRST_PAGE,context:this.props.context,user:this.props.user,onFileUpload:this.showFileUploader,key:0})]:void 0)),l?this.props.isPreviewSFMembersLoaded?(c=te("modules/clean/react/browse/preview_sf_members"),e=c.PreviewSFMembersPanel,Be(e,{context:this.props.context,user:this.props.user,isMaestroDesign:!1})):Be("div",{className:"preview-sf-members-panel-placeholder"}):void 0,this._shouldShowPinnedTeamFolder()?this._renderPinnedTeamFolder():void 0)),Ge.main({},Be(ae,{onActionButtonClick:(function(e){return function(){return e.refs.itemListController.focusSelectedItem()}})(this),selectedFiles:this.props.selectedFiles,user:this.props.user,context:this.props.context,actionHandlers:this.props.actionHandlers,handleComponentTTI:this.props.handleComponentTTI,key:"browse-selection-menu",expOverquotaFileActionVariant:this.props.expOverquotaFileActionVariant}),this._renderBrowseItemList(),this._checkAndRenderTeamFolderDescription(),Be(se,{user:this.props.user,selectedFiles:this.props.selectedFiles,context:this.props.context,shouldShowDeletedFiles:this.props.shouldShowDeletedFiles,onFileUpload:this.showFileUploader,actionHandlers:this.props.actionHandlers,ref:"contextMenu",expOverquotaFileActionVariant:this.props.expOverquotaFileActionVariant}))))}}),{BrowseApp:re,BrowseView:ce}}),define("modules/clean/react/browse/browse_drag_and_drop",["require","exports","jquery","modules/clean/react/browse/actions","modules/clean/react/browse/models","modules/clean/react/browse/store"],function(e,t,r,o,s,n){"use strict";function i(e,t,s,n,i,a){r(document).on("dragenter."+e,function(e){(t()||s())&&!r(e.target).closest(i).length&&a()&&(o.setDropTarget({target:null}),n())})}function a(e,t,r,i,a,l,u){if(t||r){if(e.is_dir&&!(i&&r)){if(a)return;o.setDropTarget({target:e}),u({path:e.fq_path,hasPermissionToUploadToFolder:!s.File.isReadOnlySharedFolder(e)&&l.isCurrentPathWriteable()})}else o.setDropTarget({target:null}),u({path:n.BrowseStore.path(),hasPermissionToUploadToFolder:l.isCurrentPathWriteable()})}}t.setupExternalDragHandler=i,t.onFileDragEnterItem=a}),define("modules/clean/react/browse/browse_keyboard_shortcuts",["require","exports","jquery","external/keymaster","external/react","external/react-dom","modules/clean/keycode","modules/clean/react/browse/actions","modules/clean/react/browse/file_jump","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/modal","modules/clean/undo","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m){"use strict";function f(e){o.clearScope(e),o.setScope(v)}function _(e,t){return function(r){e(r)&&(r.preventDefault(),"function"==typeof t&&t(r))}}function g(e){return function(t){return!document.activeElement||document.activeElement===document.body||n.findDOMNode(e).contains(t.target)}}function b(e){var t=function(t){o.getScope()===e&&l.handleKeyPress(t)},s=function(e){var t=e.which?e.keyCode:void 0;t&&[i.KeyCode.CONTROL,i.KeyCode.ALT].includes(t)&&a.setCopyMode({copyMode:!0})},n=function(e){var t=e.which?e.keyCode:void 0;t&&[i.KeyCode.CONTROL,i.KeyCode.ALT].includes(t)&&a.setCopyMode({copyMode:!1})};r(document).on("keydown."+e,s).on("keypress."+e,t).on("keyup."+e,n)}function S(e){r(document).off("."+e)}function T(e){f(e),S(e)}function w(e,t,n,i,l,f,g,S,T,w){b(w),v=o.getScope(),o.setScope(w);var y=function(){if(1===n().size)if(l()){var e=n().first();e.isDeleted?m.error(h._("Deleted files can’t be renamed.")):a.showFileRename({file:e})}else m.warning(h._("You don’t have permission to rename files in this folder."))},E=function(){return a.copySelectedFilesToClipboard()},F=function(){return a.pasteClipboardFilesToCurrentPath()},P=function(){p.perform_undo()},D=function(){var e=s.createElement(u);c.Modal.showInstance(e)},N=function(){return r(".search-bar__text-input").focus()};o("f2",w,_(t,y)),o("/",w,_(e,N)),o("shift+/",w,_(e,D)),o("escape",w,_(e,S)),d.mac?(o("command+a",w,_(e,g)),o("command+c",w,_(t,E)),o("backspace",w,_(t,T)),o("command+v",w,_(e,F)),o("command+z",w,_(e,P))):(o("ctrl+a",w,_(e,g)),o("ctrl+c",w,_(t,E)),o("delete",w,_(t,T)),o("ctrl+v",w,_(e,F)),o("ctrl+z",w,_(e,P)))}function y(e,t,s,n,i,l,u,c,p,d,h){w(e,t,s,n,i,l,u,c,p,h);var m=function(){1===s().size&&a.navigateToFileOrFolder({file:s().first(),onFileViewerUnmount:n()})},f=function(){1===s().size&&s().first().is_dir&&a.navigateToFileOrFolder({file:s().first()})},g=function(){return a.navigateToParentFolder()},b=function(e){if(!l())if("function"==typeof d&&s().size){var t=r(e.target).closest(".browse-file-row--is-selected").first();if(t.length){var o=t[0].offsetLeft+200,n=t[0].offsetTop+5,i=t.get(0);d(o,n,i)}}else d(10,10)};o("enter",h,_(t,m)),o("right",h,_(t,f)),o("left",h,_(e,g)),o("alt+a",h,_(e,b))}var v="";t.generateGetIsGlobalEvent=g,t.setupFileJumpKeyboardShortcuts=b,t.unsetFileJumpKeyboardShortcuts=S,t.resetBrowseKeyboardShortcuts=T,t.setupGeneralBrowseKeyboardShortcuts=w,t.setupItemListKeyboardShortcuts=y}),define("modules/clean/react/browse/browse_location",["jquery","external/immutable","external/classnames","external/mcl/icon","external/react","external/react-dom","modules/clean/browse_interface","modules/clean/react/browse/actions","modules/clean/react/sprite","modules/clean/react/sprite_div","modules/clean/react_logger","modules/clean/sharing/browse_exports","modules/clean/filepath","modules/clean/viewer","modules/clean/em_string","modules/clean/react/bubble_menu","modules/clean/user_education/user_education_client","modules/constants/maestro","modules/core/i18n"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b){var S,T,w,y,v,E,F,P,D,N,C,I,R,M,A,O,x,L,U,k,B;return N=o.Icon,U=i.browse_uri_for_fq_path,M=c.ReactLogger,D=p.GoldenGate,v=f.BubbleMenu,E=f.BubbleMenuItem,x=_.UserEducationEffect,O=_.UEClient,C=g.MAESTRO_ICONS_ENABLED,L=b._,B=s.DOM,k=s.createElement,P=2.625,I=20,F=1.64,R=37,y=s.createClass({displayName:"BrowseLocation",mixins:[s.addons.PureRenderMixin],propTypes:{path:s.PropTypes.string,user:s.PropTypes.object,selectedFiles:s.PropTypes.instanceOf(t.OrderedMap),isDraggingInternalFiles:s.PropTypes.bool,shouldHighlightDropTargets:s.PropTypes.bool,isBrowseInContentManager:s.PropTypes.bool,setFileUploaderPath:s.PropTypes.func,isMaestroDesign:s.PropTypes.bool},getDefaultProps:function(){return{path:"/",selectedFiles:t.OrderedMap(),isDraggingInternalFiles:!1,shouldHighlightDropTargets:!1,isBrowseInContentManager:!1,isMaestroDesign:!1,setFileUploaderPath:function(){}}},componentWillMount:function(){return M.start(this.constructor.displayName)},componentDidMount:function(){return M.end(this.constructor.displayName)},_getFirstBreadcrumbName:function(){return this.props.isBrowseInContentManager?L(D.hasContentManagerCdm(this.props.user)?"Content":"Team Folders"):d.filename("",h.get_root_name(this.props.user))},_generateBreadcrumbData:function(){var e,t,r,o,s,n,i,a,l,u,c,p,h,f,_,g,b,S,T;for(t="",c=this.props.path,b=this._getFirstBreadcrumbName(),o=(function(){var e,t,o,s;for(o=c.split("/"),s=[],e=0,t=o.length;e<t;e++)r=o[e],r.length>0&&s.push(r);return s})(),e=[{path:t,folderName:b,icon:"work"===this.props.user.role?"work_icon":"personal_icon",alt:L("work"===this.props.user.role?"Work":"Personal")}],s=n=0,p=o.length;0<=p?n<p:n>p;s=0<=p?++n:--n)c=t+"/"+o.slice(0,s+1).join("/"),e.push({path:c,folderName:d.filename(c),icon:"folder_32",alt:L("Folder")});if(e.length<3)return{dropdownCrumbs:[],inlineCrumbs:e,root:e[0]};for(g=null!=(h=null!=(f=e[0])?f.folderName:void 0)?h:"",a=this._getMaxBreadcrumbWidth(g,!1),T=(function(){var t,o,s,n;for(n=[],t=0,o=e.length;t<o;t++)r=e[t],n.push(new m(null!=(s=r.folderName)?s:"").length);return n})(),u=1,S=T[e.length-1],s=i=_=e.length-2;(_<=1?i<=1:i>=1)&&(S+=F,S+=T[s],!(S>a));s=_<=1?++i:--i)u+=1;return e.length===u+1&&(u+=1),l=e.length-u,{dropdownCrumbs:e.slice(0,l),inlineCrumbs:e.slice(l),root:e[0]}},_getMaxBreadcrumbWidth:function(e,t){var r;return r=t?P:new m(e).length,I-r},render:function(){var t,r,o,s,n,i,a,l,u;return a=this._generateBreadcrumbData(),o=a.dropdownCrumbs,n=a.inlineCrumbs,u=a.root,i=this._getMaxBreadcrumbWidth(null!=(l=null!=u?u.folderName:void 0)?l:"",o.length>0),t="page-header-text u-l-fl",n.length>1||o.length>0?B.span({},B.h1({className:"ax-visually-hidden"},d.filename(this.props.path)),B.nav({className:t,id:"browse-location","aria-label":L("Folder hierarchy"),role:"navigation"},o.length>0?k(S,{crumbs:o,currentPath:this.props.path,selectedFiles:this.props.selectedFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,shouldHighlightDropTargets:this.props.shouldHighlightDropTargets,setFileUploaderPath:this.props.setFileUploaderPath}):void 0,function(){var t,a,l;for(l=[],s=t=0,a=n.length;t<a;s=++t)r=n[s],l.push(k(w,e.extend({},r,{key:encodeURI(r.path),user:this.props.user,isOnlyCrumb:0===s&&1===n.length&&0===o.length,isLastCrumb:s===n.length-1,maxWidth:i,currentPath:this.props.path,selectedFiles:this.props.selectedFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isHighlightedDropTarget:this.props.shouldHighlightDropTargets,setFileUploaderPath:this.props.setFileUploaderPath,isMaestroDesign:this.props.isMaestroDesign})));return l}.call(this))):B.h1({className:t},this._getFirstBreadcrumbName())}}),A=s.createClass({displayName:"Spacer",render:function(){return B.span({},k(l,{group:"web",name:"chevron",className:"breadcrumb__spacer",alt:""}))}}),w=s.createClass({displayName:"BreadCrumbSegment",propTypes:{path:s.PropTypes.string.isRequired,user:s.PropTypes.object,folderName:s.PropTypes.string.isRequired,isLastCrumb:s.PropTypes.bool.isRequired,isOnlyCrumb:s.PropTypes.bool,maxWidth:s.PropTypes.number.isRequired,currentPath:s.PropTypes.string.isRequired,selectedFiles:s.PropTypes.instanceOf(t.OrderedMap),isDraggingInternalFiles:s.PropTypes.bool,isHighlightedDropTarget:s.PropTypes.bool,setFileUploaderPath:s.PropTypes.func,isMaestroDesign:s.PropTypes.bool.isRequired},getDefaultProps:function(){return{isOnlyCrumb:!1,isDraggingInternalFiles:!1,isHighlightedDropTarget:!1,selectedFiles:t.OrderedMap(),setFileUploaderPath:function(){}}},getInitialState:function(){return{isDraggedOver:!1}},handleMouseEnter:function(){if(this.props.isDraggingInternalFiles)return this.setState({isDraggedOver:!0})},handleMouseLeave:function(){if(this.state.isDraggedOver)return this.setState({isDraggedOver:!1})},handleMouseUp:function(){if(this.state.isDraggedOver)return this.setState({isDraggedOver:!1})},componentDidMount:function(){var t,r;return t=0,r=null,e(n.findDOMNode(this)).on("dragenter.breadcrumb",(function(e){return function(o){if(o.preventDefault(),o.target!==r)return r=o.target,t+=1,e.setState({isDraggedOver:!0}),e.props.isLastCrumb?void 0:e.props.setFileUploaderPath({path:e.props.path})}})(this)).on("dragleave.breadcrumb",(function(e){return function(o){if(o.preventDefault(),r=null,t-=1,t<1&&(t=0,e.state.isDraggedOver))return e.props.setFileUploaderPath({path:e.props.currentPath}),e.setState({isDraggedOver:!1})}})(this)).on("drop.breadcrumb",(function(e){return function(){return e.setState({isDraggedOver:!1})}})(this)).on("dragover.breadcrumb",function(e){return e.preventDefault(),e.stopPropagation()}).on("mouseenter.breadcrumb",this.handleMouseEnter).on("mouseleave.breadcrumb",this.handleMouseLeave).on("mouseup.breadcrumb",this.handleMouseUp)},componentWillUnmount:function(){return e(n.findDOMNode(this)).off(".breadcrumb")},render:function(){var e,t;return t=this.props.isOnlyCrumb?this.props.folderName:m.em_snippet(this.props.folderName,this.props.maxWidth),e={"breadcrumb-segment":!0,"breadcrumb-segment--is-drop-target":!this.props.isLastCrumb&&this.props.isHighlightedDropTarget,"breadcrumb-segment--file-dragged-over":!this.props.isLastCrumb&&this.state.isDraggedOver},this.props.isLastCrumb?B.span({},t):B.span({className:"breadcrumb-segment__wrapper"},k(x,{containerName:"BreadCrumbSegment",name:"link-"+this.props.path,useSpan:!0},B.a({href:U(this.props.user,this.props.path),onClick:this.navigateToFolder,className:r(e)},t)),this.props.isMaestroDesign&&C?(k(A),k(N,{name:"arrow-right"})):k(A))},navigateToFolder:function(e){return O.sendEvent("BreadCrumbSegment","linkClicked",{path:this.props.path}),e.preventDefault(),a.setUrl({path:this.props.path})}}),T=s.createClass({displayName:"BreadCrumbDropdownMenuItem",propTypes:{path:s.PropTypes.string.isRequired,icon:s.PropTypes.string.isRequired,folderName:s.PropTypes.string.isRequired,alt:s.PropTypes.string,isHighlightedDropTarget:s.PropTypes.bool,closeFunc:s.PropTypes.func,isDraggingInternalFiles:s.PropTypes.bool,selectedFiles:s.PropTypes.instanceOf(t.OrderedMap),currentPath:s.PropTypes.string.isRequired,setFileUploaderPath:s.PropTypes.func},getDefaultProps:function(){return{isHighlightedDropTarget:!1,closeFunc:function(){},alt:"",isDraggingInternalFiles:!1,selectedFiles:t.OrderedMap(),setFileUploaderPath:function(){}}},getInitialState:function(){return{isDraggedOver:!1}},handleMouseEnter:function(){if(this.props.isDraggingInternalFiles)return this.setState({isDraggedOver:!0})},handleMouseLeave:function(){if(this.state.isDraggedOver)return this.setState({isDraggedOver:!1})},handleMouseUp:function(){if(this.state.isDraggedOver&&this.setState({isDraggedOver:!1}),this.props.isDraggingInternalFiles&&!this.props.isLastCrumb)return this.props.closeFunc()},componentWillMount:function(){return M.start(this.constructor.displayName)},componentDidMount:function(){var t,r;return t=0,r=null,e(n.findDOMNode(this)).on("dragenter.breadcrumbMenuItem",(function(e){return function(o){if(o.preventDefault(),o.target!==r)return r=o.target,t+=1,e.setState({isDraggedOver:!0}),e.props.setFileUploaderPath({path:e.props.path})}})(this)).on("dragleave.breadcrumbMenuItem",(function(e){return function(o){if(o.preventDefault(),r=null,t-=1,t<1&&(t=0,e.state.isDraggedOver))return e.props.setFileUploaderPath({path:e.props.currentPath}),e.setState({isDraggedOver:!1})}})(this)).on("drop.breadcrumbMenuItem",(function(e){return function(t){return e.setState({isDraggedOver:!1})}})(this)).on("dragover.breadcrumbMenuItem",function(e){return e.preventDefault(),e.stopPropagation()}).on("mouseenter.breadcrumbMenuItem",this.handleMouseEnter).on("mouseleave.breadcrumbMenuItem",this.handleMouseLeave).on("mouseup.breadcrumbMenuItem",this.handleMouseUp),M.end(this.constructor.displayName)},componentWillUnmount:function(){return e(n.findDOMNode(this)).off(".breadcrumbMenuItem")},handleCrumbClick:function(e){return e.preventDefault(),a.setUrl({path:this.props.path})},render:function(){var e;return e={"breadcrumb-menu-item":!0,"breadcrumb-menu-item--is-drop-target":this.props.isHighlightedDropTarget,"breadcrumb-menu-item--file-dragged-over":this.state.isDraggedOver},k(E,{onClick:this.handleCrumbClick,closeFunc:this.props.closeFunc,className:r(e)},B.span({className:"force-no-break"},k(u,{group:"web",name:this.props.icon,alt:this.props.alt,text:m.em_snippet(this.props.folderName,R)})))}}),S=s.createClass({displayName:"BreadCrumbDropdown",propTypes:{crumbs:s.PropTypes.array.isRequired,currentPath:s.PropTypes.string.isRequired,shouldHighlightDropTargets:s.PropTypes.bool,selectedFiles:s.PropTypes.instanceOf(t.OrderedMap),isDraggingInternalFiles:s.PropTypes.bool,setFileUploaderPath:s.PropTypes.func},getDefaultProps:function(){return{shouldHighlightDropTargets:!1,selectedFiles:t.OrderedMap(),isDraggingInternalFiles:!1,setFileUploaderPath:function(){}}},componentWillMount:function(){return M.start(this.constructor.displayName)},componentDidMount:function(){return e(n.findDOMNode(this)).on("dragenter.breadcrumbDropdown",(function(e){return function(t){return t.preventDefault(),e.refs.bubbleMenu.showMenu()}})(this)).on("mouseenter.breadcrumbDropdown",(function(e){return function(t){if(e.props.isDraggingInternalFiles)return t.preventDefault(),e.refs.bubbleMenu.showMenu()}})(this)),M.end(this.constructor.displayName)},componentWillUnmount:function(){return e(n.findDOMNode(this)).off(".breadcrumbDropdown")},render:function(){var e,t,r,o;return t=this.props.crumbs,t.reverse(),o=B.button({className:"u-unbutton breadcrumb-overflow-button u-l-fl"},k(l,{group:"web",name:"folder_arrow_32",alt:L("Show parent folders (descending)")})),r=function(){var r,o,s;for(s=[],r=0,o=t.length;r<o;r++)e=t[r],s.push(k(T,{key:encodeURI(e.path),path:e.path,icon:e.icon,alt:e.alt,folderName:e.folderName,currentPath:this.props.currentPath,isHighlightedDropTarget:this.props.shouldHighlightDropTargets,isDraggingInternalFiles:this.props.isDraggingInternalFiles,selectedFiles:this.props.selectedFiles,setFileUploaderPath:this.props.setFileUploaderPath}));return s}.call(this),B.span({className:"breadcrumb-dropdown-container"},k(v,{ref:"bubbleMenu",position:v.POSITIONS.BOTTOM_RIGHT,targetButton:o,targetFixed:!0,items:r}),k(A))}}),y}),define("modules/clean/react/browse/browse_tile_header",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/browse/constants","modules/clean/react/columnheader","modules/core/i18n","modules/clean/react/bubble_menu","modules/clean/react/title_bubble"],function(e,t,r,o,s,n,i,a,l,u){"use strict";var c=i.SortDirections,p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createOnClickHandler=function(e,r){return function(){t.props.onSortChange(e,r)}},t}return r.__extends(t,e),t.prototype.renderDropdownButton=function(){var e=this.getCurrentSortOptionDisplayName(),t=o.createElement("button",{className:"file-tile-sort-button"},e);return o.createElement(l.BubbleMenu,{items:this.getMenuItems(),arrow_position:"top",position:l.BubbleMenu.POSITIONS.BOTTOM,targetButton:t})},t.prototype.getCurrentSortOptionDisplayName=function(){var e=this.props.currentSortField,t=this.props.currentSortDirection;return e===n.BrowseSortField.FILENAME?a._("Sort by name",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortField.MODIFIED&&t===c.DESCENDING?a._("Sort by newest",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortField.MODIFIED&&t===c.ASCENDING?a._("Sort by oldest",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortField.CATEGORY?a._("Sort by kind",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortField.EXTENSION?a._("Sort by extension",{comment:"This is an option for how to sort your files"}):e===n.BrowseSortField.SIZE?a._("Sort by size",{comment:"This is an option for how to sort your files"}):a._("Sort by",{comment:"Dropdown label where users can choose how to sort their files"})},t.prototype.getMenuItem=function(e,t,r){var s=t===this.props.currentSortField&&r===this.props.currentSortDirection,n="file-bubble-menu file-tile-sort-option";return s&&(n+=" file-tile-sort-option--selected"),o.createElement(l.BubbleMenuItem,{className:n,onClick:this.createOnClickHandler(t,r)},e)},t.prototype.getMenuItems=function(){return[this.getMenuItem(a._("Name",{comment:"This is an option for how to sort your files. (ex: 'Sort by Name')"}),n.BrowseSortField.FILENAME,c.ASCENDING),this.getMenuItem(a._("Newest",{comment:"This is an option for how to sort your files. (ex: 'Sort by Newest')"}),n.BrowseSortField.MODIFIED,c.DESCENDING),this.getMenuItem(a._("Oldest",{comment:"This is an option for how to sort your files. (ex: 'Sort by Oldest')"}),n.BrowseSortField.MODIFIED,c.ASCENDING),this.getMenuItem(a._("Kind",{comment:"This is an option for how to sort your files. (ex: 'Sort by Kind')"}),n.BrowseSortField.CATEGORY,c.ASCENDING),this.getMenuItem(a._("Extension",{comment:"This is an option for how to sort your files. (ex: 'Sort by Extension')"}),n.BrowseSortField.EXTENSION,c.ASCENDING),this.getMenuItem(a._("Size",{comment:"This is an option for how to sort your files. (ex: 'Sort by Size')"}),n.BrowseSortField.SIZE,c.ASCENDING)]},t.prototype.render=function(){return o.createElement(s.VerticallyFixed,null,o.createElement("div",{className:"file-tile-grid-sort-header--shadow"},o.createElement("div",{className:"file-tile-grid-sort-header"},this.renderDropdownButton(),o.createElement(d,{onSwitchViewType:this.props.onSwitchViewType,currentViewType:this.props.currentViewType,ref:"toggleViewTypeButton"}))))},t})(o.PureComponent);t.BrowseTileHeader=p;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t;return this.props.currentViewType===n.ViewTypes.Grid?(e=a._("View as list"),t=o.createElement(h,null)):(e=a._("View as grid"),t=o.createElement(m,null)),o.createElement(u,{content:e,position:u.POSITIONS.TOP,isTargetPositionFixed:!1,className:"toggle-view-type__title-bubble"},o.createElement("button",{key:"toggle_view_column",className:"toggle-view-type c-column-header__button u-trim-margin u-trim-padding",onClick:this.props.onSwitchViewType,ref:"button"},o.createElement("div",{"aria-label":e},t)))},t})(o.PureComponent);t.ToggleViewTypeButton=d;var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return o.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"},o.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},o.createElement("g",{id:"mode",transform:"translate(-96.000000, -32.000000)",fill:"#637282"},o.createElement("g",{id:"mode-list",transform:"translate(96.000000, 32.000000)"},o.createElement("rect",{id:"Rectangle-6",x:"6",y:"15",width:"2",height:"2"}),o.createElement("rect",{id:"Rectangle-6",x:"10",y:"15",width:"8",height:"2"}),o.createElement("rect",{id:"Rectangle-6",x:"6",y:"11",width:"2",height:"2"}),o.createElement("rect",{id:"Rectangle-6",x:"10",y:"11",width:"8",height:"2"}),o.createElement("rect",{id:"Rectangle-6",x:"6",y:"7",width:"2",height:"2"}),o.createElement("rect",{id:"Rectangle-6",x:"10",y:"7",width:"8",height:"2"})))))},t})(o.PureComponent),m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return o.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"},o.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},o.createElement("g",{id:"mode",transform:"translate(-32.000000, -32.000000)",fill:"#637282"},o.createElement("g",{id:"mode-tiles",transform:"translate(32.000000, 32.000000)"},o.createElement("g",{id:"Group",transform:"translate(7.000000, 7.000000)"},o.createElement("rect",{id:"Rectangle-6",x:"0",y:"0",width:"4",height:"4"}),o.createElement("rect",{id:"Rectangle-6",x:"6",y:"0",width:"4",height:"4"}),o.createElement("rect",{id:"Rectangle-6",x:"6",y:"6",width:"4",height:"4"}),o.createElement("rect",{id:"Rectangle-6",x:"0",y:"6",width:"4",height:"4"}))))))},t})(o.PureComponent)}),define("modules/clean/react/browse/context_menu",["external/immutable","external/react","modules/clean/react/browse/action_logger","modules/clean/react/browse/file_actions","modules/clean/react/browse/global_actions","modules/clean/react/browse/models","modules/clean/react/context_menu_v2"],function(e,t,r,o,s,n,i){var a,l,u,c,p,d,h,m,f;return d=e.OrderedMap,u=r.BrowseLogEventSources,m=o.getActionsForFileCollection,f=s.getGlobalActions,a=n.BrowseContext,p=i.GlobalContextMenu,c=i.ContextMenuItem,h=t.createElement,l=t.createClass({displayName:"BrowseContextMenu",propTypes:{context:t.PropTypes.instanceOf(a).isRequired,isSearchMode:t.PropTypes.bool,selectedFiles:t.PropTypes.instanceOf(d).isRequired,shouldShowDeletedFiles:t.PropTypes.bool,shouldShowGlobalActions:t.PropTypes.bool,user:t.PropTypes.object.isRequired,onFileUpload:t.PropTypes.func,actionHandlers:t.PropTypes.object,expOverquotaFileActionVariant:t.PropTypes.string},getDefaultProps:function(){return{onFileUpload:function(){},actionHandlers:{},isSearchMode:!1,shouldShowDeletedFiles:!1,shouldShowGlobalActions:!0}},openMenuAtPosition:function(e,t,r){if(null==r&&(r=null),this.refs.contextMenu.openMenuAtPosition(e,t),null!=r)return this.elemToFocusAfterClose=r},closeMenu:function(){return this.refs.contextMenu.closeMenu()},toggleMenu:function(e){return this.refs.contextMenu.toggleMenu(e)},render:function(){var e,t,r,o,s,n,i,a,l,d;if(o=[],this.props.shouldShowGlobalActions&&this.props.selectedFiles.isEmpty())r=f({context:this.props.context,user:this.props.user,showDeletedFiles:this.props.shouldShowDeletedFiles,onFileUpload:this.props.onFileUpload,isContextMenu:!0});else{if(this.props.selectedFiles.isEmpty())return null;r=m({files:this.props.selectedFiles,context:this.props.context,user:this.props.user,actionHandlers:this.props.actionHandlers,isSearchMode:this.props.isSearchMode,source:u.LEGACY_CONTEXT_MENU,expOverquotaFileActionVariant:this.props.expOverquotaFileActionVariant})}for(e=function(e){return c({text:e.label,icon:{group:"web",name:e.spriteName},onClick:e.performAction,href:e.href,isDisabled:e.disabled})},s=0,i=r.length;s<i;s++)t=r[s],a=e(t),(null!=(l=t.subItems)?l.length:void 0)&&(d=t.subItems.map(e),a=a.set("subMenuItems",d)),o.push(a);return n=["a:not(.filename-link)","input","button","textarea","select","#notify-wrapper",".db-modal-wrapper",".react-file-viewer",".bubble-dropdown",".pinned-team-folder__file-row"],h(p,{alwaysOpenOnCapture:!0,ignoreSelectors:n.join(),items:o,onMenuClose:(function(e){return function(){var t;if(null!=e.elemToFocusAfterClose)return"function"==typeof(t=e.elemToFocusAfterClose).focus&&t.focus(),e.elemToFocusAfterClose=null}})(this),ref:"contextMenu"},this.props.children)}}),{BrowseContextMenu:l}}),define("modules/clean/react/browse/file_actions",["external/underscore","modules/clean/analytics","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/browse/professional_collection_actions","modules/clean/react/home/home_access/home_access_util","modules/clean/search/search_helpers","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/constants/browse","modules/constants/python","modules/constants/starred","modules/constants/viewer","modules/core/browser","modules/core/i18n","modules/core/uri","require"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v){var E,F,P,D,N,C,I,R,M,A,O,x,L,U,k,B,G,V,H,q,W,j,z;return I=t.TeamsWebActionsLogger,D=i.FileTypes,E=a.BrowseLogger,P=l.File,k=u.createProfessionalCollection,q=c.isHomeEnabled,x=d.asyncMountSharedFolder,L=d.asyncShowShareModal,U=d.asyncShowSharedContentLinkSyncModal,N=d.GoldenGate,W=d.makePublicFolderLink,j=d.shouldUsePublicFolderSharing,z=d.showPublicFolderLinkModal,R=m.UEClient,C=b.STARRED_RESOURCE_ID_TYPE,M=w._,F={showProfessionalCollectionShare:!1,showTiburonShare:!1,showCopyPublicFolderFileLink:!1,showOpen:!1,showDownload:!1,showComment:!1,showDelete:!1,showArchive:!1,showUnarchive:!1,showRemove:!1,showRename:!1,showRenameTeamFolder:!1,showRenameArchivedTeamFolder:!1,showMove:!1,showCopy:!1,showVersions:!1,showRestore:!1,showReadd:!1,showPermanentDelete:!1,showPermanentDeleteTeamFolder:!1,showRemoveAccess:!1,showActivity:!1,showStar:!1,showUnstar:!1,showLoadingStar:!1},H=function(e,t){return t?e.isDeleted||e.is_unmounted:e.isDeleted},V=function(t){var r,o,s,n,i,a,l,u,c,p,d;return d=t.user,s=t.context,n=t.files,i=null!=(c=t.isMaestroDesign)&&c,u=null!=(p=t.isUnityLoaded)&&p,r=e.clone(F),s.isInsideArchivedTeamFolder?(r.showDownload=!0,r):(o=!s.isNonUserRelativeContext,l=n.every(function(e){return!H(e,o)}),a=!l&&n.every(H,o),l?O({actions:r,files:n,context:s,user:d,isMaestroDesign:i,isUnityLoaded:u}):a?A({actions:r,files:n,context:s}):r)},O=function(e){var t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,g,b,S,T,w,y,E,F,P,I,R,M,A;return s=e.actions,l=e.files,n=e.context,A=e.user,d=null!=(R=e.isMaestroDesign)&&R,P=null!=(M=e.isUnityLoaded)&&M,m=1===l.count(),f=m&&l.first().is_dir,g=m&&!l.first().is_dir,h=l.some(function(e){return e.type===D.SHARED_FOLDER||e.type===D.TEAM_SHARED_FOLDER}),F=l.some(function(e){return e.type===D.TEAM_SHARED_FOLDER}),w=l.some(function(e){return e.type===D.TEAM_SHARED_FOLDER&&"active"===e.team_folder_status}),E=l.some(function(e){return e.type===D.TEAM_SHARED_FOLDER&&"archived"===e.team_folder_status}),y=l.some(function(e){return e.type===D.TEAM_SHARED_FOLDER&&"archive_in_progress"===e.team_folder_status}),T=l.some(function(e){return e.type===D.TEAM_MEMBER_FOLDER}),I=!1,s.showCopy=!F&&!T,F||T||(m&&h&&!n.isInsideTeamFolderTree?d||n.isNonUserRelativeContext?s.showDelete=!0:s.showRemove=!0:s.showDelete=!0,s.showRename=n.isInFolderMode&&m,s.showMove=!0),A.is_team_admin&&N.hasContentManagerAndSuperAdmin(A.id)&&m&&F&&((w||!n.isNonUserRelativeContext&&!d)&&(s.showArchive=!0,s.showRenameTeamFolder=!0),E&&(s.showUnarchive=!0,s.showRenameArchivedTeamFolder=!0,s.showPermanentDeleteTeamFolder=!0)),m&&(i=l.first(),c=j(n.config,i.fq_path),c||T||n.isNonUserRelativeContext&&(y||E)||(s.showTiburonShare=!0),P&&(o=v("modules/clean/unity/features"),r=v("modules/clean/unity/check_file_cache"),I=null!=o&&(null!=r?r.is_cached_and_locally_available(i.ns_id,i.ns_path):void 0),I&&(s.showOpen=!0))),g&&(n.isNonUserRelativeContext?s.showActivity=!0:s.showComment=!0,s.showVersions=!0,n.isInFolderMode?s.showCopyPublicFolderFileLink=c:s.showCopyPublicFolderFileLink=!1),I||F&&n.isNonUserRelativeContext||(s.showDownload=n.isInFolderMode||g),_.PROFESSIONAL_COLLECTION_MAESTRO&&f&&(T||F||!n.isCurrentPathWriteable()||(s.showProfessionalCollectionShare=!0)),m&&d&&(a=l.first().type,a!==D.SHARED_FOLDER&&a!==D.TEAM_SHARED_FOLDER||n.isNonUserRelativeContext&&(y||E)||(s.showSharedFolderEvents=!0)),S=v.defined("modules/clean/react/starred/browse_exports"),m&&d&&q()&&S&&(t=v("modules/clean/react/starred/browse_exports").StarredStore,u={id:l.first().file_id,type:C.ENCODED_FILE_OBJ_ID},p=t.getIsLoading(u),b=t.getIsStarred(u),s.showStar=b===!1,s.showUnstar=b===!0,s.showLoadingStar=p),s},A=function(e){var t,r,o,s,n,i,a,l;return t=e.actions,n=e.files,r=e.context,n.some(function(e){return e.is_unmounted})?t:(a=1===n.count()&&n.first().is_dir,l=!!a&&(o=n.first(),r.inactiveNSIDByFQPath[o.fq_path.toLowerCase()]),l?t.showReadd=!0:t.showRestore=!0,r.isNonUserRelativeContext?i=!1:r.isInFolderMode?i=r.permanentDeletionDisabledStateByNSID[r.currentNSID]:(s=n.map(function(e){return e.ns_id}),i=s.some(function(e){return r.permanentDeletionDisabledStateByNSID[e]})),i||(l?t.showRemoveAccess=!0:t.showPermanentDelete=!0),r.isNonUserRelativeContext&&(t.showRemoveAccess=!1,t.showReadd=!1,(n.count()>1||a)&&(t.showRestore=!1),n.count()>1&&(t.showPermanentDelete=!1)),t)},G=function(t){var i,a,l,u,c,d,m,_,g,b,S,w,F,N,I,R,A,O,U,B,G,H,q,j,K,Y,Q,J,X,Z,$,ee,te,re,oe,se,ne,ie,ae,le,ue,ce,pe,de,he,me,fe,_e,ge,be,Se,Te,we,ye,ve,Ee,Fe,Pe;return F=t.files,m=t.context,Pe=t.user,a=t.actionHandlers,Ee=null!=(fe=t.skipSharing)&&fe,ie=null!=(_e=t.isMaestroDesign)&&_e,le=null!=(ge=t.isSearchMode)&&ge,Fe=null!=(be=t.source)?be:void 0,w=null!=(Se=t.expOverquotaFileActionVariant)?Se:void 0,ue=null!=(Te=t.isUnityLoaded)&&Te,te=function(){return L(Pe,F.first(),{browseContext:m,origin:h.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW})},K=function(){var e,t,r;if(1===F.count()&&F.first().is_dir)return e=F.first(),e.type===D.SHARED_FOLDER?(t=e.target_ns,r=""):(t=e.ns_id,r=e.ns_path),k(t,r,Pe)},Y=function(){var e,t;if(e=F.first(),m.config&&e&&e.fq_path&&(t=W(Pe.id,m.config,e.fq_path,e.is_dir)))return z(t)},G=function(){var e;return e=F.first(),le&&p.logSearchAction(e,Pe,"open"),v(["modules/clean/unity/features"],function(t){return t.open_file(e.ns_id,e.ns_path,Pe.id,t.standard_open_file_handler,function(e){return t.standard_open_file_handler(!1)})})},O=function(){return le&&p.logSearchAction(F.first(),Pe,"download"),E.logDownload({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),s.downloadFiles({files:F,context:m,user:Pe})},I=function(){var e
;return e=F.first(),le&&p.logSearchAction(e,Pe,"comment"),E.logAddComment({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),s.navigateToFileOrFolder({file:e,shouldFocusComment:!0})},ee=function(e){var t,r;if(v.defined("modules/clean/react/starred/browse_exports"))return r=F.first(),t=v("modules/clean/react/starred/browse_exports").StarredActions,t.update(Pe.role,r.file_id,C.ENCODED_FILE_OBJ_ID,e)},J=function(){var e;return e=F.first(),le&&p.logSearchAction(e,Pe,"rename"),E.logRenameFiles({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),s.showFileRename({file:e})},Z=function(){var e;return m.isNonUserRelativeContext?(e=F.first(),"function"==typeof a.onRenameTeamFolder?a.onRenameTeamFolder(e):void 0):o.showContentManagerBridge(F.toArray(),"rename",f.get_viewer().team_is_limited)},X=function(){var e;if(m.isNonUserRelativeContext)return e=F.first(),"function"==typeof a.onRenameTeamFolderArchived?a.onRenameTeamFolderArchived(e):void 0},N=function(){var e;return m.isNonUserRelativeContext?(e=F.first(),"function"==typeof a.onArchive?a.onArchive(e):void 0):o.showContentManagerBridge(F.toArray(),"archive",f.get_viewer().team_is_limited)},re=function(){var e;if(m.isNonUserRelativeContext)return e=F.first(),"function"==typeof a.onUnarchive?a.onUnarchive(e):void 0},j=function(){var e;if(m.isNonUserRelativeContext)return e=F.first(),"function"==typeof a.onPermanentDeleteArchived?a.onPermanentDeleteArchived(e):void 0},B=function(){return le&&p.logSearchAction(F.first(),Pe,"move"),E.logOpenMoveModal({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),o.showMove(Pe,F.toArray(),m.currentFQPath,{onSuccess:function(e){var t;return t=e.path,E.logMoveFiles({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),newPath:t,source:Fe})},onUndo:function(){return s.selectRowsFromNotServer(F.toArray())},onRequestNotSent:function(){var e;return s.selectFilesByFqPath({fqPathsToSelect:(function(){var t,r,o,s;for(o=F.toArray(),s=[],t=0,r=o.length;t<r;t++)e=o[t],s.push(e.fq_path);return s})()})}})},R=function(){return le&&p.logSearchAction(F.first(),Pe,"copy"),E.logOpenCopyModal({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),o.showCopy(Pe,F.toArray(),{onSuccess:function(e){var t;return t=e.files,E.logCopyFiles({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),s.selectRowsFromNotServer(t)},onUndo:function(){return s.selectRowsFromNotServer(F.toArray())},onRequestNotSent:function(){var e;return s.selectFilesByFqPath({fqPathsToSelect:(function(){var t,r,o,s;for(o=F.toArray(),s=[],t=0,r=o.length;t<r;t++)e=o[t],s.push(e.fq_path);return s})()})}})},H=function(){return o.showOverquota(w)},$=function(){var e,t;return m.isNonUserRelativeContext?void("function"==typeof a.onRestoreMulti&&a.onRestoreMulti(F.first())):(le&&p.logSearchAction(F.first(),Pe,"restore"),e=1===F.size&&F.first().is_dir,e&&!m.isNonUserRelativeContext?(t=n.getRestoreFileUrl({fqPath:F.first().fq_path,userId:Pe.id}),T.redirect(t)):a.onRestoreMulti())},Q=function(){var e,t,o;if(e=F.first(),t=e.fq_path.toLowerCase(),o=m.inactiveNSIDByFQPath[t],r.filename(e.fq_path),o)return x(o,Pe.role,h.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,!1,null,!0)},g=!m.isCurrentPathWriteable(),we=!m.isCurrentPathWriteable(),pe=!m.isCurrentPathWriteable(),ye=!m.isCurrentPathWriteable(),ae=F.some(function(e){return!P.canViewFileMembers(e,m)}),ve=ae,S=ae,c=F.every(function(e){return P.isNoAccessSharedFolder(e)}),b=c,_=c,u=V({files:F,context:m,user:Pe,isMaestroDesign:ie,isUnityLoaded:ue}),ce=[],oe=function(){var e;return m.isNonUserRelativeContext?void("function"==typeof a.onShowVersions&&a.onShowVersions(F.first())):(le&&p.logSearchAction(F.first(),Pe,"revisions"),E.logVersions({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),e=n.getFileHistoryUrl({fqPath:F.first().fq_path,userId:Pe.id},{}).toString(),T.redirect(e))},se=function(){return"function"==typeof a.onViewActivity?a.onViewActivity(F.first()):void 0},A=function(e){return m.isNonUserRelativeContext?void("function"==typeof a.onDelete&&a.onDelete(F.first())):(le&&p.logSearchAction(F.first(),Pe,"delete"),E.logDeleteFiles({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),a.onDelete(e))},q=function(e){return m.isNonUserRelativeContext?void("function"==typeof a.onPermanentDelete&&a.onPermanentDelete(F.first())):(le&&p.logSearchAction(F.first(),Pe,"purge"),E.logPermanentDeleteFiles({uid:Pe.id,path:m.currentFQPath,files:F.toArray(),source:Fe}),a.onPermanentDelete(e))},i=function(t,r,o,s,n){var i;return i={label:t,spriteName:r,iconName:n,performAction:o},e.extend(i,s)},ie?(!Ee&&u.showTiburonShare&&(de={disabled:ve},d=M(m.isNonUserRelativeContext?"Manage":"Share"),ce.push(i(d,"s_rainbow",te,de))),u.showProfessionalCollectionShare&&ce.push(i(M("Share as collection"),"premium-share",K)),u.showCopyPublicFolderFileLink&&ce.push(i(M("Copy public link"),"world_link",Y,null,"acl-link")),u.showOpen&&ce.push(i(M("Open"),"open",G,null,"action-open-in-app")),u.showDownload&&(de={disabled:b},ce.push(i(M("Download"),"download",O,de,"action-download"))),u.showComment&&ce.push(i(M("Add comment"),"s_file_comment",I,null,"action-add-comment")),u.showStar&&(de={disabled:u.showLoadingStar},l=M("Star",{comment:'Verb describing the "starring" action, not the noun.'}),ce.push(i(l,"s_star",ee.bind(null,!0),de,"action-star"))),u.showUnstar&&(de={disabled:u.showLoadingStar},l=M("Unstar",{comment:'Verb describing the "unstarring" action.'}),ce.push(i(l,"s_unstar",ee.bind(null,!1),de,"action-unstar"))),u.showVersions&&ce.push(i(M("Version history"),"previous_versions",oe,null,"action-view-version-history")),u.showUnarchive&&ce.push(i(M("Restore"),"restore",re)),u.showPermanentDeleteTeamFolder&&ce.push(i(M("Permanently delete"),"cancel",j)),u.showRename&&(de={ref:"rename",disabled:we},ce.push(i(M("Rename"),"rename",J,de,"action-rename"))),u.showRenameTeamFolder&&ce.push(i(M("Rename"),"rename",Z,null,"action-rename")),u.showRenameArchivedTeamFolder&&ce.push(i(M("Rename"),"rename",X,null,"action-rename")),u.showArchive&&ce.push(i(M("Archive"),"delete_16",N,null,"action-delete")),u.showMove&&(de={disabled:pe},ce.push(i(M("Move"),"move_16",B,de,"action-move"))),u.showCopy&&(de={disabled:_},ce.push(i(M("Copy"),"copy",R,de,"action-copy"))),u.showDelete&&(de={disabled:g},ce.push(i(M("Delete"),"delete_16",A,de,"action-delete"))),u.showRestore&&(de={disabled:ye},ce.push(i(M("Restore"),"restore",$,de))),u.showReadd&&(de={disabled:ye},ce.push(i(M("Re-add shared folder"),"restore",Q,de))),u.showPermanentDelete&&ce.push(i(M("Permanently delete"),"cancel",q)),u.showActivity&&ce.push(i(M("View activity"),"previous_versions",se,null,"action-view-version-history")),u.showSharedFolderEvents&&(U=function(){var e;return e=F.first(),le&&p.logSearchAction(e,Pe,"events"),T.redirect("/events?ns="+e.target_ns)},de={disabled:S},ce.push(i(M("Events"),"calendar_view_month",U,de,"action-events"))),ce):(Ee||u.showTiburonShare&&ce.push(i(M("Share…"),"s_rainbow",te)),u.showCopyPublicFolderFileLink&&ce.push(i(M("Copy public link…"),"world_link",Y)),u.showOpen&&ce.push(i(M("Open"),"open",G)),u.showDownload&&ce.push(i(M("Download"),"download",O)),u.showComment&&ce.push(i(M("Comment"),"s_file_comment",I)),u.showDelete&&(de={disabled:g},ce.push(i(M("Delete..."),"delete_16",A,de))),u.showRemove&&(de={disabled:g},ce.push(i(M("Remove..."),"delete_16",A,de))),u.showArchive&&ce.push(i(M("Archive"),"delete_16",N)),u.showRename&&(de={ref:"rename",disabled:we},ce.push(i(M("Rename"),"rename",J,de))),u.showRenameTeamFolder&&ce.push(i(M("Rename"),"rename",Z)),u.showMove&&(de={disabled:pe},"V1"===w||"V2"===w||"V3"===w||"V4"===w?ce.push(i(M("Move..."),"move_16",H,de)):ce.push(i(M("Move..."),"move_16",B,de))),u.showCopy&&("V1"===w||"V2"===w||"V3"===w||"V4"===w?ce.push(i(M("Copy..."),"copy",H)):ce.push(i(M("Copy..."),"copy",R))),u.showVersions&&(m.isNonUserRelativeContext?(me={ns_id:F.first().ns_id,return_url:y.parse(T.get_href()).getPath()},he=F.first().ns_path):(me={},he=F.first().fq_path),ne=n.getFileHistoryUrl({fqPath:he,userId:Pe.id},me),de={href:ne},ce.push(i(M("Version history"),"previous_versions",null,de))),u.showRestore&&ce.push(i(M("Restore…"),"restore",$)),u.showReadd&&ce.push(i(M("Re-add shared folder"),"restore",Q)),u.showPermanentDelete&&ce.push(i(M("Permanently delete…"),"cancel",q)),u.showRemoveAccess&&ce.push(i(M("Remove my access"),"cancel",q)),u.showActivity&&ce.push(i(M("View activity"),"previous_versions",se)),ce)},B=function(e){var t,r,o,n,i,a,l,u;if(r=e.event,u=e.user,o=e.file,i=e.isSearchMode,t=e.constructorDisplayName,a=e.onFileViewerUnmount,l=e.source,E.logOpenRow({uid:u.id,entity_type:o.is_dir?"folder":"file",source:l}),!(r.button>0||r.shiftKey||r.altKey||r.metaKey||r.ctrlKey))return r.preventDefault(),r.stopPropagation(),o.type===D.TEAM_SHARED_FOLDER&&(R.sendEvent(t,"TeamFolderClicked"),I.log("clicked_team_folder_web",{team_id:f.get_viewer().team_id})),i&&o.is_unmounted?U(u,o):(n=g.FileViewActionType.CLICK,i&&(p.logSearchAction(o,u,o.is_dir?"folder_open":"file_view"),n=g.FileViewActionType.SEARCH),s.navigateToFileOrFolder({file:o,onFileViewerUnmount:null!=a?a:function(){},fileViewAction:n}))},{getActionsForFileCollection:G,doOpenFile:B}});var indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/file_jump",["modules/clean/keycode","modules/clean/react/browse/store","modules/core/dom","modules/clean/react/browse/constants","modules/clean/flux/dispatcher"],function(e,t,r,o,s){var n,i,a,l,u;return l=e.KeyCode,a=t.BrowseStore,i=o.BrowseActionTypes,n=["/","\\",":","?","*","<",">","|"],u=1e3,{_timeout:null,_reset:function(){return s.dispatch({type:i.RESET_FILE_JUMP})},handleKeyPress:function(e){var t,o,c;if(o=null!=(c=e.which)?c:e.keyCode,t=String.fromCharCode(o),!(o<l.SPACE||indexOf.call(n,t)>=0||r.focus_in_input()||e.metaKey||e.altKey||e.altGraphKey||e.ctrlKey||o===l.SPACE&&!a.isFileJumping()))return o===l.SPACE&&a.isFileJumping()&&e.preventDefault(),s.dispatch({type:i.ADD_FILE_JUMP_KEY_CODE,data:{keyChar:t}}),null!=this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._reset,u)}}}),define("modules/clean/react/browse/file_list_empty_folder",["external/classnames","external/react","modules/clean/analytics","modules/clean/react/browse/constants","modules/clean/react/button","modules/clean/react_format","modules/clean/react/image","modules/clean/static_urls","modules/clean/stormcrow/stormcrow_exposure_logger","modules/core/i18n"],function(e,t,r,o,s,n,i,a,l,u){var c,p,d,h,m,f,_,g,b;return d=r.TeamsWebActionsLogger,c=o.NameSpaceAccess,m=s.button,g=n.reactFormat,b=a.static_url,p=l.StormcrowExposureLogger,h=u._,_=t.DOM,f=t.createElement,t.createClass({propTypes:{currentSharedFolderPermissionRole:t.PropTypes.number,isArchiveState:t.PropTypes.bool,isBrowseInContentManager:t.PropTypes.bool,isInsideSharedFolder:t.PropTypes.bool,isSearchState:t.PropTypes.bool,isViewingTeamFolder:t.PropTypes.bool,userId:t.PropTypes.number.isRequired,userFamiliarName:t.PropTypes.string,showFileUploaderModal:t.PropTypes.func,onCreateTeamFolder:t.PropTypes.func,enableDataMigrationTool:t.PropTypes.bool,onShowDataMigrationToolModal:t.PropTypes.func,expBizTeamFolderOnboardingVariant:t.PropTypes.string},mixins:[t.addons.PureRenderMixin],displayName:"EmptyFolder",getDefaultProps:function(){return{isSearchState:!1,onCreateTeamFolder:null,onShowDataMigrationToolModal:null}},componentWillMount:function(){return this.stormcrowExposureLogger=new p},_logTeamAction:function(e){return d.log(e,null,null,this.props.userId,!1,d.LOG_CATEGORY.TEAM_INFO)},render:function(){var t,r,o,s,n,a,l,u,p,d,S,T,w,y;return u=this.props.isInsideSharedFolder&&((p=this.props.currentSharedFolderPermissionRole)===c.ACCESS_READER||p===c.ACCESS_READER_NO_COMMENT),r=e(["u-font-center u-pad-top-xl",{"empty-folder-placeholder":!this.props.isBrowseInContentManager}]),s={"u-l-dn":u,"drag-prompt":!0},this.props.isSearchState?_.div({className:r},f(i,{src:b("/static/images/empty_states/search-vfl6DaX2I.png"),srcHiRes:b("/static/images/empty_states/search@2x-vflBsUhDE.png"),alt:""}),_.h2({className:"u-pad-top-l"},h("No results found")),_.div({},h("Please update your search and try again"))):this.props.isBrowseInContentManager&&this.props.isArchiveState?_.div({className:e([r,"u-font-meta"])},h("No archived team folders")):this.props.isBrowseInContentManager&&this.props.isViewingTeamFolder?_.div({className:r,id:"cm-empty-state"},f(i,{src:b("/static/images/empty_states/collaboration-team-folder-vflapVQHo.png"),srcHiRes:b("/static/images/empty_states/collaboration-team-folder@2x-vflsqkNUB.png"),alt:""}),_.div({className:"u-font-center u-font-meta content-manager__empty-state"},h("Team folders let you share with your entire department or team.")," ",_.a({href:"/help/9263",target:"_blank"},h("Learn how"))),f(m,{onClick:this.props.onCreateTeamFolder},h("Create team folder")),this.props.enableDataMigrationTool?_.div({className:"u-font-center u-font-meta content-manager__data-migration-tool-empty-state"},[h("Need help migrating files to Dropbox?"),_.button({className:"dmt-link button-as-link",onClick:this.props.onShowDataMigrationToolModal},h("Dropbox Migration Assistant"))]):void 0):(this.props.isViewingTeamFolder?(this._logTeamAction("upload_files_displayed"),t=h("Upload files"),this.stormcrowExposureLogger.logExposuresOnce({subgrowth_biz_team_folder_onboarding:this.props.expBizTeamFolderOnboardingVariant}),a=b("/static/images/empty_states/team-folder-vflZkv0TQ.png"),l=b("/static/images/empty_states/team-folder@2x-vfloC8f3o.png"),n=h("This Team folder is empty. Upload files to this folder to share with your Team."),"V1"!==(d=this.props.expBizTeamFolderOnboardingVariant)&&"V2"!==d||(n=_.div({},_.h2({},h("Your team folder is a shared space with your Dropbox team.")),_.div({},h("Team folders automatically include all members of your team, so any document or folder you add here will be automatically shared with your entire team."))),t=h("Add files"),w=g(h("or <helpLink>create a regular shared folder</helpLink> if you want only some members of your team to access a given folder"),{helpLink:_.a({href:"/help/19",target:"_blank"})})),o=_.div({className:"o-grid"},_.div({className:e({"o-grid__col--centered":!0,"u-pad-top-m":!0,"o-grid__col--1-of-3":"V1"===(S=!this.props.expBizTeamFolderOnboardingVariant)||"V2"===S,"o-grid__col--1-of-2":"V1"===(T=this.props.expBizTeamFolderOnboardingVariant)||"V2"===T})},_.div({},n),f(m,{onClick:(function(e){return function(){return e.props.showFileUploaderModal(),e._logTeamAction("upload_files_clicked")}})(this)},t),w?_.div({className:"u-pad-top-xs"},w):void 0))):(a=b("/static/images/empty_states/files-vflsVPyeo.png"),l=b("/static/images/empty_states/files@2x-vflvkuH8g.png"),y=_.h2({},h("This folder is empty.")),o=this.props.isBrowseInContentManager?_.div({},""):_.div({},h("Drag and drop files onto this window to upload."))),_.div({className:r},a?f(i,{src:a,srcHiRes:l,alt:""}):void 0,y,_.div({className:e(s)},o)))}})}),define("modules/clean/react/browse/file_list_team_folder_description",["require","exports","tslib","external/react","modules/clean/react/button","modules/clean/react/css","modules/clean/react/image","modules/clean/react_logger","modules/clean/static_urls","modules/core/i18n"],function(e,t,r,o,s,n,i,a,l,u){"use strict";var c=(function(e){function t(r){return e.call(this,t.displayName,r)||this}return r.__extends(t,e),t.prototype.render=function(){var e=l.static_url("/static/images/empty_states/team-folder-vflZkv0TQ.png"),t=l.static_url("/static/images/empty_states/team-folder@2x-vfloC8f3o.png"),r=u._("This is your Team folder. Upload files to this folder to share with your Team."),n=u._("Upload files");return o.createElement("div",{className:"team-folder-description u-font-center"},o.createElement(i,{src:e,srcHiRes:t,alt:u._("Team Folder")}),o.createElement("div",{className:"o-grid"},o.createElement("div",{className:"o-grid__col--1-of-3 o-grid__col--centered u-pad-top-m"},o.createElement("div",null,r),o.createElement(s.Button,{onClick:this.props.showFileUploaderModal},n))))},t})(a.ReactPureLogger);c.displayName="TeamFolderDescription",t.TeamFolderDescription=n(c,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/browse/browse-vflIgR_rF.css"])}),define("modules/clean/react/browse/file_list_utils",["modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t){var r,o,s,n;return r=e.DropTargetHighlightMode,n=e.FileTypes,o=t.File,s={shouldFileBeHighlightedDropTarget:function(e){var t,s,i,a;if(s=e.file,i=e.isSelected,t=e.dropTargetHighlightMode,t===r.NONE)return!1;if(!s.is_dir)return!1;if(o.isReadOnlySharedFolder(s))return!1;if(s.isDeleted)return!1;switch(t){case r.ALL_FOLDERS:return!0;case r.NONSELECTED_FOLDERS:return!i;case r.NONSELECTED_NONSHARED_FOLDERS:return!i&&s.type!==n.SHARED_FOLDER;case r.NONSELECTED_NONSHARED_NONTEAM_FOLDERS:return!i&&(a=s.type)!==n.SHARED_FOLDER&&a!==n.TEAM_SHARED_FOLDER}return!1}},{FileListHelpers:s}}),define("modules/clean/react/browse/folder_list_row",["jquery","external/classnames","external/immutable","external/react","external/underscore","modules/clean/filepath","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/sprite","modules/core/i18n","modules/clean/react/browse/actions","modules/clean/react/browse/name_input","modules/clean/react/flag","modules/clean/react_logger","modules/clean/sharing/browse_exports","modules/clean/static_urls"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f){var _,g,b,S,T,w,y,v;return b=i.NewFolderCreationState,_=a.BrowseContext,T=u._,g=p.NameInput,S=h.ReactLogger,m.GoldenGate,v=f.static_url,y=o.DOM,w=o.createElement,o.createClass({displayName:"NewFolderCreationListRow",mixins:[o.addons.PureRenderMixin],propTypes:{newFolderState:o.PropTypes.oneOf(s.values(b)),context:o.PropTypes.instanceOf(_),topOffsetPx:o.PropTypes.number,user:o.PropTypes.object,isMaestroDesign:o.PropTypes.bool},componentWillMount:function(){return S.start(this.constructor.displayName)},componentDidMount:function(){return S.end(this.constructor.displayName)},_handleCancel:function(){return c.cancelCreateFolder()},_handleSubmit:function(e){return c.createFolder({pathName:this.props.context.currentFQPath,folderName:e,nsId:this.props.context.rootNSID})},_renderIcon:function(){var e;return e=n.new_folder_icon(this.props.context.isInsideTeamFolderTree),w(l,{group:"web",name:v("/static/images/icons/icon_spacer-vflN3BYt2.gif"),className:t("sprite","sprite_web","browse-file-row__accessory",e,{"u-pad-right-xs":!this.props.isMaestroDesign}),alt:""})},_renderNewFolderCreationColumn:function(){var e,t;return e=this._renderIcon(),t=y.div({}),this.props.newFolderState===b.PENDING_INPUT?t=w(g,{defaultValue:"",label:T("Folder name"),onSubmit:this._handleSubmit,onCancel:this._handleCancel,className:"browse-file-row__input"}):this.props.newFolderState===b.SAVING_INPUT&&(t=y.div({className:"creating_folder_text",role:"status","aria-live":"polite"},T("Creating new folder…"))),y.div({className:"o-grid__col--1-of-2",role:"gridcell"},w(d.Flag,{leftAttachment:e},t))},_renderPlaceholder:function(){return y.div({role:"gridcell"})},render:function(){var e;return e={"browse-file-row":!0,"o-grid":!0,"o-grid--no-gutter":!0,"browse-file-row--is-selected":!0},y.li({className:t(e),role:"row",style:{position:"absolute",top:this.props.topOffsetPx}},this._renderPlaceholder(),this._renderNewFolderCreationColumn(),this._renderPlaceholder(),this._renderPlaceholder(),this._renderPlaceholder())}})}),define("modules/clean/react/browse/global_actions",["jquery","external/classnames","external/react","external/underscore","modules/clean/react/title_bubble","modules/clean/payments/pro_trial_onboarding_tour","modules/clean/css","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/professional_collection_actions","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/sprite","modules/clean/react/sprite_div","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/user","modules/clean/viewer","modules/constants/browse","modules/constants/maestro","modules/clean/react/bubble_menu","modules/core/browser","modules/core/i18n","modules/core/uri","require"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D){var N,C,I,R,M,A,O,x,L,U,k,B,G,V,H,q,W,j,z,K;return x=n.ProOnboardingTooltips,C=l.BrowseLogger,q=c.createProfessionalCollection,d.NameSpaceAccess,N=h.BrowseContext,m.BrowseStore,G=g.asyncShowShareAFolderWizardModal,V=g.asyncShowShareModal,B=g.asyncMountSharedFolder,k=g.asyncGenContentManagerBridgeUri,O=g.GoldenGate,y.MAESTRO_ICONS_ENABLED,I=v.BubbleMenu,R=v.BubbleMenuItem,L=F._,j=r.DOM,H=r.createElement,W=t,A={INLINE:0,INLINE_WITH_TEXT:1},U=function(e,t){var r,o;return t?(o=T.get_viewer(),r=e.isInsideAutoTeamFolder&&o.team_is_limited&&"/"===a.parent_dir(e.currentFQPath),L(r?o.work_user.is_team_admin?"Folder settings":"Invite members":e.isCurrentlyInRoot?"New shared folder":"Share folder")):L(e.isInsideAutoTeamFolder?"Team folder options…":e.isInsideSharedFolder?"Shared folder options…":e.isCurrentlyInRoot?"Share a folder…":"Share this folder…")},K=function(e){var t,r,o,s,n,i,a,l,c,p,d,h,m,f,_,g,S,T,w;return o=e.context,w=e.user,g=e.showDeletedFiles,f=e.onFileUpload,null!=(_=e.isMaestroDesign)&&_,h=o.isCurrentlyInRoot,s=A.INLINE,A.INLINE,c=function(e){return e.preventDefault(),f(e)},p=function(e){return e.preventDefault(),u.nameNewFolder()},function(e){return e.preventDefault(),h?G(w):V(w,o,{origin:b.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS})},d=function(e){return e.preventDefault(),u.setShouldShowDeletedFiles({shouldShowDeletedFiles:!g})},l=function(e){return E.redirect("/team/admin/settings/management")},m=[],r=L("Management settings"),t={label:r,spriteName:"gear",performAction:l,style:s},T=L("Upload…"),S={label:T,spriteName:"upload_16",iconName:"action-upload",performAction:c,style:s},a=s,i={label:L("New folder"),spriteName:"folder_add",iconName:"action-new-folder",performAction:p,style:a},n={label:L(g?"Hide deleted files":"Show deleted files"),spriteName:g?"trash-can-open":"trash-can",iconName:g?"action-hide":"action-show-deleted-files",performAction:d,style:s},o.isInsideDeletedFolder||(m=O.hasContentManagerTSDSwitch(w.id)?m.concat([S,i,n,t]):m.concat([S,i,n]),m=m.filter(function(e){return null!=e})),m},z=function(e){var t,r,o,s,n,i,a,l,c,d,h,m,f,_,g,S,y,v,F,P,D,N,I,R,M,H,W,j,z,K,Y,Q,J,X,Z,$,ee;return t=e.context,ee=e.user,X=e.showDeletedFiles,z=e.onFileUpload,M=e.isMaestroDesign,I=e.isContextMenu,H=null!=(K=e.isNoComment)&&K,R=t.isCurrentlyInRoot,D=ee.is_team_admin&&R&&O.hasContentManager(ee.id),N=!t.canViewContainingNSMembers,r=A.INLINE,J=A.INLINE,j=w.SUBGROWTH_PRO_ONBOARDING_LAST_SEEN_STEP,l="V1"===w.SUBGROWTH_PRO_ONBOARDING_UPLOAD&&0===j,a="V1"===w.SUBGROWTH_PRO_ONBOARDING_SHARING&&1===j,d=L("Getting started?\nClick here to upload your files to Dropbox"),c=L("Have you tried using Dropbox to collaborate with others?\nClick here to share a project folder"),f=function(e){return e.preventDefault(),l&&x.setUserOnboardingAttribute(e.currentTarget,j+1),z(e)},_=function(e){return e.preventDefault(),C.logCreateFolder({uid:ee.id}),u.nameNewFolder()},v=function(e){return e.preventDefault(),a&&x.setUserOnboardingAttribute(e.currentTarget,j+1),R?G(ee):V(ee,t,{origin:b.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS})},F=function(e){return k(T.get_viewer().team_is_limited).then(function(e){return E.open_tab(e.toString())})},P=function(e){return e.preventDefault(),C.logToggleDeletedFiles({uid:ee.id,show_deleted_files:!X}),u.setShouldShowDeletedFiles({shouldShowDeletedFiles:!X})},y=function(e){var r;return e.preventDefault(),r=p.getRestoreFileUrl({fqPath:t.currentFQPath,userId:ee.id}),E.redirect(r)},S=function(e){var r,o,s;if(e.preventDefault(),r=t.currentFQPath.toLowerCase(),o=t.inactiveNSIDByFQPath[r],s=t.isInsideDeletedNestedSharedFolder,o)return B(o,ee.role,b.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,!1,null,s)},g=function(e){return q(t.currentNSID,t.currentNSPath,ee)},s={label:L("Folder"),sublabel:L("For private files"),spriteName:I?"folder":"folder_32",performAction:_,disabled:!t.isCurrentPathWriteable()},n={label:L("Shared folder"),sublabel:L("For collaborating on a project"),spriteName:I?"folder_user":"folder_user_32",performAction:v},i={label:L("Team folder"),sublabel:L("For sharing with an entire department or team"),sublabelLine2:L("This will take you to the Admin Console"),spriteName:I?"folder_team":"folder_team_32",performAction:F},$=L(M?"Upload files":"Upload…"),Z={label:$,tooltip:l?d:void 0,spriteName:"upload_16",iconName:"action-upload",performAction:f,disabled:!t.isCurrentPathWriteable(),active_onboarding_step:l,style:r},o={label:L(X?"Hide deleted files":"Show deleted files"),spriteName:X?"trash-can-open":"trash-can",iconName:X?"action-hide":"action-show-deleted-files",performAction:P,style:r,disabled:N},W=[],t.isInsideDeletedSharedFolder||t.isInsideDeletedNestedSharedFolder?W.push({label:L("Re-add shared folder"),spriteName:"restore",performAction:S,style:r}):t.isInsideDeletedFolder?W.push({label:L("Restore folder"),spriteName:"restore",performAction:y,style:r}):!M&&D?I?(W=W.concat([Z,s,n,i]),H||W.push(o)):(W.push(Z),W.push({label:L("New folder"),spriteName:"folder_add",iconName:"action-new-folder",dropdownItems:[s,n,i],disabled:!t.isCurrentPathWriteable(),style:A.INLINE}),H||W.push(o)):(m=D?A.INLINE_WITH_TEXT:r,h={label:L("New folder"),spriteName:"folder_add",iconName:"action-new-folder",performAction:_,disabled:!t.isCurrentPathWriteable(),style:m},Y={label:U(t,M),tooltip:a?c:void 0,spriteName:"rainbow_16",iconName:"action-new-shared-folder",performAction:v,active_onboarding_step:a,style:J,disabled:N},Q=w.PROFESSIONAL_COLLECTION_MAESTRO&&t.isCurrentPathWriteable()?{label:L("Share as collection"),spriteName:"premium-share",performAction:g,style:J}:void 0,W=M?ee.is_cdm_member&&"/"===t.currentFQPath?W.concat([Z,h]):R?W.concat([Z,Y,h]):W.concat([Y,Q,Z,h]):W.concat([Z,h,Y]),W=W.filter(function(e){return null!=e}),H||W.push(o)),W},M=r.createClass({displayName:"GlobalActions",propTypes:{shouldShowDeletedFiles:r.PropTypes.bool.isRequired,context:r.PropTypes.instanceOf(N).isRequired,user:r.PropTypes.instanceOf(S).isRequired,onFileUpload:r.PropTypes.func.isRequired,isActionsBarDisabled:r.PropTypes.bool.isRequired},getInitialState:function(){return{isHeaderFixed:!0}},componentDidMount:function(){return this._handleWindowResize(),e(window).on("resize.globalActionButtons",o.throttle(this._handleWindowResize,30))},componentWillUnmount:function(){return e(window).off("resize.globalActionButtons")},_renderButton:function(e){var t,r,o,s,n,i;return r=e.buttonClasses,s=e.message,i=e.spriteName,n=e.onClick,o=e.disabled,t=j.button({className:W(r),disabled:o,onClick:n},H(f,{className:"global-actions__button-sprite",group:"web",name:i,alt:s})),o||(t=this._wrapWithTitleBubble(t,s)),t},_renderButtonWithText:function(e){var t,r,o,s,n;return t=e.buttonClasses,o=e.message,n=e.spriteName,s=e.onClick,r=e.disabled,j.button({className:W(t,"button-as-link"),disabled:r,onClick:s},H(_,{className:"global-actions__button-sprite",group:"web",name:n,text:o,alt:"",spritePosition:"left"}))},_handleWindowResize:function(){var t;return t="fixed"===e(".browse-header").css("position"),this.setState({isHeaderFixed:t})},_wrapWithTitleBubble:function(e,t){return H(s,{content:t,position:s.POSITIONS.BOTTOM,distanceFromTarget:-3,isTargetPositionFixed:this.state.isHeaderFixed},e)},_wrapInlineButton:function(e,t){return j.li({className:"global-actions__action",key:t},e)},_renderInlineItem:function(e){var t,r,o,s;switch(r={"global-actions__button":!0,"sprite-button":!0,"global-actions__button--onboarding":null!=e.active_onboarding_step},o={buttonClasses:r,message:e.tooltip||e.label,spriteName:e.spriteName,onClick:e.performAction,disabled:e.disabled||this.props.isActionsBarDisabled},e.style){case A.INLINE_WITH_TEXT:t=this._renderButtonWithText(o);break;default:t=this._renderButton(o)}return null!=e.dropdownItems&&(s=e.style===A.INLINE_WITH_TEXT?4:8,t=this._renderDropdownButton(t,e.dropdownItems,s)),t},_renderDropdownButton:function(e,t,r){return H(I,{className:"global-actions__dropdown",targetButton:e,targetFixed:this.state.isHeaderFixed,items:this._renderDropdownItems(t),position:I.POSITIONS.BOTTOM_RIGHT,verticalDisplacement:r})},_renderDropdownItems:function(e){var t,r,o,s,n;for(t=[],o=0,n=e.length;o<n;o++)s=e[o],r=s.disabled||this.props.isActionsBarDisabled,t.push(H(R,{onClick:s.performAction,disabled:r},j.div({className:"sprite-div"},j.div({className:W(["sprite-frame","small","icon-left"])},H(f,{alt:"",group:"web",name:s.spriteName})),j.div({className:W(["sprite-text"])},j.h3({className:W(["global-actions__dropdown__item-label","u-trim-margin","u-font-strong"])},s.label),j.p({className:W(["global-actions__dropdown__item-sublabel","u-font-meta"])},s.sublabel),s.sublabelLine2?j.p({className:W(["global-actions__dropdown__item-sublabel-line2","u-font-meta"])},s.sublabelLine2):void 0))));return t},render:function(){var e,t,r,o,s,n;return n=this.props.context.isNonUserRelativeContext?K({context:this.props.context,user:this.props.user,showDeletedFiles:this.props.shouldShowDeletedFiles,onFileUpload:this.props.onFileUpload}):z({context:this.props.context,user:this.props.user,showDeletedFiles:this.props.shouldShowDeletedFiles,onFileUpload:this.props.onFileUpload,isContextMenu:!1}),t=function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)s=n[e],r.push(this._renderInlineItem(s));return r}.call(this),r={"global-actions":!0,"u-mar-top-xs":!0},j.div({className:W(r)},j.ul({className:"horizontal"},function(){var r,s,n;for(n=[],o=r=0,s=t.length;r<s;o=++r)e=t[o],n.push(this._wrapInlineButton(e,o));return n}.call(this)))}}),{getGlobalActions:z,getGlobalActionsForCM:K,GlobalActions:M}}),define("modules/clean/react/browse/internal_drag_status",["external/react","modules/clean/react/sprite"],function(e,t){var r,o;return o=e.DOM,r=e.createClass({displayName:"InternalDragStatus",mixins:[e.addons.PureRenderMixin],propTypes:{files:e.PropTypes.array.isRequired},render:function(){return o.div({id:"drag-status",className:"active"},o.div({id:"drag-selection-status"},this.props.files.slice(0,4).map(function(r,s){return r.thumbnail_url_tmpl?o.img({key:s,src:r.thumbnail_url_tmpl,className:"icon icon"+s,alt:""}):e.createElement(t,{key:s,group:"web",name:r.icon,className:"icon icon"+s,alt:""})}),o.span({className:"badge"},this.props.files.length)))}}),{InternalDragStatus:r}}),
define("modules/clean/react/browse/item_list",["jquery","external/classnames","external/mcl/button","external/mcl/vertically_fixed","external/immutable","external/keymaster","external/react","external/react-dom","external/underscore","modules/clean/components/loading_indicator","modules/clean/em_string","modules/clean/filepath","modules/clean/keycode","modules/clean/react/browse/actions","modules/clean/react/browse/browse_drag_and_drop","modules/clean/react/browse/browse_keyboard_shortcuts","modules/clean/react/browse/constants","modules/clean/react/browse/file_actions","modules/clean/react/browse/file_list_empty_folder","modules/clean/react/browse/internal_drag_status","modules/clean/react/browse/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/browse/file_list_utils","modules/clean/react/browse/store","modules/clean/react/browse/overflow_menu","modules/clean/react/columnheader","modules/clean/react/file_uploader/constants","modules/clean/react/helpers","modules/clean/react/modal","modules/clean/react/selectable_list","modules/clean/react_logger","modules/clean/sharing/browse_exports","modules/clean/static_urls","modules/clean/undo","modules/core/accessible_announce","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/react/browse/item_list_row","modules/clean/react/browse/folder_list_row","modules/clean/react/browse/file_jump","modules/clean/react/maestro/tile_grid","modules/clean/react/browse/tile_label_name_input","modules/clean/react/title_bubble","modules/clean/react/maestro/checkbox","modules/clean/react/browse/browse_tile_header","modules/clean/react/sticky/container","modules/clean/react/sticky/sticky","require"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D,N,C,I,R,M,A,O,x,L,U,k,B,G,V,H,q,W,j,z,K,Y,Q){var J,X,Z,$,ee,te,re,oe,se,ne,ie,ae,le,ue,ce,pe,de,he,me,fe,_e,ge,be,Se,Te,we,ye,ve,Ee,Fe,Pe,De,Ne,Ce,Ie,Re,Me,Ae,Oe,xe,Le,Ue,ke,Be,Ge,Ve,He,qe,We,je,ze,Ke,Ye,Qe,Je,Xe,Ze,$e,et;return se=r.Button,xe=o.VerticallyFixed,d.KeyCode,Qe=m.setupExternalDragHandler,Ke=m.onFileDragEnterItem,je=f.generateGetIsGlobalEvent,Ye=f.resetBrowseKeyboardShortcuts,Je=f.setupGeneralBrowseKeyboardShortcuts,Xe=f.setupItemListKeyboardShortcuts,ue=_.CulledListConstants,te=_.BrowseSortField,ce=_.DropTargetHighlightMode,we=_.LoadingStates,ye=_.NewFolderCreationState,Pe=_.RenameStates,Le=_.ViewTypes,be=S.InternalDragStatus,pe=w.File,Ee=w.Paper,$=w.BrowseContext,w.FileRename,de=y.FileListHelpers,v.BrowseStore,ee=E.BrowseOverflowMenu,ve=E.OverflowMenuSize,ae=F.ColumnHeader,le=F.ColumnTypes,De=F.SortDirections,fe=P.INTERNAL_FILE_DATA_TRANSFER_TYPE,Ze=D.shallowCompareStateAndProps,N.Modal,Ge=C.createSelectableList,Ve=C.createSelection,Fe=I.ReactLogger,he=R.GoldenGate,$e=M.static_url,Z=O.AccessibleAnnounce,Ue=L._,Re=H.TileItem,Ae=H.TileItemLabelText,ge=H.InfiniteTileGrid,Me=q.TileItemLabelInput,ne=j.Checkbox,ie=j.CheckboxState,oe=z.BrowseTileHeader,Oe=z.ToggleViewTypeButton,Ce=K.StickyContainer,Ne=Y.Sticky,He=i.DOM,Be=i.createElement,_e="ItemList",X="undefined"!=typeof window&&null!==window?e(window):null,J="undefined"!=typeof document&&null!==document?e(document.documentElement):null,me=s.Record({numThresholdRows:10,labelHeight:40,tileHeight:160,maxTileWidth:160,tilePadding:16,scrollDeltaThreshold:1}),qe=s.Set(["ai","au","fl","key","numbers","pages","pkg","pr","psd","sketch","txt","md"]),ke=s.Set(["acrobat","code","compressed","excel","film","gear","picture","powerpoint","sound","word"]),We=s.Set(["folder","folder_app","folder_camera","folder_team","folder_team_locked","folder_user","folder_user_locked"]),Se=Ge(i.createClass({displayName:"ItemList",propTypes:{user:i.PropTypes.object.isRequired,context:i.PropTypes.instanceOf($).isRequired,path:i.PropTypes.string.isRequired,rowHeight:i.PropTypes.number,isMaestroDesign:i.PropTypes.bool,selectedFiles:i.PropTypes.instanceOf(s.OrderedMap),isBrowseInContentManager:i.PropTypes.bool,isRenaming:i.PropTypes.bool,itemListLength:i.PropTypes.number,openContextMenuAtPosition:i.PropTypes.func,setFileUploaderPath:i.PropTypes.func,onFocus:i.PropTypes.func,focusSelectedItem:i.PropTypes.func,isDraggingExternalFiles:i.PropTypes.bool,isDraggingInternalFiles:i.PropTypes.bool,className:i.PropTypes.string,actionHandlers:i.PropTypes.object,selectAll:i.PropTypes.func,deselectAll:i.PropTypes.func,viewType:i.PropTypes.oneOf(l.values(Le)),maestroGridViewVariant:i.PropTypes.string,maestroListViewFullRowSelect:i.PropTypes.bool},getDefaultProps:function(){return{rowHeight:ue.ITEM_ROW_HEIGHT_PX,isMaestroDesign:!1,selectedFiles:s.OrderedMap(),isDraggingExternalFiles:!1,isDraggingInternalFiles:!1,activeDropTarget:!1,isRenaming:!1,onFocus:function(){return{}},setFileUploaderPath:function(){return{}},isBrowseInContentManager:!1,className:null,actionHandlers:{},viewType:Le.List}},componentWillMount:function(){return Fe.start(this.constructor.displayName),this.isFocused=!1},componentDidMount:function(){return this._setupFocusHandler(),this._setupExternalDragHandler(),this._setupKeyboardShortcuts(),Fe.end(this.constructor.displayName)},componentWillUnmount:function(){return Ye(_e),e(a.findDOMNode(this)).off(".ItemList")},_setupFocusHandler:function(){var t;return t=e(a.findDOMNode(this)),t.on("focusin.ItemList",(function(e){return function(){return e.isFocused=!0,e.props.onFocus(),!0}})(this)),t.on("focusout.ItemList",(function(e){return function(){return e.isFocused=!1,!0}})(this))},getFocusHandler:function(e){return(function(t){return function(){return t.isFocused=e,!0}})(this)},_setupExternalDragHandler:function(){var e,t,r,o,s;return o=(function(e){return function(){return e.props.isDraggingInternalFiles}})(this),r=(function(e){return function(){return e.props.isDraggingExternalFiles}})(this),s=(function(e){return function(){return e.props.setFileUploaderPath({path:e.props.path,hasPermissionToUploadToFolder:e.props.context.isCurrentPathWriteable()})}})(this),e=".browse-file-row",t=(function(e){return function(){return e.props.activeDropTarget}})(this),Qe(_e,o,r,s,e,t)},_setupKeyboardShortcuts:function(){var e,t,r,o,s,n;return t=je(this),r=(function(e){return function(t){return e.isFocused&&"BUTTON"!==t.target.tagName}})(this),s=(function(e){return function(){return e.props.selectedFiles}})(this),e=(function(e){return function(){return e.props.focusSelectedItem}})(this),n=(function(e){return function(){return e.props.context.isCurrentPathWriteable()}})(this),o=(function(e){return function(){return e.props.isMaestroDesign}})(this),Xe(t,r,s,e,n,o,this.props.selectAll,this.props.deselectAll,this.props.actionHandlers.onDelete,this.props.openContextMenuAtPosition,_e)},render:function(){var e;return e=t(this.props.className,{"browse-files o-list-ui":!this.props.isBrowseInContentManager,"browse-files__content-manager":this.props.isBrowseInContentManager,"browse-files--single-selection":1===this.props.selectedFiles.size&&!this.props.maestroListViewFullRowSelect}),He.div({className:"browse-files-wrapper"},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER?He.ul({className:e,role:"presentation"},this.props.children):He.ul({className:e,role:"presentation",style:{display:"block",position:"relative",height:this.props.itemListLength*this.props.rowHeight}},this.props.children))}})),Te=i.createClass({displayName:"ItemListController",gridViewPrewarmedThumbnailRequestIds:[],propTypes:{context:i.PropTypes.instanceOf($).isRequired,items:i.PropTypes.instanceOf(s.List).isRequired,user:i.PropTypes.object.isRequired,path:i.PropTypes.string.isRequired,isMaestroDesign:i.PropTypes.bool,isSearchMode:i.PropTypes.bool,selection:i.PropTypes.shape({selected:i.PropTypes.instanceOf(s.OrderedSet),anchor:i.PropTypes.string}),selectedFiles:i.PropTypes.instanceOf(s.OrderedMap),createNewFolderState:i.PropTypes.oneOf(l.values(ye)),customEmptyFolderView:i.PropTypes.func,dropTargetHighlightMode:i.PropTypes.oneOf((function(){var e;e=[];for(ze in ce)et=ce[ze],e.push(et);return e})()),fileRename:i.PropTypes.shape({file:i.PropTypes.instanceOf(pe),state:i.PropTypes.oneOf(l.values(Pe))}),isArchiveState:i.PropTypes.bool,isBrowseInContentManager:i.PropTypes.bool,isTextSelectable:i.PropTypes.bool,loadingState:i.PropTypes.oneOf(l.values(we)),mostRecentlyDraggedOverFile:i.PropTypes.instanceOf(pe),openContextMenuAtPosition:i.PropTypes.func,isDraggingExternalFiles:i.PropTypes.bool,isDraggingInternalFiles:i.PropTypes.bool,activeDropTarget:i.PropTypes.object,onSelectionChange:i.PropTypes.func,showFilenameHighlights:i.PropTypes.bool,disableColumnDetail:i.PropTypes.bool,enableDoubleClickTraversal:i.PropTypes.bool,onFocus:i.PropTypes.func,setFileUploaderPath:i.PropTypes.func,onCreateTeamFolder:i.PropTypes.func,enableDataMigrationTool:i.PropTypes.bool,onShowDataMigrationToolModal:i.PropTypes.func,settingsGearMenuAlt:i.PropTypes.string,settingsGearMenuItems:i.PropTypes.arrayOf(i.PropTypes.shape({label:i.PropTypes.string,action:i.PropTypes.func})),activeSortField:i.PropTypes.oneOf(l.values(te)),activeSortDirection:i.PropTypes.oneOf(l.values(De)),onSortChange:i.PropTypes.func,initialMultiColumnSortField:i.PropTypes.string,actionHandlers:i.PropTypes.object,handleComponentTTI:i.PropTypes.func,showFileUploaderModal:i.PropTypes.func,isFileViewerShown:i.PropTypes.func,isSharedWithLoaded:i.PropTypes.bool,isStarredLoaded:i.PropTypes.bool,expBizTeamFolderOnboardingVariant:i.PropTypes.string,viewType:i.PropTypes.oneOf(l.values(Le)),isMaestroDesignAndMcl:i.PropTypes.bool,maestroGridViewVariant:i.PropTypes.string,maestroListViewFullRowSelect:i.PropTypes.bool,maestroGridViewPrewarmVariant:i.PropTypes.string,gridViewOptions:i.PropTypes.instanceOf(me),totalNumItems:i.PropTypes.number,onSwitchViewType:i.PropTypes.func,showOverflowActions:i.PropTypes.bool,isSubgrowthPinnedExp:i.PropTypes.bool,numTeamFolders:i.PropTypes.number},getDefaultProps:function(){return{isMaestroDesign:!1,isSearchMode:!1,selection:Ve(),selectedFiles:s.OrderedMap(),createNewFolderState:ye.CREATE_FOLDER_INACTIVE,customEmptyFolderView:null,showFileUploaderModal:function(){},dropTargetHighlightMode:ce.NONE,fileRename:null,isArchiveState:!1,isColumnHeaderVisible:!0,isMultiColumnGroupVisible:!0,isBrowseInContentManager:!1,isPaginating:!1,isTextSelectable:!0,mostRecentlyDraggedOverFile:null,shouldHighlightDropTargets:!1,showFilenameHighlights:!1,disableColumnDetails:!1,enableDoubleClickTraversal:!0,isDraggingExternalFiles:!1,isDraggingInternalFiles:!1,onFocus:function(){},setFileUploaderPath:function(){},activeSortField:null,activeSortDirection:null,onSortChange:function(){},isFileViewerShown:function(){return!1},initialMultiColumnSortField:null,handleComponentTTI:function(){},viewType:Le.List,maestroGridViewVariant:"OFF",maestroListViewFullRowSelect:!1,maestroGridViewPrewarmVariant:"OFF",gridViewOptions:new me,totalNumItems:0,onSwitchViewType:function(){},showOverflowActions:!0,isSubgrowthPinnedExp:!1,numTeamFolders:0}},getInitialState:function(){var e;return{activeMultiColumnField:this.props.initialMultiColumnSortField,viewportHeight:("undefined"!=typeof document&&null!==document&&null!=(e=document.documentElement)?e.clientHeight:void 0)||0,rowHeight:this.getRowHeight(this.props),scrollPosition:0,lastSelectedItemIndex:-1,arrowingDown:!1,promptBannerIsVisible:!1}},componentWillMount:function(){return Fe.start(this.constructor.displayName)},componentDidMount:function(){return window.addEventListener("scroll",this.updateOnScroll),window.addEventListener("resize",this.updateOnResize),this.props.selection.selected.size&&!this.props.isFileViewerShown()&&this.scrollItemRowsIntoView(),this.props.viewType===Le.List&&this.props.loadingState!==we.LOADING_FIRST_PAGE&&this.props.handleComponentTTI(this.constructor.displayName),this.props.isSubgrowthPinnedExp&&document.querySelector(".has-top-notification")&&this.setState({promptBannerIsVisible:!0}),Q(["modules/clean/unity_browse_interface"],(function(e){return function(t){return e.triggerUnityChangeCallback=function(){return t.browse_visible_change_callback(e.props.items.toArray(),e.props.user.id,0,e.props.items.size-1)}}})(this)),this._maybePrewarmGalleryViewThumbStore(),Fe.end(this.constructor.displayName)},componentWillUnmount:function(){return window.removeEventListener("scroll",this.updateOnScroll),window.removeEventListener("resize",this.updateOnResize),this.triggerUnityChangeCallback=void 0},shouldComponentUpdate:Ze,componentDidUpdate:function(e){var t,r,o,s,n;if(this.props.loadingState!==we.LOADING_FIRST_PAGE&&this.props.handleComponentTTI(this.constructor.displayName),e.items!==this.props.items&&"function"==typeof this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback(),e.viewType!==this.props.viewType&&this.updateOnScroll(),t=this.props.selection.selected.subtract(e.selection.selected),!t.size||this.props.isFileViewerShown()||this.allSelected()?this.props.isFileViewerShown()||this.props.createNewFolderState===e.createNewFolderState||this.props.createNewFolderState===ye.CREATE_FOLDER_INACTIVE||X.scrollTop(0):this.scrollItemRowsIntoView(),e.loadingState!==this.props.loadingState&&this.props.loadingState===we.LOADED&&Z.polite(Ue("Finished loading files")),e.viewType!==this.props.viewType&&(n=this.props.viewType===Le.List?this.refs.toggleViewTypeButton:null!=(r=this.refs.browseTileGrid)&&null!=(o=r.refs.tileGridHeader)?o.refs.toggleViewTypeButton:void 0,null!=n&&null!=(s=n.refs.button)&&s.focus()),e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath)return this._maybePrewarmGalleryViewThumbStore()},componentWillReceiveProps:function(e){var t,r,o,s,n,i;return null!=(null!=(i=e.selection)?i.selected:void 0)?(s=this.props.selection.selected.last(),n=this.getIndexOfItem(s),t=e.selection.selected.last(),r=this.getIndexOfItem(t,e.items),o={lastSelectedItemIndex:r,arrowingDown:!1},r-n===1&&(o.arrowingDown=!0),this.setState(o)):this.setState({lastSelectedItemIndex:-1}),this.setState({rowHeight:this.getRowHeight(e)})},_maybePrewarmGalleryViewThumbStore:function(){var e;if(this.props.viewType===Le.List&&("ON"===(e=this.props.maestroGridViewVariant)||"GALLERY"===e||"GALLERY_PERSIST"===e)&&"ON"===this.props.maestroGridViewPrewarmVariant)return this._undoPrewarmGalleryViewThumbStore(),Q(["modules/clean/web_timing_logger","modules/clean/photos/thumb_loading/generic_thumb_store"],(function(e){return function(t,r){return t.waitForTTI().then(function(){return e.thumbStore=new r,e.props.items.slice(0,100).forEach(function(t){var r,o;if(o=re.getGridViewThumbnailUrl(t),null!=o)return r=e.thumbStore.bind_url(o,{onSuccess:function(){}}),e.gridViewPrewarmedThumbnailRequestIds.push(r)})})}})(this))},_undoPrewarmGalleryViewThumbStore:function(){if(this.thumbStore&&this.gridViewPrewarmedThumbnailRequestIds.length>0)return this.gridViewPrewarmedThumbnailRequestIds.forEach((function(e){return function(t){return e.thumbStore.unbind_url(t)}})(this)),this.gridViewPrewarmedThumbnailRequestIds=[]},focusSelectedItem:function(){var t,r,o;if(r=this.props.selectedFiles.first(),r&&(o=this.getIndexOfItem(r.fq_path),t=this.props.viewType===Le.Grid?e(a.findDOMNode(this)).find(".file-tile-grid-container .tile__preview:eq("+o+")"):e(a.findDOMNode(this)).find(".browse-files .browse-file-row:eq("+o+")"),!t.is(":focus")))return t.focus()},getRowHeight:function(e){var t;return t=ue.ITEM_ROW_HEIGHT_PX,e.isMaestroDesign?t=e.isSearchMode?ue.MAESTRO_SEARCH_ROW_HEIGHT_PX:ue.MAESTRO_ITEM_ROW_HEIGHT_PX:e.isSearchMode&&(t=ue.SEARCH_ROW_HEIGHT_PX),t},getIndexOfItem:function(e,t){return null==t&&(t=this.props.items),t.findIndex(function(t){return t instanceof pe?p.paths_are_equal(t.fq_path,e):t instanceof Ee?t.pad_id===e:void 0})},scrollItemRowsIntoView:function(){var t,r,o,s,n,i,a,l,u;if(s=this.state.lastSelectedItemIndex,o=1,s>=0){if(r="fixed"===e(".browse-header").css("position"),u=r?parseInt(e(".browse-files").css("marginTop"))||ue.DEFAULT_HEADER_HEIGHT_PX:0,this.isGridView())return void(null!=(l=this.refs.tileGrid)&&l.scrollTileIntoView(this.state.viewportHeight,this.state.lastSelectedItemIndex));if(t=this.state.viewportHeight-u-this.state.rowHeight-o,n=s*this.state.rowHeight-o,a=this.state.scrollPosition,i=this.state.scrollPosition+t,a<=n&&n<=i)return;return n<a?X.scrollTop(n):this.state.arrowingDown?X.scrollTop(n-t+o):X.scrollTop(n-Math.round(t/2)+o)}},getSharedWithTitle:function(){return Ue(he.hasAudienceBox(this.props.user.id)||he.hasNewMembershipUI(this.props.user.id)?"Members":this.props.context.isInsideSharedFolder?"Additional sharing":"Shared with")},isGridView:function(){return this.props.viewType===Le.Grid},anySelected:function(){return this.props.selectedFiles.size>0},allSelected:function(){return this.props.selectedFiles.size===this.props.items.size},selectNone:function(){return this.props.onSelectionChange(this.props.selection.set("selected",s.OrderedSet([])))},selectAll:function(){var e;return this.props.onSelectionChange(this.props.selection.set("selected",s.OrderedSet(function(){var t,r,o,s;for(o=this.props.items.toArray(),s=[],t=0,r=o.length;t<r;t++)e=o[t],s.push(e.fq_path);return s}.call(this))))},_toggleSelectAll:function(){return this.anySelected()?this.selectNone():this.selectAll(),event.target.focus()},_getCheckboxState:function(){var e,t,r;return t=this.anySelected(),e=this.allSelected(),r=ie.Unchecked,t&&(r=ie.PartiallyChecked),e&&(r=ie.Checked),r},_getColumns:function(){var e,t,r;return e=[{type:le.SINGLE,label:Ue("Name"),headerClassName:"o-grid__col o-grid__col--6-of-12",sortField:te.FILENAME},{type:le.SINGLE,label:Ue("Modified"),headerClassName:"o-grid__col o-grid__col--3-of-12",sortField:te.MODIFIED},{type:le.MULTI,columns:[{label:this.getSharedWithTitle(),headerClassName:"o-grid__col o-grid__col--3-of-12",sortField:te.SHARED_WITH},{label:Ue("Type"),headerClassName:"o-grid__col o-grid__col--3-of-12",sortField:te.CATEGORY},{label:Ue("Extension"),headerClassName:"o-grid__col o-grid__col--3-of-12",sortField:te.EXTENSION},{label:Ue("Size"),headerClassName:"o-grid__col o-grid__col--3-of-12",sortField:te.SIZE}]},{type:le.STATIC,label:Ue("Actions"),headerClassName:"ax-visually-hidden"}],this.props.isMaestroDesign?(e.unshift({type:le.STATIC,content:this.renderSelectToggleCheckbox(),headerClassName:"select-all-checkbox",labelClassName:"ax-visually-hidden",label:Ue("Select All Checkboxes"),role:"gridcell"}),"ON"!==(t=this.props.maestroGridViewVariant)&&"GALLERY"!==t&&"GALLERY_PERSIST"!==t||(r=Be(Oe,{onSwitchViewType:this.props.onSwitchViewType,currentViewType:this.props.viewType,ref:"toggleViewTypeButton"}),e.push({type:le.STATIC,content:r,headerClassName:"toggle-view-type--list-view",labelClassName:"ax-visually-hidden",label:Ue("Toggle View Type")}))):e.unshift({type:le.STATIC,label:Ue("Row selection"),headerClassName:"ax-visually-hidden"}),e},handleDragStart:function(e,t,r){var o,s,n,i,u;return null==t&&(t=[]),null==r&&(r=!0),r?(i=l.indexBy(t,"fq_path"),Object.assign(i,this.props.selectedFiles.toJS()),u=l.values(i)):u=t,he.canDeepNest(this.props.user.id)&&u.some(function(e){return pe.isTeamSharedFolder(e)})?void U.error(Ue("Team folders can’t be moved.")):u.some(function(e){return pe.isTeamMemberFolder(e)})?void U.error(Ue("Your member folder can’t be moved.")):(s={userId:this.props.user.id,fromPath:this.props.path,filePaths:(function(){var e,t,r;for(r=[],e=0,t=u.length;e<t;e++)n=u[e],r.push(n.fq_path);return r})()},null!=e.dataTransfer?("function"==typeof(o=e.dataTransfer).setDragImage&&o.setDragImage(a.findDOMNode(this.refs.dragIcon),-10,-10),e.dataTransfer.setData(fe,JSON.stringify(s)),e.dataTransfer.effectAllowed="copyMove"):void 0)},createOnDragEnterHandlerForFile:function(e,t,r){return(function(o){return function(){return Ke(e,o.props.isDraggingExternalFiles,o.props.isDraggingInternalFiles,t,r,o.props.context,o.props.setFileUploaderPath)}})(this)},_handleGridTTI:function(){return this.props.handleComponentTTI(this.constructor.displayName)},_renderPaperRow:function(e,t,r){var o;return o=this.state.rowHeight*t,Be(B.PaperItemRow,{paper:e,user:this.props.user,key:e.pad_id,topOffsetPx:o,rowIndex:t,totalRowCount:r,showTitleHighlights:!0,isMaestroDesign:this.props.isMaestroDesign,isSearchMode:this.props.isSearchMode})},_renderFileRow:function(e,t,r){var o,s,n,i,a,l,u,c;return n=this.props.selection.selected.has(e.fq_path),o=de.shouldFileBeHighlightedDropTarget({file:e,isSelected:n,dropTargetHighlightMode:this.props.dropTargetHighlightMode}),s=e===this.props.activeDropTarget,p.paths_are_equal(null!=(a=this.props.fileRename)?a.file.fq_path:void 0,e.fq_path)&&(l=this.props.fileRename.state),i=this.props.selection.selected.last()===e.fq_path||!this.props.selection.selected.size&&0===t,c=this.state.rowHeight*t,u=this.props.context.isNonUserRelativeContext&&e.isDeleted?null:this.props.settingsGearMenuItems,Be(B.FileItemRow,{selectableListId:e.fq_path,key:encodeURI(e.fq_path)+":"+t,file:e,user:this.props.user,isTabbable:i,enableDoubleClickTraversal:this.props.enableDoubleClickTraversal,isMaestroDesignAndMcl:this.props.isMaestroDesignAndMcl,isMaestroDesign:this.props.isMaestroDesign,isSearchMode:this.props.isSearchMode,topOffsetPx:c,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isAvailableDropTarget:o,isActiveDropTarget:s,isArchiveState:this.props.isArchiveState,isModifiedColumnVisible:this.props.isModifiedColumnVisible,isMultiColumnGroupVisible:this.props.isMultiColumnGroupVisible,isTextSelectable:this.props.isTextSelectable,context:this.props.context,renameState:l,loadingState:this.props.loadingState,rowIndex:t,totalRowCount:r,settingsGearMenuAlt:this.props.settingsGearMenuAlt,settingsGearMenuItems:u,showColumnDetail:!this.props.isColumnHeaderVisible&&!this.props.disableColumnDetails,showFilenameHighlights:this.props.showFilenameHighlights,maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,inSelectMode:this.props.selectedFiles.count()>0,selectedFilesCount:this.props.selectedFiles.count(),setFileUploaderPath:this.props.setFileUploaderPath,onDragStart:this.handleDragStart,onFileDragEnterItem:this.createOnDragEnterHandlerForFile(e,n,s),actionHandlers:this.props.actionHandlers,contextFileActionHandlers:this.props.contextFileActionHandlers,isSharedWithLoaded:this.props.isSharedWithLoaded,isStarredLoaded:this.props.isStarredLoaded,showOverflowActions:this.props.showOverflowActions})},_renderLoadingIndicator:function(e,r){var o,s;return o=["u-font-center item-list-loading-indicator-wrapper",{"u-pad-top-m":!this.props.isMaestroDesign},{"item-list-loading-indicator-wrapper--grid":this.props.viewType===Le.Grid}],s={className:t(o),key:"loadingIndicator"},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||(s.style={position:"absolute",top:r*this.state.rowHeight||0,width:"100%"}),He.li(s,Be(u,{style:u.LoadingIndicatorStyle.BLUE_SPINNER,startMessage:e}))},_renderEmptyFolder:function(){var e;return e=this.props.context.isInsideAutoTeamFolder&&1===this.props.path.match(/\//g).length,Be(b,{key:"emptyFolderPlaceholder",currentSharedFolderPermissionRole:this.props.context.currentSharedFolderPermissionRole,onCreateTeamFolder:this.props.onCreateTeamFolder,enableDataMigrationTool:this.props.enableDataMigrationTool,onShowDataMigrationToolModal:this.props.onShowDataMigrationToolModal,isArchiveState:this.props.isArchiveState&&!this.props.context.isInsideArchivedTeamFolder,isBrowseInContentManager:this.props.isBrowseInContentManager,isInsideSharedFolder:this.props.context.isInsideSharedFolder,isViewingTeamFolder:e,userId:this.props.user.id,userFamiliarName:this.props.user.familiar_name,showFileUploaderMpdal:this.props.showFileUploaderModal,expBizTeamFolderOnboardingVariant:this.props.expBizTeamFolderOnboardingVariant})},_getPerformanceHackColumnClassName:function(){switch(this.state.activeMultiColumnField){case te.SHARED_WITH:return"is-sharedwith-column-visible";case te.CATEGORY:return"is-type-column-visible";case te.EXTENSION:return"is-extension-column-visible";case te.SIZE:return"is-size-column-visible"}},_renderItemGrid:function(e){var t;return t=this.props.activeSortField,t===te.SHARED_WITH&&(t=te.FILENAME),Be(re,{key:"browseTileGrid",ref:"browseTileGrid",isCreateFolderUIActive:e,context:this.props.context,items:this.props.items,user:this.props.user,isSearchMode:this.props.isSearchMode,selection:this.props.selection,selectedFiles:this.props.selectedFiles,createNewFolderState:this.props.createNewFolderState,actionHandlers:this.props.actionHandlers,focusSelectedItem:this.focusSelectedItem,selectAll:this.selectAll,deselectAll:this.selectNone,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isDraggingExternalFiles:this.props.isDraggingExternalFiles,setFileUploaderPath:this.props.setFileUploaderPath,path:this.props.path,activeDropTarget:this.props.activeDropTarget,createOnDragEnterHandlerForFile:this.createOnDragEnterHandlerForFile,handleDragStart:this.handleDragStart,contextFileActionHandlers:this.props.contextFileActionHandlers,fileRename:this.props.fileRename,onSelectionChange:this.props.onSelectionChange,onSwitchViewType:this.props.onSwitchViewType,onSortChange:this.props.onSortChange,activeSortField:t,activeSortDirection:this.props.activeSortDirection,gridViewOptions:this.props.gridViewOptions,totalNumItems:this.props.totalNumItems,currentViewType:this.props.viewType,handleTTI:this._handleGridTTI,isMaestroDesignAndMcl:this.props.isMaestroDesignAndMcl,thumbStore:this.thumbStore})},_renderItemList:function(e){var t,r,o;return r=this.props.items.toArray(),o=0,e&&(o+=1),this.props.loadingState===we.LOADING_REMAINING_PAGES&&(o+=1),t=this.props.loadingState===we.LOADING_FIRST_PAGE?0:r.length+o,Be(Se,{key:"itemList",ref:"itemList",allItemIds:this.props.items.map(function(e){return e.fq_path}),user:this.props.user,path:this.props.path,context:this.props.context,rowHeight:this.state.rowHeight,isMaestroDesign:this.props.isMaestroDesign,selectedFiles:this.props.selectedFiles,isBrowseInContentManager:this.props.isBrowseInContentManager,isRenaming:!!this.props.fileRename,openContextMenuAtPosition:this.props.openContextMenuAtPosition,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,itemListLength:t,activeDropTarget:this.props.activeDropTarget,keyScope:_e,linkedOutsideClasses:[".bubble-menu-item-wrapper",".browse-menu",".context-menu",".react-file-viewer",".db-modal"],selection:this.props.selection,setFileUploaderPath:this.props.setFileUploaderPath,onFocus:this.props.onFocus,onSelectionChange:this.props.onSelectionChange,focusSelectedItem:this.focusSelectedItem,className:this._getPerformanceHackColumnClassName(),actionHandlers:this.props.actionHandlers,isCheckboxes:this.props.isMaestroDesign,selectAll:this.selectAll,deselectAll:this.selectNone},this._renderItemRows(r,e))},_renderCreateFolderUI:function(){return Be(G,{newFolderState:this.props.createNewFolderState,context:this.props.context,user:this.props.user,topOffsetPx:0,isMaestroDesign:this.props.isMaestroDesign})},_expGetPinnedFolderHeight:function(){var e;return e=92,this.state.rowHeight*this.props.numTeamFolders+e},_renderItemRows:function(e,t){var r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D,N,C,I,R;if(P=[],F=(function(e){return function(t,r,o){return t instanceof pe?P.push(e._renderFileRow(t,r,o)):t instanceof Ee?P.push(e._renderPaperRow(t,r,o)):void 0}})(this),"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER){for(a=i=0,h=e.length;i<h;a=++i)l=e[a],F(l,a+1,e.length);return this.props.loadingState===we.LOADING_REMAINING_PAGES&&P.push(this._renderLoadingIndicator(Ue("Loading files…"),e.length)),P}for(w=0,T=0,t&&(w=1),this.props.loadingState===we.LOADING_REMAINING_PAGES&&(T=1),E=e.length,R=E+w+T,b=Math.ceil(this.state.viewportHeight/this.state.rowHeight)+2*ue.ITEM_BUFFER_SIZE,y=Math.min(R,b),s=this.props.isSubgrowthPinnedExp?this._expGetPinnedFolderHeight():0,I=Math.max(0,this.state.scrollPosition-ue.ITEM_BUFFER_SIZE*this.state.rowHeight-s),C=Math.min(Math.floor(I/this.state.rowHeight),R-y),o=Math.min(C+y-1,R-1),r=e.slice(C,+o+1||9e9),d=this.state.lastSelectedItemIndex,u=[],c=[],d>=0&&(d<C?(n=Math.max(0,d-1),p=Math.min(d+1,C-1),u=function(){D=[];for(var e=n;n<=p?e<=p:e>=p;n<=p?e++:e--)D.push(e);return D}.apply(this)):d>o&&(n=Math.max(o+1,d-1),p=Math.min(d+1,E-1),c=function(){N=[];for(var e=n;n<=p?e<=p:e>=p;n<=p?e++:e--)N.push(e);return N}.apply(this))),g=0,m=u.length;g<m;g++)a=u[g],l=e[a],F(l,a+w,R);for(S=0,f=r.length;S<f;S++)l=r[S],F(l,C+w,R),C+=1;for(p=C,v=0,_=c.length;v<_;v++)a=c[v],l=e[a],F(l,a+w,R);return t&&P.unshift(this._renderCreateFolderUI()),this.props.loadingState===we.LOADING_REMAINING_PAGES&&P.push(this._renderLoadingIndicator(Ue("Loading files…"),p)),P},updateOnResize:function(){var e;if(e=document.documentElement.clientHeight,this.state.viewportHeight!==e)return this.setState({viewportHeight:e})},updateOnScroll:function(){var e;if(this.props.viewType!==Le.Grid&&(e=X.scrollTop(),0!==e||"fixed"!==J.css("position")))return null!=e&&this.state.scrollPosition!==e?this.setState({scrollPosition:e}):void 0},handleMultiColumnChange:function(e){return this.setState({activeMultiColumnField:e.sortField})},renderSelectToggleCheckbox:function(){var e;return e=this._getCheckboxState(),He.div({className:t({"file-select-checkbox":!0,"file-select-checkbox--gridview":this.isGridView(),"show-boxes":this.anySelected()}),key:"selection_toggle_column"},Be(xe,{},Be(ne,{ariaLabel:Ue("Select all"),checkboxState:e,onClick:this._toggleSelectAll})))},renderColumnHeaderContent:function(){var e;return e=["browse-file-list-header o-grid o-grid--no-gutter",{"ax-visually-hidden":!this.props.isMaestroDesign&&this.props.selection.selected.size||this.props.isMaestroDesign&&!this.props.items.size}],this.props.isSubgrowthPinnedExp&&e.push("exp-pinned-sticky__header"),Be(ae,{columns:this._getColumns(),className:t(e),tabbable:!!this.props.isMaestroDesign||!this.props.selection.selected.size,disabled:this.props.loadingState!==we.LOADED,activeSortField:this.props.activeSortField,initialMultiColumnSortField:this.state.activeMultiColumnField,activeSortDirection:this.props.activeSortDirection,onSortChange:this.props.onSortChange,onMultiColumnChange:this.handleMultiColumnChange,isMaestroDesign:this.props.isMaestroDesign})},renderColumnHeader:function(){return this.props.isSubgrowthPinnedExp?Be(Ne,{offsetHeight:40,className:"exp-pinned-sticky"},this.renderColumnHeaderContent()):this.props.isMaestroDesign?this.props.viewType===Le.List?He.div({key:"columnHeaderShadow",className:"browse-file-list-header__shadow"},Be(xe,{},this.renderColumnHeaderContent())):this.props.loadingState!==we.LOADING_FIRST_PAGE?this.renderSelectToggleCheckbox():void 0:this.renderColumnHeaderContent()},render:function(){var e,r,o,s,n;return r=this.props.createNewFolderState!==ye.CREATE_FOLDER_INACTIVE,o=this.props.loadingState===we.LOADED&&!this.props.items.count()&&!r,n=[],!this.props.isColumnHeaderVisible||o&&this.props.isMaestroDesign||n.push(this.renderColumnHeader()),o?n.push(("function"==typeof(e=this.props).customEmptyFolderView?e.customEmptyFolderView():void 0)||this._renderEmptyFolder()):this.props.loadingState===we.LOADING_FIRST_PAGE?n.push(He.ul({key:"loadingIndicatorContainer",className:t("browse-files o-list-ui")},this._renderLoadingIndicator(Ue("Loading files…")))):this.props.viewType===Le.List?n.push(this._renderItemList(r)):this.props.viewType===Le.Grid&&n.push(this._renderItemGrid(r)),n.push(He.div({key:"dragIcon",ref:"dragIcon",className:"offscreen-drag-icon"},this.props.selectedFiles.count()?Be(be,{files:this.props.selectedFiles.toArray()}):void 0)),this.props.isSubgrowthPinnedExp?(s=96,this.state.promptBannerIsVisible&&(s+=48),He.div({role:"grid","aria-readonly":"true"},Be(Ce,{offsetTop:s,useNativeSticky:!0},n))):He.div({role:"grid","aria-readonly":"true"},n)}}),Ie="BrowseTileGrid",re=i.createClass({displayName:"BrowseTileGrid",propTypes:{items:i.PropTypes.instanceOf(s.List).isRequired,context:i.PropTypes.instanceOf($).isRequired,
isCreateFolderUIActive:i.PropTypes.bool,user:i.PropTypes.object.isRequired,isSearchMode:i.PropTypes.bool,selectedFiles:i.PropTypes.instanceOf(s.OrderedMap),selection:i.PropTypes.shape({selected:i.PropTypes.instanceOf(s.OrderedSet),anchor:i.PropTypes.string}),createNewFolderState:i.PropTypes.oneOf(l.values(ye)),actionHandlers:i.PropTypes.object,focusSelectedItem:i.PropTypes.func,selectAll:i.PropTypes.func,deselectAll:i.PropTypes.func,isDraggingInternalFiles:i.PropTypes.bool,isDraggingExternalFiles:i.PropTypes.bool,setFileUploaderPath:i.PropTypes.func,path:i.PropTypes.string,activeDropTarget:i.PropTypes.object,createOnDragEnterHandlerForFile:i.PropTypes.func,handleDragStart:i.PropTypes.func,contextFileActionHandlers:i.PropTypes.object,fileRename:i.PropTypes.object,onSelectionChange:i.PropTypes.func,onSortChange:i.PropTypes.func,activeSortField:i.PropTypes.oneOf(l.values(te)),activeSortDirection:i.PropTypes.oneOf(l.values(De)),gridViewOptions:i.PropTypes.instanceOf(me),totalNumItems:i.PropTypes.number,handleTTI:i.PropTypes.func,isMaestroDesignAndMcl:i.PropTypes.bool,thumbStore:i.PropTypes.object},getInitialState:function(){return{sectionLabels:s.List([]),sectionStartIndices:s.List([]),selectedIds:s.Set([])}},_getTimeBands:function(){var e,t,r,o,s,n,i,a,l,u,c;return t=Date.now(),r=864e5,c=new Date(t),c.setHours(0,0,0,0),l=c.getTime(),u=l-r,e=new Date(t),0===c.getDay()?e.setDate(c.getDate()-7):e.setDate(c.getDate()-c.getDay()-1),e.setHours(0),a=e.getTime(),n=a-7*r,c.setDate(1),i=c.getTime(),c.setMonth(c.getMonth()-1),o=c.getTime(),c.setMonth(c.getMonth()-3),s=c.getTime(),{today:l,yesterday:u,thisWeek:a,lastWeek:n,thisMonth:i,lastMonth:o,lastThreeMonths:s}},_getTileItems:function(e){var t,r;return r=e.items.count(),t=e.totalNumItems-r,t>0&&(r+=t),e.isCreateFolderUIActive&&(r+=1),s.List([]).setSize(r)},_setTileItemsSections:function(e){var t,r,o,n,i;return o=s.List([]),n=s.List([]),t=null,e.activeSortField===te.CATEGORY?e.items.forEach(function(e,r){var s;if(s=pe.getCategoryDescription(e,!0),s!==t)return o=o.push(s),n=n.push(r),t=s}):e.activeSortField===te.EXTENSION?e.items.forEach(function(e,r){var s,i;if(s=pe.getExtension(e).toUpperCase(),s!==t)return i=s,""===s&&(i=Ue("EXTENSIONLESS",{comment:"Label for files without extensions like .txt or .png"})),o=o.push(i),n=n.push(r),t=s}):e.activeSortField===te.MODIFIED&&(e.activeSortDirection===De.DESCENDING?(i=this._getTimeBands(),e.items.forEach(function(e,r){var s,a;if(s=1e3*e.ts,a=Ue(s>=i.today?"TODAY":s>=i.yesterday?"YESTERDAY":s>=i.thisWeek?"THIS WEEK":s>=i.lastWeek?"LAST WEEK":s>=i.thisMonth?"THIS MONTH":s>=i.lastMonth?"LAST MONTH":s>=i.lastThreeMonths?"THREE MONTHS AGO":"OLDER"),a!==t)return o=o.push(a),n=n.push(r),t=a})):e.activeSortDirection===De.ASCENDING&&(r=[Ue("JANUARY",{comment:"the month"}),Ue("FEBRUARY",{comment:"the month"}),Ue("MARCH",{comment:"the month"}),Ue("APRIL",{comment:"the month"}),Ue("MAY",{comment:"the month"}),Ue("JUNE",{comment:"the month"}),Ue("JULY",{comment:"the month"}),Ue("AUGUST",{comment:"the month"}),Ue("SEPTEMBER",{comment:"the month"}),Ue("OCTOBER",{comment:"the month"}),Ue("NOVEMBER",{comment:"the month"}),Ue("DECEMBER",{comment:"the month"})],e.items.forEach(function(e,s){var i,a,l,u;if(e.ts?(i=new Date(1e3*e.ts),a=r[i.getMonth()],l=i.getFullYear(),u=a+" "+l):u=Ue("MISSING DATES",{comment:"label for group of files without dates marking when they are created or modified"}),u!==t)return o=o.push(u),n=n.push(s),t=u}))),this.setState({sectionLabels:o,sectionStartIndices:n})},_createToggleSelectHandler:function(e){var t;return t=e.fq_path,(function(e){return function(){var r;return r=e.props.selection,e.setState({isSelecting:!0}),r=r.selected.has(t)?r.update("selected",function(e){return e.delete(t)}):r.update("selected",function(e){return e.add(t)}).set("anchor",t),e.props.onSelectionChange(r)}})(this)},_renderTileOverflowMenu:function(e){var t;return t=g.getActionsForFileCollection({files:s.Set([e]),context:this.props.context,user:this.props.user,actionHandlers:this.props.contextFileActionHandlers,isMaestroDesign:!0,skipSharing:!1}),Be(ee,{file:e,actionItems:t,size:ve.Small,showBorders:!0})},_createViewFileHandler:function(e){if(e instanceof pe)return(function(t){return function(r){return r.preventDefault(),g.doOpenFile({event:r,user:t.props.user,file:e,isSearchMode:t.props.isSearchMode,constructorDisplayName:t.constructor.displayName,onFileViewerUnmount:function(){var e;return null!=(e=t.refs.tileGrid)?e.getAndUpdateTileLayout():void 0},source:"visual_browse"})}})(this)},_getSVGIconName:function(e){var t;return t=this._getSVGIconBaseName(e),e.isDeleted&&(t+="-disabled"),t},_getSVGIconBaseName:function(e){var t,r,o;return o=e.icon,o&&("_32"===o.slice(-3)&&(o=o.slice(0,-3)),"page_white_"===o.slice(0,11)&&(o=o.slice(11)),"_gray"===o.slice(-5)&&(o=o.slice(0,-5))),e instanceof Ee?"paper":e.is_dir?We.has(o)?o:"folder":(t=e.fq_path.lastIndexOf("."),t===-1?"unknown":(r=e.fq_path.slice(t+1),qe.has(r)?r:ke.has(o)?o:"unknown"))},_setSelectedTiles:function(e){var t;return t=s.Set([]),e.selectedFiles.forEach(function(e){return t=t.add(e.sjid)}),this.setState({selectedIds:t})},componentWillMount:function(){return Fe.start(this.constructor.displayName),this.setState({tileItems:this._getTileItems(this.props)}),this._setTileItemsSections(this.props),this._setSelectedTiles(this.props)},componentDidMount:function(){return this._setupExternalDragHandler(),this._setupKeyboardShortcuts(),Fe.end(this.constructor.displayName)},_setupExternalDragHandler:function(){var e,t,r,o,s;return o=(function(e){return function(){return e.props.isDraggingInternalFiles}})(this),r=(function(e){return function(){return e.props.isDraggingExternalFiles}})(this),s=(function(e){return function(){return e.props.setFileUploaderPath({path:e.props.path,hasPermissionToUploadToFolder:e.props.context.isCurrentPathWriteable()})}})(this),e=".tile",t=(function(e){return function(){return e.props.activeDropTarget}})(this),Qe(Ie,o,r,s,e,t)},_setupKeyboardShortcuts:function(){var e,t,r,o,s,n;return t=je(this),r=t,s=(function(e){return function(){return e.props.selectedFiles}})(this),e=(function(e){return function(){return e.props.focusSelectedItem}})(this),n=(function(e){return function(){return e.props.context.isCurrentPathWriteable()}})(this),o=function(){return!0},Je(t,r,s,e,n,o,this.props.selectAll,this.props.deselectAll,this.props.actionHandlers.onDelete,Ie)},componentWillUnmount:function(){return Ye(Ie)},componentWillReceiveProps:function(e){if(e.items===this.props.items&&e.isCreateFolderUIActive===this.props.isCreateFolderUIActive&&e.fileRename===this.props.fileRename||this.setState({tileItems:this._getTileItems(e)}),e.selectedFiles!==this.props.selectedFiles&&this._setSelectedTiles(e),e.activeSortField!==this.props.activeSortField||e.activeSortDirection!==this.props.activeSortDirection||e.items!==this.props.items)return this._setTileItemsSections(e)},_createOnTileDragStartForItem:function(e,t,r){return(function(o){return function(s){return t?o.props.handleDragStart(s):(r(e),o.props.handleDragStart(s,[e]))}})(this)},_handleCreateFolderSubmit:function(e){return h.createFolder({pathName:this.props.context.currentFQPath,folderName:e,nsId:this.props.context.rootNSID})},_handleCreateFolderCancel:function(){return h.cancelCreateFolder()},_getCreateFolderTile:function(){var e,t;return e=Ue("New folder"),t=He.div({}),this.props.createNewFolderState===ye.PENDING_INPUT?(e=Ue("Folder name"),t=Be(Me,{label:e,handleSubmit:this._handleCreateFolderSubmit,handleCancel:this._handleCreateFolderCancel})):this.props.createNewFolderState===ye.SAVING_INPUT&&(e=Ue("Creating new folder…"),t=Be(Ae,{label:e})),new Re({id:"New folder tile",iconUrl:$e("/static/images/maestro/tile-icons/folder-vflMFXe_s.svg"),labelNode:t,altText:e})},_getTileItem:function(e){var t,r,o,s,n,i,a,l,u,d,m,f,_,g,b,S,T,w,y,v,E,F,P,D;return f=this.props,0===e&&f.isCreateFolderUIActive?this._getCreateFolderTile():(f.isCreateFolderUIActive&&(e-=1),(n=f.items.get(e))?(D=this._createViewFileHandler(n),F=this._createToggleSelectHandler(n),i=n instanceof pe,v=D,a=!1,l=!1,i&&(t=this._renderTileOverflowMenu(n)),o=f.selectedFiles.count()>0,o&&(a=f.selection.anchor===n.fq_path,l=f.selection.selected.has(n.fq_path),v=F,i&&(P={"aria-label":Ue("View File"),onClick:D},t=this.props.isMaestroDesignAndMcl?Be(se,Object.assign({className:"tile__action-button--view-file",variant:"secondary"},P)):Be("button",Object.assign({className:"tile__action-button--view-file"},P)))),m=this._createOnTileDragStartForItem(n,l,F),r=p.filename(n.fq_path),T=c.em_snippet(r,16,.5),u=T,y=re.getGridViewThumbnailUrl(n),(null!=(_=f.fileRename)?_.file:void 0)&&p.paths_are_equal(null!=(g=f.fileRename)?g.file.fq_path:void 0,n.fq_path)?(null!=(b=f.fileRename)?b.state:void 0)===Pe.PENDING_INPUT?d=Be(Me,{defaultValue:r,label:r,handleSubmit:function(e){return h.renameFile({file:n,newName:e})},handleCancel:function(){return h.cancelFileRename({item:n})}}):(null!=(S=f.fileRename)?S.state:void 0)===Pe.SAVING_INPUT&&(d=Be(Ae,{label:Ue("Renaming…"),className:"tile-label__text--saving"})):(E=Be(Ae,{label:u}),d=r!==T?Be(W,{content:r,position:W.POSITIONS.BOTTOM,className:"tile-label__title-bubble"},E):E),s=n===this.props.activeDropTarget,w=this._getSVGIconName(n),new Re({id:n.sjid,labelNode:d,altText:r,iconUrl:$e("/static/images/maestro/tile-icons/"+w+".svg"),thumbnailUrl:y,actionNode:t,onTileAction:v,isDraggable:!0,onDragEnter:this.props.createOnDragEnterHandlerForFile(n,l,s),onDragStart:m,isFocused:a,isSelectable:!0,isSelected:l,handleToggleSelect:F,alwaysShowCheckbox:o,checkboxAriaText:Ue("Select tile")})):e>=f.items.count()&&e<f.totalNumItems?new Re({id:"Placeholder "+e,iconUrl:$e("/static/images/maestro/tile-icons/unknown-vflEPx1xQ.svg")}):null)},_renderFixedHeader:function(){return Be(oe,{key:"tileGridHeader",ref:"tileGridHeader",onSortChange:this.props.onSortChange,currentSortField:this.props.activeSortField,currentSortDirection:this.props.activeSortDirection,onSwitchViewType:this.props.onSwitchViewType,currentViewType:this.props.currentViewType})},_renderTileGrid:function(){return Be(ge,{key:"tileGrid",ref:"tileGrid",tileItems:this.state.tileItems,containerClass:"file-tile-grid-container",rowClass:"file-tile-row",logTileLoading:!0,numThresholdRows:this.props.gridViewOptions.numThresholdRows,scrollDeltaThreshold:this.props.gridViewOptions.scrollDeltaThreshold,sectionStartIndices:this.state.sectionStartIndices,sectionLabels:this.state.sectionLabels,contentOffset:136,getTileItem:this._getTileItem,selectedIds:this.state.selectedIds,handleTTI:this.props.handleTTI,thumbStore:this.props.thumbStore})},render:function(){var e;return e=[this._renderFixedHeader(),this._renderTileGrid()],He.div({},e)}}),re.getGridViewThumbnailUrl=function(e){var t;return t=null,null!=e.thumbnail_url_tmpl&&(t=k.parse(e.thumbnail_url_tmpl),t=t.removeQuery("size").removeQuery("size_mode"),t=t.updateQuery({size:"256x256",size_mode:"2"}).toString()),t},{ItemListController:Te,ItemList:Se}}),define("modules/clean/react/browse/item_list_row",["jquery","external/immutable","external/underscore","external/classnames","external/mcl/button","external/react","external/react-dom","modules/clean/browse_interface","modules/clean/filepath","modules/clean/keycode","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/file_actions","modules/clean/react/browse/name_input","modules/clean/react/browse/settings_gear_menu","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/browse/render_partials","modules/clean/react/browse/overflow_menu","modules/clean/react/content_manager/path_util","modules/clean/react_format","modules/clean/react/selectable_list","modules/clean/react/sprite","modules/clean/search/search_helpers","modules/clean/sharing/browse_exports","modules/constants/starred","modules/clean/react/home/home_access/home_access_util","modules/core/dom","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/react/browse/share_button","modules/clean/react/flag","modules/clean/react/helpers","modules/clean/user_education/user_education_client","modules/clean/react/maestro/checkbox","modules/clean/react_logger","require"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D,N,C,I,R,M,A,O,x,L,U){var k,B,G,V,H,q,W,j,z,K,Y,Q,J,X,Z,$,ee,te,re,oe,se,ne,ie,ae,le,ue,ce,pe,de,he,me,fe;return G=s.Button,ie=a.browse_uri_for_fq_path,ce=a.get_browse_root_name,Y=u.KeyCode,$=p.RenameStates,z=p.FileTypes,Q=h.NameInput,te=m.SettingsGearMenuBubble,q=f.File,k=f.BrowseContext,J=f.Paper,_.BrowseStore,W=g.FileIcon,B=b.BrowseOverflowMenu,he=T.reactFormat,le=w.createSelection,K=E.GoldenGate,fe=E.shouldUsePublicFolderSharing,ee=F.STARRED_RESOURCE_ID_TYPE,pe=P.isHomeEnabled,ne=N._,re=R.ShareButton,me=A.shallowCompareStateAndProps,oe=O.UEClient,se=O.UserEducationEffect,V=x.Checkbox,H=x.CheckboxState,Z=L.ReactLogger,ue=n.DOM,ae=n.createElement,de=function(e,t,r,o,s){return(!t.is_dir||!fe(r.config,t.fq_path))&&(!(!e||t.isDeleted)&&(!q.isTeamMemberFolder(t)&&(!!q.canViewFileMembers(t,r)&&((!r.isNonUserRelativeContext||!s)&&!(r.isNonUserRelativeContext&&o&&!s)))))},j=n.createClass({displayName:"FileItemRow",propTypes:{context:n.PropTypes.instanceOf(k).isRequired,file:n.PropTypes.instanceOf(q).isRequired,user:n.PropTypes.object,columnClasses:n.PropTypes.string,isTabbable:n.PropTypes.bool,enableDoubleClickTraversal:n.PropTypes.bool,isMaestroDesign:n.PropTypes.bool,isSearchMode:n.PropTypes.bool,topOffsetPx:n.PropTypes.number,isSelected:n.PropTypes.bool,isDraggingInternalFiles:n.PropTypes.bool,isDraggingExternalFiles:n.PropTypes.bool,isAvailableDropTarget:n.PropTypes.bool,isActiveDropTarget:n.PropTypes.bool,isArchiveState:n.PropTypes.bool,isTextSelectable:n.PropTypes.bool,isMultiColumnGroupVisible:n.PropTypes.bool,isModifiedColumnVisible:n.PropTypes.bool,renameState:n.PropTypes.oneOf(r.values($)),rowIndex:n.PropTypes.number,showColumnDetail:n.PropTypes.bool,showFilenameHighlights:n.PropTypes.bool,isMaestroDesignAndMcl:n.PropTypes.bool,maestroListViewFullRowSelect:n.PropTypes.bool,inSelectMode:n.PropTypes.bool,disableCheckbox:n.PropTypes.bool,settingsGearMenuAlt:n.PropTypes.string,settingsGearMenuItems:n.PropTypes.arrayOf(n.PropTypes.shape({label:n.PropTypes.string,action:n.PropTypes.func})),totalRowCount:n.PropTypes.number,selectedFilesCount:n.PropTypes.number,onMouseEnter:n.PropTypes.func,onMouseDown:n.PropTypes.func,onMouseUp:n.PropTypes.func,onDragStart:n.PropTypes.func,onFileDragEnterItem:n.PropTypes.func,setFileUploaderPath:n.PropTypes.func,onToggleRowSelected:n.PropTypes.func,contextFileActionHandlers:n.PropTypes.object,isSharedWithLoaded:n.PropTypes.bool,isStarredLoaded:n.PropTypes.bool,showOverflowActions:n.PropTypes.bool},getDefaultProps:function(){return{columnClasses:"browse-file-row__column o-grid__col o-grid__col--am",isMaestroDesign:!1,isSearchMode:!1,isSelected:!1,isTabbable:!1,enableDoubleClickTraversal:!0,isDraggingInternalFiles:!1,isDraggingExternalFiles:!1,isAvailableDropTarget:!1,isActiveDropTarget:!1,isArchiveState:!1,isTextSelectable:!0,renameState:null,isMultiColumnGroupVisible:!0,isModifiedColumnVisible:!0,showColumnDetail:!1,showFilenameHighlights:!1,maestroListViewFullRowSelect:!1,inSelectMode:!1,disableCheckbox:!1,onFileDragEnterItem:function(){},setFileUploaderPath:function(){},showOverflowActions:!0,onMouseEnter:null,onMouseDown:null,onMouseUp:null,onToggleRowSelected:null,onFocus:null,onDragStart:function(){},isHovered:!1}},getInitialState:function(){return{hasThumbErrored:!1,wasSelectedBeforeMostRecentMouseDown:!1,shouldShowSettingsBubble:!1,isHovered:!1}},componentWillMount:function(){return Z.start(this.constructor.displayName)},componentDidMount:function(){if(this._isMounted=!0,Z.end(this.constructor.displayName),e(i.findDOMNode(this)).on("dragenter.fileRow",(function(e){return function(){return e.props.onFileDragEnterItem()}})(this)).on("focusin.fileRow",(function(e){return function(t){var r;if(!e.state.focusedIn)return e.setState({focusedIn:!0}),"function"==typeof(r=e.props).onFocus?r.onFocus(t):void 0}})(this)).on("focusout.fileRow",(function(e){return function(){return e.setState({focusedIn:!1})}})(this)).on("mouseup.fileRow",this.handleMouseUp),!this.props.isMaestroDesign)return this._setTabIndices()},componentWillReceiveProps:function(e){if(this.props.isSelected&&!e.isSelected)return this.setState({wasSelectedBeforeMostRecentMouseDown:!1,shouldShowSettingsBubble:!1})},shouldComponentUpdate:me,componentDidUpdate:function(e){if(!this.props.isMaestroDesign)return this._setTabIndices()},componentWillUnmount:function(){return e(i.findDOMNode(this)).off(".fileRow"),this._isMounted=!1},_setTabIndices:function(){var e,t,r,o,s;for(t=D.getFocusableElementsIn(i.findDOMNode(this),!1),s=[],r=0,o=t.length;r<o;r++)e=t[r],"selection_checkbox"===e.className?s.push(e.tabIndex=-1):this.props.isTabbable?s.push(e.tabIndex=0):s.push(e.tabIndex=-1);return s},handleMouseEnter:function(e){return this.props.isDraggingInternalFiles||this.props.isDraggingExternalFiles?void c.setDropTarget({target:this.props.file}):(this.setState({isHovered:!0}),this.props.onMouseEnter(e))},handleMouseLeave:function(){return this.props.isDraggingInternalFiles||this.props.isDraggingExternalFiles?void c.setDropTarget({target:null}):this.setState({isHovered:!1})},handleMouseDown:function(e){return this.setState({wasSelectedBeforeMostRecentMouseDown:this.props.isSelected}),this.props.onMouseDown(e)},handleMouseUp:function(e){if(!this.props.maestroListViewFullRowSelect||!this.props.inSelectMode)return this.handleSettingsGearMenuMouseUp(e),this.props.onMouseUp(e)},handleSettingsGearMenuMouseUp:function(t){if(null!=this.props.settingsGearMenuItems){if(this.state.shouldShowSettingsBubble)return this.setState({shouldShowSettingsBubble:!1});if(e.contains(i.findDOMNode(this.refs.settings),t.target))return this.setState({shouldShowSettingsBubble:!0})}},handleFilenameClick:function(e){if(!this.props.isTextSelectable)return this.props.maestroListViewFullRowSelect&&this.props.inSelectMode?(e.preventDefault(),void this.toggleSelected(e)):this._openFile(e)},_openFile:function(e){return d.doOpenFile({event:e,user:this.props.user,file:this.props.file,isSearchMode:this.props.isSearchMode,constructorDisplayName:this.constructor.displayName,onFileViewerUnmount:this._onViewerUnmount,source:"list_browse"})},_onViewerUnmount:function(){var e;if(this._isMounted)return null!=(e=i.findDOMNode(this))?e.focus():void 0},handleDoubleClick:function(e){if(this.props.enableDoubleClickTraversal)return this.handleFilenameClick(e)},handleRenameSubmit:function(e){return c.renameFile({file:this.props.file,newName:e})},handleRenameCancel:function(){return c.cancelFileRename({file:this.props.file})},handleDragStart:function(e){return this.props.isMaestroDesign&&!this.props.isSelected?(this.toggleSelected(e),this.props.onDragStart(e,[this.props.file])):this.props.onDragStart(e)},toggleSelected:function(e){return e.stopPropagation(),this.props.onToggleRowSelected(e)},handleCheckboxKeyPress:function(e){var t;if(t=e.which||e.keyCode,t===Y.SPACE)return e.stopPropagation(),this.toggleSelected(e)},_renderSelectionToggleColumn:function(){var e;return[this.props.isMaestroDesign?(e=H.Unchecked,this.props.isSelected&&(e=H.Checked),this.props.disableCheckbox?void 0:ue.div({className:o({"file-select-checkbox":!0,"show-boxes":this.props.inSelectMode}),key:"selection_toggle_column",role:"gridcell",onDoubleClick:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},onMouseDown:(function(e){return function(t){return t.stopPropagation(),e.props.onMouseDown(t),oe.sendEvent(e.constructor.displayName,"CheckboxToggled")}})(this),onMouseUp:(function(e){return function(t){return t.stopPropagation(),e.props.onMouseUp(t)}})(this),onKeyPress:this.handleCheckboxKeyPress},0===this.props.rowIndex?ae(se,{containerName:this.constructor.displayName,name:"FirstFileSelectCheckbox",useSpan:!0},ae(V,{ariaLabel:ne("Select row"),checkboxState:e,onMouseDown:function(e){return e.target.blur()}})):ae(V,{ariaLabel:ne("Select row"),checkboxState:e,onMouseDown:function(e){return e.target.blur()}}))):ue.div({className:"ax-visually-hidden",key:"selection_toggle_column",role:"gridcell"},ue.input({className:"selection_checkbox",ref:"selectionToggleInput",type:"checkbox","aria-label":ne("Select row"),checked:this.props.isSelected,onChange:this.toggleSelected,tabIndex:-1}))]},_renderPlaceholder:function(){return ue.span({"aria-hidden":"true"},"--")},_renderScreenReaderExtraInfo:function(){var e,t;if(e=[],this.props.file.isDeleted&&e.push(ne("Deleted")),this.props.isSelected&&e.push(ne("Selected")),this.props.file.is_dir&&(this.props.file.type===z.SHARED_FOLDER?q.isReadOnlySharedFolder(this.props.file)?e.push(ne("Read-only shared folder")):e.push(ne("Shared folder")):this.props.file.type===z.TEAM_SHARED_FOLDER?q.isReadOnlySharedFolder(this.props.file)?e.push(ne("Read-only team shared folder")):e.push(ne("Team shared folder")):e.push(ne("Folder"))),e.length>0)return t=" "+e.join(" "),ue.span({className:"ax-visually-hidden"},t)},_renderFilename:function(){var e,t,s,n,i,a,u,p,d,h,m;return t=this.props.file,s=l.filename(t.fq_path),i=this.props.showFilenameHighlights?v.highlightMatchString(s,t.filename_highlights):r.escape(s),u=l.parent_dir(t.fq_path),p=ie(this.props.user,u),h="/"===u?ce(this.props.user):this.props.isMaestroDesign?u.slice(1):u,this.props.renameState===$.PENDING_INPUT?(a=ne(t.is_dir?"Rename directory…":"Rename file…"),ae(Q,{ref:"nameInput",label:a,defaultValue:l.filename(t.fq_path),onSubmit:this.handleRenameSubmit,onCancel:this.handleRenameCancel,className:"browse-file-row__input"})):this.props.renameState===$.SAVING_INPUT?ue.span({ref:"renameStatus",role:"status"},ne("Renaming…")):(n=null,t.is_unmounted||((null!=(m=this.props.context)?m.isNonUserRelativeContext:void 0)?n=S.getBasePrefix(this.props.user.id)+"/home"+t.fq_path:t.is_unmounted||(n=t.href)),a=ue.a({ref:"filenameLabel",className:o("filename-link u-ellip","browse-file-row__name",this.props.isArchiveState?"browse-file-row__name-archived":void 0),href:n,onContextMenuCapture:(function(e){return function(){return e._handleContextMenuCapture("filename")}})(this),onDragStart:(function(e){return function(t){if(!e.props.isMaestroDesign&&(t.stopPropagation(),!e.props.isArchiveState))return c.setSelection({selection:le([e.props.file.fq_path])}),e.props.onDragStart(t,[e.props.file],!1)}})(this),onMouseDown:(function(e){return function(t){var r,o;if(!e.props.isMaestroDesign)return o=2===t.button||2===t.buttons,r=t.button>0||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey,!e.props.file.is_dir&&!r||o?void 0:t.stopPropagation()}})(this),onClick:this.handleFilenameClick},ue.span({dangerouslySetInnerHTML:{__html:i}}),this._renderScreenReaderExtraInfo()),!(this.props.isMaestroDesign&&pe()&&this.props.isStarredLoaded)||this.props.maestroListViewFullRowSelect&&this.props.inSelectMode||(e=U("modules/clean/react/starred/browse_exports").Star,a=ue.span({className:"browse-file-row__name-with-star"},a,ae(e,{id:this.props.file.file_id,idType:ee.ENCODED_FILE_OBJ_ID,role:this.props.user.role,ref:"Star"}))),ue.div({className:"browse-file-row__name-location"},0===this.props.rowIndex?ae(se,{containerName:this.constructor.displayName,name:"FirstFileNameLabel",useSpan:!0},a):a,this.props.showColumnDetail?ue.div({className:o({"u-ellip":!0,"browse-file-row__location":!0,"u-font-meta":this.props.isMaestroDesign})},this.props.isMaestroDesign?t.is_unmounted?ne("not added yet, in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:h}):(d=ne("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:h}),this.props.maestroListViewFullRowSelect&&this.props.inSelectMode?d:ue.a({href:p,className:"browse-file-row-location-link",onClick:(function(e){return function(t){return e._handleLoadFileLocation(t,u)}})(this),onContextMenuCapture:(function(e){return function(){return e._handleContextMenuCapture("location")}})(this)},d)):t.is_unmounted?he(ne("not added yet, in <strong>%(location)s</strong>",{comment:"Describes the parent directory of a file in a list of search results."}),{location:h,strong:ue.strong()}):ue.a({href:p,className:"browse-file-row-location-link",onClick:(function(e){return function(t){return e.props.isSearchMode&&v.logSearchAction(e.props.file,e.props.user,"click_path_link"),c.setUrl({path:u}),t.preventDefault()}})(this),onContextMenuCapture:(function(e){return function(){return e._handleContextMenuCapture("location")}})(this)},he(ne("in <strong>%(location)s</strong>",{comment:"Describes the parent directory of a file in a list of search results."}),{location:h,strong:ue.strong()}))):void 0))},_handleContextMenuCapture:function(e){if(this.props.isSearchMode)return v.logSearchAction(this.props.file,this.props.user,e+"_context_menu")},_handleLoadFileLocation:function(e,t){return e.stopPropagation(),this.props.isSearchMode&&v.logSearchAction(this.props.file,this.props.user,"click_path_link"),c.setUrl({path:t}),e.preventDefault()},_renderFilenameColumn:function(){var e,t,r;return t=ae(W,{className:o({"u-pad-right-xs":!this.props.isMaestroDesign}),ref:"icon",file:this.props.file,onClick:this.handleFilenameClick,onDragStart:(function(e){return function(t){if(!e.props.isMaestroDesign)return t.stopPropagation(),c.setSelection({selection:le([e.props.file.fq_path])}),e.props.onDragStart(t,[e.props.file],!1)}})(this),onMouseDown:(function(e){return function(t){if(e.props.file.is_dir)return t.stopPropagation()}})(this)}),r=this._renderFilename(),e=this.props.isMaestroDesign&&!this.props.isMultiColumnGroupVisible?8:6,ue.div({ref:"filenameColumn",className:o(""+this.props.columnClasses,"column--filename","o-grid__col--"+e+"-of-12"),key:"filename_column",role:"rowheader"},ae(M.FlagWithoutCss,{leftAttachment:t},r))},_renderModifiedColumn:function(){var e,t,r;return e=this.props.file.last_modified_fname||"",t=this.props.file.ago||this._renderPlaceholder(),this.props.showColumnDetail&&!this.props.isMaestroDesign&&(t=this.props.file.ago?ne("Modified %(ago)s").format({ago:this.props.file.ago}):""),ue.div({className:o((r={},r[""+this.props.columnClasses]=!0,r["u-ellip"]=!0,r["o-grid__col--3-of-12"]=this.props.isMultiColumnGroupVisible||this.props.isMaestroDesign,r["o-grid__col--6-of-12"]=!(this.props.isMultiColumnGroupVisible||this.props.isMaestroDesign),r)),key:"modified_column",role:"gridcell"},this.props.isMaestroDesign?ue.span({className:"browse-file-row__modified-time"},t):t,e.length?ue.span({className:"browse-file-row__modifier u-font-meta"},(this.props.isMaestroDesign?"by ":"")+e):void 0)},_renderMultiColumnGroup:function(){var e,t,r;return t=(function(e){return function(t,r){return ue.div({className:"column--multi "+e.props.columnClasses+" column--"+t+" o-grid__col--3-of-12",role:"gridcell",key:t,ref:t},r)}})(this),r=[],this.props.isSharedWithLoaded&&!this._isTeamSharedFolderInArchivedMode()?(e=U("modules/clean/react/browse/shared_with").SharedWithController,r.push(t("sharedwith",ae(e,{file:this.props.file,browseContext:this.props.context,tabIndex:this.props.isTabbable?0:-1,isMaestroDesign:this.props.isMaestroDesign,inSelectMode:this.props.maestroListViewFullRowSelect&&this.props.inSelectMode,actionHandlers:this.props.contextFileActionHandlers})))):r.push(t("sharedwith",null)),r.push(t("type",q.getCategoryDescription(this.props.file)),t("extension",q.getExtension(this.props.file)||this._renderPlaceholder()),t("size",this.props.file.size||this._renderPlaceholder())),r},_isTeamSharedFolderArchived:function(){return this.props.file.type===z.TEAM_SHARED_FOLDER&&"archived"===this.props.file.team_folder_status},_isTeamSharedFolderArchivedInProgress:function(){return this.props.file.type===z.TEAM_SHARED_FOLDER&&"archive_in_progress"===this.props.file.team_folder_status},_isTeamSharedFolderInArchivedMode:function(){return this._isTeamSharedFolderArchived()||this._isTeamSharedFolderArchivedInProgress()},_renderActionsColumn:function(){var e,r,s,n,i,a,l,u;if(!((null!=(n=this.props.context)?n.isNonUserRelativeContext:void 0)&&K.hasContentManagerCdm(this.props.user.id))){if(e=[],this.props.isMaestroDesign&&this.props.maestroListViewFullRowSelect&&this.props.inSelectMode)u=this._openFile,l={"aria-label":ne("View File"),onClick:u},this.props.isMaestroDesignAndMcl?e.push(ae(G,Object.assign({className:"file-list-view-file-button",variant:this.state.isHovered?"secondary":"invisible"},l))):e.push(ae("button",Object.assign({className:"file-list-view-file-button"},l)));else{if(i=!0,this.props.isMaestroDesign&&this.props.selectedFilesCount>0&&(i=!1,this.props.isSelected&&1===this.props.selectedFilesCount&&(i=!0)),!i)return;a=this.props.isMaestroDesign&&this.props.showOverflowActions,de(this.props.user,this.props.file,this.props.context,this.props.isArchiveState,this._isTeamSharedFolderInArchivedMode())&&e.push(ae(re,{ref:"shareButton",key:"share_button_column",browseContext:this.props.context,file:this.props.file,user:this.props.user,isMaestroDesign:this.props.isMaestroDesign,actionHandlers:this.props.contextFileActionHandlers})),a&&(r=d.getActionsForFileCollection({files:t.Set([this.props.file]),context:this.props.context,user:this.props.user,actionHandlers:this.props.contextFileActionHandlers,isMaestroDesign:!0,skipSharing:!0}),e.push(ae(B,{ref:"overflow_menu",key:"overflow_menu_column",file:this.props.file,actionItems:r,showBorders:this.state.isHovered})))}return ue.div({className:o((s={},s[""+this.props.columnClasses]=!0,s.sharing__actions=!0,s["sharing__actions--overflow-menu"]=a,s)),key:"actions_column",role:"gridcell"},e)}},_getMenuItemsForFile:function(e,t){var r,o,s,n,i,a,l;for(l=[],s=0,i=t.length;s<i;s++)a=t[s],n=a[0],r=!0,2===a.length&&(o=a[1],o(e)||(r=!1)),r&&l.push(n);return l},_renderSettingsGearColumn:function(){var e;return e=this._getMenuItemsForFile(this.props.file,this.props.settingsGearMenuItems),ue.div({className:"settings-gear-button",key:"settings_gear_column",role:"gridcell"},ae(te,{ref:"settings",alt:this.props.settingsGearMenuAlt,isShowing:this.state.shouldShowSettingsBubble,menuItems:e,browseContext:this.props.context,file:this.props.file,isActionDisabled:K.hasContentManagerActionsDisabled(this.props.user.id)}))},_renderEmptyColumns:function(){return ue.div({className:o(""+this.props.columnClasses,"u-ellip","o-grid__col--3-of-12"),role:"gridcell",key:"empty_column"})},_renderFileRow:function(e){var t;return ue.li(e,this._renderSelectionToggleColumn(),this._renderFilenameColumn(),this.props.isArchiveState?this._renderEmptyColumns():this.props.isModifiedColumnVisible?this._renderModifiedColumn():void 0,this.props.isMultiColumnGroupVisible?function(){var e,r,o,s;for(o=this._renderMultiColumnGroup(),s=[],e=0,r=o.length;e<r;e++)t=o[e],s.push(t);return s}.call(this):void 0,null!=this.props.settingsGearMenuItems?this._renderSettingsGearColumn():this._renderActionsColumn())},render:function(){var e,t,r;return e={"browse-file-row":!0,"browse-file-row--focused-in":this.state.focusedIn,"browse-file-row--is-selected":this.props.isSelected,"browse-file-row--is-archived":this.props.isArchiveState,"browse-file-row--is-deleted":this.props.file.isDeleted,"browse-file-row--is-drop-target":this.props.isAvailableDropTarget,"browse-file-row--file-dragged-over":this.props.isAvailableDropTarget&&this.props.isActiveDropTarget,"o-grid":!0,"o-grid--no-gutter":!0},r={className:o(e),"data-filename":this.props.file.fq_path.split("/").slice(-1),role:"row",tabIndex:this.props.isTabbable?0:-1,draggable:(this.props.isMaestroDesign||this.props.isSelected&&this.state.wasSelectedBeforeMostRecentMouseDown)&&!((t=this.props.renameState)===$.PENDING_INPUT||t===$.SAVING_INPUT),onBlur:(function(e){return function(){return e.setState({focusedIn:!1})}})(this),onMouseEnter:this.handleMouseEnter,onMouseDown:(function(e){return function(t){
return e.props.isMaestroDesign?t.stopPropagation():e.handleMouseDown(t)}})(this),onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseLeave,onClick:this.props.isMaestroDesign?this.handleFilenameClick:this.props.onClick,onDoubleClick:this.handleDoubleClick,onDragStart:this.handleDragStart},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||null==this.props.topOffsetPx||(r.style={position:"absolute",top:this.props.topOffsetPx},r["aria-posinset"]=this.props.rowIndex+1,r["aria-setsize"]=this.props.totalRowCount),this._renderFileRow(r)}}),X=n.createClass({displayName:"PaperItemRow",propTypes:{paper:n.PropTypes.instanceOf(J).isRequired,user:n.PropTypes.object,topOffsetPx:n.PropTypes.number,columnClasses:n.PropTypes.string,rowIndex:n.PropTypes.number,showTitleHighlights:n.PropTypes.bool,totalRowCount:n.PropTypes.number,isMaestroDesign:n.PropTypes.bool,isSearchMode:n.PropTypes.bool,onMouseEnter:n.PropTypes.func,onMouseDown:n.PropTypes.func,onMouseUp:n.PropTypes.func},getDefaultProps:function(){return{columnClasses:"browse-file-row__column o-grid__col o-grid__col--am",showTitleHighlights:!1,isMaestroDesign:!1,isSearchMode:!1,onMouseEnter:null,onMouseDown:null,onMouseUp:null}},componentWillMount:function(){return Z.start(this.constructor.displayName)},componentDidMount:function(){return Z.end(this.constructor.displayName)},render:function(){var e,t,s,n,i,a,l,u,c;return l=ae(y,{group:"web",name:"paper_white_32",ref:"icon",className:o("browse-file-row__accessory",{"u-pad-right-xs":!this.props.isMaestroDesign}),alt:""}),c=this.props.paper.title,s=this.props.showTitleHighlights?v.highlightMatchString(c,this.props.paper.title_highlights):r.escape(c),a=I({scheme:"https",authority:"www.dropbox.com",path:"/paper"}),e=ue.div({className:"browse-file-row__name-location"},ue.a({className:"filename-link u-ellip browse-file-row__name",href:this.props.paper.url,onContextMenuCapture:(function(e){return function(){if(e.props.isSearchMode)return v.logPaperSearchAction(e.props.paper,e.props.user,"paper_context_menu")}})(this),onClick:(function(e){return function(t){if(e.props.isSearchMode)return v.logPaperSearchAction(e.props.paper,e.props.user,"paper_open")}})(this)},ue.span({dangerouslySetInnerHTML:{__html:s}})),ue.div({className:"u-ellip browse-file-row__location"},this.props.isMaestroDesign?ne("in Paper",{comment:"The Dropbox Paper page"}):ue.a({href:a},he(ne("in <strong>Paper</strong>",{comment:"The Dropbox Paper page."}),{strong:ue.strong()})))),i=this.props.paper.last_modified_date?ne("Modified %(date)s").format({date:this.props.paper.last_modified_date}):"",this.props.isMaestroDesign?(t=8,n=3):(t=6,n=6),u={className:o("browse-file-row","o-grid","o-grid--no-gutter"),"data-filename":this.props.paper.title,role:"row",tabIndex:"-1"},"undefined"!=typeof RUNNING_IN_REACTSERVER&&null!==RUNNING_IN_REACTSERVER||null==this.props.topOffsetPx||(u.style={position:"absolute",top:this.props.topOffsetPx},u["aria-setsize"]=this.props.totalRowCount,u["aria-posinset"]=this.props.rowIndex+1),ue.li(u,ue.div({className:o(""+this.props.columnClasses,"column--filename","o-grid__col--"+t+"-of-12"),role:"rowheader"},ae(M.FlagWithoutCss,{leftAttachment:l},e)),ue.div({className:o(""+this.props.columnClasses,"u-ellip","o-grid__col--"+n+"-of-12"),role:"gridcell"},i,ue.span({className:"browse-file-row__modifier u-font-meta"},this.props.paper.creator_name)))}}),{FileItemRow:j,PaperItemRow:X}}),define("modules/clean/react/browse/keyboard_shortcuts",["external/react","external/react-dom","jquery","modules/core/browser","modules/core/i18n","modules/clean/keycode","modules/clean/react/modal","modules/clean/react/flag"],function(e,t,r,o,s,n,i,a){var l,u,c,p,d,h;return p=s._,l=n.KeyCode,u=i.Modal,h=e.DOM,d=e.createElement,c=[{key:"↑",desc:p("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:p("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{windowsKey:"ctrl + a",macKey:"⌘ + a",desc:p("Select all files")},{key:"esc",desc:p("Deselect all files")},{key:"←",desc:p("Go up a folder")},{key:"/",desc:p("Search")},{key:"→",desc:p("Open folder")},{key:"enter",desc:p("Open file or folder")},{key:"alt + a",desc:p("Show action menu for selected file(s)")},{windowsKey:"ctrl + c",macKey:"⌘ + c",desc:p("Copy selected file(s)")},{windowsKey:"ctrl + v",macKey:"⌘ + v",desc:p("Paste selected file(s) into the current folder")},{key:"F2",desc:p("Rename selected file")},{windowsKey:"Delete",macKey:"delete",desc:p("Delete selected file(s)")},{windowsKey:"ctrl + z",macKey:"⌘ + z",desc:p("Undo recent move/copy/rename/delete")},{key:"?",desc:p("Show keyboard shortcuts")}],e.createClass({displayName:"KeyboardShortcuts",componentDidMount:function(){var e;return e=t.findDOMNode(this.refs.shortcutsModal.refs.modal),r(e).on("keydown",this._handleQuestionMarkKeyDown)},componentWillUnmount:function(){var e;return e=t.findDOMNode(this.refs.shortcutsModal.refs.modal),r(e).off("keydown",this._handleQuestionMarkKeyDown)},_handleQuestionMarkKeyDown:function(e){if(e.shiftKey&&e.which===l.FORWARD_SLASH)return e.stopPropagation(),this.refs.shortcutsModal.close()},_renderShortcutsItem:function(e){var t;return t=h.span({className:"keyboard-shortcuts__key"},e.key?e.key:o.mac?e.macKey:e.windowsKey),h.li({className:"keyboard-shortcuts__item u-mar-bottom-xs"},d(a.Flag,{leftAttachment:t,alignment:"top"},h.span({className:"keyboard-shortcuts__desc"},e.desc)))},render:function(){var e;return d(u,{ref:"shortcutsModal",acceptButtonText:"",className:"keyboard-shortcuts",onShow:this._setupKeyDown,title:p("Dropbox keyboard shortcuts"),width:750},h.ul({className:"keyboard-shortcuts__pane u-unlist u-trim-padding"},function(){var t,r,o;for(o=[],t=0,r=c.length;t<r;t++)e=c[t],o.push(this._renderShortcutsItem(e));return o}.call(this)))}})}),define("modules/clean/react/browse/name_input",["require","exports","tslib","external/classnames","external/react","external/react-dom","modules/clean/keycode","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,n,i,a,l){"use strict";var u=function(){},c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDragStart=function(e){e.stopPropagation()},t.handleSubmit=function(e){e.preventDefault(),t.submitIfChanged()},t.handleKeyDown=function(e){e.keyCode===i.KeyCode.ESC&&(e.preventDefault(),t.props.onCancel())},t.handleBlur=function(e){t.submitIfChanged()},t.handleClick=function(e){t.props.onClick(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=n.findDOMNode(this.refs.input);e.focus(),window.requestAnimationFrame(function(){var t=e.value,r=t.lastIndexOf(".");r===-1&&(r=t.length),e.setSelectionRange(0,r)})},t.prototype.submitIfChanged=function(){var e=n.findDOMNode(this.refs.input).value.trim();e===this.props.defaultValue?(this.props.label===a._("Folder name")&&l.error(a._("Please provide a name for the new folder.")),this.props.onCancel()):this.props.onSubmit(e)},t.prototype.render=function(){return s.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},s.createElement("input",{ref:"input",defaultValue:this.props.defaultValue,className:o("c-input",this.props.className),onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))},t})(s.PureComponent);c.defaultProps={className:"",onCancel:u,onClick:u,onSubmit:u},t.NameInput=c}),define("modules/clean/react/browse/nav_actions",["jquery","external/underscore","modules/clean/browse_interface","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/selectable_list","modules/clean/web_timing_logger","modules/core/browser","modules/core/uri"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h){var m,f,_,g,b;return m=a.BrowseActionTypes,g=a.LoadingStates,f=l.BrowseContext,_=u.BrowseStore,b=c.createSelection,new((function(){function e(){}return e.prototype._dataApi=i,e.prototype.setUrlPrefix=function(e){var t;return t=e.prefix,o.dispatch({type:m.SET_URL_PREFIX,data:{prefix:t}})},e.prototype.setUrl=function(e){var t,n,i,a,l,u;t=e.path,n=e.prefix,i=e.qargs,"/search"===n?(u=_.user(),l="work"===u.role?r.WORK_ROOT:r.PERSONAL_ROOT,n+=l,s.push_state(n,i)):(a={},"1"===s.deconstruct_url().qargs.d&&(a.d="1"),s.push_state(_.urlPrefix()+h.encode_parts(t),a),o.dispatch({type:m.SET_SELECTION,data:{selection:b()}}))},e.prototype.setLoadingState=function(e){var t,r;return t=e.loadingState,r=e.path,o.dispatch({type:m.SET_LOADING_STATE,data:{loadingState:t,path:r}})},e.prototype.setMountPoints=function(e){var t;return t=e.mountPoints,o.dispatch({type:m.SET_MOUNT_POINTS,data:{mountPoints:t}})},e.prototype.setTeamFolders=function(e){var t;return t=e.teamFolders,o.dispatch({type:m.SET_TEAM_FOLDERS,data:{teamFolders:t}})},e.prototype.setPath=function(e){var t,r,s,i,a,l,u;return a=e.path,i=e.onPathLoaded,s=e.nsId,r=null!=(l=e.logFetchedDataRequiredForTTI)&&l,o.dispatch({type:m.SET_PATH,data:{path:a}}),this.setLoadingState({loadingState:g.LOADING_FIRST_PAGE,path:a}),u=_.user().id,t=(function(e){return function(t){var o,s,l,c,d,h;return l=t.path,s=t.data,r&&p.log_js_modules_fetched_data_required_for_tti(),e.setMountPoints({mountPoints:s.ns_id_to_mount_point}),e.setTeamFolders({teamFolders:s.team_folders_js_info}),o=f.fromServerObject(s),s.paginated?(e.setLoadingState({loadingState:g.LOADING_REMAINING_PAGES,path:a}),e.load({path:l,files:[],context:o}),c=function(t,r){if(e.add({path:l,files:r}),t.areAllItemsReady())return e.setLoadingState({loadingState:g.LOADED,path:a}),t.stopAutoFetching()},d=new n,d.initialize(s.first_page,"sjid","/browse_get_next",u,c),d.startAutoFetching()):(h=s.file_info,e.load({path:l,files:h,context:o}),e.setLoadingState({loadingState:g.LOADED,path:a})),"function"==typeof i?i():void 0}})(this),this._dataApi.loadPath({path:a,userId:u,sortFoldersFirst:!d.mac,includeDeletedFiles:_.shouldShowDeletedFiles(),nsId:s,onSuccess:t,onError:(function(e){return function(){if("/"!==a)return e.setPath({path:"/",onPathLoaded:i})}})(this)})},e.prototype.load=function(e){var t,r,s;return s=e.path,r=e.files,t=e.context,o.dispatch({type:m.LOAD_PATH,data:{path:s,files:r,context:t}})},e.prototype.add=function(e){var t,r;return r=e.path,t=e.files,o.dispatch({type:m.ADD_FILES,data:{path:r,files:t}})},e.prototype.setDataApi=function(e){return this._dataApi=e},e})())}),define("modules/clean/react/browse/overflow_menu",["require","exports","tslib","external/react","modules/clean/react/browse/actions","external/mcl/overflow_button","external/mcl/popover","modules/core/i18n"],function(e,t,r,o,s,n,i,a){"use strict";var l,u=function(){};(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(l=t.OverflowMenuSize||(t.OverflowMenuSize={}));var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stopPropagation=function(e){return e.stopPropagation()},t.onMenuToggle=function(e){e.isOpen&&s.setContextFile({file:t.props.file})},t}return r.__extends(t,e),t.prototype.renderOverflowButton=function(){return o.createElement(n.OverflowButton,{"aria-label":a._("More actions"),className:"browse-overflow-menu-trigger-button",tagName:"span",size:this.props.size===l.Small?"small":"default",variant:this.props.showBorders?"secondary":"borderless"})},t.prototype.makeClickHandlerForAction=function(e){return function(t){e.performAction(t),t.stopPropagation()}},t.prototype.render=function(){var e=this,t=this.props.actionItems.map(function(t){return o.createElement(i.PopoverContentItem,{key:t.label,onClick:e.makeClickHandlerForAction(t),disabled:t.disabled},t.label)}),r=o.createElement(i.Popover,{onSelection:u,closeOnSelection:!0,onMenuToggle:this.onMenuToggle},o.createElement(i.PopoverTrigger,{className:"browse-overflow-menu-trigger"},this.renderOverflowButton()),o.createElement(i.PopoverContent,{attachment:"right",className:"browse-overflow-menu-content"},t));return o.createElement("div",{className:"browse-overflow-menu",onClick:this.stopPropagation,onDoubleClick:this.stopPropagation},r)},t})(o.PureComponent);t.BrowseOverflowMenu=c}),define("modules/clean/react/browse/pinned_team_folder",["require","exports","tslib","external/classnames","external/mcl/vertically_fixed","modules/clean/react/browse/item_list_row","modules/clean/react/browse/file_list_utils","external/react","modules/clean/react/css","modules/clean/react/sprite","modules/clean/react_logger","modules/constants/subgrowth_experiments","modules/core/i18n","modules/clean/react/tooltip","modules/clean/user_education/user_education_client"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m){"use strict";var f=(function(e){function t(t){var r=e.call(this,"PinnedTeamFolderView",t)||this;return r.displayName="PinnedTeamFolder",r.noop=function(){},r.isSubgrowthPinnedExp=function(){return r.props.isMaestroDesign&&("ON"===p.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP1||["V1","V2"].indexOf(p.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP2)!==-1)},r.renderTeamFolderRow=function(e,t){var o=r.props,s=o.activeDropTarget,l=o.context,u=o.dropTargetHighlightMode,c=o.isDraggingInternalFiles,p=o.isDraggingExternalFiles,d=o.isMaestroDesign,h=o.isTextSelectable,f=o.selection,_=o.setFileUploaderPath,g=o.user,b=i.FileListHelpers.shouldFileBeHighlightedDropTarget({file:e,isSelected:f.selected.has(e.fq_path),dropTargetHighlightMode:u}),S=a.createElement(n.FileItemRow,{selectableListId:e.fq_path,key:encodeURI(e.fq_path),file:e,user:g,context:l,shouldFocus:f.selected.last()===e.fq_path,isDraggingInternalFiles:c,isDraggingExternalFiles:p,isAvailableDropTarget:b,isActiveDropTarget:e===s,isTextSelectable:h,isModifiedColumnVisible:!1,disableCheckbox:!0,isMaestroDesign:d,setFileUploaderPath:_,onDragStart:r.noop,onMouseEnter:r.noop,onMouseDown:r.noop,onMouseUp:r.noop});return 0===t&&(S=a.createElement(m.UserEducationEffect,{containerName:r.displayName,name:"TeamFolder",key:encodeURI(e.fq_path)},S)),S},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){m.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context)),e.prototype.componentDidMount.call(this)},t.prototype.renderTeamFolderHeader=function(e,t){return a.createElement("div",null,a.createElement("span",{className:"pinned-team-folder__header-text"},e),a.createElement("div",{className:"pinned-team-folder__info-button"},a.createElement(h.Tooltip,{position:h.TooltipPosition.RIGHT,tooltip_contents:a.createElement("div",null,t),tooltip_classname:"pinned-team-folder__tooltip"},a.createElement(u,{group:"web",name:"info",alt:d._("File section information")}))))},t.prototype.renderContent=function(){var e=this.props.teamFolders,t=e.map(this.renderTeamFolderRow),r=d.ungettext("Team Folder","Team Folders",e.size),s={"pinned-team-folder__file-row":!0,"u-pad-top-xs":!0,"exp-pinned-folders":this.isSubgrowthPinnedExp()};return a.createElement("div",null,a.createElement("div",{className:"u-pad-top-xs"},this.renderTeamFolderHeader(r,d._("Everything in a Team folder is automatically shared with your team.                   Team folders can also contain shared folders for collaborating with                   people outside your team."))),a.createElement("div",{className:o(s)},t),a.createElement("div",{className:"u-pad-top-m"},this.renderTeamFolderHeader(d._("Other Folders"),d._("These folders help you organize your private work files."))))},t.prototype.render=function(){if(this.isSubgrowthPinnedExp())return this.renderContent();var e={"pinned-team-folder__shadow":this.props.isMaestroDesign};return a.createElement("div",{className:o(e)},a.createElement(s.VerticallyFixed,{className:"pinned-team-folder"},a.createElement("div",{className:"pinned-team-folder__wrapper"},this.renderContent())))},t})(c.ReactLogger);t.PinnedTeamFolder=l(f,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/browse/browse-vflIgR_rF.css"])}),define("modules/clean/react/browse/professional_collection_actions",["require","exports","modules/clean/ajax","modules/core/browser","modules/core/notify","modules/core/i18n"],function(e,t,r,o,s,n){"use strict";function i(e,t,i){s.success(n._("Creating collection...")),r.WebRequest({url:"/premium_sharing/create",subject_user:i,data:{ns_id:e,path:t},success:function(e){var t=JSON.parse(e);t.error?s.error(t.error):o.redirect(t.collectionUrl)},error:function(){s.error(n._("Error during the creation of the collection."))}})}t.createProfessionalCollection=i}),define("modules/clean/react/browse/render_partials",["external/classnames","external/react","modules/clean/react/browse/models","modules/clean/static_urls"],function(e,t,r,o){var s,n,i,a;return s=r.File,a=o.static_url,i=t.DOM,t.createElement,n=t.createClass({displayName:"FileIconView",propTypes:{file:t.PropTypes.instanceOf(s).isRequired,onClick:t.PropTypes.func,onMouseDown:t.PropTypes.func,className:t.PropTypes.string},getDefaultProps:function(){return{onClick:function(){},onMouseDown:function(){},onDragStart:function(){},className:""}},getInitialState:function(){return{hasThumbFailed:!1}},render:function(){var t,r,o;return t="",o="",r=function(){},this.props.file.thumbnail_url_tmpl&&!this.state.hasThumbFailed?(o=this.props.file.thumbnail_url_tmpl,t="browse-file-row__accessory "+this.props.className,r=(function(e){return function(){return e.setState({hasThumbFailed:!0})}})(this)):(t=e(["sprite","sprite_web","s_web_"+this.props.file.icon,"browse-file-row__accessory",""+this.props.className]),o=a("/static/images/icons/icon_spacer-vflN3BYt2.gif")),i.img({className:t,src:o,onClick:this.props.onClick,onDragStart:this.props.onDragStart,onMouseDown:this.props.onMouseDown,onError:r,alt:""})}}),{FileIcon:n}}),define("modules/clean/react/browse/selection_actions",["require","exports","tslib","external/immutable","external/react","external/classnames","modules/clean/react/browse/models","modules/clean/react/browse/util","modules/clean/react/bubble_menu","modules/clean/em_string","modules/clean/react/sprite","modules/core/i18n","modules/clean/react/browse/file_actions","modules/clean/react/browse/action_logger"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h){"use strict";var m=i.BrowseContext,f=l.BubbleMenu,_=l.BubbleMenuItem,g=h.BrowseLogEventSources;t.BrowseSelectionMenu=s.createClass({displayName:"BrowseSelectionMenu",mixins:[s.addons.PureRenderMixin],propTypes:{context:s.PropTypes.instanceOf(m).isRequired,selectedFiles:s.PropTypes.instanceOf(o.OrderedMap).isRequired,user:s.PropTypes.object.isRequired,onActionButtonClick:s.PropTypes.func,actionHandlers:s.PropTypes.object,isSearchMode:s.PropTypes.bool,handleComponentTTI:s.PropTypes.func,expOverquotaFileActionVariant:s.PropTypes.string},getDefaultProps:function(){return{actionHandlers:{},onActionButtonClick:function(){},isSearchMode:!1,handleComponentTTI:function(){}}},componentDidMount:function(){this.props.handleComponentTTI(this.constructor.displayName)},componentDidUpdate:function(){this.refs.moreActionsBubbleMenu&&this.refs.moreActionsBubbleMenu.hideMenu()},_renderMenuButton:function(e){var t,o=this,i=e.label,a=e.spriteName,l=e.performAction,u=e.href,p=e.ref,d=e.disabled,h=void 0!==d&&d;if(l){var m={ref:p,className:"button-as-link browse-menu__action-button",onClick:function(e){h||(o.props.onActionButtonClick(),l(e))},disabled:!1};h&&(m.disabled=!0),t=s.createElement("button",r.__assign({},m),s.createElement(c,{group:"web",name:a,alt:"",className:"browse-menu__action-button-sprite"}),s.createElement("span",{className:"browse-menu__action-button-label"},i))}else u&&(t=s.createElement("a",{ref:p,className:"browse-menu__action-button",href:u},s.createElement(c,{group:"web",name:a,alt:"",className:"browse-menu__action-button-sprite"}),s.createElement("span",{className:"browse-menu__action-button-label"},i)));var f=n({"browse-menu__action":!0,"browse-menu__action--disabled":h});return s.createElement("li",{key:i,className:f,"data-action":i},t)},_renderMoreActionsDropbdown:function(e){var t=p._("More")+" ",r=s.createElement("button",{className:"button-as-link browse-menu__action-button"},t,s.createElement(c,{group:"web",name:"arrow-down-blue",alt:"",className:"browse-menu__more-dropdown-arrow"})),o=e.map(function(e){var t=e.label,r=e.spriteName,o=e.performAction,n=e.href,i=e.disabled,a=void 0!==i&&i;return s.createElement(_,{href:n,onClick:function(){o&&o()},disabled:a},s.createElement(c,{group:"web",name:r,alt:"",className:"browse-menu__action-button-sprite"}),s.createElement("span",{className:"browse-menu__action-button-label"},t))});return s.createElement("li",{className:"browse-menu__action"},s.createElement(f,{ref:"moreActionsBubbleMenu",targetButton:r,targetFixed:!0,position:f.POSITIONS.BOTTOM_LEFT,items:o}))},render:function(){var e,t=a.describeFiles(this.props.selectedFiles);if(e=1!==this.props.selectedFiles.count()||this.props.selectedFiles.first().is_dir?"":this.props.selectedFiles.first().size,this.props.selectedFiles.isEmpty())return null;for(var r=d.getActionsForFileCollection({files:this.props.selectedFiles,context:this.props.context,user:this.props.user,skipSharing:!0,isSearchMode:this.props.isSearchMode,actionHandlers:this.props.actionHandlers,source:g.LEGACY_HEADER_ACTIONS,expOverquotaFileActionVariant:this.props.expOverquotaFileActionVariant}),o=12*new u(t).length,n=12*new u(e).length,i=800-(o+n+10+20),l=0,c=[],p=0;p<r.length;p++){if(l+=12*new u(r[p].label).length+16+3+8,l>i||p>=6){var h=p-1;c=r.slice(h),r=r.slice(0,h);break}}return s.createElement("div",{className:"c-column-header browse-menu browse-file-list-header"},s.createElement("span",{className:"browse-menu__description"},t),s.createElement("ul",{className:"browse-menu__actions"},r.map(this._renderMenuButton),c.length?this._renderMoreActionsDropbdown(c):null),s.createElement("span",{className:"browse-menu__filesize-label"},e))}})}),define("modules/clean/react/browse/settings_gear_menu",["external/react","external/underscore","modules/clean/react/browse/models","modules/clean/react/bubble_menu","modules/clean/react/sprite"],function(e,t,r,o,s){var n,i,a,l,u,c,p;return n=r.BrowseContext,l=r.File,i=o.BubbleMenu,a=o.BubbleMenuItem,p=e.DOM,c=e.createElement,u=e.createClass({displayName:"settingsGearMenuBubble",propTypes:{alt:e.PropTypes.string.isRequired,browseContext:e.PropTypes.instanceOf(n).isRequired,file:e.PropTypes.instanceOf(l).isRequired,isActionDisabled:e.PropTypes.bool,isShowing:e.PropTypes.bool.isRequired,menuItems:e.PropTypes.arrayOf(e.PropTypes.shape({label:e.PropTypes.string,action:e.PropTypes.func})).isRequired},render:function(){var e,r;return e=p.button({className:"sprite-button bubble-button"},c(s,{group:"web",name:"gear",alt:this.props.alt})),c(i,{position:i.POSITIONS.BOTTOM,targetButton:e,ref:"gearBubbleMenu",items:function(){var e,o,s,n;for(s=this.props.menuItems,n=[],e=0,o=s.length;e<o;e++)r=s[e],n.push(c(a,{onClick:t.partial(r.action,this.props.browseContext,this.props.file),disabled:this.props.isActionDisabled},r.label));return n}.call(this)})}}),{SettingsGearMenuBubble:u}}),define("modules/clean/react/browse/share_button",["require","external/classnames","external/mcl/button","external/react","external/react-dom","modules/clean/css","modules/clean/keycode","modules/clean/react/button","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/sprite","modules/clean/sharing/browse_exports","modules/core/i18n"],function(e,t,r,o,s,n,i,a,l,u,c,p,d){var h,m,f,_,g,b,S,T,w,y;return m=r.Button,i.KeyCode,T=a.button,_=l.FileTypes,h=u.BrowseContext,f=u.File,S=p.asyncShowShareModal,b=d._,y=o.DOM,w=o.createElement,g=o.createClass({displayName:"ShareButton",mixins:[o.addons.PureRenderMixin],propTypes:{browseContext:o.PropTypes.instanceOf(h).isRequired,file:o.PropTypes.instanceOf(f).isRequired,user:o.PropTypes.object.isRequired,isMaestroDesign:o.PropTypes.bool,actionHandlers:o.PropTypes.object},handleClick:function(e){var t,r;if(this.props.browseContext.isNonUserRelativeContext&&this.props.file.type===_.TEAM_SHARED_FOLDER&&null!=(null!=(t=this.props.actionHandlers)?t.onTeamFolderManage:void 0)?null!=(r=this.props.actionHandlers)&&r.onTeamFolderManage(this.props.file):S(this.props.user,this.props.file,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"}),this.props.isMaestroDesign)return e.stopPropagation()},handleDoubleClick:function(e){return e.stopPropagation(),this.handleClick()},render:function(){var e;return e=b(this.props.browseContext.isNonUserRelativeContext?"Manage":"Share"),this.props.isMaestroDesign?w(m,{"aria-label":e,className:"inline-share-button",onClick:this.handleClick,onDoubleClick:this.handleClick,variant:"secondary"},e):w(T,{"aria-label":e,className:t({"c-btn c-btn--tertiary":!0,"inline-button":!0,"inline-share-button":!0,"variant-DROPDOWN":!0,"extra-padding":!0}),onClick:this.handleClick,onDoubleClick:this.handleDoubleClick,ref:"button",importance:"secondary"},y.span({className:"inline-share-button-label"},e))}}),{ShareButton:g}}),define("modules/clean/react/browse/sort_helpers",[],function(){var e,t;return e=function(e,t,r){var o,s,n,i,a,l,u,c;for(o="=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=u=0,c=Math.max(e.length,t.length);0<=c?u<c:u>c;i=0<=c?++u:--u){if(s=e.charAt(i),n=t.charAt(i),!s)return-r;if(!n)return r;if(a=o.indexOf(s),l=o.indexOf(n),a<l)return-r;if(l<a)return r}return 0},t=function(t,r,o){var s,n,i,a,l,u;if(Array.isArray(t)&&Array.isArray(r)){for(a=l=0,u=Math.max(t.length,r.length);0<=u?l<u:l>u;a=0<=u?++l:--l){if(n=t[a],i=r[a],null==n)return-o;if(null==i)return o;if("number"==typeof n&&"string"==typeof i)return-o;if("number"==typeof i&&"string"==typeof n)return o;if("string"==typeof n&&"string"==typeof i){if(s=e(n,i,o),0!==s)return s}else{if(n<i)return-o;if(i<n)return o}}return 0}return t===r?0:t<r?-o:o},{compare:t}});var extend=function(e,t){function r(){this.constructor=e}for(var o in t)hasProp.call(t,o)&&(e[o]=t[o]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/store",["external/immutable","modules/core/browser","modules/core/exception","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/pagelet_logger","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/columnheader","modules/clean/react/selectable_list","modules/constants/subgrowth_experiments"],function(e,t,r,o,s,n,i,a,l,u,c,p){var d,h,m,f,_,g,b,S,T,w,y,assert,v,E;return assert=r.assert,T=n.PageletLogger,d=i.BrowseActionTypes,m=i.BrowseSortField,g=i.FileTypes,b=i.LoadingStates,S=i.NewFolderCreationState,w=i.RenameStates,h=a.BrowseContext,_=a.File,v=l.compare,y=u.SortDirections,E=c.createSelection,f=(function(r){function s(){return s.__super__.constructor.apply(this,arguments)}return extend(s,r),s.prototype._init=function(){return this._unsortedFiles=e.Map(),this._sortedFiles=e.List(),this._teamFolders=e.List(),this._path="",this._user=null,this._urlPrefix="",this._selection=E(),this._loadingState=b.LOADING_FIRST_PAGE,this._context=new h,this._mountPoints=null,this._shouldShowDeletedFiles=!1,this._activeDropTarget=null,this._inCopyMode=!1,this._clipboardFiles=e.OrderedMap(),this._currentSort={sortField:m.FILENAME,sortDirection:y.ASCENDING},this._fileRename=null,this._newFolderCreationState=S.CREATE_FOLDER_INACTIVE,this._filePathsToSelectOnNextUpdate=e.Set(),this._activeFileJumpFilter="",this._fileJumpIndex=[],this._activeTab=void 0,this._browseLogger=null,this._contextFile=null},s.prototype.contextFile=function(){return this._contextFile},s.prototype.files=function(){return this._sortedFiles},s.prototype.filesMap=function(){return this._unsortedFiles},s.prototype.filesWithoutTeamFolders=function(){return this._sortedFiles.filter(function(e){return e.type!==g.TEAM_SHARED_FOLDER})},s.prototype.teamFolders=function(){var e;return"ON"===p.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP1||"V1"===(e=p.SUBGROWTH_BIZ_TRIAL_ONBOARDING_EXP2)||"V2"===e?this._sortedFiles.filter(function(e){return e.type===g.TEAM_SHARED_FOLDER}):this._teamFolders},s.prototype.path=function(){return this._path},s.prototype.user=function(){return this._user},s.prototype.urlPrefix=function(){return this._urlPrefix},s.prototype.selection=function(){return this._selection},s.prototype.selectedFiles=function(){var t;return t=this._sortedFiles.filter((function(e){return function(t){return e._selection.selected.has(t.fq_path)}})(this)),e.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},s.prototype.activeTab=function(){return this._activeTab},s.prototype.loadingState=function(){return this._loadingState},s.prototype.context=function(){return this._context},s.prototype.mountPoints=function(){return this._mountPoints},s.prototype.shouldShowDeletedFiles=function(){return this._shouldShowDeletedFiles},s.prototype.activeDropTarget=function(){return this._activeDropTarget},s.prototype.currentSort=function(){return this._currentSort},s.prototype.getIndexOfFile=function(e){return this._sortedFiles.findIndex(function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id})},s.prototype.getFileByFilename=function(e){return this._sortedFiles.find(function(t){return o.filename(t.fq_path)===e})||null},s.prototype.getFileByFullPath=function(e){return this._sortedFiles.find(function(t){return t.fq_path===e})||null},s.prototype.inCopyMode=function(){return this._inCopyMode},s.prototype.clipboardFiles=function(){return this._clipboardFiles},s.prototype.fileRename=function(){return this._fileRename},s.prototype.newFolderCreationState=function(){return this._newFolderCreationState},s.prototype.isFileJumping=function(){return this._activeFileJumpFilter.length>0},s.prototype.browseLogger=function(){if(null!=this._browseLogger)return this._browseLogger},s.prototype._initializeEverything=function(t){var r,o,s,n,i,a,l,u,c,p;return p=t.user,a=t.path,o=t.files,c=t.urlPrefix,r=t.context,i=t.mountPoints,s=t.fqPathsToSelect,n=t.loadingState,l=t.shouldShowDeletedFiles,u=t.teamFolders,this._user=p,this._path=a,this._urlPrefix=c,this._appendFiles({path:a,files:o},!1),this._context=r,this._mountPoints=e.Map(i),this._loadingState=n,this._setTeamFolders({teamFolders:u}),n===b.LOADED?this.selectFqPaths({fqPathsToSelect:s},!1):this._filePathsToSelectOnNextUpdate=e.Set(s),this._shouldShowDeletedFiles=Boolean(l),this.emit_change()},s.prototype._setUser=function(e){var t;if(t=e.user,null==this.user())return this._user=t},s.prototype.initBrowseLogger=function(e,t){if(null==this._browseLogger)return this._browseLogger=new T("browse",e,!0,t)},s.prototype.isPathEqualsTo=function(e){return!(e&&"/"!==e||this._path&&"/"!==this._path)||e===this._path},s.prototype.componentReadyForTTI=function(e){if(null!=this._browseLogger)return this._browseLogger.componentReady(e)},s.prototype._setPathData=function(e){var t,r,s;if(s=e.path,r=e.files,t=e.context,o.paths_are_equal(s,this._path))return this._unsortedFiles=this._unsortedFiles.clear(),this._sortedFiles=this._sortedFiles.clear(),this._selection=E(),this._appendFiles({path:s,files:r},!1),this._context=t,this.emit_change()},s.prototype._appendFiles=function(t,r){var s,n,i,a,l,u,c;if(c=t.path,n=t.files,null==r&&(r=!0),o.paths_are_equal(c,this._path)){for(i=[],a=[],l=0,u=n.length;l<u;l++)s=n[l],s instanceof _||(s=_.fromServerObject(s)),i.push([s.fq_path,s]),this._unsortedFiles.has(s.fq_path)||a.push(s);return this._unsortedFiles=this._unsortedFiles.merge(i),this._sortedFiles=this._sortedFiles.concat(e.List(a)),assert(this._unsortedFiles.size===this._sortedFiles.size,"appendFiles ended up with mismatched data structures"),this._sortFiles(this._currentSort,!1),this._filePathsToSelectOnNextUpdate.count()&&this.selectFqPaths({fqPathsToSelect:this._filePathsToSelectOnNextUpdate.toArray()},!1),this._buildFileJumpIndex(),
r?this.emit_change():void 0}},s.prototype._applyFileDeltas=function(t){var r,s,n,i,a,l,u,c;if(l=t.path,n=t.fileDeltas,o.paths_are_equal(l,this._path)){for(i=0,a=n.length;i<a;i++)c=n[i],s=c.before,r=c.after,this._applyFileDelta({before:s,after:r,pathForDelta:l});return this._filePathsToSelectOnNextUpdate.size&&(u=this.selectFqPaths({fqPathsToSelect:this._filePathsToSelectOnNextUpdate.toArray()},!1),u.size===this._filePathsToSelectOnNextUpdate.size&&(this._filePathsToSelectOnNextUpdate=e.Set())),assert(this._unsortedFiles.size===this._sortedFiles.size,"applyFileDeltas ended up with mismatched file collections (map vs. sorted list)"),this._sortFiles(this._currentSort,!1),this._buildFileJumpIndex(),this.emit_change()}},s.prototype._applyTeamFolderDowngrade=function(e){var t,r,o;return o=this.mountPoints().get(e),r=this.filesMap().get(o),null!=r&&(t=r.merge({icon:"folder_user_32",type:g.SHARED_FOLDER}),this._replaceFile({existingFile:r,newFile:t})),this.emit_change()},s.prototype._setPath=function(e){var t;return t=e.path,this._path=t,this.emit_change()},s.prototype._setUrlPrefix=function(e){var t;return t=e.prefix,this._urlPrefix=t,this.emit_change()},s.prototype._setLoadingState=function(t){var r,s;if(s=t.path,r=t.loadingState,o.paths_are_equal(s,this._path))return this._loadingState=r,r===b.LOADED&&(this._filePathsToSelectOnNextUpdate=e.Set()),this.emit_change()},s.prototype._setMountPoints=function(t){var r;return r=t.mountPoints,this._mountPoints=e.Map(r)},s.prototype._setTeamFolders=function(t){var r,o;return o=t.teamFolders,this._teamFolders=e.List((function(){var e,t,s,n;for(s=o||[],n=[],e=0,t=s.length;e<t;e++)r=s[e],n.push(_.fromServerObject(r));return n})())},s.prototype._setSelection=function(e){var t;return t=e.selection,this._selection=t,this.emit_change()},s.prototype.selectFqPaths=function(t,r){var o,s,n,i,a,l;return n=t.fqPathsToSelect,null==r&&(r=!0),i=n.map(function(e){return e.toLowerCase()}),s=this._sortedFiles.filter(function(e){var t;return t=e.fq_path.toLowerCase(),indexOf.call(i,t)>=0}),a=s.map(function(e){return e.fq_path}),l=this._selection.set("selected",e.OrderedSet(a)),o=a.size?a.get(0):null,l=l.set("anchor",o),this._selection=l,r&&this.emit_change(),a},s.prototype._setActiveTab=function(e){var t;return t=e.tabName,this._activeTab=t,this.emit_change()},s.prototype._setShouldShowDeletedFiles=function(e){var t;return t=e.shouldShowDeletedFiles,this._shouldShowDeletedFiles=Boolean(t),this.emit_change()},s.prototype._setDropTarget=function(e){var t;return t=e.target,this._activeDropTarget=t,this.emit_change()},s.prototype._setCopyMode=function(e){var t;return t=e.copyMode,this._inCopyMode=t,this.emit_change()},s.prototype._sortFiles=function(e,r){var o,s,n,i,a,l,u,c,p,d;if(d=e.sortField,p=e.sortDirection,null==r&&(r=!0),c=p===y.ASCENDING?1:-1,l=!this._context.isNonUserRelativeContext,i=function(e,t){var r,s,n,i,a;return r=e.value,s=e.isTMF,n=t.value,i=t.isTMF,a=o(s,i),a||v(r,n,c)},n=function(e,t){var r,s,n,i,a,l,u;return s=e.isFolder,r=e.value,n=e.isTMF,a=t.isFolder,i=t.value,l=t.isTMF,u=o(n,l),u?u:s&&a?v(r,i,c):s?-c:a?c:v(r,i,c)},s=function(e,t){var r,s,n,i,a,l,u;return s=e.isFolder,r=e.value,n=e.isTMF,a=t.isFolder,i=t.value,l=t.isTMF,u=o(n,l),u?u:s&&a?v(r,i,c):s?1:a?-1:""===r?1:""===i?-1:v(r,i,c)},o=function(e,t){if(l){if(e)return-1;if(t)return 1}},u=d===m.FILENAME||d===m.SHARED_WITH,u?(a=t.mac?i:n,this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:e.sort_key,isTMF:_.isTeamMemberFolder(e)}},a)):d===m.MODIFIED?this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:e.ts,isTMF:_.isTeamMemberFolder(e)}},s):d===m.CATEGORY?this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:_.getCategoryDescription(e),isTMF:_.isTeamMemberFolder(e)}},s):d===m.EXTENSION?this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:_.getExtension(e),isTMF:_.isTeamMemberFolder(e)}},s):d===m.SIZE&&(this._sortedFiles=this._sortedFiles.sortBy(function(e){return{isFolder:e.is_dir,value:-e.bytes,isTMF:_.isTeamMemberFolder(e)}},s)),this._currentSort={sortField:d,sortDirection:p},r)return this.emit_change()},s.prototype._setClipboardToSelectedFiles=function(){return this._clipboardFiles=this.selectedFiles(),this.emit_change()},s.prototype._updateContextFile=function(e){return this._contextFile=e,this.emit_change()},s.prototype._updateRenameState=function(e,t){var r;return t?(r=Object.keys(w).map(function(e){return w[e]}),assert(indexOf.call(r,t)>=0,"_updateRenameState received: "+t+", but expected one of: "+r),this._fileRename=Object.freeze({file:e,state:t})):this._fileRename=null,this.emit_change()},s.prototype._setNewFolderCreationState=function(e){return this._newFolderCreationState=e,this.emit_change()},s.prototype.setFilePathsToSelectOnNextUpdate=function(t){var r,o;return r=null!=(o=t.fqPathsToSelect)?o:[],this._filePathsToSelectOnNextUpdate=e.Set(r)},s.prototype._addCommentStatusBatch=function(e){var t;return t=e.commentStatusByFqPath,Object.keys(t).map((function(e){return function(r){var o,s;if(o=e._unsortedFiles.get(r),null!=o)return s=o.merge(t[r]),e._insertOrUpdateFile({file:s,forceUpdate:!0})}})(this)),this.emit_change()},s.prototype._addFileJumpKeyCode=function(e){var t,r,o,s,n,i,a,l;for(n=e.keyChar,this._activeFileJumpFilter+=n.toLowerCase(),o=null,a=this._fileJumpIndex,s=0,i=a.length;s<i;s++)if(l=a[s],r=l.fqPath,t=l.filename,t>=this._activeFileJumpFilter){o=r;break}if(null!=o)return this.selectFqPaths({fqPathsToSelect:[o]})},s.prototype._resetFileJump=function(){return this._activeFileJumpFilter=""},s.prototype._buildFileJumpIndex=function(){return this._fileJumpIndex=this._unsortedFiles.keySeq().toArray().map(function(e){var t;return t=o.filename(e).toLowerCase(),{filename:t,fqPath:e}}),this._fileJumpIndex.sort(function(e,t){var r,o;return r=e.filename,o=t.filename,r<o?-1:r>o?1:0})},s.prototype._applyFileDelta=function(e){var t,r,s,n;if(r=e.before,t=e.after,n=e.pathForDelta,t&&!o.paths_are_equal(o.parent_dir(t.fq_path),n)&&(t=null),t!==r&&(s=t&&this._unsortedFiles.get(t.fq_path),!(s&&s.sjid>=t.sjid)))return t&&r?this._replaceFile({existingFile:r,newFile:t}):t&&!r?this._insertOrUpdateFile({file:t}):r&&!t?this._removeFile({file:r}):void 0},s.prototype._insertOrUpdateFile=function(e){var t,r,o,s,n,i,a,l;return s=e.file,n=null!=(a=e.forceUpdate)&&a,this._unsortedFiles=this._unsortedFiles.set(s.fq_path,s),i=s.fq_path.toLowerCase(),t=function(e){return e.fq_path.toLowerCase()===i},l=this._sortedFiles.findEntry(t)||[null,null],o=l[0],r=l[1],r?n||s.sjid>r.sjid?this._sortedFiles=this._sortedFiles.set(o,s):void 0:this._sortedFiles=this._sortedFiles.push(s)},s.prototype._removeFile=function(e){var t,r;return t=e.file,assert(this._unsortedFiles.has(t.fq_path),"trying to remove a file that doesn't exist in the file map"),r=this._sortedFiles.indexOf(t),assert(r!==-1,"tried to remove file that doesn't exist in the sorted file list"),this._unsortedFiles=this._unsortedFiles.delete(t.fq_path),this._sortedFiles=this._sortedFiles.delete(r)},s.prototype._replaceFile=function(e){var t,r,o,s;return t=e.existingFile,o=e.newFile,assert(this._unsortedFiles.has(t.fq_path),"tried to replace file, but previous file doesn't exist in map"),r=this._sortedFiles.indexOf(t),assert(r!==-1,"tried to update file, but previous file doesn't exist in sorted list"),t.fq_path===o.fq_path?(this._sortedFiles=this._sortedFiles.set(r,o),this._unsortedFiles=this._unsortedFiles.set(t.fq_path,o)):(this._sortedFiles=this._sortedFiles.delete(r),this._unsortedFiles=this._unsortedFiles.delete(t.fq_path),this._unsortedFiles=this._unsortedFiles.set(o.fq_path,o),this._sortedFiles=this._sortedFiles.push(o),(null!=(s=this._fileRename)?s.state:void 0)===w.SAVING_INPUT?(this._updateRenameState(t,null),this.selectFqPaths({fqPathsToSelect:[o.fq_path]})):void 0)},s.prototype._new_payload=function(e){switch(e.action.type){case d.INITIALIZE_EVERYTHING:return this._initializeEverything(e.action.data);case d.LOAD_PATH:return this._setPathData(e.action.data);case d.ADD_FILES:return this._appendFiles(e.action.data);case d.ADD_FILES_AND_SET_LOADING_STATE:return this._appendFiles(e.action.data,!1),this._setLoadingState(e.action.data);case d.SET_PATH:return this._setPath(e.action.data);case d.SET_USER:return this._setUser(e.action.data);case d.SET_URL_PREFIX:return this._setUrlPrefix(e.action.data);case d.CHANGE_FILES:return this._applyFileDeltas(e.action.data);case d.OPEN_PREVIEW:return this._setPreviewFile(e.action.data);case d.CLOSE_PREVIEW:return this._setPreviewFile(e.action.data);case d.SET_ACTIVE_TAB:return this._setActiveTab(e.action.data);case d.SET_SELECTION:return this._setSelection(e.action.data);case d.SELECT_FILES_BY_FQ_PATH:return this.selectFqPaths(e.action.data);case d.SET_LOADING_STATE:return this._setLoadingState(e.action.data);case d.SET_SEARCH_ACTIVE:return this._setSearchActive(e.action.data);case d.SET_MOUNT_POINTS:return this._setMountPoints(e.action.data);case d.SET_TEAM_FOLDERS:return this._setTeamFolders(e.action.data);case d.SET_SHOULD_SHOW_DELETED_FILES:return this._setShouldShowDeletedFiles(e.action.data);case d.SET_DROP_TARGET:return this._setDropTarget(e.action.data);case d.SET_COPY_MODE:return this._setCopyMode(e.action.data);case d.COPY_SELECTED_FILES_TO_CLIPBOARD:return this._setClipboardToSelectedFiles();case d.SORT_FILES:return this._sortFiles(e.action.data);case d.REQUEST_NEW_FILE_NAME:return this._updateRenameState(e.action.data.file,w.PENDING_INPUT);case d.SET_FILE_RENAME_PENDING:return this._updateRenameState(e.action.data.file,w.SAVING_INPUT);case d.SET_FILE_RENAME_COMPLETE:case d.CANCEL_FILE_RENAME:return this._updateRenameState(e.action.data.file,null);case d.REQUEST_FOLDER_NAME:return this._setNewFolderCreationState(S.PENDING_INPUT);case d.CREATE_FOLDER_PENDING:return this._setNewFolderCreationState(S.SAVING_INPUT);case d.CREATE_FOLDER_COMPLETE:case d.CANCEL_CREATE_FOLDER:return this._setNewFolderCreationState(S.CREATE_FOLDER_INACTIVE);case d.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return this.setFilePathsToSelectOnNextUpdate(e.action.data);case d.TEAM_FOLDER_DOWNGRADE:return this._applyTeamFolderDowngrade(e.action.data.nsId);case d.ADD_COMMENT_STATUS_BATCH:return this._addCommentStatusBatch(e.action.data);case d.ADD_FILE_JUMP_KEY_CODE:return this._addFileJumpKeyCode(e.action.data);case d.RESET_FILE_JUMP:return this._resetFileJump();case d.SET_CONTEXT_FILE:return this._updateContextFile(e.action.data.file)}},s})(s),{BrowseStore:new f}}),define("modules/clean/react/browse/tile_label_name_input",["require","exports","tslib","external/react","modules/clean/react/browse/name_input"],function(e,t,r,o,s){"use strict";var n=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation()},t}return r.__extends(t,e),t.prototype.render=function(){return o.createElement(s.NameInput,{defaultValue:this.props.defaultValue,label:this.props.label,onSubmit:this.props.handleSubmit,onCancel:this.props.handleCancel,onClick:this.handleClick,className:"tile-label-input "+this.props.className})},t})(o.PureComponent);t.TileItemLabelInput=n}),define("modules/clean/react/browse/util",["require","exports","modules/clean/react/browse/models","modules/clean/em_string","modules/clean/filepath","modules/core/i18n"],function(e,t,r,o,s,n){"use strict";function i(e){if(1===e.count()){var t=e.first(),r=s.filename(t.fq_path);return o.em_snippet(r,13.5)}if(e.count()>1){var i=function(e){return e.isDeleted},a=e.some(i)&&!e.every(i),l=e.toArray().filter(function(e){return e.is_dir}),u=e.toArray().filter(function(e){return!e.is_dir});if(a)return n._("No available actions");var c=[];if(u.length){var p=n.ungettext("%(num_files)d file","%(num_files)d files",u.length).format({num_files:u.length});c.push(p)}if(l.length){var p=n.ungettext("%(num_folders)d folder","%(num_folders)d folders",l.length).format({num_folders:l.length});c.push(p)}return 2===c.length?n._("%(x)s and %(y)s",{comment:'\n            The whole string is a phrase like "2 files and 3 folders". \'x\' is\n            a string containing a phrase like "2 files" and \'y\' is a string\n            containing a phrase like "3 folders".\n          '}).format({x:c[0],y:c[1]}):c[0]}return""}function a(e,t){var o=e.count(),s=n._("You only have partial access");return o>0?1!==o||r.File.canViewFileMembers(e.first(),t)?n.ungettext("%(count)d item selected","%(count)d items selected",o).format({count:o}):r.File.isNoAccessSharedFolder(e.first())?n._("You don’t have access to this folder"):s:t&&!t.canViewContainingNSMembers?s:""}t.describeFiles=i,t.getSelectedFilesText=a}),define("modules/clean/react/content_manager/path_util",["require","exports","modules/clean/sharing/gating_util"],function(e,t,r){"use strict";function o(e){return r.GoldenGate.hasContentManagerCdm(e)?"/team/admin/content":"/team/admin/team_folders"}t.getBasePrefix=o}),define("modules/clean/react/context_menu_v2",["jquery","external/immutable","external/keymaster","external/classnames","external/react","external/react-dom","external/underscore","modules/clean/keycode","modules/clean/react/css","modules/clean/react/sprite_div","modules/core/browser","modules/core/dom","modules/clean/react/browse/constants"],function(e,t,r,o,s,n,i,a,l,u,c,p,d){var h,m,f,_,g,b,S,T,w,y;return b=a.KeyCode,S=d.MouseEventButton,w=s.createElement,y=s.DOM,T="",f=t.Record({icon:null,text:"",shouldShow:!0,isDisabled:!1,onClick:i.noop,href:null,subMenuItems:null}),g=s.createClass({displayName:"GlobalContextMenu",propTypes:{alwaysOpenOnCapture:s.PropTypes.bool,ignoreSelectors:s.PropTypes.string,items:s.PropTypes.arrayOf(s.PropTypes.instanceOf(f)),onMenuOpen:s.PropTypes.func,onMenuClose:s.PropTypes.func},getDefaultProps:function(){return{alwaysOpenOnCapture:!1,ignoreSelectors:"a, input, button, textarea, select",onMenuOpen:i.noop,onMenuClose:i.noop}},getInitialState:function(){return{isMenuOpen:!1}},componentDidMount:function(){return e(document).on("contextmenu.GlobalContextMenu",(function(t){return function(r){return 0===e(r.target).closest(t.props.ignoreSelectors).size()?t.toggleMenu(r):t.closeMenu()}})(this)),e(document).on("click.GlobalContextMenu",(function(t){return function(r){if(r.button!==S.RIGHT&&0===e(r.target).closest(".context-menu").size())return t.closeMenu()}})(this))},componentWillUnmount:function(){return e(document).off(".GlobalContextMenu")},openMenuAtPosition:function(e,t,r){return this.setState({isMenuOpen:!0,left:e,top:t}),this.props.onMenuOpen(r)},closeMenu:function(){if(this.state.isMenuOpen)return this.setState({isMenuOpen:!1}),this.props.onMenuClose()},toggleMenu:function(e){if(!e.shiftKey)return e.preventDefault(),this.state.isMenuOpen&&!this.props.alwaysOpenOnCapture?this.closeMenu():this.openMenuAtPosition(e.clientX,e.clientY,e)},render:function(){return y.span({},this.state.isMenuOpen?w(_,{initialLeft:this.state.left,initialTop:this.state.top,onMenuClose:this.closeMenu,items:this.props.items,ref:"contextMenu"}):void 0)}}),m=s.createClass({displayName:"ContextMenuHandler",propTypes:{alwaysOpenOnCapture:s.PropTypes.bool,className:s.PropTypes.string,items:s.PropTypes.arrayOf(s.PropTypes.instanceOf(f)),onMenuBlur:s.PropTypes.func,onMenuOpen:s.PropTypes.func,onMenuClose:s.PropTypes.func},getDefaultProps:function(){return{onMenuBlur:i.noop,onMenuOpen:i.noop,onMenuClose:i.noop,alwaysOpenOnCapture:!1}},getInitialState:function(){return{isMenuOpen:!1}},componentDidMount:function(){return e(document).on("click.ContextMenuHandler",(function(t){return function(r){if(r.button!==S.RIGHT&&0===e(r.target).closest(".context-menu").size())return t.closeMenu()}})(this))},componentWillUnmount:function(){return e(document).off(".ContextMenuHandler")},openMenuAtPosition:function(e,t,r){return this.setState({isMenuOpen:!0,left:e,top:t}),this.props.onMenuOpen(r)},closeMenu:function(){return this.setState({isMenuOpen:!1}),this.props.onMenuClose()},toggleMenu:function(e){if(!e.shiftKey)return e.preventDefault(),this.state.isMenuOpen&&!this.props.alwaysOpenOnCapture?this.closeMenu():this.openMenuAtPosition(e.clientX,e.clientY,e)},render:function(){return y.span({className:this.props.className},this.state.isMenuOpen?w(_,{initialLeft:this.state.left,initialTop:this.state.top,onMenuBlur:this.props.onMenuBlur,onMenuClose:this.closeMenu,items:this.props.items,ref:"contextMenu"}):void 0,y.span({"aria-haspopup":!0,className:"context-menu-target",onContextMenuCapture:this.toggleMenu,ref:"contextMenuTarget"},this.props.children))}}),h=s.createClass({displayName:"ContextMenu",propTypes:{initialLeft:s.PropTypes.number,initialTop:s.PropTypes.number,items:s.PropTypes.arrayOf(s.PropTypes.instanceOf(f)),onMenuBlur:s.PropTypes.func,onMenuClose:s.PropTypes.func,onCurrentMenuClose:s.PropTypes.func,level:s.PropTypes.number,shouldAutoSelect:s.PropTypes.bool},getDefaultProps:function(){return{initialLeft:null,initialTop:null,items:null,onMenuBlur:i.noop,onMenuClose:i.noop,onCurrentMenuClose:i.noop,level:0,shouldAutoSelect:!1}},getInitialState:function(){return{selectedIndex:null,left:null,right:null,isSubMenuOpen:!1}},componentWillMount:function(){return this.setState({left:this.props.initialLeft,top:this.props.initialTop})},componentDidMount:function(){if(T=r.getScope(),r.setScope("ContextMenu"),this.updateCoordinates(),n.findDOMNode(this.refs.contextMenu).focus(),this.props.shouldAutoSelect)return this._selectNextItem()},componentDidUpdate:function(e){if(e.items!==this.props.items||e.initialLeft!==this.props.initialLeft||e.initialTop!==this.props.initialTop)return this.setState({selectedIndex:null}),this.updateCoordinates(),n.findDOMNode(this.refs.contextMenu).focus()},componentWillUnmount:function(){return r.setScope(T)},_getReachableIndices:function(){var e,t,r,o,s,n;for(s=[],n=this.props.items,e=r=0,o=n.length;r<o;e=++r)t=n[e],t.shouldShow&&!t.isDisabled&&s.push(e);return s},_selectNextItem:function(){var e,t;if(e=this._getReachableIndices(),t=null!=this.state.selectedIndex?(e.indexOf(this.state.selectedIndex)+1)%e.length:0,null!=t)return this.selectItem(e[t])},_selectPreviousItem:function(){var e,t;if(e=this._getReachableIndices(),t=null!=this.state.selectedIndex?(e.indexOf(this.state.selectedIndex)+e.length-1)%e.length:e.length-1,null!=t)return this.selectItem(e[t])},_handleKeyDown:function(e){var t,r,o,s,n,i,a,l;if(!this.state.isSubMenuOpen)switch(e.keyCode){case b.TAB:return e.preventDefault(),e.stopPropagation();case b.ESC:return this.props.onMenuClose();case b.SPACE:case b.ENTER:if(null!=this.state.selectedIndex)return a=this.props.items[this.state.selectedIndex],this.clickItem(a,e),this.openSubMenu(a,!0),e.preventDefault(),e.stopPropagation();break;case b.DOWN:return this._selectNextItem(),e.preventDefault(),e.stopPropagation();case b.UP:return this._selectPreviousItem(),e.preventDefault(),e.stopPropagation();case b.RIGHT:if(null!=this.state.selectedIndex)return this.openSubMenu(this.props.items[this.state.selectedIndex],!0);break;case b.LEFT:if(this.props.level>0)return this.props.onCurrentMenuClose(),e.preventDefault(),e.stopPropagation();break;default:for(l=String.fromCharCode(e.keyCode),n=this.props.items,i=[],t=o=0,s=n.length;o<s;t=++o)if(r=n[t],r.shouldShow&&!r.isDisabled){if(r.text[0].toUpperCase()===l){this.selectItem(t),e.preventDefault(),e.stopPropagation();break}i.push(void 0)}return i}},openSubMenu:function(e,t){var r;if((null!=(r=e.subMenuItems)?r.length:void 0)>0)return this.setState({isSubMenuOpen:!0,shouldAutoSelectSubMenu:t})},closeSubMenu:function(){return n.findDOMNode(this.refs.contextMenu).focus(),this.setState({isSubMenuOpen:!1})},selectItemWithMouse:function(e){return n.findDOMNode(this.refs.contextMenu).focus(),this.selectItem(e,!0,!1)},selectItem:function(e,t,r){if(this.setState({selectedIndex:e}),t)return this.openSubMenu(this.props.items[e],r)},clickItem:function(e,t){if(null==e.subMenuItems&&!e.isDisabled)return null!=e.href?c.redirect(e.href):e.onClick(t),this.props.onMenuClose()},updateCoordinates:function(){var t,r,o,s,i,a,l,u;return t=this.props.initialLeft,l=this.props.initialTop,null!=t&&null!=l&&null!=this.refs.contextMenu&&(u=p.viewport_dimensions(),a=15,i=e(n.findDOMNode(this.refs.contextMenu)).width(),s=e(n.findDOMNode(this.refs.contextMenu)).height(),r=u.width-a-i,t>r&&(t=r),o=u.height-a-s,l>o&&(l=o)),this.setState({left:t,top:l})},getSelectedItemDomId:function(){return null!=this.state.selectedIndex?"contextMenu"+this.props.level+"-item"+this.state.selectedIndex:""},_renderItem:function(e,t){var r,s,n,i,a;return n=this.state.selectedIndex===t,s=(null!=(a=e.subMenuItems)?a.length:void 0)>0,i="contextMenu"+this.props.level+"-item"+t,r={"context-menu-item":!0,"context-menu-item--has-submenu":s,"context-menu-item--selected":n,"context-menu-item--disabled":e.isDisabled},y.li({key:i,id:i,"data-action":e.text,className:o(r),role:"menuitem","aria-haspopup":s,"aria-disabled":e.isDisabled,onMouseEnter:(function(r){return function(){return e.isDisabled?r.setState({selectedIndex:null}):r.selectItemWithMouse(t)}})(this),onClick:(function(t){return function(r){return t.clickItem(e,r)}})(this)},null!=e.icon?w(u,{group:e.icon.group,name:e.icon.name,alt:"",text:e.text}):y.span({},e.text),s?y.span({className:"context-menu-item__accessory c-arrow--right"}):void 0,s&&n&&this.state.isSubMenuOpen?w(h,{initialLeft:null,initialTop:null,className:"context-menu--secondary",level:this.props.level+1,items:e.subMenuItems,onMenuClose:this.props.onMenuClose,onCurrentMenuClose:this.closeSubMenu,shouldAutoSelect:this.state.shouldAutoSelectSubMenu}):void 0)},render:function(){var e,t,r;return null!=this.state.left&&null!=this.state.top&&(r={left:this.state.left,top:this.state.top}),y.ul({id:"contextMenu"+this.props.level,ref:"contextMenu",className:o("no-padding","bubble-dropdown","context-menu",this.props.className),style:r,role:"menu",tabIndex:-1,"aria-activedescendant":this.getSelectedItemDomId(),onBlur:this.props.onMenuBlur,onKeyDown:this._handleKeyDown},function(){var r,o,s,n;for(s=this.props.items,n=[],e=r=0,o=s.length;r<o;e=++r)t=s[e],t.shouldShow&&n.push(this._renderItem(t,e));return n}.call(this))}}),_=l(h,["/static/css/components/bubble_dropdown-vflTPbDJ3.css","/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]),{GlobalContextMenu:g,ContextMenuHandler:m,ContextMenu:h,ContextMenuItem:f}}),define("modules/clean/react/file_uploader/constants",["require","exports","modules/core/browser"],function(e,t,r){"use strict";t.UploaderActionTypes={SET_PATH:"UPLOADER_SET_PATH",SET_USER:"UPLOADER_SET_USER",SET_NUM_DRAGGING_FILES:"SET_NUM_DRAGGING_FILES",QUEUE_UPLOADS:"QUEUE_UPLOADS",START_UPLOAD:"START_UPLOAD",COMPLETE_UPLOAD:"COMPLETE_UPLOAD",CANCEL_UPLOADS:"CANCEL_UPLOADS",SET_CURRENT_UPLOAD_PROGRESS:"SET_CURRENT_UPLOAD_PROGRESS",UPLOAD_ERROR:"UPLOAD_ERROR",SET_IS_UPLOAD_MODAL_OPEN:"SET_IS_UPLOAD_MODAL_OPEN",SET_IS_INLINE_STATUS_DISMISSED:"SET_IS_INLINE_STATUS_DISMISSED",ADD_NEW_FAILED_FILE:"ADD_NEW_FAILED_FILE"},t.FileStatus={PENDING:"PENDING",UPLOADING:"UPLOADING",COMPLETE:"COMPLETE",CANCELLED:"CANCELLED",FAILED:"FAILED"},t.UploadErrorType={FILE_SIZE_ERROR:"FILE_SIZE_ERROR",HTTP_ERROR:"HTTP_ERROR",CONNECTION_ERROR:"CONNECTION_ERROR",OVER_QUOTA_ERROR:"OVER_QUOTA_ERROR",IGNORED:"IGNORED",EMPTY_OR_FOLDER:"EMPTY_OR_FOLDER",PACKAGE_FILE:"PACKAGE_FILE",GENERIC:"GENERIC"},t.INTERNAL_FILE_DATA_TRANSFER_TYPE=r.msie?"text":"application/x-dropbox-file-list"});var extend=function(e,t){function r(){this.constructor=e}for(var o in t)hasProp.call(t,o)&&(e[o]=t[o]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;define("modules/clean/react/file_uploader/store",["external/immutable","modules/clean/base64","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/browse/constants","modules/clean/react/browse/store","modules/core/browser","modules/core/exception"],function(e,t,r,o,s,n,i,a){var l,u,c,p,d,h,m,assert,f,reportStack;return l=s.BrowseActionTypes,u=n.BrowseStore,assert=a.assert,reportStack=a.reportStack,h={SET_PATH:"UPLOADER_SET_PATH",SET_USER:"UPLOADER_SET_USER",SET_NUM_DRAGGING_FILES:"SET_NUM_DRAGGING_FILES",QUEUE_UPLOADS:"QUEUE_UPLOADS",START_UPLOAD:"START_UPLOAD",COMPLETE_UPLOAD:"COMPLETE_UPLOAD",CANCEL_UPLOADS:"CANCEL_UPLOADS",SET_CURRENT_UPLOAD_PROGRESS:"SET_CURRENT_UPLOAD_PROGRESS",UPLOAD_ERROR:"UPLOAD_ERROR",SET_IS_UPLOAD_MODAL_OPEN:"SET_IS_UPLOAD_MODAL_OPEN",SET_IS_INLINE_STATUS_DISMISSED:"SET_IS_INLINE_STATUS_DISMISSED",ADD_NEW_FAILED_FILE:"ADD_NEW_FAILED_FILE"},c={PENDING:"PENDING",UPLOADING:"UPLOADING",COMPLETE:"COMPLETE",CANCELLED:"CANCELLED",FAILED:"FAILED"},d={FILE_SIZE_ERROR:"FILE_SIZE_ERROR",HTTP_ERROR:"HTTP_ERROR",CONNECTION_ERROR:"CONNECTION_ERROR",OVER_QUOTA_ERROR:"OVER_QUOTA_ERROR",IGNORED:"IGNORED",EMPTY_OR_FOLDER:"EMPTY_OR_FOLDER",PACKAGE_FILE:"PACKAGE_FILE",GENERIC:"GENERIC"},p=e.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:c.PENDING,errorType:d.GENERIC,errorMessage:""}),f=function(){var e,r,o;for(e="",r=0;r<=15;++r)e+=String.fromCharCode(Math.floor(256*Math.random()));return o=t.encode(e),o=o.replace(/\+/g,"-"),o=o.replace(/\//g,"_"),o=o.replace(/\=*$/,"")},m=(function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return extend(o,t),o.prototype._init=function(){return this._path="/",this._hasPermissionToUploadToFolder=!0,this._user=null,this._fileList=e.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._isInlineStatusDismissed=!1,this._numSecondsLeft=0},o.prototype.fileList=function(){return this._fileList},o.prototype.currentUpload=function(){return this._fileList.get(this._currentUploadId)},o.prototype.currentUploadPercentage=function(){return this.currentUpload().percentUploaded},o.prototype.numSecondsLeft=function(){return this._numSecondsLeft},o.prototype.isUploadCancelled=function(e){var t;return(null!=(t=this._fileList.get(e))?t.status:void 0)===c.CANCELLED},o.prototype.isInlineStatusDismissed=function(){return this._isInlineStatusDismissed},o.prototype.path=function(){return this._path},o.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},o.prototype.user=function(){return this._user},o.prototype.nextUpload=function(){return this._fileList.find(function(e){return e.status===c.PENDING})},o.prototype.numDraggingFiles=function(){return this._numDraggingFiles},o.prototype.isInternalTransfer=function(){return this._isInternalTransfer},o.prototype.totalSizeOfCompletedUploads=function(){return this._fileList.reduce(function(e,t){return t.status===c.COMPLETE?e+t.size:e},0)},o.prototype.totalSize=function(){return this._fileList.reduce(function(e,t){var r;return(r=t.status)===c.COMPLETE||r===c.PENDING||r===c.UPLOADING?e+t.size:e},0)},o.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},o.prototype._setUser=function(e){var t;return t=e.user,this._user=t,this.emit_change()},o.prototype._setPath=function(e){var t,r,o;return r=e.path,t=null==(o=e.hasPermissionToUploadToFolder)||o,this._path=r,this._hasPermissionToUploadToFolder=t,this.emit_change()},o.prototype._initializeEverything=function(e){var t,r,o;return o=e.user,r=e.path,t=e.context,this._user=o,this._path=r,this._hasPermissionToUploadToFolder=t.isCurrentPathWriteable(),this.emit_change()},o.prototype._queueUploads=function(e){var t,r,o,s,n;for(r=e.files,n={},o=0,s=r.length;o<s;o++)t=r[o],n[t.uploadId]=t;return this._fileList=this._fileList.merge(n),this.emit_change()},o.prototype._startUpload=function(e){var t;return t=e.file,assert(null==this._currentUpload),assert(null!=t),assert(this._fileList.get(t.uploadId)===t),this._fileList=this._fileList.update(t.uploadId,function(e){return e.set("status",c.UPLOADING)}),this._currentUploadId=t.uploadId,this.emit_change()},o.prototype._completeUpload=function(e){var t,o,s,n;return s=e.uploadId,n=this._fileList.get(s),s===this._currentUploadId&&n.status===c.UPLOADING||reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:n.toJS(),fileListLength:this._fileList.count(),uploadId:s,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(n.uploadId,function(e){return e.set("status",c.COMPLETE)}),this._currentUploadId=null,o=this._fileList.find(function(e){var t;return(t=e.status)===c.PENDING||t===c.UPLOADING}),o||(t=this._fileList.valueSeq().filter(function(e){return e.status===c.COMPLETE}).map(function(e){return r.normalize(e.dest)+r.normalize(e.name)}),t.every(function(e){return u.filesMap().has(e)})?u.selectFqPaths({fqPathsToSelect:t.toArray()}):u.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:t.toArray()})),this.emit_change()},o.prototype._cancelUploads=function(e){var t,r,o,s;for(r=e.files,o=0,s=r.length;o<s;o++)t=r[o],this._fileList=this._fileList.update(t.uploadId,function(e){var t;return(t=e.status)===c.PENDING||t===c.UPLOADING?e.set("status",c.CANCELLED):e}),t.uploadId===this._currentUploadId&&(this._currentUploadId=null);return this.emit_change()},o.prototype._setCurrentUploadProgress=function(e){var t,r;return r=e.percentComplete,t=e.numSecondsLeft,this._fileList=this._fileList.update(this._currentUploadId,function(e){return e.set("percentUploaded",r)}),this._numSecondsLeft=t,this.emit_change()},o.prototype._handleUploadError=function(e){var t,r,o,s;return s=e.uploadId,r=e.errorType,t=e.errorMessage,o=this._fileList.get(s),o.uploadId!==this._currentUploadId&&reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:o.toJS(),fileListLength:this._fileList.count(),errorType:r,errorMessage:t}}),this._fileList=this._fileList.update(o.uploadId,function(e){return e.set("status",c.FAILED).set("errorType",r).set("errorMessage",t)}),this._currentUploadId=null,this.emit_change()},o.prototype._setNumDraggingFiles=function(e){var t,r,o;return r=e.numDraggingFiles,t=null!=(o=e.isInternalTransfer)&&o,this._numDraggingFiles=r,this._isInternalTransfer=t,this.emit_change()},o.prototype._setIsUploadModalOpen=function(e){var t;return t=e.isUploadModalOpen,this._isUploadModalOpen=t,this.emit_change()},o.prototype._setIsInlineStatusDismissed=function(e){var t;return t=e.isInlineStatusDismissed,this._isInlineStatusDismissed=t,this.emit_change()},o.prototype._addNewFailedFile=function(e){var t,r,o;return o=e.file,r=e.errorType,t=e.errorMessage,null==o.uploadId&&(o=o.set("uploadId",f())),o=o.set("status",c.FAILED).set("errorType",r).set("errorMessage",t),this._fileList=this._fileList.set(o.uploadId,o),this.emit_change()},o.prototype._new_payload=function(e){switch(e.action.type){case l.INITIALIZE_EVERYTHING:return this._initializeEverything(e.action.data);case l.SET_USER:case h.SET_USER:return this._setUser(e.action.data);case l.SET_PATH:case h.SET_PATH:return this._setPath(e.action.data);case h.QUEUE_UPLOADS:return this._queueUploads(e.action.data);case h.START_UPLOAD:return this._startUpload(e.action.data);case h.COMPLETE_UPLOAD:return this._completeUpload(e.action.data);case h.CANCEL_UPLOADS:return this._cancelUploads(e.action.data);case h.SET_CURRENT_UPLOAD_PROGRESS:return this._setCurrentUploadProgress(e.action.data);case h.UPLOAD_ERROR:return this._handleUploadError(e.action.data);case h.SET_NUM_DRAGGING_FILES:return this._setNumDraggingFiles(e.action.data);case h.SET_IS_UPLOAD_MODAL_OPEN:return this._setIsUploadModalOpen(e.action.data);case h.SET_IS_INLINE_STATUS_DISMISSED:return this._setIsInlineStatusDismissed(e.action.data);case h.ADD_NEW_FAILED_FILE:return this._addNewFailedFile(e.action.data)}},o})(o),{UploaderStore:new m,UploaderActionTypes:h,FileUpload:p,FileStatus:c,UploadErrorType:d,generateUploadId:f}}),define("modules/clean/react/home/home_access/home_access_util",["require","exports","modules/constants/starred"],function(e,t,r){"use strict";function o(){return r.HOME_ENABLED}t.isHomeEnabled=o}),
define("modules/clean/react/maestro/checkbox",["require","exports","tslib","external/react","external/classnames"],function(e,t,r,o,s){"use strict";var n;(function(e){e[e.Checked=0]="Checked",e[e.PartiallyChecked=1]="PartiallyChecked",e[e.Unchecked=2]="Unchecked"})(n||(n={})),t.CheckboxState=n;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.checkboxState,t=s({"checkbox-button":!0,"partial-checked":e===n.PartiallyChecked,checked:e===n.Checked});return o.createElement("button",{role:"checkbox","aria-checked":e===n.Checked,"aria-label":this.props.ariaLabel,className:t,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown})},t})(o.PureComponent);t.Checkbox=i}),define("modules/clean/react/maestro/tile_grid",["require","exports","tslib","external/immutable","external/react","external/react-dom","external/classnames","modules/clean/js_client_stopwatch","external/mcl/culled_list","modules/clean/react/sticky/container","modules/clean/react/sticky/sticky","modules/core/browser","modules/clean/react/maestro/checkbox","modules/clean/keycode","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react_logger"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f){"use strict";var _={thumbnailUrl:void 0,labelNode:"",altText:"",iconUrl:"",actionNode:void 0,onTileAction:void 0,id:void 0,isDraggable:!1,onDragEnter:void 0,onDragStart:void 0,isFocused:!1,isSelectable:!1,isSelected:!1,handleToggleSelect:void 0,checkboxAriaText:"",alwaysShowCheckbox:!1},g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o.Record(_));t.TileItem=g;var b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e="tile-label__text";return this.props.className&&(e="#{className} #{this.props.className}"),s.createElement("div",{className:e},this.props.label)},t})(s.PureComponent);t.TileItemLabelText=b;var S=(function(){function e(e,t,r,s){var n=this;this.recordTileError=function(e){var t=Math.floor(e/n.numTilesPerPage);n.pagesWithThumbErrors.has(t)||(n.pagesWithThumbErrors=n.pagesWithThumbErrors.add(t))},this.recordTileLoaded=function(e,t,r){if(r){if(n.thumbsLoaded.has(e))return;n.thumbsLoaded=n.thumbsLoaded.add(e)}else{if(n.iconsLoaded.has(e))return;n.iconsLoaded=n.iconsLoaded.add(e)}var o=!1;o=n.numTiles%n.numTilesPerPage===0?e>=n.numTiles-n.numTilesPerPage:e>=n.numTiles-n.numTiles%n.numTilesPerPage;var s=n.numTilesPerPage;if(o){var i=n.numTiles%n.numTilesPerPage;0!==i&&(s=i)}var a=Math.floor(e/n.numTilesPerPage);if(r||!t){var l=n.numTilesFinalizedByPage,u=l.get(a)||0;n.numTilesFinalizedByPage=l.set(a,u+1)}if(0===a&&n.handleTTI){!(n.iconsLoaded.has(e)&&n.thumbsLoaded.has(e))&&(n.numTilesLoadedOnFirstPage++,n.numTilesLoadedOnFirstPage===s&&n.handleTTI())}r&&(n.pagesWithThumbs.has(a)||(n.pagesWithThumbs=n.pagesWithThumbs.add(a)),n.anyThumbLoadedTimeByPage.get(a)||(n.anyThumbLoadedTimeByPage=n.anyThumbLoadedTimeByPage.set(a,n.getTimeNow())),n.numTilesFinalizedByPage.get(a)===s&&(n.allThumbsLoadedTimeByPage=n.allThumbsLoadedTimeByPage.set(a,n.getTimeNow())))},this.pruneTrackedPages=function(){n.startTimeByPage.entrySeq().forEach(function(e){var t=e[0],r=e[1];!n.pagesToLog.has(t)&&!n.pagesCompletedLogging.has(t)&&n.getTimeNow()-r>2e3&&(n.startTimeByPage=n.startTimeByPage.delete(t))})},this.logCompletedPages=function(){n.pagesToLog.forEach(function(e){var t=n.startTimeByPage.get(e),r=Math.max(n.allThumbsLoadedTimeByPage.get(e),t),o=Math.max(n.anyThumbLoadedTimeByPage.get(e),t);return r&&!n.pagesWithThumbs.has(e)?void n.handlePageCompletedLogging(e):n.pagesWithThumbErrors.has(e)?void n.handlePageCompletedLogging(e):void(t&&r&&o&&(n.logPerfStats(e,t,o,r),n.handlePageCompletedLogging(e)))})},this.numTiles=e.count(),this.numTilesPerPage=t,this.numTilesFinalizedByPage=o.List(),this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=o.Set(),this.thumbsLoaded=o.Set(),this.startTimeByPage=o.Map(),this.allThumbsLoadedTimeByPage=o.Map(),this.anyThumbLoadedTimeByPage=o.Map(),this.pagesWithThumbErrors=o.Set(),this.pagesWithThumbs=o.Set(),this.pagesCompletedLogging=o.Set(),this.pagesToLog=o.Set(),this.handleTTI=s}return e.prototype.getTimeNow=function(){var e=p.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging=this.pagesCompletedLogging.add(e),this.pagesToLog=this.pagesToLog.delete(e),this.startTimeByPage=this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage=this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage=this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){a.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){a.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,r,o){a.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:r-t}),a.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:o-t})},e})();t.InfiniteTileGridLogger=S;var T=(function(e){function t(t){var r=e.call(this,"InfiniteTileGrid",t)||this;if(r.scrollTileIntoView=function(e,t){var o=r.props.contentOffset||0,s=document.documentElement.scrollTop||document.body.scrollTop,n=Math.floor(t/r.state.tilesPerRow),i=e-o,a=r.getRowHeight(),l=n*a,u=l+a;s<=l&&u<=i+s||(l<s?window.scrollTo(0,l):window.scrollTo(0,u-i))},r.updateOnResize=function(){window.requestAnimationFrame(function(){r.getAndUpdateTileLayout()})},r.setLastViewedPage=function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,o=Math.round(t/e);if(r.tileLoadLogger.pruneTrackedPages(),r.tileLoadLogger.logCompletedPages(),!r.tileLoadLogger.pagesCompletedLogging.has(o)&&!r.tileLoadLogger.pagesToLog.has(o))if(o!==r.tileLoadLogger.lastViewedPage){if(r.tileLoadLogger.lastViewedPage=o,r.tileLoadLogger.pageChangeTime=r.tileLoadLogger.getTimeNow(),!r.tileLoadLogger.startTimeByPage.get(o)){var s=r.tileLoadLogger.getTimeNow(),n=r.tileLoadLogger.startTimeByPage.set(o,s);r.tileLoadLogger.startTimeByPage=n}}else{var s=r.tileLoadLogger.getTimeNow();if(s-r.tileLoadLogger.pageChangeTime>1e3){var i=r.tileLoadLogger.pagesToLog.add(o);r.tileLoadLogger.pagesToLog=i}}},r.logTileError=function(e){r.tileLoadLogger&&r.tileLoadLogger.recordTileError(e),r.props.logTileLoading&&S.logThumbLoadError()},r.logTileLoaded=function(e,t,o){r.tileLoadLogger&&r.tileLoadLogger.recordTileLoaded(e,t,o)},r.renderTileElement=function(e,t){var o=r.props.getTileItem(e);if(!o)return null;o.labelNode&&o.labelNode;var n=!!r.props.selectedIds&&r.props.selectedIds.has(o.id);return s.createElement(w,{key:o.id,onTileAction:o.onTileAction,width:r.state.tileWidth,height:r.props.tileHeight,leftOffset:t,tileIndex:e,tilePadding:r.props.tilePadding,labelHeight:r.props.labelHeight,actionNode:o.actionNode,iconUrl:o.iconUrl,thumbnailUrl:o.thumbnailUrl,labelNode:o.labelNode,altText:o.altText,onThumbnailError:r.props.logTileLoading?r.logTileError:void 0,onThumbnailLoad:r.props.logTileLoading?r.logTileLoaded:void 0,isDraggable:o.isDraggable,onDragEnter:o.onDragEnter,onDragStart:o.onDragStart,isFocused:o.isFocused,isSelectable:o.isSelectable,isSelected:n,handleToggleSelect:o.handleToggleSelect,checkboxAriaText:o.checkboxAriaText,alwaysShowCheckbox:o.alwaysShowCheckbox,thumbStore:r.thumbStore,scrollTileIntoView:r.scrollTileIntoView})},r.renderRowContent=function(e,t){if(!Array.isArray(e))return e;for(var n=r.state.tileWidth+r.props.tilePadding,i=o.List([]),a=e,l=a[0],u=a[1],c=0,p=l;p<u;p++){var d=c*n;i=i.push(r.renderTileElement(p,d)),c++}return s.createElement("div",null,i)},r.props.sectionLabels||r.props.sectionStartIndices){if(!r.props.sectionLabels||!r.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(r.props.sectionLabels.count()!==r.props.sectionStartIndices.count())throw new Error("sectionLabels and sectionStartIndices must be of same length.")}return r.state={tileWidth:r.props.maxTileWidth,tilesPerRow:1},r.props.thumbStore?r.thumbStore=r.props.thumbStore:r.thumbStore=new m,a.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var t=this;window.addEventListener("resize",this.updateOnResize),this.animationFrameRequestId=window.requestAnimationFrame(function(){var e=t.getAndUpdateTileLayout();t.props.logTileLoading&&t.setupTileLogging(t.getRowHeight(),e.tilesPerRow)}),e.prototype.componentDidMount.call(this)},t.prototype.componentWillReceiveProps=function(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(e.tileItems.count())},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateOnResize),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),delete this.tileLoadLogger)},t.prototype.getRowHeight=function(){return this.props.tileHeight+2*this.props.tilePadding+this.props.labelHeight},t.prototype.getPageHeight=function(){var e=document.documentElement.clientHeight||window.outerHeight,t=this.props.contentOffset||0,r=e-t,o=this.getRowHeight(),s=o*Math.ceil(r/o);return Math.max(s,o)},t.prototype.getAndUpdateTileLayout=function(){var e=this.props.maxTileWidth+this.props.tilePadding,t=n.findDOMNode(this);if(!t)return{tileWidth:this.props.maxTileWidth,tilesPerRow:1};var r=t.clientWidth,o=Math.max(1,Math.floor(r/e)),s=1,i=this.props.maxTileWidth,a=r%e;return 0===Math.round(a)?(s=o,i=this.props.maxTileWidth):(s=o+1,i=r/s-this.props.tilePadding),this.state.tileWidth===i&&this.state.tilesPerRow===s||this.setState({tileWidth:i,tilesPerRow:s}),{tileWidth:i,tilesPerRow:s}},t.prototype.setupTileLogging=function(e,t){var r=this.getPageHeight(),o=t*Math.ceil(r/e);this.tileLoadLogger=new S(this.props.tileItems,o,t,this.props.handleTTI);var s=this.tileLoadLogger.pagesToLog.add(0);this.tileLoadLogger.pagesToLog=s;var n=this.tileLoadLogger.getTimeNow(),i=this.tileLoadLogger.startTimeByPage.set(0,n);this.tileLoadLogger.startTimeByPage=i,this.logTrackingInterval=setInterval(this.setLastViewedPage,200,r)},t.prototype.render=function(){var e=this,t=new Array,r=new Array,o=this.getRowHeight(),n=this.props,i=n.numThresholdRows,a=n.containerClass,p=n.rowClass,d=n.scrollDeltaThreshold;if(this.props.sectionStartIndices&&this.props.sectionStartIndices.count()>0){var h=[];return this.props.sectionStartIndices.forEach(function(n,i){var a=e.props.tileItems.count();i!==e.props.sectionStartIndices.count()-1&&(a=e.props.sectionStartIndices.get(i+1));var l=e.props.sectionLabels.get(i),p=e.props.tileItems.slice(n,a),d=Math.ceil(p.count()/e.state.tilesPerRow),m=40+d*o,f=s.createElement("div",{key:"section-"+l+"-shadow",style:{height:40}});t.push(f),r.push(40);var _=s.createElement("li",{key:"section-"+l},s.createElement(u.StickyContainer,{offsetTop:e.props.contentOffset,id:l,stickHeight:m},s.createElement(c.Sticky,{offsetHeight:40},s.createElement("div",{className:"tile-section-header"},l))));h.push(_);for(var g=0;g<d;g++){var b=n+g*e.state.tilesPerRow,S=Math.min(b+e.state.tilesPerRow,a);t.push([b,S]),r.push(o)}}),s.createElement("div",null,s.createElement("ul",{className:"tile-section-headers-list"},h),s.createElement(l.CulledList,{items:t,listItemHeight:r,itemBuffer:i,className:a,itemClassName:p,renderRowContent:this.renderRowContent,scrollThreshold:d}))}for(var m=this.props.tileItems.count(),f=Math.ceil(m/this.state.tilesPerRow),_=0;_<f;_++){var g=_*this.state.tilesPerRow,b=Math.min(g+this.state.tilesPerRow,m);t.push([g,b]),r.push(o)}return s.createElement(l.CulledList,{items:t,listItemHeight:r,itemBuffer:i,className:a,itemClassName:p,renderRowContent:this.renderRowContent,scrollThreshold:d})},t})(f.ReactPureLogger);T.defaultProps={numThresholdRows:10,tileItems:o.List(),tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,getTileItem:function(e){return null},handleTTI:function(){},thumbStore:null},t.InfiniteTileGrid=T;var w=(function(e){function t(t){var r=e.call(this,t)||this;return r.focusTile=function(){if(!r.state.isFocused){var e=r.refs.tileThumbContainer;e&&e.focus()}},r.maybeLogTileInteractive=function(){if(!r.state.isPlaceholderMode){var e=!!r.props.thumbnailUrl,t=!r.state.isPlaceholderMode&&r.state.thumbLoaded;if(r.props.onThumbnailLoad){var o=window.requestAnimationFrame(function(){var o=window.requestAnimationFrame(function(){r.props.onThumbnailLoad(r.props.tileIndex,e,t)});r.animationRequestIds.push(o)});r.animationRequestIds.push(o)}}},r.toggleSelect=function(e){e.stopPropagation(),r.props.handleToggleSelect&&r.props.handleToggleSelect()},r.handleThumbKeyPress=function(e){switch(e.keyCode){case h.KeyCode.SPACE:e.preventDefault();case h.KeyCode.ENTER:r.props.onTileAction(e)}},r.onBlur=function(e){r.setState({isFocused:!1})},r.onFocus=function(e){var t=document.documentElement.clientHeight;r.props.scrollTileIntoView(t,r.props.tileIndex),r.setState({isFocused:!0})},r.state={thumbLoaded:!1,iconLoaded:!1,isPlaceholderMode:!0},r.animationRequestIds=[],r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;if(this.props.thumbnailUrl){var t=Date.now();this.thumbRequestId=this.props.thumbStore.bind_url(this.props.thumbnailUrl,{onSuccess:function(){e.setState({thumbLoaded:!0}),S.logThumbRTT(Date.now()-t)},onError:function(){e.props.onThumbnailError&&e.props.onThumbnailError(e.props.tileIndex)}})}this.iconRequestId=this.props.thumbStore.bind_url(this.props.iconUrl,{onSuccess:function(){e.state.thumbLoaded||e.setState({iconLoaded:!0})}}),this.renderCompleteTileTimeout=setTimeout(function(){e.setState({isPlaceholderMode:!1})},20),this.maybeLogTileInteractive()},t.prototype.componentDidUpdate=function(e,t){!e.isFocused&&this.props.isFocused&&this.focusTile(),this.maybeLogTileInteractive()},t.prototype.componentWillUnmount=function(){this.thumbRequestId&&this.props.thumbStore.unbind_url(this.thumbRequestId),this.props.thumbStore.unbind_url(this.iconRequestId),clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach(function(e){window.cancelAnimationFrame(e)})},t.prototype.renderCheckbox=function(){var e=d.CheckboxState.Unchecked;this.props.isSelected&&(e=d.CheckboxState.Checked);var t="tile-select-checkbox";return this.props.alwaysShowCheckbox||(t+=" tile-select-checkbox--hidden"),s.createElement("div",{key:"tile-checkbox-node",className:t},s.createElement(d.Checkbox,{ariaLabel:this.props.checkboxAriaText,checkboxState:e,onClick:this.toggleSelect}))},t.prototype.renderActionNode=function(){return s.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},t.prototype.renderThumbnail=function(){var e={className:"tile__preview",style:{maxHeight:this.props.width,maxWidth:this.props.width},alt:this.props.altText,draggable:!1};if(this.state.thumbLoaded)e.className+=" tile__preview--thumb",e.src=this.props.thumbStore.get_thumb(this.props.thumbnailUrl);else{if(!this.state.iconLoaded)return s.createElement("div",{className:"tile-container__placeholder"});e.className+=" tile__preview--icon",e.src=this.props.thumbStore.get_thumb(this.props.iconUrl)}return s.createElement("img",r.__assign({},e))},t.prototype.render=function(){var e=null;this.props.labelNode&&(e=s.createElement("div",{className:"tile-label"},this.props.labelNode));var t={position:"absolute",left:this.props.leftOffset,height:this.props.height+2*this.props.tilePadding+this.props.labelHeight,width:this.props.width+this.props.tilePadding};if(this.state.isPlaceholderMode)return s.createElement("div",{className:"tile-container",style:t},s.createElement("div",{className:"tile-container__placeholder"}),e);var o={className:i(["tile",{"tile--is-selected":this.props.isSelected,"tile--focused-in":this.state.isFocused}]),style:{height:this.props.height+this.props.labelHeight,width:this.props.width},draggable:this.props.isDraggable,onBlur:this.onBlur,onClick:this.props.onTileAction,onDragEnter:this.props.onDragEnter,onDragStart:this.props.onDragStart,onFocus:this.onFocus},n=[this.renderActionNode()];this.props.isSelectable&&n.unshift(this.renderCheckbox());var a={height:this.props.width,width:this.props.width},l=s.createElement("div",{ref:"tileThumbContainer",className:"tile__thumb-container",style:a,tabIndex:0,onKeyDown:this.handleThumbKeyPress},this.renderThumbnail());return s.createElement("div",{className:"tile-container",style:t},s.createElement("div",r.__assign({},o),l,n,e))},t})(s.PureComponent);t.TileElement=w}),define("modules/clean/react/previews/constants",["require","exports"],function(e,t){"use strict";function r(e){return a[e]}function o(e){return l[e]}function s(e){return c[e]}t.ErrorTypes={LOAD_ERROR:"LOAD_ERROR",SUPPORT_ERROR:"SUPPORT_ERROR",EXTENSION_ERROR:"EXTENSION_ERROR",NEED_FLASH_ERROR:"NEED_FLASH_ERROR",FILE_SIZE_ERROR:"FILE_SIZE_ERROR",PASSWORD_PROTECTED_ERROR:"PASSWORD_PROTECTED_ERROR",PENDING_UPLOAD_ERROR:"PENDING_UPLOAD_ERROR",EMPTY_FILE_ERROR:"EMPTY_FILE_ERROR"};var n;(function(e){e[e.BROWSE=0]="BROWSE",e[e.SHARED_LINK_FILE=1]="SHARED_LINK_FILE",e[e.SHARED_LINK_FOLDER=2]="SHARED_LINK_FOLDER",e[e.SHARED_LINK_COLLECTION=3]="SHARED_LINK_COLLECTION",e[e.VERSION_HISTORY=4]="VERSION_HISTORY",e[e.FILE_VIEWER=5]="FILE_VIEWER",e[e.DESKTOP=6]="DESKTOP"})(n=t.PreviewSourceContext||(t.PreviewSourceContext={}));var i;(function(e){e[e.VISIT=0]="VISIT",e[e.CLICK=1]="CLICK"})(i=t.PreviewSourceAction||(t.PreviewSourceAction={}));var a=[];a[n.BROWSE]="browse",a[n.SHARED_LINK_FILE]="sl_file",a[n.SHARED_LINK_FOLDER]="sl_folder",a[n.SHARED_LINK_COLLECTION]="sl_collection",a[n.VERSION_HISTORY]="version_history",a[n.FILE_VIEWER]="file_viewer",a[n.DESKTOP]="desktop",t.getPreviewSourceContextKey=r;var l=[];l[i.VISIT]="visit",l[i.CLICK]="click",t.getPreviewSourceActionKey=o;var u;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NEW_FILE=1]="NEW_FILE",e[e.BEFORE_UNLOAD=2]="BEFORE_UNLOAD",e[e.UNMOUNT=3]="UNMOUNT"})(u=t.PreviewSessionEndReasons||(t.PreviewSessionEndReasons={})),t.RivieraPreviewResponseTypes={UNKNOWN:0,OK:1,CONVERSION_FAILURE:2,TEMPORARY_FAILURE:3,INTERNAL_FAILURE:4,UNSUPPORTED_FORMAT:5,TIMEOUT:6,TOO_BIG:7,INVALID_METADATA:8,SOURCE_CORRUPT:9,TIME_BUDGET_EXCEEDED:10,NOT_FOUND:11,PASSWORD_PROTECTED:12};var c=[];c[u.UNKNOWN]="unknown",c[u.NEW_FILE]="new_file",c[u.BEFORE_UNLOAD]="before_unload",c[u.UNMOUNT]="unmount",t.getSessionEndReasonLoggingKey=s}),define("modules/clean/react/pro/pro_onboarding_tour_modal",["external/react","jquery","external/classnames","modules/clean/ajax","modules/clean/react/button","modules/clean/react/css","modules/clean/react/image","modules/clean/react/modal"],function(e,t,r,o,s,n,i,a){var l,u,c,p,d,h,m,f;return l=a.Modal,m=e.createElement,f=r,h=e.addons.CSSTransitionGroup,d=e.createClass({displayName:"ProOnboardingWelcomeScreen",propTypes:{tourPaths:e.PropTypes.array,onTourPathChange:e.PropTypes.func,contentSource:e.PropTypes.object},getInitialState:function(){return{tourPath:null}},setTourPathState:function(e){return this.setState({tourPath:e}),this.props.onTourPathChange(e)},renderMainText:function(t){var r;return t instanceof Array?(r=t.map(function(r,o){return e.createElement("li",{key:o,className:"onboarding-panel__checkmark"},t[o])}),e.createElement("ul",{className:"onboarding-panel__list"},r)):e.createElement("p",null,t)},render:function(){var t;return t=this.props.tourPaths.map((function(t){return function(r,o){var n,a,l,u,c;return c=t.props.contentSource[r].welcome,n=c["image-path"],a=null!=c["image-path-retina"]?c["image-path-retina"]:n,l=o<t.props.tourPaths.length-1,u=f({"onboarding-panel__column":!0,"onboarding-panel__column--rb":l}),e.createElement("div",{key:o,className:u},e.createElement("h2",{className:"onboarding-panel__title"},c.title),e.createElement("div",{className:"onboarding-panel__image"},e.createElement(i,{src:n,srcHiRes:a})),e.createElement("div",{className:"onboarding-panel__content"},t.renderMainText(c["main-text"])),e.createElement(s.link_button,{onClick:t.setTourPathState.bind(t,r),className:"onboarding-panel__button c-btn c-btn--primary"},c["button-text"]))}})(this)),e.createElement("div",{className:"onboarding-panel onboarding-panel--welcome"},t)}}),u=e.createClass({displayName:"ProOnboardingFeatureContent",propTypes:{tourStep:e.PropTypes.number,className:e.PropTypes.string,contentSource:e.PropTypes.object.isRequired,handleFeatureLinkClick:e.PropTypes.func},render:function(){var t,r,o;return t=f({"onboarding-panel__image":!0,"onboarding-panel__image--center":!0,"onboarding-panel__image--b":!0}),r=this.props.contentSource["image-path"],o=null!=this.props.contentSource["image-path-retina"]?this.props.contentSource["image-path-retina"]:r,e.createElement("div",{key:this.props.tourStep,className:"onboarding-panel__column"},e.createElement("h2",{className:"onboarding-panel__title"},this.props.contentSource.title),e.createElement("div",{className:t},e.createElement(i,{src:r,srcHiRes:o})),e.createElement("div",{className:"onboarding-panel__text"},this.props.contentSource["main-text"]),e.createElement(s.link_button,{className:"onboarding-panel__button c-btn c-btn--primary",href:this.props.contentSource["button-href"],target:"_blank",onClick:this.props.handleFeatureLinkClick},this.props.contentSource["button-text"]))}}),c=e.createClass({displayName:"ProOnboardingNavigation",propTypes:{handleTourForward:e.PropTypes.func,handleTourBackward:e.PropTypes.func,handleTourEnd:e.PropTypes.func,atTourEnd:e.PropTypes.bool},render:function(){var t,r;return r=e.createElement("div",{className:"onboarding-panel__nav--next",onClick:this.props.handleTourForward}),this.props.atTourEnd&&(t=f({"c-btn":!0,"c-btn--secondary":!0,"c-btn--big":!0,"c-btn--full":!0,"onboarding-panel__button":!0,"onboarding-panel__nav--fin":!0}),r=e.createElement("button",{onClick:this.props.handleTourEnd,className:t},"Go to my Dropbox")),e.createElement("div",{className:"onboarding-panel__nav"},e.createElement("div",{className:"onboarding-panel__nav--prev",onClick:this.props.handleTourBackward}),r)}}),p=e.createClass({displayName:"ProOnboardingTourModal",propTypes:{className:e.PropTypes.string,modalId:e.PropTypes.string.isRequired,onboardingPaths:e.PropTypes.array.isRequired,contentSource:e.PropTypes.object.isRequired},statics:{renderWithProps:function(e){var r,o,s;return r=n(p,["/static/css/payments/pro_trial_onboarding_tour-vfl8U7rsY.css"]),s={style:"lightbox",onDismiss:t("#pro-trial-tour-header-bubble").removeClass("force-hidden")},o=m(r,e),l.showInstance(m(l,s,o))}},getInitialState:function(){return{tourStep:0,tourPath:null,tourPathNumStep:null,atTourStart:!0,atTourEnd:!1}},onTourPathChange:function(e){var t;return t={selected_path:e},this._log("pro_onboarding_path_selected",t),this.setState({tourPath:e,atTourStart:!1,tourPathNumStep:this.props.contentSource[e].features.length-1})},tourForward:function(){var e;return e={selected_path:this.state.tourPath,tour_step:this.state.tourStep},this._log("pro_onboarding_tour_forward",e),this.setState({tourStep:this.state.tourStep+1,atTourStart:!1,atTourEnd:this.state.tourStep===this.state.tourPathNumStep-1})},tourBackward:function(){var e;return e={selected_path:this.state.tourPath,tour_step:this.state.tourStep},this._log("pro_onboarding_tour_backward",e),0===this.state.tourStep?this.setState({atTourStart:!0}):this.setState({tourStep:this.state.tourStep-1,atTourEnd:!1})},tourEnd:function(){var e;return e={selected_path:this.state.tourPath,tour_step:this.state.tourStep},this._log("pro_onboarding_tour_finish",e),l.close()},logLinkClick:function(){var e;return e={selected_path:this.state.tourPath,tour_step:this.state.tourStep},this._log("pro_onboarding_tour_link_click",e)},_log:(function(e){return function(e,t){return o.WebRequest({url:"/pro/trial_onboarding_tour_log",data:{evt:e,extra_data:JSON.stringify(t)}})}})(this),render:function(){var t,r;return r=[],this.state.atTourStart?(t={selected_path:this.state.tourPath,tour_step:this.state.tourStep},this._log("pro_onboarding_tour_start",t),r.push(e.createElement(d,{key:"onboardingWelcome",contentSource:this.props.contentSource,tourPaths:this.props.onboardingPaths,onTourPathChange:this.onTourPathChange}))):r.push(e.createElement(h,{component:"div",transitionName:"fade",transitionLeave:!1},e.createElement(u,{key:this.state.tourPath+"-"+this.state.tourStep,tourStep:this.state.tourStep,handleFeatureLinkClick:this.logLinkClick,contentSource:this.props.contentSource[this.state.tourPath].features[this.state.tourStep]})),e.createElement(c,{key:"onboardingNav",atTourEnd:this.state.atTourEnd,handleTourForward:this.tourForward,handleTourBackward:this.tourBackward,handleTourEnd:this.tourEnd})),e.createElement("div",{id:this.props.modalId,className:this.props.className},r)}}),{ProOnboardingTourModal:p,ProOnboardingFeatureContent:u,ProOnboardingNavigation:c,ProOnboardingWelcomeScreen:d}}),define("modules/clean/search/search_results",["require","exports","tslib","external/react","external/react-dom","external/underscore","modules/clean/notserver","modules/clean/react/async_file_modal_controller","modules/clean/react/css","modules/clean/search/actions","modules/clean/search/api","modules/clean/search/store","modules/clean/search/search_results_view","modules/clean/react_logger"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h){"use strict";var m=(function(e){function t(t){var r=e.call(this,"SearchResultsController",t)||this;return r._onSearchStoreChanged=function(){r.setState(r._get_state_from_store())},r._handleScroll=function(){s.findDOMNode(r).getBoundingClientRect().bottom<=window.innerHeight&&u.searchActions.loadMoreResults({path:r.props.path,user:r.props.user})},r._handleSelectionChange=function(e){u.searchActions.setSearchSelection({selection:e})},r._handleDelete=function(){var e=r.state.selectedFiles.toArray();a.showDelete(r.props.user,e,r.state.context,function(){})},r._handleRestoreMulti=function(){var e=r.state.selectedFiles.toArray();a.showRestore(r.props.user,e,function(){})},r._handlePermanentDelete=function(){var e=r.state.selectedFiles,t=function(){u.searchActions.removeSearchResults({fq_paths:e.map(function(e){return e.fq_path}).toOrderedMap()})};a.showPermanentlyDelete(r.props.user,e.toArray(),t)},r._actionHandlers={onDelete:r._handleDelete,onRestoreMulti:r._handleRestoreMulti,onPermanentDelete:r._handlePermanentDelete},r._searchApi=c.searchApiClient,r}return r.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this),this.state=this._get_state_from_store(),this._setupFileEventListener()},t.prototype.componentDidMount=function(){p.searchStore.add_change_listener(this._onSearchStoreChanged),this.setState(this._get_state_from_store()),e.prototype.componentDidMount.call(this)},t.prototype.componentWillUnmount=function(){p.searchStore.remove_change_listener(this._onSearchStoreChanged),i.NotClients[this.props.user.id].unsubscribe(this._handlerId)},t.prototype._get_state_from_store=function(){return{context:p.searchStore.browseContext(),hasMoreResults:p.searchStore.hasMoreResults(),loadingState:p.searchStore.loadingState(),latestQuery:p.searchStore.latestQuery(),numDeletedResults:p.searchStore.numDeletedResults(),searchResults:p.searchStore.searchResults(),selection:p.searchStore.selection(),selectedFiles:p.searchStore.selectedFiles(),didLoadDeletedResults:p.searchStore.didLoadDeletedResults()}},t.prototype._setupFileEventListener=function(){var e=this,t=i.NotClients[this.props.user.id];this._handlerId=t.subscribe_sfj({name:"SearchEventDispatcher",handler:function(){if(!e.state.latestQuery)return void t.handler_success(e._handlerId,{ns_map:t.get_ns_map()});e._searchApi.getUpdatesForResults({query:e.state.latestQuery,namespaceToJournalIdMap:t.get_ns_map(),showDeleted:e.state.didLoadDeletedResults,user:e.props.user,onSuccess:function(r){u.searchActions.applyUpdatesFromNotserver({payload:r,path:e.props.path}),t.handler_success(e._handlerId,{ns_map:r.ns_map})}})}})},t.prototype.render=function(){return o.createElement(d.SearchResultsView,r.__assign({},this.state,{maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,maestroSearchBarProps:this.props.maestroSearchBarProps,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,onFullSearch:this.props.onFullSearch,onScroll:n.throttle(this._handleScroll,200),setFileUploaderPath:this.props.setFileUploaderPath,onSelectionChange:this._handleSelectionChange,path:this.props.path,trademarkBusiness:this.props.trademarkBusiness,user:this.props.user,contextFileActionHandlers:this.props.contextFileActionHandlers,actionHandlers:this._actionHandlers,handleComponentTTI:this.props.handleComponentTTI,ensureFileViewerClosedIfNotPreviewing:this.props.ensureFileViewerClosedIfNotPreviewing,isFileViewerShown:this.props.isFileViewerShown}))},t})(h.ReactLogger);t.SearchResultsController=l(m,["/static/css/browse/browse-vflIgR_rF.css","/static/css/scooter/scooter-scoped-vfl0UVTY2.css"])}),define("modules/clean/search/search_results_view",["require","exports","tslib","jquery","external/underscore","external/mcl/vertically_fixed","external/react","modules/clean/analytics","modules/clean/browse_interface","modules/clean/history","modules/clean/react/browse/util","modules/clean/react/image","modules/clean/react/maestro/header","modules/clean/react/maestro/layout","modules/clean/react/sprite","modules/clean/static_urls","modules/clean/teams/team_promo_banner","modules/clean/viewer","modules/constants/browse","modules/core/browser","modules/core/i18n","modules/core/uri","modules/clean/react/browse/constants","modules/clean/react/browse/item_list","modules/clean/react/app_actions_view","modules/clean/react/browse/file_actions","modules/clean/search/constants","modules/clean/react_logger"],function(e,t,r,o,s,n,i,a,l,u,c,p,d,h,m,f,_,g,b,S,T,w,y,v,E,F,P,D){"use strict";var N=(function(e){function t(t){var r=e.call(this,"SearchResultsView",t)||this;return r._banner_view_logged=!1,r._ensureFileViewerClosedIfNotPreviewing=function(){var e=u.deconstruct_url().qargs;r.props.ensureFileViewerClosedIfNotPreviewing(e)},r._renderEmptyFolderView=function(){return i.createElement("div",{className:"empty-folder-placeholder u-font-center u-pad-top-xl"},i.createElement(p,{src:f.static_url("/static/images/empty_states/search-vfl6DaX2I.png"),srcHiRes:f.static_url("/static/images/empty_states/search@2x-vflBsUhDE.png"),alt:""}),i.createElement("h2",{className:"u-pad-top-l"},T._("No results found")),i.createElement("div",null,"/"===r.props.path?T._("Please update your search and try again"):r._renderFullSearchLink()))},r.state={},r}return r.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this),u.add_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype.componentDidMount=function(){o(window).on("scroll.SearchResults",this.props.onScroll),e.prototype.componentDidMount.call(this)},t.prototype.componentWillUnmount=function(){o(window).off("scroll.SearchResults"),u.remove_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype._renderFullSearchLink=function(){var e="work"===this.props.user.role?l.WORK_ROOT:l.PERSONAL_ROOT,t=w.parse("/search"+e).setQuery({path:"/",query:this.props.latestQuery}).toString();return i.createElement("a",{href:t,onClick:this.props.onFullSearch},T._("Search all of my Dropbox instead"))},t.prototype._maybeRenderUpsellPromoBanner=function(){if(this.props.limitedTeamBannerUpsell)return this.props.loadingState!==y.LoadingStates.LOADED||this.props.hasMoreResults||this._banner_view_logged||(this._banner_view_logged=!0,a.TeamsWebActionsLogger.log("banner_search_displayed",{location:"search_results",item_count:this.props.searchResults.size})),
i.createElement("div",{className:"team-promo-banner-wrapper__shadow"},i.createElement("div",{className:"team-promo-banner-wrapper"},this._renderUpsellPromoBannerContent()))},t.prototype._renderUpsellPromoBannerContent=function(){return i.createElement(_,{description:[T._("Search through file contents in addition to file names with %(trademark_business)s").format({trademark_business:this.props.trademarkBusiness}),i.createElement("a",{className:"upsell_info u-pad-xxs",href:"/help/6635",target:"_blank",rel:"noopener noreferrer",key:"info-link"},i.createElement(m,{group:"web",name:"info",alt:T._("more info")}))],buttons:[{text:T._("Upgrade"),handler:function(){S.redirect(new w({path:"/team/upgrade",query:{tk:"search_upsell_results",camp:"web"}}).toString())}}]})},t.prototype._maybeRenderSearchResultsHeader=function(){return i.createElement("div",{className:"search-results__info-shadow"},this._maybeRenderSearchResultsHeaderContent())},t.prototype._maybeRenderSearchResultsHeaderContent=function(){var e;if(this.props.searchResults.size&&this.props.loadingState!==y.LoadingStates.LOADING_FIRST_PAGE){e="/"===this.props.path&&b.SHOW_PAPER_SEARCH_RESULTS?T.ungettext("%(num_results)d result in files, folders, Paper docs, and content.","%(num_results)d results in files, folders, Paper docs, and content.",this.props.searchResults.size).format({num_results:this.props.searchResults.size}):T.ungettext("%(num_results)d result in files, folders, and content.","%(num_results)d results in files, folders, and content.",this.props.searchResults.size).format({num_results:this.props.searchResults.size});var t=i.createElement("div",{className:"search-results__info o-grid--no-gutter"},this.props.hasMoreResults?i.createElement("span",{className:"o-grid__col o-grid__col--12-of-12"},e):[i.createElement("span",{className:"o-grid__col o-grid__col--8-of-12"},e),i.createElement("span",{className:"o-grid__col o-grid__col--4-of-12"},T._("Modified"))]);return i.createElement(n.VerticallyFixed,null,t)}},t.prototype._getLoadingState=function(){return this.props.loadingState===P.SearchLoadingStates.LOADING_FIRST_PAGE?y.LoadingStates.LOADING_FIRST_PAGE:this.props.loadingState===P.SearchLoadingStates.LOADING_ADDITIONAL_PAGE?y.LoadingStates.LOADING_REMAINING_PAGES:y.LoadingStates.LOADED},t.prototype._maybeRenderMaestroActionMenu=function(){if(this.props.selectedFiles.size){var e=F.getActionsForFileCollection({files:this.props.selectedFiles,context:this.props.context,user:this.props.user,actionHandlers:this.props.actionHandlers,isMaestroDesign:!0,isSearchMode:!0});if(e.length>0){var t={displayName:e[0].label,handleClick:e[0].performAction},r=e.slice(1).map(function(e){return{displayName:e.label,handleClick:e.performAction,iconName:e.spriteName,mclIconName:e.iconName}}),o=c.getSelectedFilesText(this.props.selectedFiles,this.props.context);return i.createElement(E,{headerText:o,primaryMenuItem:t,secondaryMenuItems:r})}}return i.createElement("div",null)},t.prototype._renderSearchResultItems=function(){return i.createElement(v.ItemListController,{context:this.props.context,items:this.props.searchResults,loadingState:this._getLoadingState(),isMaestroDesign:!0,isSearchMode:!0,isColumnHeaderVisible:!1,isMultiColumnGroupVisible:!1,showFileViewerModal:this.props.showFileViewerModal,isFileViewerShown:this.props.isFileViewerShown,isPaginating:!1,setFileUploaderPath:this.props.setFileUploaderPath,isTextSelectable:!1,isDragAndDropEnabled:!1,shouldShowDeletedFiles:!1,showContainingPaths:!0,showFilenameHighlights:!0,user:this.props.user,path:this.props.path,selection:this.props.selection,selectedFiles:this.props.selectedFiles,onSelectionChange:this.props.onSelectionChange,customEmptyFolderView:this._renderEmptyFolderView,contextFileActionHandlers:this.props.contextFileActionHandlers,actionHandlers:this.props.actionHandlers,maestroListViewFullRowSelect:this.props.maestroListViewFullRowSelect,onOutsideMouseUp:s.noop,handleComponentTTI:this.props.handleComponentTTI})},t.prototype._renderMaestroAppContent=function(){return i.createElement("div",{className:"search-results"},this._maybeRenderUpsellPromoBanner(),this._maybeRenderSearchResultsHeader(),this._renderSearchResultItems())},t.prototype.render=function(){var e=this.props,t=e.user,r=e.maestroSearchBarProps,o=g.get_viewer();return i.createElement(h.MaestroChrome,{user:t,viewer:o,titleRegion:i.createElement(d.MaestroHeaderTitle,null,T._("Search results")),embeddedAppRegion:this._renderMaestroAppContent(),actionSidebarRegion:this._maybeRenderMaestroActionMenu(),searchBarProps:r})},t})(D.ReactLogger);t.SearchResultsView=N}),define("modules/clean/sharing/browse_exports",["require","exports","tslib","modules/clean/sharing/gating_util","modules/clean/sharing/async_share_modal_util","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/wizard/async_wizard_modals"],function(e,t,r,o,s,n,i){"use strict";function a(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/sharing/shared_content_link_sync_utils"],function(e){return e.mountSharedFolder.apply(e,t)})}function l(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){return[2,new Promise(function(r,o){e(["modules/clean/sharing/ui_util"],function(e){r(e.genContentManagerBridgeUri.apply(void 0,t))},o)})]})})}t.asyncMountSharedFolder=a,t.asyncGenContentManagerBridgeUri=l,t.GoldenGate=o.GoldenGate,t.asyncShowShareModal=s.asyncShowShareModal,t.asyncShowPrefilledShareModal=s.asyncShowPrefilledShareModal,t.asyncShowSharedContentLinkSyncModal=s.asyncShowSharedContentLinkSyncModal,t.makePublicFolderLink=n.makePublicFolderLink,t.shouldUsePublicFolderSharing=n.shouldUsePublicFolderSharing,t.showPublicFolderLinkModal=n.showPublicFolderLinkModal,t.asyncShowShareAFolderWizardModal=i.asyncShowShareAFolderWizardModal}),define("modules/clean/sharing/constants",["require","exports","external/underscore","modules/constants/sharing"],function(e,t,r,o){"use strict";(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={}));(function(e){e[e.PUBLIC=1]="PUBLIC",e[e.TEAM_ONLY=2]="TEAM_ONLY",e[e.PASSWORD=3]="PASSWORD",e[e.ONLY_YOU=99]="ONLY_YOU"})(t.SHMODEL_LINK_TOKEN_VISIBILITY||(t.SHMODEL_LINK_TOKEN_VISIBILITY={})),t.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},t.MEMBER_ACTION={LEAVE_A_COPY:"leave_a_copy",MAKE_EDITOR:"make_editor",MAKE_OWNER:"make_owner",MAKE_VIEWER:"make_viewer",MAKE_VIEWER_NO_COMMENT:"make_viewer_no_comment",REMOVE:"remove",ALL:["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"]},t.SNIPPET_SIZES={FILENAME:22,DISPLAY_NAME:26,EMAIL:30,OUT_OF_QUOTA_FOLDER_NAME:15},t.VALIDATE_PATH_PERMISSIONS={change_options:"canChangeOptions",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership"},t.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE={change_options:"canChangeOptions",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality",relinquish_membership:"canRelinquishMembership"},t.FOLDER_METADATA_PERMISSIONS={change_options:"canChangeOptions",edit_contents:"canEditContents",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unmount:"canUnmountFolder",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership",leave_a_copy:"leaveACopy"},t.ALPHA_FOLDER_METADATA_PERMISSIONS={change_options:"canChangeOptions",edit_contents:"canEditContents",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unmount:"canUnmountFolder",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership",leave_a_copy:"leaveACopy",enable_pass:"enable_viewer_info",disable_pass:"disable_viewer_info",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy"},t.FOLDER_METADATA_PERMISSIONS_INTERNAL={change_options:"canChangeOptions",edit_contents:"canEditContents",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unmount:"canUnmountFolder",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality",relinquish_membership:"canRelinquishMembership",leave_a_copy:"leaveACopy",enable_viewer_info:"enablePass",disable_viewer_info:"disablePass"},t.ALPHA_FILE_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_pass:"disablePass",enable_pass:"enablePass",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unshare:"unshare"},t.FILE_METADATA_PERMISSIONS={invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",unshare:"unshare"},t.SHARE_ACTION_ORIGIN_TYPE={BROWSE_FILE_ACTIONS:"BROWSE_FILE_ACTIONS",BROWSE_FILE_ROW:"BROWSE_FILE_ROW",BROWSE_GLOBAL_ACTIONS:"BROWSE_GLOBAL_ACTIONS",BROWSE_SHARED_FOLDER_BANNER:"BROWSE_SHARED_FOLDER_BANNER",CONTENT_MANAGER:"CONTENT_MANAGER",DESKTOP_CLIENT:"DESKTOP_CLIENT",EVENTS_PAGE:"EVENTS_PAGE",FILE_ROW_SHARE_MENU:"FILE_ROW_SHARE_MENU",GRANT_ACCESS:"GRANT_ACCESS",LEGACY_BROWSE:"LEGACY_BROWSE",LINKS_PAGE:"LINKS_PAGE",NOTIFICATION_WEB:"NOTIFICATION_WEB",OFFICE_INTEGRATION:"OFFICE_INTEGRATION",OUT_OF_QUOTA_MODAL:"OUT_OF_QUOTA_MODAL",PARENT_FOLDER_MODAL:"PARENT_FOLDER_MODAL",PREVIEW_PAGE:"PREVIEW_PAGE",PREVIEW_PAGE_FACEPILE:"PREVIEW_PAGE_FACEPILE",RECENTS:"RECENTS",SHARE:"SHARE",SHARE_LINK_MODAL:"SHARE_LINK_MODAL",SYNC_MODAL:"SYNC_MODAL",WIZARD:"WIZARD"},t.TOKEN_LINK_TYPE={SHARED_LINK:"s",SHARED_CONTENT_LINK:"c"},t.ACCESS_VALUES=r.values(t.ACCESS_LEVEL),t.GOLDEN_GATE=o.GOLDEN_GATE,t.NDSL=o.NDSL,t.PASS_CONTROL_AVAILABILITY=o.PASS_CONTROL_AVAILABILITY,t.REQUEST_ACCESS=o.REQUEST_ACCESS,t.ShareTibActionOriginType=o.ShareTibActionOriginType,t.SHARING_EXPERIMENTS=o.SHARING_EXPERIMENTS,t.TRUELINK=o.TRUELINK}),define("modules/clean/sharing/gating_util",["require","exports","modules/clean/sharing/constants"],function(e,t,r){"use strict";t.GoldenGate={canActOnInheritedMembers:function(e){return r.GOLDEN_GATE.CAN_ACT_ON_INHERITED_MEMBERS[e]},canDeepNest:function(e){return r.GOLDEN_GATE.CAN_DEEP_NEST[e]},canSetFolderConfidential:function(e){return r.GOLDEN_GATE.CAN_SET_FOLDER_CONFIDENTIAL[e]},hasNewMembershipUI:function(e){return r.GOLDEN_GATE.HAS_NEW_MEMBERSHIP_UI[e]},hasAudienceBox:function(e){return r.GOLDEN_GATE.HAS_AUDIENCE_BOX[e]},hasContentManager:function(e){return r.GOLDEN_GATE.HAS_CONTENT_MANAGER[e]},hasContentManagerAndSuperAdmin:function(e){return r.GOLDEN_GATE.HAS_CONTENT_MANAGER_AND_SUPER_ADMIN[e]},hasContentManagerActionsDisabled:function(e){return r.GOLDEN_GATE.HAS_CONTENT_MANAGER_ACTIONS_DISABLED[e]},hasContentManagerCdm:function(e){return r.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM[e]},hasContentManagerCdmInTSD:function(e){return r.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM_IN_TSD[e]},hasContentManagerTSDSwitch:function(e){return r.GOLDEN_GATE.HAS_CONTENT_MANAGER_TSD_SWITCH[e]},SHARING_TOTAL_LIMIT:r.GOLDEN_GATE.SHARING_TOTAL_LIMIT}}),define("modules/clean/sharing/public_folder/public_folder",["require","exports","modules/core/uri"],function(e,t,r){"use strict";function o(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;var r=(e.publicFolderFqPath||"/public").toLowerCase(),o=t.toLowerCase();return o===r?"/":o.startsWith(r+"/")?t.substring(r.length):null}function s(e,t){return null!=o(e,t)}function n(e,t,s,n){if(n)return null;var i=o(t,s);if(null!=i){var a=new r({scheme:"https",authority:"dl.dropboxusercontent.com"});return t.publicAppToken?(a.setPath("/spa/"+t.publicAppToken+i+"/data"),a.toString()):(a.setPath("/u/"+e+i),a.toString())}return null}function i(t){return new Promise(function(r,o){e(["external/react","modules/clean/react/modal","modules/clean/sharing/public_folder/modal"],function(e,o,s){var n=o.Modal,i=s.CopyPublicLinkModal;n.showInstance(e.createElement(i,{publicLink:t})),r()})})}t.shouldUsePublicFolderSharing=s,t.makePublicFolderLink=n,t.showPublicFolderLinkModal=i}),define("modules/clean/stormcrow/stormcrow_exposure_logger",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";var o=(function(){function e(){this.exposures={}}return e.prototype.logExposure=function(e,t){r.SilentBackgroundRequest({url:"/log/stormcrow_exposures",data:{stormcrow_name:e,variant:t}})},e.prototype.logExposuresOnce=function(e){var t=this;Object.keys(e).forEach(function(r){if(!(r in t.exposures)){var o=e[r];r&&o&&(t.exposures[r]=o,t.logExposure(r,o))}})},e})();t.StormcrowExposureLogger=o}),define("modules/clean/teams/team_promo_banner",["external/classnames","external/react","modules/clean/react/button"],function(e,t,r){var o,s,n;return s=t.DOM,o=t.createElement,n=t.PropTypes,t.createClass({displayName:"TeamPromoBanner",propTypes:{className:n.string,title:n.string,description:n.node,buttons:n.arrayOf(n.shape({text:n.string,handler:n.func}))},render:function(){var t,n;return s.div({className:e("team-promo-banner",this.props.className)},s.div({className:"team-promo-banner-contents"},s.div({className:"team-promo-banner-body"},s.div({className:"team-promo-banner-title"},this.props.title),s.div({className:"team-promo-banner-description"},this.props.description)),s.div({className:"team-promo-banner-buttons"},function(){var e,i,a,l;for(a=this.props.buttons,l=[],n=e=0,i=a.length;e<i;n=++e)t=a[n],l.push(s.span({className:"team-promo-banner-button",key:"button-"+n},o(r.button,{importance:"tertiary",onClick:t.handler},t.text)));return l}.call(this))))}})}),define("modules/core/framework_args",["require","exports"],function(e,t){"use strict";t.FRAMEWORK_ARGS=["country_override","cProfile","public_mode_override","stormcrow_override","stormcrow_override_data_field","stormcrow_override_population","stormcrow_override_ttl","stormcrow_panel","uncompressed_js","use_packages"]});
//# sourceMappingURL=pkg-maestro-browse.min.js-vfltdu5Io.map